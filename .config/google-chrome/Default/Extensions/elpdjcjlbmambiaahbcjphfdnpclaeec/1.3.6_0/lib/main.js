!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.APIListeners=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(){return{createPort:function(){return null}}}();b.exports=d},{}],2:[function(a,b,c){var d=function(){var a,b=!1,c=function(b,c,d){switch(b.type){case"request-ContextMenu.add":a.calls.add(b.data,d)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(c),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(c),b=!1)},calls:{add:function(a,b){chrome.contextMenus.create({title:a.title,contexts:a.contexts,onclick:function(a){chrome.tabs.query({active:!0,currentWindow:!0},function(c){chrome.tabs.sendMessage(c[0].id,{type:"request-selection"},function(c){var d={html:c.html,text:c.text,url:a.linkUrl};b(d)})})}})}}}}();b.exports=d},{}],3:[function(a,b,c){var d=function(){var a,b=!1,c=function(b,c,d){switch(b.type){case"request-I18n.translate":a.calls.translate(b.data,d);break;case"request-I18n.translateMany":a.calls.translateMany(b.data,d)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(c),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(c),b=!1)},calls:{translate:function(a,b){var c={};c[a]=chrome.i18n.getMessage(a),"function"==typeof b?b(c):console.warn("No callback supplied for I18n.translate")},translateMany:function(a,b){var c={};a.forEach(function(a){if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&(c[b]=chrome.extension.getURL("/data/"+a[b]));else c[a]=chrome.i18n.getMessage(a)}),"function"==typeof b?b(c):console.warn("No callback supplied for I18n.translateMany")}}}}();b.exports=d},{}],4:[function(a,b,c){var d=function(){var a,b=!1,c={},d=function(b,c,d){return 0!==b.type.indexOf("request-LocalRequest.get.")||(a.calls.execute(b.type,b.data,d),!0)};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(d),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(d),b=!1)},addListener:function(a,b){c["request-LocalRequest.get."+a]=b},calls:{execute:function(a,b,d){0!==a.indexOf("request-LocalRequest.get.")&&(a="request-LocalRequest.get."+a),"function"==typeof c[a]&&c[a](b,d)}}}}();b.exports=d},{}],5:[function(a,b,c){var d=function(){var a,b=!1,c=function(b,c,d){switch(b.type){case"request-PersistentStorage.get":case"request-PersistentStorage.getMany":a.calls.get(b.data,d);break;case"request-PersistentStorage.set":case"request-PersistentStorage.setMany":a.calls.set(b.data,d)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(c),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(c),b=!1)},calls:{get:function(a,b){chrome.storage.local.get(a,function(a){if("function"==typeof b)try{b(a)}catch(c){}})},set:function(a,b){chrome.storage.local.set(a,function(){if("function"==typeof b)try{b()}catch(a){}})}}}}();b.exports=d},{}],6:[function(a,b,c){var d=function(){var a,b=!1,c=function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d={};d.title=a[c].title,d.iconUrl=chrome.extension.getURL("/data/"+a[c].icon),b.push(d)}return b},d=function(b,c,d){switch(b.type){case"request-Popup.show":a.calls.show(b.data,d)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(d),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(d),b=!1)},calls:{show:function(a,b){var d="id-"+Math.round(1e3*Math.random());chrome.notifications.create(d,{type:"basic",title:a.title,message:a.message,iconUrl:chrome.extension.getURL("/data/"+a.icon),buttons:c(a.buttons)}),chrome.notifications.onButtonClicked.addListener(function(a,c){void 0!==b&&b(c)})}}}}();b.exports=d},{}],7:[function(a,b,c){var d=function(){var a,b=!1,c=function(a){var b=new XMLHttpRequest;return b.onreadystatechange=function(){if(4==b.readyState){var c;try{c=JSON.parse(b.responseText)}catch(d){"undefined"!=typeof Bugsnag&&Bugsnag.notifyException(d,"Request error",b.responseText),c=b.responseText}a(c)}},b},d=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push([c,encodeURIComponent(a[c])].join("="));return b.join("&")},e=function(b,c,d){switch(b.type){case"request-Request.get":a.calls.get(b.data,d);break;case"request-Request.post":a.calls.post(b.data,d)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(e),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(e),b=!1)},calls:{get:function(a,b){var e=c(b),f=a.url.indexOf("?")>-1?"&":"?",g=d(a.params),h=a.url+(g?f+g:"");e.open("GET",h,!0),e.send()},post:function(a,b){var e=c(b);e.open("POST",a.url,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(d(a.params))}}}}();b.exports=d},{}],8:[function(a,b,c){var d=function(){var a,b=!1,c=function(a){var b=a.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i),c=b&&b[1];return 0===c.indexOf("www.")?c.slice(4):c},d={},e={},f=function(b,c,d){switch(b.type){case"request-Tabs.attachAlways":a.attachAlways(b.data.scripts,b.data.css);break;case"request-Tabs.attachOnURLMatch":a.attachOnURLMatch(b.data.url,b.data.scripts,b.data.css);break;case"request-Tabs.clearAttachBucket":a.clearAttachBucket(b.data)}return!0},g=function(b,c,d){switch(b.type){case"request-Tabs.open":a.open(b.data)}return!0},h=function(a,b,f){if("complete"==b.status&&0===f.url.indexOf("http")){var g,h=[],j=[];for(g in d)d.hasOwnProperty(g)&&(d[g].scripts.forEach(function(a){-1===h.indexOf(a)&&h.push(a)}),d[g].css.forEach(function(a){-1===j.indexOf(a)&&j.push(a)}));for(g in e)for(var k in e[g])c(f.url)==k&&e[g].hasOwnProperty(k)&&(e[g][k].scripts.forEach(function(a){-1===h.indexOf(a)&&h.push(a)}),e[g][k].css.forEach(function(a){-1===j.indexOf(a)&&j.push(a)}));h=i(h),j=i(j),console.log(h),h.forEach(function(b){chrome.tabs.executeScript(a,{file:b})}),j.forEach(function(b){chrome.tabs.insertCSS(a,{file:b})})}},i=function(a){var b=[];return a.forEach(function(a){b.push("/data/"+a)}),b};return a={listen:function(a){b||(chrome.tabs.onUpdated.addListener(h),chrome.runtime.onMessage.addListener(g),chrome.runtime.onMessage.addListener(f),b=!0)},close:function(a){b&&(chrome.tabs.onUpdated.removeListener(h),chrome.runtime.onMessage.removeListener(g),chrome.runtime.onMessage.removeListener(f),b=!1)},open:function(a){var b=a.url;0!==b.indexOf("http")&&(b=chrome.extension.getURL("/data/html/"+b)),chrome.tabs.create({url:b})},onAttach:function(a){},onDetach:function(a){},_callOnAttach:function(a){},_callOnDetach:function(a){},attachAlways:function(a,b,c){void 0===c&&(c="default"),void 0===d[c]&&(d[c]={scripts:[],css:[]}),a.forEach(function(a){-1===d[c].scripts.indexOf(a)&&d[c].scripts.push(a)}),b.forEach(function(a){-1===d[c].css.indexOf(a)&&d[c].css.push(a)})},attachOnURLMatch:function(a,b,c,d,f){void 0===d&&(d=!1),void 0===f&&(f="default"),void 0===e[f]&&(e[f]={}),d&&(a=chrome.extension.getURL("/data/html/"+a));var g=e[f][a]||{scripts:[],css:[]};b.forEach(function(a){-1===g.scripts.indexOf(a)&&g.scripts.push(a)}),c.forEach(function(a){-1===g.css.indexOf(a)&&g.css.push(a)}),e[f][a]=g},clearAttachBucket:function(a){void 0!==d[a]&&delete d[a],void 0!==e[a]&&delete e[a]}}}();b.exports=d},{}],9:[function(a,b,c){var d=function(){var a,b=!1,c=[],d=function(b,c,d){switch(b.type){case"request-changePage":a.calls.changePage(b.data.to);break;case"request-changeIcon":a.calls.changeIcon(b.data.icon);break;case"request-changeBadge":a.calls.changeBadge(b.data.badge.text);break;case"request-changeTitle":a.calls.changeTitle(b.data.title)}return!0};return a={listen:function(a){b||(chrome.runtime.onMessage.addListener(d),b=!0)},close:function(){b&&(chrome.runtime.onMessage.removeListener(d),b=!1)},setSizeMapping:function(){},onChangePage:function(a){c.push(a)},_callOnChangePage:function(){for(var a in c)c.hasOwnProperty(a)&&c[a]()},calls:{changePage:function(b){return chrome.browserAction.setPopup({popup:"/data/html/"+b}),a._callOnChangePage(),!1},changeIcon:function(a){chrome.browserAction.setIcon({path:"/data/"+a})},changeBadge:function(a){chrome.browserAction.setBadgeText({text:a})},changeTitle:function(a){chrome.browserAction.setTitle({title:a})}}}}();b.exports=d},{}],10:[function(a,b,c){var d=function(){return{timer:{setTimeout:window.setTimeout.bind(window),clearTimeout:window.clearTimeout.bind(window),setInterval:window.setInterval.bind(window),clearInterval:window.clearInterval.bind(window)}}}();b.exports=d},{}],11:[function(a,b,c){if(void 0!==a){var d=(a("./Utils.js"),a("./TabsListener.js")),e=[],f=a("./BackgroundListener.js"),g={PersistentStorageListener:a("./PersistentStorageListener.js"),UIListener:a("./UIListener.js"),RequestListener:a("./RequestListener.js"),PopupListener:a("./PopupListener.js"),I18nListener:a("./I18nListener.js"),TabsListener:a("./TabsListener.js"),ContextMenuListener:a("./ContextMenuListener.js"),LocalRequestListener:a("./LocalRequestListener.js")},h={PersistentStorageListener:a("./PersistentStorageListener.js"),UIListener:a("./UIListener.js"),RequestListener:a("./RequestListener.js"),PopupListener:a("./PopupListener.js"),I18nListener:a("./I18nListener.js"),TabsListener:a("./TabsListener.js"),ContextMenuListener:a("./ContextMenuListener.js"),LocalRequestListener:a("./LocalRequestListener.js")},i=function(a,b){void 0===b&&(b=!1);for(var c in g)g.hasOwnProperty(c)&&(b||g[c].close(),g[c].listen(a))},j=function(a){i(a,!0)},k=function(a){if(!(e.indexOf(a)>-1)){for(var b in h)h.hasOwnProperty(b)&&h[b].listen(a);e.push(a)}},l=function(a){var b=e.indexOf(a);b>-1&&e.splice(b,1)};g.UIListener.onChangePage(i),d.attachAlways(["js/api/api.js","js/api/selection.js"],[]),d.onAttach(k),d.onDetach(l);j(f.createPort()),g.UIListener.setSizeMapping({"login.html":{width:360,height:450},"main.html":{width:510,height:550}});var m=g;b.exports=m}},{"./BackgroundListener.js":1,"./ContextMenuListener.js":2,"./I18nListener.js":3,"./LocalRequestListener.js":4,"./PersistentStorageListener.js":5,"./PopupListener.js":6,"./RequestListener.js":7,"./TabsListener.js":8,"./UIListener.js":9,"./Utils.js":10}]},{},[11])(11)});