// From https://github.com/timdown/rangy/blob/1e55169d2e4d1d9458c2a87119addf47a8265276/lib/rangy-textrange.js then minified
!function(e,t){"function"==typeof define&&define.amd?define(["./rangy-core"],e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e(require("rangy")):e(t.rangy)}(function(e){return e.createModule("TextRange",["WrappedSelection"],function(S,t){var e,n,r,g="character",v="word",c=S.dom,i=S.util,a=i.extend,s=i.createOptions,d=c.getBody,o=/^[ \t\f\r\n]+$/,u=/^[ \t\f\r]+$/,h=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,l=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,p="en",C=S.Selection.isDirectionBackward,f=!1,N=!1;function y(e,t){for(var n=e.slice(t.start,t.end),r={isWord:t.isWord,chars:n,toString:function(){return n.join("")}},i=0,o=n.length;i<o;++i)n[i].token=r;return r}function m(e,t,n){for(var r,i=n(e,t),o=[],a=0;r=i[a++];)o.push(y(e,r));return o}e=c.createTestElement(document,"<p>1 </p><p></p>",!0),n=e.firstChild,(r=S.getSelection()).collapse(n.lastChild,2),r.setStart(n.firstChild,0),e.innerHTML="1 <br />",r.collapse(e,2),r.setStart(e.firstChild,0),f=1==(""+r).length,e.innerHTML="1 <p>1</p>",r.collapse(e,2),r.setStart(e.firstChild,0),N=1==(""+r).length,c.removeNode(e),r.removeAllRanges();var x={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""};var T={includeBlockContentTrailingSpace:!1,includeSpaceBeforeBr:!f,includeSpaceBeforeBlock:!N,includePreLineTrailingSpace:!0},P={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(e,t){var n,r=e.join(""),i=[];function o(e,t,n){i.push({start:e,end:t,isWord:n})}for(var a,s,c=0;n=t.wordRegex.exec(r);){if(s=(a=n.index)+n[0].length,c<a&&o(c,a,!1),t.includeTrailingSpace)for(;l.test(e[s]);)++s;o(a,s,!0),c=s}return c<e.length&&o(c,e.length,!1),i}}},b={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},w={wordOptions:null,characterOptions:null},R={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},E={wordOptions:null,characterOptions:null,direction:"forward"};function B(e,t){var n,r,i,o=s(e,t);return t.hasOwnProperty("wordOptions")&&(o.wordOptions=(n=o.wordOptions)?(r=n.language||p,a(i={},P[r]||P[p]),a(i,n),i):P[p]),t.hasOwnProperty("characterOptions")&&(o.characterOptions=s(o.characterOptions,x)),o}var O,k,L,I=c.getComputedStyleProperty;k=document.createElement("table"),(L=d(document)).appendChild(k),O="block"==I(k,"display"),L.removeChild(k);var A={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};function W(e,t){var n=I(e,"display",t),r=e.tagName.toLowerCase();return"block"==n&&O&&A.hasOwnProperty(r)?A[r]:n}function _(e){for(var t,n=function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}(t=e).concat([t]),r=0,i=n.length;r<i;++r)if(1==n[r].nodeType&&"none"==W(n[r]))return!0;return!1}function D(e,t){return!t&&e.hasChildNodes()?e.firstChild:function(e){for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}(e)}function F(e){var t=e.previousSibling;if(t){for(e=t;e.hasChildNodes();)e=e.lastChild;return e}var n=e.parentNode;return n&&1==n.nodeType?n:null}function V(e){if(!e||3!=e.nodeType)return!1;var t=e.data;if(""===t)return!0;var n=e.parentNode;if(!n||1!=n.nodeType)return!1;var r=I(e.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(t)&&/^(normal|nowrap)$/.test(r)||/^[\t\r ]+$/.test(t)&&"pre-line"==r}function $(e){return""===e.data||!!V(e)&&(!e.parentNode||!!_(e))}function M(e){var t,n,r=e.nodeType;return 7==r||8==r||_(e)||/^(script|style)$/i.test(e.nodeName)||3==(t=e).nodeType&&(n=t.parentNode)&&"hidden"==I(n,"visibility")||$(e)}function q(e,t){var n=e.nodeType;return 7==n||8==n||1==n&&"none"==W(e,t)}function j(){this.store={}}j.prototype={get:function(e){return this.store.hasOwnProperty(e)?this.store[e]:null},set:function(e,t){return this.store[e]=t}};function U(r,i,o){return function(e){var t=this.cache;if(t.hasOwnProperty(r))return 0,t[r];0;var n=i.call(this,o?this[o]:this,e);return t[r]=n}}function G(e,t){this.node=e,this.session=t,this.cache=new j,this.positions=new j}var K={getPosition:function(e){var t=this.positions;return t.get(e)||t.set(e,new te(this,e))},toString:function(){return"[NodeWrapper("+c.inspectNode(this.node)+")]"}},z="NON_SPACE",H="UNCOLLAPSIBLE_SPACE",Y="COLLAPSIBLE_SPACE",J="TRAILING_SPACE_BEFORE_BLOCK",Q="TRAILING_SPACE_IN_BLOCK",X="TRAILING_SPACE_BEFORE_BR",Z="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",ee="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";function te(e,t){this.offset=t,this.nodeWrapper=e,this.node=e.node,this.session=e.session,this.cache=new j}a(G.prototype=K,{isCharacterDataNode:U("isCharacterDataNode",c.isCharacterDataNode,"node"),getNodeIndex:U("nodeIndex",c.getNodeIndex,"node"),getLength:U("nodeLength",c.getNodeLength,"node"),containsPositions:U("containsPositions",function(e){return c.isCharacterDataNode(e)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(e.nodeName)},"node"),isWhitespace:U("isWhitespace",V,"node"),isCollapsedWhitespace:U("isCollapsedWhitespace",$,"node"),getComputedDisplay:U("computedDisplay",W,"node"),isCollapsed:U("collapsed",M,"node"),isIgnored:U("ignored",q,"node"),next:U("nextPos",D,"node"),previous:U("previous",F,"node"),getTextNodeInfo:U("textNodeInfo",function(e){var t=null,n=!1,r=I(e.parentNode,"whiteSpace"),i="pre-line"==r;return i?(t=u,n=!0):"normal"!=r&&"nowrap"!=r||(t=o,n=!0),{node:e,text:e.data,spaceRegex:t,collapseSpaces:n,preLine:i}},"node"),hasInnerText:U("hasInnerText",function(e,t){for(var n=this.session,r=n.getPosition(e.parentNode,this.getNodeIndex()+1),i=n.getPosition(e,0),o=t?r:i,a=t?i:r;o!==a;){if(o.prepopulateChar(),o.isDefinitelyNonEmpty())return!0;o=t?o.previousVisible():o.nextVisible()}return!1},"node"),isRenderedBlock:U("isRenderedBlock",function(e){for(var t=e.getElementsByTagName("br"),n=0,r=t.length;n<r;++n)if(!M(t[n]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:U("trailingSpace",function(e){if("br"==e.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var t=e.lastChild;t;){if(!q(t))return 1==t.nodeType?this.session.getNodeWrapper(t).getTrailingSpace():"";t=t.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:U("leadingSpace",function(e){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var ne={character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){var e=this;if(!e.prepopulatedChar){var t=e.node,n=e.offset,r="",i="EMPTY",o=!1;if(0<n)if(3==t.nodeType){var a=t.data,s=a.charAt(n-1),c=e.nodeWrapper.getTextNodeInfo(),d=c.spaceRegex;c.collapseSpaces?d.test(s)?1<n&&d.test(a.charAt(n-2))||(c.preLine&&"\n"===a.charAt(n)?(r=" ",i=Z):(r=" ",i=Y)):(r=s,i=z,o=!0):(r=s,i=H,o=!0)}else{var u=t.childNodes[n-1];if(u&&1==u.nodeType&&!M(u)&&("br"==u.tagName.toLowerCase()?(r="\n",e.isBr=!0,o=!(i=Y)):e.checkForTrailingSpace=!0),!r){var l=t.childNodes[n];l&&1==l.nodeType&&!M(l)&&(e.checkForLeadingSpace=!0)}}e.prepopulatedChar=!0,e.character=r,e.characterType=i,e.isCharInvariant=o}},isDefinitelyNonEmpty:function(){var e=this.characterType;return e==z||e==H},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var e=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();e&&(this.isTrailingSpace=!0,this.character=e,this.characterType=Y),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var t=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();t&&(this.isLeadingSpace=!0,this.character=t,this.characterType=Y),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(e){for(var t=this;t=t.previousVisible();)if(""!==t.getCharacter(e))return t;return null},getCharacter:function(e){this.resolveLeadingAndTrailingSpaces();var t,n,r,i=this.character,o=(t=e.ignoreCharacters,(r="string"==typeof(n=t||"")?n.split(""):n).sort(function(e,t){return e.charCodeAt(0)-t.charCodeAt(0)}),r.join("").replace(/(.)\1+/g,"$1")),a=""!==i&&-1<o.indexOf(i);if(this.isCharInvariant)return a?"":i;var s=["character",e.includeSpaceBeforeBr,e.includeBlockContentTrailingSpace,e.includePreLineTrailingSpace,o].join("_"),c=this.cache.get(s);if(null!==c)return c;var d,u,l="",h=this.characterType==Y,p=!1,f=this;function g(){return p||(u=f.getPrecedingUncollapsedPosition(e),p=!0),u}return h&&(this.type==ee?l="\n":" "==i&&(!g()||u.isTrailingSpace||"\n"==u.character||" "==u.character&&u.characterType==Y)||("\n"==i&&this.isLeadingSpace?g()&&"\n"!=u.character&&(l="\n"):(d=this.nextUncollapsed())&&(d.isBr?this.type=X:d.isTrailingSpace&&"\n"==d.character?this.type=Q:d.isLeadingSpace&&"\n"==d.character&&(this.type=J),"\n"==d.character?(this.type!=X||e.includeSpaceBeforeBr)&&(this.type!=J||e.includeSpaceBeforeBlock)&&(this.type==Q&&d.isTrailingSpace&&!e.includeBlockContentTrailingSpace||(this.type!=Z||d.type!=z||e.includePreLineTrailingSpace)&&("\n"==i?d.isTrailingSpace?this.isTrailingSpace||this.isBr&&(d.type="TRAILING_LINE_BREAK_AFTER_BR",g()&&u.isLeadingSpace&&!u.isTrailingSpace&&"\n"==u.character?d.character="":d.type=ee):l="\n":" "==i&&(l=" "))):l=i))),-1<o.indexOf(l)&&(l=""),this.cache.set(s,l),l},equals:function(e){return!!e&&this.node===e.node&&this.offset===e.offset},inspect:function(){return"[Position("+c.inspectNode(this.node)+":"+this.offset+")]"},toString:function(){return this.character}};a(te.prototype=ne,{next:U("nextPos",function(e){var t,n,r,i=e.nodeWrapper,o=e.node,a=e.offset,s=i.session;return o?(a==i.getLength()?n=(t=o.parentNode)?i.getNodeIndex()+1:0:i.isCharacterDataNode()?(t=o,n=a+1):(r=o.childNodes[a],s.getNodeWrapper(r).containsPositions()?(t=r,n=0):(t=o,n=a+1)),t?s.getPosition(t,n):null):null}),previous:U("previous",function(e){var t,n,r,i=e.nodeWrapper,o=e.node,a=e.offset,s=i.session;return 0==a?n=(t=o.parentNode)?i.getNodeIndex():0:i.isCharacterDataNode()?(t=o,n=a-1):(r=o.childNodes[a-1],s.getNodeWrapper(r).containsPositions()?(t=r,n=c.getNodeLength(r)):(t=o,n=a-1)),t?s.getPosition(t,n):null}),nextVisible:U("nextVisible",function(e){var t=e.next();if(!t)return null;var n=t.nodeWrapper,r=t.node,i=t;return n.isCollapsed()&&(i=n.session.getPosition(r.parentNode,n.getNodeIndex()+1)),i}),nextUncollapsed:U("nextUncollapsed",function(e){for(var t=e;t=t.nextVisible();)if(t.resolveLeadingAndTrailingSpaces(),""!==t.character)return t;return null}),previousVisible:U("previousVisible",function(e){var t=e.previous();if(!t)return null;var n=t.nodeWrapper,r=t.node,i=t;return n.isCollapsed()&&(i=n.session.getPosition(r.parentNode,n.getNodeIndex())),i})});var re=null,ie=function(){function e(i){var o=new j;return{get:function(e){var t=o.get(e[i]);if(t)for(var n,r=0;n=t[r++];)if(n.node===e)return n;return null},set:function(e){var t=e.node[i];(o.get(t)||o.set(t,[])).push(e)}}}var n=i.isHostProperty(document.documentElement,"uniqueID");function t(){this.initCaches()}return t.prototype={initCaches:function(){var t;this.elementCache=n?(t=new j,{get:function(e){return t.get(e.uniqueID)},set:function(e){t.set(e.node.uniqueID,e)}}):e("tagName"),this.textNodeCache=e("data"),this.otherNodeCache=e("nodeName")},getNodeWrapper:function(e){var t;switch(e.nodeType){case 1:t=this.elementCache;break;case 3:t=this.textNodeCache;break;default:t=this.otherNodeCache}var n=t.get(e);return n||(n=new G(e,this),t.set(n)),n},getPosition:function(e,t){return this.getNodeWrapper(e).getPosition(t)},getRangeBoundaryPosition:function(e,t){var n=t?"start":"end";return this.getPosition(e[n+"Container"],e[n+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},t}();function oe(){return re||(ae(),re=new ie)}function ae(){re&&re.detach(),re=null}function se(e,n,r,i){r&&(n?M(r.node)&&(r=e.previousVisible()):M(r.node)&&(r=r.nextVisible()));var o=e,a=!1;var s,c=!1;return{next:function(){if(c)return c=!1,s;for(var e;t=void 0,t=null,n?(t=o,a||(o=o.previousVisible(),a=!o||r&&o.equals(r))):a||(t=o=o.nextVisible(),a=!o||r&&o.equals(r)),a&&(o=null),e=t;)if(e.getCharacter(i))return s=e;return null;var t},rewind:function(){if(!s)throw t.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");c=!0},dispose:function(){e=r=null}}}a(c,{nextNode:D,previousNode:F});var ce=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1};function de(e,t,n){var s=se(e,!1,null,t),c=se(e,!0,null,t),r=n.tokenizer;function i(e){for(var t,n,r=[],i=e?s:c,o=!1,a=!1;t=i.next();){if(n=t.character,h.test(n))a&&(o=!(a=!1));else{if(o){i.rewind();break}a=!0}r.push(t)}return r}var o=i(!0),a=i(!1).reverse(),d=m(a.concat(o),n,r),u=o.length?d.slice(ce(d,o[0].token)):[],l=a.length?d.slice(0,ce(d,a.pop().token)+1):[];return{nextEndToken:function(){for(var e,t;1==u.length&&!(e=u[0]).isWord&&0<(t=i(!0)).length;)u=m(e.chars.concat(t),n,r);return u.shift()},previousStartToken:function(){for(var e,t;1==l.length&&!(e=l[0]).isWord&&0<(t=i(!1)).length;)l=m(t.reverse().concat(e.chars),n,r);return l.pop()},dispose:function(){s.dispose(),c.dispose(),u=l=null}}}function ue(e,t,n,r){var i=e.getRangeBoundaryPosition(t,!0),o=e.getRangeBoundaryPosition(t,!1);return se(r?o:i,!!r,r?i:o,n)}function le(e,t,n,r,c){var i,o,a,s,d,u,l=C(c.direction),h=se(e,l,e.session.getRangeBoundaryPosition(r,l),c.characterOptions),p="",f=[],g=null;function v(e,t){var n,r,i,o,a=f[e].previousVisible(),s=f[t-1];return{startPos:a,endPos:s,valid:!c.wholeWordsOnly||(n=a,r=s,i=c.wordOptions,(o=S.createRange(n.node)).setStartAndEnd(n.node,n.offset,r.node,r.offset),!o.expand("word",{wordOptions:i}))}}for(;i=h.next();)if(o=i.character,n||c.caseSensitive||(o=o.toLowerCase()),l?(f.unshift(i),p=o+p):(f.push(i),p+=o),n){if(d=t.exec(p))if(s=(a=d.index)+d[0].length,u){if(!l&&s<p.length||l&&0<a){g=v(a,s);break}}else u=!0}else if(-1!=(a=p.indexOf(t))){g=v(a,a+t.length);break}return u&&(g=v(a,s)),h.dispose(),g}function he(r){return function(){var e=!!re,t=[oe()].concat(i.toArray(arguments)),n=r.apply(this,t);return e||ae(),n}}function pe(s,c){return he(function(e,t,n,r){void 0===n&&(n=t,t=g),r=B(r,w);var i=s;c&&(i=0<=n,this.collapse(!i));var o=function(e,t,n,r,i){var o,a,s,c,d=0,u=e,l=Math.abs(n);if(0!==n){var h=n<0;switch(t){case g:for(a=se(e,h,null,r);(o=a.next())&&d<l;)++d,u=o;s=o,a.dispose();break;case v:for(var p=de(e,r,i),f=h?p.previousStartToken:p.nextEndToken;(c=f())&&d<l;)c.isWord&&(++d,u=h?c.chars[0]:c.chars[c.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+t+"' not implemented")}h?(u=u.previousVisible(),d=-d):u&&u.isLeadingSpace&&!u.isTrailingSpace&&(t==v&&(s=(a=se(e,!1,null,r)).next(),a.dispose()),s&&(u=s.previousVisible()))}return{position:u,unitsMoved:d}}(e.getRangeBoundaryPosition(this,i),t,n,r.characterOptions,r.wordOptions),a=o.position;return this[i?"setStart":"setEnd"](a.node,a.offset),o.unitsMoved})}function fe(a){return he(function(e,t){for(var n,r=ue(e,this,t=s(t,x),!a),i=0;(n=r.next())&&h.test(n.character);)++i;r.dispose();var o=0<i;return o&&this[a?"moveStart":"moveEnd"]("character",a?i:-i,{characterOptions:t}),o})}function ge(r){return he(function(e,t){var n=!1;return this.changeEachRange(function(e){n=e[r](t)||n}),n})}a(S.rangePrototype,{moveStart:pe(!0,!1),moveEnd:pe(!1,!1),move:pe(!0,!0),trimStart:fe(!0),trimEnd:fe(!1),trim:he(function(e,t){var n=this.trimStart(t),r=this.trimEnd(t);return n||r}),expand:he(function(e,t,n){var r=!1,i=(n=B(n,R)).characterOptions;if(t||(t=g),t==v){var o,a,s=n.wordOptions,c=e.getRangeBoundaryPosition(this,!0),d=e.getRangeBoundaryPosition(this,!1),u=de(c,i,s).nextEndToken(),l=u.chars[0].previousVisible();if(this.collapsed)o=u;else o=de(d,i,s).previousStartToken();return a=o.chars[o.chars.length-1],l.equals(c)||(this.setStart(l.node,l.offset),r=!0),a&&!a.equals(d)&&(this.setEnd(a.node,a.offset),r=!0),n.trim&&(n.trimStart&&(r=this.trimStart(i)||r),n.trimEnd&&(r=this.trimEnd(i)||r)),r}return this.moveEnd(g,1,n)}),text:he(function(e,t){return this.collapsed?"":function(e,t,n){for(var r,i=[],o=ue(e,t,n);r=o.next();)i.push(r);return o.dispose(),i}(e,this,s(t,x)).join("")}),selectCharacters:he(function(e,t,n,r,i){var o={characterOptions:i};t||(t=d(this.getDocument())),this.selectNodeContents(t),this.collapse(!0),this.moveStart("character",n,o),this.collapse(!0),this.moveEnd("character",r-n,o)}),toCharacterRange:he(function(e,t,n){t||(t=d(this.getDocument()));var r,i=t.parentNode,o=c.getNodeIndex(t),a=-1==c.comparePoints(this.startContainer,this.endContainer,i,o),s=this.cloneRange();return a?(s.setStartAndEnd(this.startContainer,this.startOffset,i,o),r=-s.text(n).length):(s.setStartAndEnd(i,o,this.startContainer,this.startOffset),r=s.text(n).length),{start:r,end:r+this.text(n).length}}),findText:he(function(e,t,n){(n=B(n,b)).wholeWordsOnly&&(n.wordOptions.includeTrailingSpace=!1);var r=C(n.direction),i=n.withinRange;i||(i=S.createRange()).selectNodeContents(this.getDocument());var o=t,a=!1;"string"==typeof o?n.caseSensitive||(o=o.toLowerCase()):a=!0;var s=e.getRangeBoundaryPosition(this,!r),c=i.comparePoint(s.node,s.offset);-1===c?s=e.getRangeBoundaryPosition(i,!0):1===c&&(s=e.getRangeBoundaryPosition(i,!1));for(var d,u=s,l=!1;;)if(d=le(u,o,a,i,n)){if(d.valid)return this.setStartAndEnd(d.startPos.node,d.startPos.offset,d.endPos.node,d.endPos.offset),!0;u=r?d.startPos:d.endPos}else{if(!n.wrap||l)return!1;i=i.cloneRange(),u=e.getRangeBoundaryPosition(i,!r),i.setBoundary(s.node,s.offset,r),l=!0}}),pasteHtml:function(e){if(this.deleteContents(),e){var t=this.createContextualFragment(e),n=t.lastChild;this.insertNode(t),this.collapseAfter(n)}}}),a(S.selectionPrototype,{expand:he(function(e,t,n){this.changeEachRange(function(e){e.expand(t,n)})}),move:he(function(e,t,n,r){var i=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var o=this.getRangeAt(0);r||(r={}),r.characterOptions=s(r.characterOptions,T),i=o.move(t,n,r),this.setSingleRange(o)}return i}),trimStart:ge("trimStart"),trimEnd:ge("trimEnd"),trim:ge("trim"),selectCharacters:he(function(e,t,n,r,i,o){var a=S.createRange(t);a.selectCharacters(t,n,r,o),this.setSingleRange(a,i)}),saveCharacterRanges:he(function(e,t,n){for(var r=this.getAllRanges(),i=[],o=1==r.length&&this.isBackward(),a=0,s=r.length;a<s;++a)i[a]={characterRange:r[a].toCharacterRange(t,n),backward:o,characterOptions:n};return i}),restoreCharacterRanges:he(function(e,t,n){this.removeAllRanges();for(var r,i,o,a=0,s=n.length;a<s;++a)o=(i=n[a]).characterRange,(r=S.createRange(t)).selectCharacters(t,o.start,o.end,i.characterOptions),this.addRange(r,i.backward)}),text:he(function(e,t){for(var n=[],r=0,i=this.rangeCount;r<i;++r)n[r]=this.getRangeAt(r).text(t);return n.join("")})}),S.innerText=function(e,t){var n=S.createRange(e);return n.selectNodeContents(e),n.text(t)},S.createWordIterator=function(e,t,n){var r=oe();n=B(n,E);var i=de(r.getPosition(e,t),n.characterOptions,n.wordOptions),o=C(n.direction);return{next:function(){return o?i.previousStartToken():i.nextEndToken()},dispose:function(){i.dispose(),this.next=function(){}}}},S.noMutation=function(e){e(oe()),ae()},S.noMutation.createEntryPointFunction=he,S.textRange={isBlockNode:function(e){return e&&(1==e.nodeType&&!/^(inline(-block|-table)?|none)$/.test(W(e))||9==e.nodeType||11==e.nodeType)},isCollapsedWhitespaceNode:$,createPosition:he(function(e,t,n){return e.getPosition(t,n)})}}),e},this);
