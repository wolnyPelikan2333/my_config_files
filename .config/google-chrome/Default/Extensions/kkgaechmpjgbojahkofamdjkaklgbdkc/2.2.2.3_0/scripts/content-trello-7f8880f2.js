"use strict";(self.webpackChunk_planyway_planyway=self.webpackChunk_planyway_planyway||[]).push([[946],{15985:(e,t,r)=>{r.d(t,{Z:()=>BaseProvider});var i=r(26171),n=r(23513),a=r.n(n),o=r(88946),s=r.n(o),l=r(62079),c=r.n(l),d=r(73324),u=r.n(d),h=r(27525),p=r.n(h),v=r(91829),m=r.n(v),f=r(51791),C=r.n(f),y=r(90143),g=r.n(y),_=r(57170),k=r.n(_),w=r(86981),b=r.n(w),D=r(8244),E=r.n(D),S=r(39290),A=r.n(S),I=r(35820),P=r.n(I),T=r(52020),x=r.n(T),R=r(88546),$=r.n(R),L=r(99595),M=r.n(L),N=r(66775),F=r.n(N),G=r(2201),O=r.n(G),z=r(57445),j=r.n(z),U=r(19755),B=r.n(U),H=r(82617),K=r(14587),V=r(56777),W=(r(71315),r(33001),r(88078),r(39790),r(8937)),Z=r(29704),q=r(46930);function ownKeys(e,t){var r=c()(e);if(x()){var i=x()(e);t&&(i=u()(i).call(i,(function(t){return $()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,a=null!=arguments[t]?arguments[t]:{};t%2?M()(r=ownKeys(Object(a),!0)).call(r,(function(t){(0,i.Z)(e,t,a[t])})):F()?O()(e,F()(a)):M()(n=ownKeys(Object(a))).call(n,(function(t){j()(e,t,$()(a,t))}))}return e}class BaseProvider{constructor(){if((0,i.Z)(this,"_invalidAccountIds",new(a())),new.target===BaseProvider)throw new TypeError("Unable to create BaseProvider instance directly");this._ngBootstrap(),this._$rootScope.$on(W.FK.AccountAdding,(()=>this._accounts=null))}get type(){_prevent("type")}get integrationService(){_prevent("integrationService")}get cardsService(){_prevent("cardService")}static get sortOrder(){_prevent("sortOrder")}initializeAsync(e){_prevent(this.initializeAsync.name)}getCardTemplates(){_prevent(this.getCardTemplates.name)}getCalendarExtraCardStyle(e){_prevent(this.getCalendarExtraCardStyle.name)}getCardTemplateData(e){_prevent(this.getCardTemplateData.name)}getCardTooltipConfig(){_prevent(this.getCardTooltipConfig.name)}getCardEditorHtml(){_prevent(this.getCardEditorHtml.name)}getCardContextMenuHtml(){_prevent(this.getCardContextMenuHtml.name)}getWorkPanelHtml(){_prevent(this.getWorkPanelHtml.name)}getWorkPanelCalloutConfig(){_prevent(this.getWorkPanelCalloutConfig.name)}isWorkPanelAvailable(){_prevent(this.isWorkPanelAvailable.name)}getCalendarsPickerHtml(){_prevent(this.getCalendarsPickerHtml.name)}getCardId(e){_prevent(this.getCardId.name)}getCalendarCardClass(){_prevent(this.getCalendarCardClass.name)}isMilestonesSupported(){_prevent(this.isMilestonesSupported.name)}scrollToCard(){_prevent(this.scrollToCard.name)}get _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}get _calendarCardsSrv(){return this._calendarCardsSrvLazy||(this._calendarCardsSrvLazy=this._$injector.get("calendarCardsSrv")),this._calendarCardsSrvLazy}get _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=this._$injector.get("collectionSrv")),this._collectionSrvLazy}get _dialogSrv(){return this._dialogSrvLazy||(this._dialogSrvLazy=this._$injector.get("dialogSrv")),this._dialogSrvLazy}get _htmlHelperSrv(){return this._htmlHelperSrvLazy||(this._htmlHelperSrvLazy=this._$injector.get("htmlHelperSrv")),this._htmlHelperSrvLazy}get _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=this._$injector.get("licenseSrv")),this._licenseSrvLazy}get _notificationSrv(){return this._notificationSrvLazy||(this._notificationSrvLazy=this._$injector.get("notificationSrv")),this._notificationSrvLazy}get _onboardingSrv(){return this._onboardingSrvLazy||(this._onboardingSrvLazy=this._$injector.get("onboardingSrv")),this._onboardingSrvLazy}get _planywayIntegrationSrv(){return this._planywayIntegrationSrvLazy||(this._planywayIntegrationSrvLazy=this._$injector.get("planywayIntegrationSrv")),this._planywayIntegrationSrvLazy}get _platformSrv(){return this._platformSrvLazy||(this._platformSrvLazy=this._$injector.get("platformSrv")),this._platformSrvLazy}get _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=this._$injector.get("settingsSrv")),this._settingsSrvLazy}get _telemetrySrv(){return this._telemetrySrvLazy||(this._telemetrySrvLazy=this._$injector.get("telemetrySrv")),this._telemetrySrvLazy}get _timeTrackingSrv(){return this._timeTrackingSrvLazy||(this._timeTrackingSrvLazy=this._$injector.get("timeTrackingSrv")),this._timeTrackingSrvLazy}_ngBootstrap(){let e=B()("body").injector();this._$injector=e.get("$injector"),this._$rootScope=e.get("$rootScope"),this._$translate=e.get("$translate"),this._$log=e.get("$log"),this._$window=e.get("$window"),this._$interval=e.get("$interval"),this._$timeout=e.get("$timeout")}get accountType(){_prevent("accountType")}get invalidAccountIds(){return this._invalidAccountIds}getAccountName(e){_prevent(this.getAccountName.name)}getAccountEmail(e){_prevent(this.getAccountEmail.name)}getAccountUser(e){_prevent(this.getAccountUser.name)}getAccountUserAsync(e){_prevent(this.getAccountUser.name)}getCurrentCollectionConnectedAccountIds(){var e;let t=this._userSettings.global.settings.collection[this._currentCollectionId];if(!t)return[];let r=s()(e=this._planywayIntegrationSrv.getConnectedAccounts(this.accountType)).call(e,(e=>{let{accountId:t}=e;return t})),i=(0,Z.Bn)(t.account,r);return c()(i)}getCurrentCollectionConnectedAccounts(){var e;return s()(e=this.getCurrentCollectionConnectedAccountIds()).call(e,(e=>this._planywayIntegrationSrv.getConnectedAccountById(e)))}isCurrentCollectionAccountReady(e){return this.integrationService.isCurrentCollectionAccountReady(e)}getCurrentCollectionConnectedCalendarIds(e){_prevent(this.getCurrentCollectionConnectedCalendarIds.name)}getCurrentCollectionConnectedCalendar(e,t){_prevent(this.getCurrentCollectionConnectedCalendar.name)}getCurrentCollectionConnectedCalendars(e){_prevent(this.getCurrentCollectionConnectedCalendars.name)}setCurrentCollectionConnectedCalendars(e,t){var r;let i=this._userSettings.global.settings.collection[this._currentCollectionId];if(!i)return;let n=[...u()(r=this.getCurrentCollectionConnectedCalendars(e)).call(r,(e=>!p()(t).call(t,(t=>t.calendarId===e.calendarId)))),...u()(t).call(t,(e=>e.isConnected))];for(let e of n)this._collectionSettings.global.settings.calendar[e.calendarId]=e;let a=u()(t).call(t,(e=>!e.isConnected));for(let e of a)delete this._collectionSettings.global.settings.calendar[e.calendarId];for(let t of i.account[e])p()(n).call(n,(e=>e.calendarId===t))||delete this._collectionSettings.global.settings.calendar[t];i.account[e]=s()(n).call(n,(e=>{let{calendarId:t}=e;return t})),this.cardsService.reloadCalendars(e),this._userSettings.global.saveAsync(),this._collectionSettings.global.saveAsync()}getCurrentCollectionSelectedCalendarIds(e){var t,r;return s()(t=u()(r=this.getCurrentCollectionConnectedCalendars(e)).call(r,(e=>e.isSelected))).call(t,(e=>e.calendarId))}hasCurrentCollectionSelectedCalendars(){var e;return p()(e=this.getCurrentCollectionConnectedAccountIds()).call(e,(e=>this.getCurrentCollectionSelectedCalendarIds(e).length>0))}getCurrentCollectionAccountIdByConnectedCalendarId(e){for(let t of this.getCurrentCollectionConnectedAccountIds()){let r=this.getCurrentCollectionConnectedCalendarIds(t);if(m()(r).call(r,e))return t}}getSignalRConnectionParams(e){_prevent(this.getSignalRConnectionParams.name)}getDefaultUserLocalProviderSettings(){return{}}reduceUserLocalProviderSettings(e){return e}getDefaultUserGlobalProviderSettings(){return{}}reduceUserGlobalProviderSettings(e){return e}getDefaultCollectionLocalProviderSettings(){return{}}getDefaultCollectionLocalExtendedSettings(){return{}}reduceCollectionLocalProviderSettings(e){return e}getDefaultCollectionGlobalProviderSettings(){return{}}getDefaultCollectionGlobalExtendedSettings(){return{}}reduceCollectionGlobalProviderSettings(e){return e}callRecordsApiAsync(e,t,r,i){_prevent(this.callRecordsApiAsync.name)}get timeTrackingCardType(){}canCreateCard(e,t){_prevent("canCreateCard")}isTimeTrackingAvailable(){_prevent("isTimeTrackingAvailable")}getMainToolbarRightHtml(){_prevent(this.getMainToolbarRightHtml.name)}getMainToolbarFiltersMenuHtml(){_prevent(this.getMainToolbarFiltersMenuHtml.name)}getSchedulerToolbarViewSettingsMenuHtml(){_prevent(this.getSchedulerToolbarViewSettingsMenuHtml.name)}getSupportedSchedulerModes(){_prevent(this.getSupportedSchedulerModes.name)}getSupportedTimelineViews(){_prevent(this.getSupportedTimelineViews.name)}getViewSettingsMenuFieldItems(){_prevent(this.getViewSettingsMenuFieldItems.name)}addTimeRecordManuallyAsync(e){_prevent(this.addTimeRecordManuallyAsync.name)}getTimerParentCardByIdAsync(e,t){_prevent(this.getTimerParentCardByIdAsync.name)}createTimeRecordCardByTimerAsync(e){_prevent(this.createTimeRecordCardByTimerAsync.name)}static getSidebarPanelHtml(){_prevent(BaseProvider.getSidebarPanelHtml.name)}isAccountCollapsed(e){var t;return m()(t=this._collectionSettings.local.settings.mainSidebar.collapsed).call(t,e)}toggleAccountCollapsed(e){const t=this._collectionSettings.local.settings.mainSidebar.collapsed,r=C()(t).call(t,e);-1===r?t.push(e):g()(t).call(t,r,1),this._collectionSettings.local.save()}async addAccountToCurrentCollectionAsync(e){this._userSettings.global.settings.collection[this._currentCollectionId].account[e.accountId]=[],await this._userSettings.global.saveAsync(),this._$rootScope.$broadcast(W.FK.AccountAdding,e)}async removeAccountFromCurrentCollectionAsync(e){delete this._userSettings.global.settings.collection[this._currentCollectionId].account[e.accountId],await this._userSettings.global.saveAsync(),this._$rootScope.$broadcast(W.FK.AccountDeleting,e)}async removeAccountFromAllCollectionsAsync(e){for(let t of c()(this._userSettings.global.settings.collection))delete this._userSettings.global.settings.collection[t].account[e.accountId];await this._userSettings.global.saveAsync(),this._$rootScope.$broadcast(W.FK.AccountDeleting,e)}getNewCardObjectProviderCard(e,t){_prevent(this.getNewCardObjectProviderCard.name)}getTimelineResourceTemplates(){_prevent(this.getTimelineResourceTemplates.name)}getTimelineResourcesByType(e,t){_prevent(this.getTimelineResourcesByType.name)}getTimelineResourcesMenuByType(e,t){_prevent(this.getTimelineResourcesMenuByType.name)}expandTimelineResources(e,t){_prevent(this.expandTimelineResources.name)}updateProviderCardDataByTimelineResource(e,t){_prevent(this.updateProviderCardDataByTimelineResource.name)}isEventDataUpdated(e,t,r){_prevent(this.isEventDataUpdated.name)}isOwnCalendarCard(e){_prevent(this.isOwnCalendarCard.name)}isCardContextMenuAvailable(e){_prevent(this.isCardContextMenuAvailable.name)}isCardResizeAvailable(e){_prevent(this.isCardResizeAvailable.name)}isCardSatisfiesSchedulerFilters(e){_prevent(this.isCardSatisfiesSchedulerFilters.name)}canModifyInScheduler(e){_prevent(this.canModifyInScheduler.name)}canStartMoveInScheduler(e){_prevent(this.canStartMoveInScheduler.name)}canEndMoveInScheduler(e){_prevent(this.canEndMoveInScheduler.name)}canResizeInScheduler(e,t,r){_prevent(this.canResizeInScheduler.name)}canUpdateInScheduler(e){_prevent(this.canUpdateInScheduler.name)}canSortInScheduler(e){_prevent(this.canSortInScheduler.name)}getMovedEvent(e,t){_prevent(this.getMovedEvent.name)}getCardExtraClasses(e){_prevent(this.getCardExtraClasses.name)}getHiddenCardElements(){_prevent(this.getHiddenCardElements.name)}getCardMemberBackground(e){_prevent(this.getCardMemberBackground.name)}getCardCalendarName(e){_prevent(this.getCardCalendarName.name)}getCardTaskListName(e){_prevent(this.getCardTaskListName.name)}getCardLinks(e){_prevent(this.getCardLinks.name)}getDragInfo(e,t){_prevent(this.getDragInfo.name)}getDraggingCard(e,t,r,i){_prevent(this.getDraggingCard.name)}getDraggedCardUpdateData(e,t,r){_prevent(this.getDraggedCardUpdateData.name)}getPreviewCard(e){_prevent(this.getPreviewCard.name)}updateCardByMouseAsync(e,t,r){_prevent(this.updateCardByMouseAsync.name)}getUpdateByMouseTelemetry(e,t,r){_prevent(this.getUpdateByMouseTelemetry.name)}createCardByExternalCall(e,t,r,i,n,a){_prevent(this.createCardByExternalCall.name)}createCardByClick(e,t){_prevent(this.createCardByClick.name)}createCardByDropAsync(e){_prevent(this.createCardByDropAsync.name)}createTimeRecordCardByClick(e,t){_prevent(this.createTimeRecordCardByClick.name)}createTimeRecordCardByDropAsync(e){_prevent(this.createTimeRecordCardByDropAsync.name)}get availableCardTypes(){_prevent("defaultCardType")}get defaultCardType(){_prevent("defaultCardType")}get availableCardRoles(){_prevent("defaultCardRole")}get defaultCardRole(){_prevent("defaultCardRole")}async copyCardUrlAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logCardEvent(e,W.cN.CardEvents.UrlCopied,t.telemetry);try{let t=new(k());t.set(H.pJ,this._currentCollectionId),t.set(H.m3,(0,H.kV)({accountType:this.accountType,calendarId:e.calendarId,cardType:e.cardType,cardId:e.recurrenceId||e.id})),t.set(H.Ii,W.Un.ShareCard),await(0,Z.mb)(`https://planyway.com/app?${t}`),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.URL_COPIED_TO_CLIPBOARD"),W.k$.Success)}catch(e){this._$log.error("Planyway copy card URL error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.COPY_CARD_URL_ERROR"),W.k$.Error),this._telemetrySrv.logError("Planyway copy card URL error",e,{class:this.constructor.name,method:this.copyCardUrlAsync.name})}}async copyCardAsTimeRecordAsync(e){var t;let r,i,n,a;!(0,q.I1)(e)||(0,q.IK)(e)?(r=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id),i=r.start,n=r.end):(r=this.getRecurrenceHead(e),i=e.start,n=e.end),r.isAllDay?(a=this._timeTrackingSrv.timeRecordDefaultDurationMinutes,i=(0,Z.nT)(e.start),n=(0,Z.mH)(i,a)):(a=(0,Z.CX)(i,n),a>this._timeTrackingSrv.timeRecordMaxDurationMinutes&&(a=this._timeTrackingSrv.timeRecordMaxDurationMinutes,n=(0,Z.mH)(i,a)));let o=b()(t=this._collectionSrv.getCurrentCollectionConnectedAccounts()).call(t,(e=>{let t=(0,V.dS)(e.accountType);return t.timeTrackingCardType&&t.getCurrentCollectionSelectedCalendarIds(e.accountId).length>0}));if(!o)return;let s,l=(0,V.dS)(o.accountType);try{s=this._calendarCardsSrv.createTempCalendarCard(o.accountId,l.timeTrackingCardType,{title:r.title,isAllDay:!1,start:i,end:n,durationMinutes:a,providerCard:{}}),l.logCardEvent(s,W.cN.CardEvents.CreateDialogOpened,{where:W.a6.Scheduler,by:W.AH.CopyAsTimeRecord}),await this._dialogSrv.showEditCardDialogAsync(s,{cardTypes:[l.timeTrackingCardType]})?l.logCardEvent(s,W.cN.CardEvents.Scheduled,{where:W.a6.Scheduler,by:W.AH.CopyAsTimeRecord}):(l.logCardEvent(s,W.cN.CardEvents.CreateDialogClosed,{where:W.a6.Scheduler,by:W.AH.CopyAsTimeRecord}),this._calendarCardsSrv.deleteCalendarCardAsync(s))}catch(e){this._$log.error("Planyway copy card as time entry error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway copy card as time entry error",e,{class:this.constructor.name,method:this.copyCardAsTimeRecordAsync.name}),s&&this._calendarCardsSrv.deleteCalendarCardAsync(s),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.COPY_CARD_AS_TIME_ENTRY_ERROR"),W.k$.Error)}}async tryOpenCardAsync(e){const{calendarId:t,cardType:r,cardId:i}=e;if(!t||!r||!i)return;let n;try{if(this._appCommonSrv.setSchedulerBusy(!0),await this._collectionSrv.waitCurrentCollectionConnectedAccountsReadyAsync())for(let e of this.getCurrentCollectionConnectedAccounts()){const a=e.accountId;let o=this.getCurrentCollectionConnectedCalendar(a,t);if(o.isConnected&&o.isSelected){n=await this._calendarCardsSrv.waitCalendarCardAsync(a,t,r,i);break}}}finally{this._appCommonSrv.setSchedulerBusy(!1)}if(n)try{const{link:t}=await this._appCommonSrv.getAppContextAsync();let r,i,a;switch(null==t?void 0:t.type){case W.Un.PushNotificationMemberAssigned:case W.Un.PushNotificationMemberMentioned:case W.Un.PushNotificationRemindStart:r=W.a6.Scheduler,i=W.AH.PushNotification,a=!0;break;case W.Un.ShareCard:r=W.a6.Scheduler,i=W.AH.ShareCard,a=!0;break;default:({where:r,by:i,shouldOpenCard:a}=await this._onTryOpenCardByLinkAsync(n,null==t?void 0:t.type)||{})}if(a){this.logCardEvent(n,W.cN.CardEvents.EditDialogOpened,{where:r,by:i}),await this._dialogSrv.showEditCardDialogAsync(n,{scrollToCommentId:e.commentId})||this.logCardEvent(n,W.cN.CardEvents.EditDialogClosed,{where:r,by:i})}}catch(e){this._$log.error("Planyway open card error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway open card error",e,{class:this.constructor.name,method:this.tryOpenCardAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.OPEN_CARD_ERROR"),W.k$.Error)}else this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CARD_IS_NOT_FOUND_ERROR"),W.k$.Warning)}getCardTimeDurationText(e){_prevent(this.getCardTimeDurationText.name)}getTotalCardsTimeDurationInDay(e,t){_prevent(this.getTotalCardsTimeDurationInDay.name)}hasEstimation(e){_prevent(this.hasEstimation.name)}hasTrackedTime(e){_prevent(this.hasTrackedTime.name)}isHotkeyAvailable(e,t,r){_prevent(this.isHotkeyAvailable.name)}updateCardsByHotkey(e,t,r,i,n){_prevent(this.updateCardsByHotkey.name)}duplicateCardsAsync(e){_prevent(this.duplicateCardsAsync.name)}removeCardDatesAsync(e){_prevent(this.removeCardDatesAsync.name)}deleteCardsAsync(e){_prevent(this.deleteCardsAsync.name)}getThirdPartyUserId(e){_prevent(this.getThirdPartyUserId.name)}logCardEvent(e,t){_prevent(this.logCardEvent.name)}async getRecurringModeAsync(e,t){let r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(p()(e).call(e,(e=>(0,q.I1)(e)&&!(0,q.IK)(e)))){if(i)return W.f.AllSeries;const n=p()(e).call(e,(e=>!e.isRecurrenceHead())),a=E()(e).call(e,(e=>void 0!==e.providerCard.canModify?e.providerCard.canModify:!e.isReadOnly));if(this._$rootScope.$broadcast(W.FK.CloseContextMenusRequested),r=await this._dialogSrv.showEditRecurringConfirmDialogAsync(e[0].cardType,n&&a,t),!r||r!==W.f.AllSeries&&!this._licenseSrv.checkPaidFeatureAvailable(W.ZV.RecurringCards,!0))return null}return r}getRecurrenceHead(e){return this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.recurrenceId||e.id)}getRecurrenceException(e){var t,r;let i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null!==(t=e.realIsAllDay)&&void 0!==t?t:e.isAllDay,o=null!==(r=e.realStart)&&void 0!==r?r:e.start;e instanceof q.fb?(i=e.clone(),i.recurrenceId=e.id||e.recurrenceId,i.recurrenceRule=null,i.recurrenceException=null,i.exceptionDate=o,i.originalStart=a?(0,Z.tC)(o):o.toISOString()):i=e.toOccurrence({sourceCardId:e.recurrenceId||e.id,exceptionDate:o,originalStart:a?(0,Z.tC)(o):o.toISOString()});let s=this.getRecurrenceHead(e);i.providerCard=s.providerCard.clone(),i.providerCard.sourceCardId=e.recurrenceId||e.id;for(let[e,t]of A()(n))if(void 0!==t){let r;switch(e){case"cardType":case"isAllDay":case"start":case"end":r=i;break;default:r=i.providerCard}r[e]=t}return i}createRecurrenceExceptionAsync(e,t){return this._calendarCardsSrv.addExceptionToRecurrentAsync(e.accountId,e.cardType,e),t?this._calendarCardsSrv.createRecurrenceExceptionAsync(e.accountId,e.cardType,e):this._calendarCardsSrv.createRecurrenceGapAsync(e.accountId,e.cardType,e)}async deleteRecurrenceExceptionsAsync(e,t){(e.recurrenceException||t)&&(await this._calendarCardsSrv.removeExceptionsFromRecurrentAsync(e.accountId,e.cardType,e,{fromDate:t}),(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(e.cardType,e,{fromDate:t})}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this.deleteRecurrenceExceptionsAsync.name})}})())}createFollowingRecurrenceAsync(e,t,r){let i=K.Ci.fromString(e.recurrenceRule);if(i.origOptions.until)i.origOptions.until<=r.start?(i.origOptions.until=null,i.origOptions.count=1):(i.origOptions.until=r.isAllDay?(0,Z._q)((0,Z.$Y)((0,Z.wD)(i.origOptions.until))):(0,Z._q)((0,Z.h3)((0,Z.wD)(i.origOptions.until))),i.origOptions.count=null);else if(i.origOptions.count){i.options.dtstart=(0,Z._q)(e.start);let r=i.all((e=>e<(0,Z._q)(t)));i.origOptions.count-=r.length}let n=r.clone({recurrenceRule:i.toString({onlyDate:r.isAllDay}).replace("RRULE:",""),recurrenceId:null});n.providerCard=n.providerCard.clone(),n.providerCard.sourceCardId=e.id;let a=this._calendarCardsSrv.createTempCalendarCard(e.accountId,e.cardType,n);return this._calendarCardsSrv.createCalendarCardAsync(a)}async _applyRecurrenceActionsAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=await P().all(s()(e).call(e,(async e=>{var r,i,n,a,o;if(!(0,q.I1)(e)||(0,q.IK)(e))return e;let s,l,{recurringMode:c,createException:d,properties:u}=t;u=u?u.get(e.id):{},t.recurringMode===W.f.ThisAndFollowing&&(0,q.e4)(e)&&(c=W.f.AllSeries);try{switch(c){case W.f.OnlyOccurrence:s=this.getRecurrenceHead(e),l=this.getRecurrenceException(e,u),null===(r=t.telemetryCallback)||void 0===r||r.call(t,e,s),await(null===(i=t[W.f.OnlyOccurrence])||void 0===i?void 0:i.call(t,l,t.createException)),e=await this.createRecurrenceExceptionAsync(l,t.createException);break;case W.f.ThisAndFollowing:s=this.getRecurrenceHead(e),l=this.getRecurrenceException(e,u),null===(n=t.telemetryCallback)||void 0===n||n.call(t,e,s),await(null===(a=t[W.f.ThisAndFollowing])||void 0===a?void 0:a.call(t,l));let c=e.start;d&&(e=await this.createFollowingRecurrenceAsync(s,c,l)),await this.deleteRecurrenceExceptionsAsync(s,c);break;case W.f.AllSeries:return s=this.getRecurrenceHead(e),await(null===(o=t[W.f.AllSeries])||void 0===o?void 0:o.call(t,s)),s}}catch(e){this._$log.error("Planyway update recurrent card error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway update recurrent card error",e,{class:this.constructor.name,method:this._applyRecurrenceActionsAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_RECURRING_CARD_ERROR"),W.k$.Error)}}))),u()(e).call(e,(e=>e))}get _userSettings(){return this._settingsSrv.user}get _collectionSettings(){return this._settingsSrv.collection}get _currentCollectionId(){return this._collectionSrv.currentCollectionId}_onTryOpenCardByLinkAsync(e,t){}async _restAsync(e,t,r){let i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(r,e,t,_objectSpread(_objectSpread({},n.query),n.body),n.telemetrySkipOnSuccess),o=200;try{return await this._platformSrv.restAsync(e,t,n)}catch(e){throw o=e.status,i=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,o,i)}}}function _prevent(e){throw new SyntaxError(`Unable to use abstract "${e}" directly`)}},49083:(e,t,r)=>{r.d(t,{s:()=>getProviderDependencies});var i=r(8937),n=r(26171);class CalendarIconController{constructor(){(0,n.Z)(this,"_iconSize","small")}static get controllerName(){return"githubProjectIconCtrl"}get iconSize(){return this._iconSize}}var a=r(40024),o=r.n(a),s=r(51791),l=r.n(s),c=r(90143),d=r.n(c),u=r(56626),h=r.n(u),p=r(67552),v=r.n(p),m=r(62079),f=r.n(m),C=r(52020),y=r.n(C),g=r(88546),_=r.n(g),k=r(66775),w=r.n(k),b=r(2201),D=r.n(b),E=r(26881),S=r(73324),A=r.n(S),I=r(87994),P=r.n(I),T=r(88946),x=r.n(T),R=r(91829),$=r.n(R),L=r(86981),M=r.n(L),N=r(57445),F=r.n(N),G=r(99595),O=r.n(G),z=r(56777),j=r(43603),U=r(29704),B=r(14248),H=r.n(B),K=r(42191),V=r.n(K);function ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let W=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$scope","dialogSrv","githubIntegrationSrv","licenseSrv","platformSrv","telemetrySrv"])],(function(e){return{F:class CalendarPickerController{constructor(t,r,i,n,a,o){e(this),this._$scope=t,this._dialogSrv=r,this._githubIntegrationSrv=i,this._licenseSrv=n,this._platformSrv=a,this._telemetrySrv=o}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubCalendarPickerCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"field",key:"account",value:void 0},{kind:"get",key:"projectsAvailable",value:function projectsAvailable(){return this.calendars.length>0}},{kind:"get",key:"filterText",value:function filterText(){return this._filterText||""}},{kind:"set",key:"filterText",value:function filterText(e){this._filterText=e,this._filteredOrganizations=null}},{kind:"get",key:"filteredOrganizations",value:function filteredOrganizations(){var e;this._filteredOrganizations||(this._filteredOrganizations=A()(e=this.organizations).call(e,(e=>e.filteredProjects.length>0)));return this._filteredOrganizations}},{kind:"get",key:"organizations",value:function organizations(){if(!this._organizations){var e,t,r;let i=P()(e=A()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>e!==this.account.accountId))).call(e,(e=>this._provider.getCurrentCollectionConnectedCalendarIds(e)));this._organizations=x()(r=this._githubIntegrationSrv.getGitHubOrganizations(this.account.accountId)).call(r,(e=>{var t,r;return e={id:e.id,name:e.name,avatarUrl:e.avatarUrl,projects:x()(t=A()(r=e.projects).call(r,(e=>!$()(i).call(i,e.id)))).call(t,(e=>{var t;e=_objectSpread({},e);let r=M()(t=this.calendars).call(t,(t=>t.id===e.id));return F()(e,"isConnected",{get:()=>r.isConnected,set:e=>r.isConnected=e}),e})),toggleAllProjectsConnected:()=>{var t;let r=e.isAllProjectsConnected;O()(t=e.filteredProjects).call(t,(e=>e.isConnected=!r))}},F()(e,"filteredProjects",{get:()=>{var t;return this.filterText?A()(t=e.projects).call(t,(e=>{var t;return $()(t=e.name.toLowerCase()).call(t,this.filterText.toLowerCase())})):e.projects}}),F()(e,"isAllProjectsConnected",{get:()=>{var t;let r=A()(t=e.filteredProjects).call(t,(e=>e.isConnected));return 0!==r.length&&r.length===e.filteredProjects.length}}),F()(e,"isSomeProjectsConnected",{get:()=>{var t;let r=A()(t=e.filteredProjects).call(t,(e=>e.isConnected));return 0!==r.length&&r.length!==e.filteredProjects.length}}),e}))}return this._organizations}},{kind:"get",key:"calendars",value:function calendars(){if(!this._projects){var e,t,r,n;let a=P()(e=A()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>e!==this.account.accountId))).call(e,(e=>this._provider.getCurrentCollectionConnectedCalendarIds(e)));this._projects=x()(r=A()(n=this._githubIntegrationSrv.getGitHubProjects(this.account.accountId)).call(n,(e=>!$()(a).call(a,e.id)))).call(r,(e=>{e=_objectSpread({},e);let t=this._provider.getCurrentCollectionConnectedCalendar(this.account.accountId,e.id);return F()(e,"isConnected",{get:()=>t.isConnected,set:e=>{(!e||this.account.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))&&(t.isConnected=e)}}),e}))}return this._projects}},{kind:"set",key:"calendars",value:function calendars(e){this._projects=e}},{kind:"get",key:"noProjectsImgUrl",value:function noProjectsImgUrl(){return this._platformSrv.getPlatformUrl(H())}},{kind:"get",key:"notFoundImgUrl",value:function notFoundImgUrl(){return this._platformSrv.getPlatformUrl(V())}},{kind:"method",key:"createProjectAsync",value:async function createProjectAsync(e){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogOpened,{where:i.bs.AddGitHubProjectsDialog}),await this._dialogSrv.showGitHubProjectDialogAsync(e,{account:this.account})?(this._projects=null,this._organizations=null,this._filteredOrganizations=null):this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogClosed,{where:i.bs.AddGitHubProjectsDialog})}}]}}));var Z=r(27525),q=r.n(Z),Q=r(76555),Y=r.n(Q),X=r(19755),J=r.n(X),ee=r(82617),te=r(20115),re=r(45911),ie=r(47436),ne=r(20750);function CardContextMenuController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function CardContextMenuController_getDecoratorsApi(){CardContextMenuController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CardContextMenuController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardContextMenuController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardContextMenuController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardContextMenuController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardContextMenuController_createElementDescriptor(e){var t,r=CardContextMenuController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CardContextMenuController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardContextMenuController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardContextMenuController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardContextMenuController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardContextMenuController_toPropertyKey(e){var t=function CardContextMenuController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ae="complete",oe="labels",se="assignees",le="customField",ce="copyUrl",de="duplicate",ue="remove",he="delete";let pe=function CardContextMenuController_decorate(e,t,r,i){var n,a=CardContextMenuController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CardContextMenuController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CardContextMenuController_isDataDescriptor(n.descriptor)||CardContextMenuController_isDataDescriptor(i.descriptor)){if(CardContextMenuController_hasDecorators(n)||CardContextMenuController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CardContextMenuController_hasDecorators(n)){if(CardContextMenuController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CardContextMenuController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CardContextMenuController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$rootScope","$scope","$translate","appCommonSrv","calendarCardsSrv","dialogSrv","telemetrySrv","githubIntegrationSrv","planywayIntegrationSrv"])],(function(e){return{F:class CardContextMenuController{constructor(t,r,n,a,o,s,l,c,d,u){e(this),this._$element=t,this._$rootScope=r,this._$scope=n,this._$translate=a,this._appCommonSrv=o,this._calendarCardsSrv=s,this._dialogSrv=l,this._telemetrySrv=c,this._githubIntegrationSrv=d,this._planywayIntegrationSrv=u,this._$scope.$on(i.FK.OpenNestedContextMenuRequested,((e,t)=>{const{calendarCard:r,nestedMenu:n,source:a,sourceElement:o}=t;if(r.providerType!==i.lP.GitHub||this._source!==a)return;let s;switch(this._source){case i.xI.Scheduler:s=M()(o).call(o,`.k-event[data-uid="${r.uid}"]`)[0];break;case i.xI.TaskLists:let e=M()(o).call(o,`.pw-tasks-card[data-id="${r.id}"]`);if(!e[0])return;s=e[0];break;default:return}let l=new(J().Event)("contextmenu",{target:s}),c=this._getContextMenuScope(n);if(!c)return;this._cardContextMenu=c.$mdMenu,this.setCardContextMenu(this._cardContextMenu),this.cardContextMenu.open(l,r),c.$once("$pwContextMenuClosed",(()=>{let e=this._getContextMenuScope("github-context");e&&(this._cardContextMenu=e.$mdMenu,this.setCardContextMenu(this._cardContextMenu))}));const onGitHubProjectUpdated=e=>{var t,r;e.id===(null===(t=this._contextMenuLabels)||void 0===t?void 0:t.calendarCard.providerCard.projectId)&&(this._contextMenuLabels=null),e.id===(null===(r=this._contextMenuMembers)||void 0===r?void 0:r.calendarCard.providerCard.projectId)&&(this._contextMenuMembers=null)};this._githubIntegrationSrv.addGitHubProjectEventListener("updated",onGitHubProjectUpdated),this._$scope.$on("$destroy",(()=>{this._githubIntegrationSrv.removeGitHubProjectEventListener("updated",onGitHubProjectUpdated)}))}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubCardContextMenuCtrl"}},{kind:"field",key:"_source",value:void 0},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"set",key:"onSetContextMenu",value:function onSetContextMenu(e){this._onSetContextMenu=e}},{kind:"get",key:"cardContextMenu",value:function cardContextMenu(){return this._cardContextMenu}},{kind:"method",key:"setCardContextMenu",value:function setCardContextMenu(e){this._cardContextMenu=e,this._onSetContextMenu({providerType:i.lP.GitHub,menuController:this._cardContextMenu})}},{kind:"method",key:"isContextMenuItemAvailable",value:function isContextMenuItemAvailable(){if(!this.cardContextMenu)return!1;let e=this.cardContextMenu.pwData;if(!e)return!1;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return q()(r).call(r,(t=>{if(!(e.isTempCard||e.providerCard.capabilities.has(t)))return!1;switch(t){case ae:return!e.isReadOnly&&!e.providerCard.isArchived;case oe:return!e.isReadOnly&&!e.providerCard.isArchived&&this.getContextMenuLabels(e).length>0;case se:return!e.isReadOnly&&!e.providerCard.isArchived&&this.getContextMenuMembers(e).length>0;case le:return!e.isReadOnly&&!e.providerCard.isArchived;case ce:return!e.isTempCard;case de:return!e.isReadOnly&&!e.providerCard.isArchived&&!e.isTempCard;case ue:return!e.isReadOnly&&!e.providerCard.isArchived&&e.hasDates;case he:return!e.isReadOnly&&!e.isTempCard}return!0}))}},{kind:"method",key:"toggleCardIsCompleted",value:function toggleCardIsCompleted(e){this._provider.toggleCardsIsCompletedAsync([e],{applyRecurringActionToHead:this._cardContextMenu.applyRecurringActionToHead,telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"getContextMenuLabels",value:function getContextMenuLabels(e){if(!e)return[];if(!this._contextMenuLabels||this._contextMenuLabels.calendarCard!==e){this._contextMenuLabels={calendarCard:e};let i=this._githubIntegrationSrv.getGitHubRepositoryById(e.accountId,e.providerCard.repositoryId);var t,r;if(i)this._contextMenuLabels.cardLabels=Y()(t=A()(r=i.labels).call(r,(e=>e.id!==te.$d))).call(t,ne.Ny);else this._contextMenuLabels.cardLabels=[]}return this._contextMenuLabels.cardLabels}},{kind:"method",key:"isContextMenuLabelSelected",value:function isContextMenuLabelSelected(e,t){return null==e?void 0:e.providerCard.labelIds.has(t.id)}},{kind:"method",key:"toggleCardLabel",value:function toggleCardLabel(e,t){this._provider.toggleCardsLabelAsync([e],t.id,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"get",key:"isMultipleMembersSupported",value:function isMultipleMembersSupported(){return!!this.cardContextMenu&&(!!this.cardContextMenu.pwData&&(0,re.xZ)(this.cardContextMenu.pwData))}},{kind:"method",key:"getContextMenuMembers",value:function getContextMenuMembers(e){if(!e||e.providerType!==i.lP.GitHub)return[];if(!this._contextMenuMembers||this._contextMenuMembers.calendarCard!==e){this._contextMenuMembers={calendarCard:e};let i=this._githubIntegrationSrv.getGitHubRepositoryById(e.accountId,e.providerCard.repositoryId);if(i){var t,r;let n=this._planywayIntegrationSrv.getConnectedAccountById(e.accountId).githubUserId,a=this._githubIntegrationSrv.getGitHubMemberById(e.accountId,n);this._contextMenuMembers.cardMembers=Y()(t=A()(r=i.members).call(r,(e=>e.id!==te.$d))).call(t,((e,t)=>(0,ne.mF)(e,t,a)))}else this._contextMenuMembers.cardMembers=[]}return this._contextMenuMembers.cardMembers}},{kind:"method",key:"isContextMenuMemberSelected",value:function isContextMenuMemberSelected(e,t){return null==e?void 0:e.providerCard.memberIds.has(t.id)}},{kind:"get",key:"memberFilter",value:function memberFilter(){return this._memberFilter}},{kind:"set",key:"memberFilter",value:function memberFilter(e){this._memberFilter=e,e&&(this._memberFilterRegex=(0,U.n0)(e))}},{kind:"method",key:"filterMembersByFullName",value:function filterMembersByFullName(){return e=>!this.memberFilter||this._memberFilterRegex.test(e.fullName)}},{kind:"method",key:"toggleCardMember",value:function toggleCardMember(e,t){this._provider.toggleCardsMemberAsync([e],t.id,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"get",key:"contextMenuCustomFields",value:function contextMenuCustomFields(){if(!this._contextMenuCustomFields){var e;let t=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{let t=this._provider.getCurrentCollectionSelectedCalendarIds(e);return x()(t).call(t,(t=>this._githubIntegrationSrv.getGitHubProjectById(e,t)))}));this._contextMenuCustomFields=P()(t).call(t,(e=>{var t,r;return x()(t=A()(r=e.customFields).call(r,(e=>e.type===ie.p9.List))).call(t,(e=>function CardContextMenuController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=CardContextMenuController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=CardContextMenuController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}({icon:"icons-16:format-list-checks"},e)))}))}return this._contextMenuCustomFields}},{kind:"method",key:"isCustomFieldOptionSelected",value:function isCustomFieldOptionSelected(e,t,r){let i=this._calendarCardsSrv.getCalendarCardCustomFieldValues(e)||{};return!!i[t]&&(!r||i[t]===r)}},{kind:"method",key:"isContextMenuCustomFieldAvailable",value:function isContextMenuCustomFieldAvailable(e,t){var r;if(!e||e.providerType!==i.lP.GitHub)return!1;let n=this._githubIntegrationSrv.getGitHubProjectById(e.accountId,e.providerCard.projectId);return q()(r=n.customFields).call(r,(e=>e.id===t))}},{kind:"method",key:"toggleCardCustomFieldOption",value:function toggleCardCustomFieldOption(e,t,r){let i=this._calendarCardsSrv.getCalendarCardCustomFieldValues(e)||{};i[t]&&i[t]===r&&(r=null),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(e,{customFields:{[t]:r}})}},{kind:"method",key:"copyCardUrl",value:function copyCardUrl(e){this._provider.copyCardUrlAsync(e,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"duplicateCard",value:function duplicateCard(e){this._provider.duplicateCardsAsync([e],{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"removeCard",value:function removeCard(e){this._provider.removeCardDatesAsync([e],{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"deleteCard",value:function deleteCard(e){this._provider.deleteCardsAsync([e],{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"_getContextMenuScope",value:function _getContextMenuScope(e){var t;let r=M()(t=this._$element).call(t,`md-menu[data-menu='${e}']`);if(0!==r.length)return r.scope()}}]}}));var ve=r(10349),me=r.n(ve),fe=r(8244),Ce=r.n(fe),ye=r(54847),ge=r.n(ye),_e=r(23513),ke=r.n(_e),we=r(84705),be=r.n(we),De=r(31082),Ee=r.n(De),Se=r(35820),Ae=r.n(Se),Ie=r(40405),Pe=r.n(Ie),Te=r(41092),xe=r(46930);function CardEditorController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function CardEditorController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=CardEditorController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=CardEditorController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function CardEditorController_getDecoratorsApi(){CardEditorController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CardEditorController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardEditorController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardEditorController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardEditorController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardEditorController_createElementDescriptor(e){var t,r=CardEditorController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CardEditorController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardEditorController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardEditorController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardEditorController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardEditorController_toPropertyKey(e){var t=function CardEditorController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Re="complete",$e="addAssignee",Le="addLabel",Me="addCustomFields",Ne="openInSource",Fe="duplicate",Ge="copyUrl",Oe="deleteCard",ze={[ee.eT.GitHubCard]:[Re,$e,Le,Me,Ne,Fe,Ge,Oe]},je={dialog:i.AH.Dialog,panel:i.AH.DialogPanel},Ue={[ie.p9.Date]:{icon:"icons-16:calendar-outline",placeholder:"BUTTONS.SET_DATE"},[ie.p9.List]:{icon:"icons-16:format-list-checks",placeholder:"DIALOGS.CHOOSE_OPTION"},[ie.p9.Number]:{icon:"icons-16:pound",placeholder:"DIALOGS.ADD_NUMBER"},[ie.p9.Text]:{icon:"icons-16:format-text",placeholder:"DIALOGS.ADD_TEXT"}},Be={Status:{icon:"icons-16:github-status-outline",placeholder:"DIALOGS.ADD_STATUS",showInCompactView:!0},Priority:{icon:"icons-16:github-priority-outline",placeholder:"DIALOGS.ADD_PRIORITY",showInCompactView:!0}};let He=function CardEditorController_decorate(e,t,r,i){var n,a=CardEditorController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CardEditorController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CardEditorController_isDataDescriptor(n.descriptor)||CardEditorController_isDataDescriptor(i.descriptor)){if(CardEditorController_hasDecorators(n)||CardEditorController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CardEditorController_hasDecorators(n)){if(CardEditorController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CardEditorController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CardEditorController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$rootScope","$scope","$sce","$log","$window","$timeout","$translate","$mdMenu","$showdownProvider","appCommonSrv","calendarCardsSrv","dialogSrv","githubIntegrationSrv","htmlHelperSrv","notificationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class CardEditorController{constructor(t,r,n,a,o,s,l,c,d,u,h,p,v,m,f,C,y,g,_,k){e(this),this._$element=t,this._$rootScope=r,this._$scope=n,this._$sce=a,this._$log=o,this._$window=s,this._$timeout=l,this._$translate=c,this._$mdMenu=d,this._appCommonSrv=h,this._calendarCardsSrv=p,this._dialogSrv=v,this._githubIntegrationSrv=m,this._htmlHelperSrv=f,this._notificationSrv=C,this._planywayIntegrationSrv=y,this._platformSrv=g,this._settingsSrv=_,this._telemetrySrv=k;const w=J()("body");let b;this._selectedProjects=null,this._isDescriptionEditing=!1,this._isNewCardValid=!0,this._$scope.$on(i.FK.GitHubProjectSelectionChanged,(()=>this._selectedProjects=null)),this._$scope.$on(i.FK.CardTypeChanged,(()=>this._providerWhitelist=null)),this._$timeout((()=>{this._renderDelayed=!0,this._$scope.$broadcast("md-resize-textarea")}),150),this._$scope.$on(i.FK.CardDialogKeyDown,((e,t)=>{let{keyboardEvent:r}=t;J()(r.target).is("input, textarea")?this._onInputKeyDown(r):this._onEditorKeyDown(r)}));const onClick=()=>{var e;b||(null===(e=this.clickRequester)||void 0===e||e.click(),this.clickRequester=null)};this._$element.on("mousedown",(e=>{b=!(!J()(e.target).is("input, textarea")&&!M()(w).call(w,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0])})),this._$element.on("click",onClick),this._$scope.$on("$mdMenuClosed",((e,t)=>{let{causedByEvent:r}=t;J()(r.target).closest(".pw-dialog-edit-card")[0]||onClick()})),this._$element.on("click",".pw-js-dialog-edit-card-description-render",(e=>{this.isBusy||this.isReadOnly||J()(e.target).closest("a")[0]||this._$window.getSelection().toString()||(this.isDescriptionEditing=!0)})),this._$element.on("focus",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!0})),this._$element.on("blur",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!1})),this._$scope.$on("$destroy",(()=>{this._removeServiceListeners(),this.isNewCard&&!this._isSaveCardCalled&&this._clearCardData(),this._keepScrollFocus()})),this._registerEditor(),this.$onInit=()=>{const updateTitle=()=>{this._logCardEvent({event:i.cN.CardEvents.TitleChanged}),this._setCardPropertiesAsync({title:this.title})};this._updateTitle=this.isNewCard?Pe()(updateTitle,300):updateTitle}}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubCardEditorCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"field",key:"calendarCard",value:void 0},{kind:"field",key:"isDetailed",value:void 0},{kind:"field",key:"isDense",value:void 0},{kind:"field",key:"hasChanges",value:void 0},{kind:"field",key:"_forceDetailedMode",value:void 0},{kind:"field",key:"_dialogOpenerContext",value:void 0},{kind:"field",key:"clickRequester",value:void 0},{kind:"get",key:"calendarAccountId",value:function calendarAccountId(){return void 0===this._calendarAccountId&&(this._calendarAccountId=this.isNewCard?null:this.calendarCard.accountId),this._calendarAccountId}},{kind:"get",key:"setCalendarHandler",value:function setCalendarHandler(){return this._setCalendarHandler||(this._setCalendarHandler=e=>{let t=this._planywayIntegrationSrv.getConnectedAccountById(e.accountId);if(t.accountType===ee.Qm.GitHub)this._moveToProjectAsync(e),this._logCardEvent({event:i.cN.CardEvents.GitHubProjectChanged,data:{accountId:e.accountId,calendarId:e.id}});else{let r=(0,z.fL)(t.accountType);if(!r)return;this._logCardEvent({event:i.cN.CardEvents.CardProviderChanged,data:{providerType:r,accountId:e.accountId,calendarId:e.id}}),this._tmpAccountId=e.accountId,this._tmpCalendarId=e.id,this.calendarCard.providerType=r}}),this._setCalendarHandler}},{kind:"get",key:"providerWhitelist",value:function providerWhitelist(){return this._providerWhitelist||this.isNewCard||(this._providerWhitelist=[i.lP.GitHub]),this._providerWhitelist}},{kind:"method",key:"isCardButtonVisible",value:function isCardButtonVisible(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q()(t).call(t,(e=>{var t;if(!(null===(t=ze[this.calendarCard.cardType])||void 0===t?void 0:$()(t).call(t,e)))return!1;switch(e){case Ne:return!this.isNewCard&&this.cardUrl;case Fe:case Ge:return!this.isNewCard;case Oe:return!this.isReadOnly;default:return!0}}))}},{kind:"method",key:"isCardFieldEditAvailable",value:function isCardFieldEditAvailable(e){if(this.isBusy||!this._cardRepository)return!1;if(this.calendarCard.isReadOnly)return!1;return(this.calendarCard.isTempCard?ie.X8[this.cardRepository.viewerPermission]:this.calendarCard.providerCard.capabilities).has(e)}},{kind:"method",key:"cancelDialog",value:function cancelDialog(){this.hideDialog(i.Xs.Cancelled)}},{kind:"get",key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this.isCompleted!==e&&(this._isCompleted=e,this._logCardEvent({event:e?i.cN.CardEvents.MarkedCompleted:i.cN.CardEvents.MarkedIncompleted,data:{by:i.AH.Dialog}}),this._setCardPropertiesAsync({isCompleted:e}))}},{kind:"get",key:"cardNumber",value:function cardNumber(){if(this._collectionSettings.global.settings.showCardNumber)return this.calendarCard.providerCard.cardNumber}},{kind:"get",key:"titlePlaceholder",value:function titlePlaceholder(){return this._$translate.instant("MISC.ADD_ISSUE_TITLE")}},{kind:"get",key:"title",value:function title(){return this._title}},{kind:"set",key:"title",value:function title(e){(e||this.isNewCard)&&this.title!==e&&(this._title=e,this._updateTitle())}},{kind:"get",key:"hasDates",value:function hasDates(){return this.calendarCard.hasDates}},{kind:"get",key:"isSingleDate",value:function isSingleDate(){return this.calendarCard.isSingleDate}},{kind:"get",key:"isCardDatesYearShown",value:function isCardDatesYearShown(){return!(0,U.FT)(this.startDate,new Date)||!(0,U.FT)(this.endDate,new Date)}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this.isAllDay!==e&&(this._isAllDay=e,this.isAllDay?(this._startDate=(0,U.$Y)(this.startDate),this._endDate=this.endDate):(this._startDate=(0,U.nT)(this.startDate),this._endDate=(0,U.mH)((0,U.nT)(this.endDate),xe.XM)),this._logCardEvent({event:e?i.cN.CardEvents.IsAllDaySet:i.cN.CardEvents.IsAllDayUnset}),this._setCardPropertiesAsync({isAllDay:e,start:this.startDate,end:this.endDate}))}},{kind:"get",key:"startDate",value:function startDate(){return this._startDate}},{kind:"set",key:"startDate",value:function startDate(e){if(e&&!(0,U.rs)(this.startDate,e))if(this.hasDates){if(this.isAllDay){let t=(0,U.i2)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,U.E4)(this.startDate,t)}else{let t=(0,U.CX)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,U.mH)(this.startDate,t)}this._logCardEvent({event:i.cN.CardEvents.StartChanged}),this._setCardPropertiesAsync({start:e,end:this.endDate})}else this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:i.cN.CardEvents.Scheduled,data:{by:i.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})}},{kind:"get",key:"endDate",value:function endDate(){return this._endDate}},{kind:"set",key:"endDate",value:function endDate(e){e&&!(0,U.rs)(this.endDate,e)&&(this.hasDates?(this._endDate=e,this._logCardEvent({event:i.cN.CardEvents.EndChanged}),this._setCardPropertiesAsync({end:e})):(this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:i.cN.CardEvents.Scheduled,data:{by:i.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})))}},{kind:"get",key:"minEndDate",value:function minEndDate(){return this.startDate}},{kind:"get",key:"priority",value:function priority(){return this._priority}},{kind:"set",key:"priority",value:function priority(e){if(this.priority!==e){if(this._priority=e,this._isProviderTypeChanging)return;this._setCardPropertiesAsync({priority:this._priority.value})}}},{kind:"get",key:"availablePriorities",value:function availablePriorities(){return this._availablePriorities||(this._availablePriorities=[{label:this._$translate.instant("MENU.PRIORITY_HIGH"),value:3},{label:this._$translate.instant("MENU.PRIORITY_MEDIUM"),value:2},{label:this._$translate.instant("MENU.PRIORITY_LOW"),value:1},{label:this._$translate.instant("MENU.PRIORITY_UNSET"),value:0}]),this._availablePriorities}},{kind:"method",key:"setPriority",value:function setPriority(e,t){t&&(this.priority=t,this._logCardEvent({event:i.cN.CardEvents.PriorityChanged,data:{by:je[e],priority:this.priority.value}}))}},{kind:"get",key:"selectedProjects",value:function selectedProjects(){var e;null===this._selectedProjects&&(this._selectedProjects=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return x()(t=this._provider.getCurrentCollectionSelectedCalendarIds(e)).call(t,(t=>this._githubIntegrationSrv.getGitHubProjectById(e,t)))})));return this._selectedProjects}},{kind:"get",key:"cardProject",value:function cardProject(){return this._cardProject}},{kind:"method",key:"setCardProject",value:function setCardProject(e,t){e&&t&&(this._cardProject=this._githubIntegrationSrv.getGitHubProjectById(e,t),this._cardRepositoryLabels=null,this._cardRepositoryMembers=null,this._availableRepositories=null,this._cardCustomFields=null)}},{kind:"get",key:"cardRepository",value:function cardRepository(){if(!this._cardRepository){const t=this.calendarCard.providerCard.repositoryId;if(t)this._cardRepository=this._githubIntegrationSrv.getGitHubRepositoryById(this.calendarCard.accountId,t);else{var e;if(this.calendarCard.providerCard.memberIds.has(te.$d))return void(this._cardRepository=this.availableRepositories[0]);const t=me()(this.calendarCard.providerCard.memberIds),r=M()(e=this.availableRepositories).call(e,(e=>Ce()(t).call(t,(t=>{var r;return q()(r=e.members).call(r,(e=>e.id===t))}))));this._cardRepository=r||null,this._cardRepository&&this._setCardPropertiesAsync({repositoryId:this._cardRepository.id})}}return this._cardRepository}},{kind:"get",key:"availableRepositories",value:function availableRepositories(){return this.cardProject?(this._availableRepositories||(this._availableRepositories=this._githubIntegrationSrv.getGitHubProjectRepositories(this.cardProject.accountId,this.cardProject.id,!0),this._cardRepository=null),this._availableRepositories):[]}},{kind:"method",key:"setCardRepository",value:function setCardRepository(e){if(e.id&&(!this._cardRepository||this._cardRepository.id!==e.id)){var t,r,n;this._cardRepository&&this._logCardEvent({event:i.cN.CardEvents.RepositoryChanged}),this._cardRepository=null;let s=new(ge())(x()(t=A()(r=this.cardMembers).call(r,(t=>{var r;return M()(r=e.members).call(r,(e=>e.id===t.id))}))).call(t,(e=>[e.id,e])));if(s.size!==this._cardMembers.length){var a,o;const t=new(ke())(A()(a=me()(this.calendarCard.providerCard.memberIds)).call(a,(e=>s.has(e))));return void this._setCardPropertiesAsync({memberIds:t,projectId:null===(o=this._cardProject)||void 0===o?void 0:o.id,repositoryId:e.id})}this._setCardPropertiesAsync({projectId:null===(n=this._cardProject)||void 0===n?void 0:n.id,repositoryId:e.id})}}},{kind:"get",key:"isLabelsAvailable",value:function isLabelsAvailable(){return this.cardRepository}},{kind:"get",key:"cardLabels",value:function cardLabels(){if(this.delayRender||this._isProviderTypeChanging)return[];if(!this.cardProject)return[];var e,t,r;this._cardLabels||(this._cardLabels=Y()(e=A()(t=x()(r=me()(this.calendarCard.providerCard.labelIds)).call(r,(e=>this._githubIntegrationSrv.getGitHubLabelById(this.calendarCard.accountId,e)))).call(t,(e=>e&&this.calendarCard.providerCard.repositoryId===e.repositoryId))).call(e,ne.Ny));return this._cardLabels}},{kind:"get",key:"cardRepositoryLabels",value:function cardRepositoryLabels(){if(this.delayRender)return[];if(!this.cardRepository)return[];var e,t,r;this._cardRepositoryLabels||(this._cardRepositoryLabels=x()(e=Y()(t=A()(r=this.cardRepository.labels).call(r,(e=>e.id!==te.$d))).call(t,ne.Ny)).call(e,(e=>CardEditorController_objectSpread(CardEditorController_objectSpread({},e),{},{name:e.name,isSelected:this.calendarCard.providerCard.labelIds.has(e.id)}))),this._cardLabels=null);return this._cardRepositoryLabels}},{kind:"method",key:"toggleLabel",value:function toggleLabel(e,t){this._cardRepositoryLabels=null;let r=!this.calendarCard.providerCard.labelIds.has(t.id);this._logCardEvent({event:r?i.cN.CardEvents.LabelAdded:i.cN.CardEvents.LabelRemoved,data:{by:je[e]}}),this._setCardPropertiesAsync({labelIds:(0,re.iG)(this.calendarCard,t.id)})}},{kind:"method",key:"showEditLabelsDialog",value:function showEditLabelsDialog(e){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.LabelEditDialogOpened,{where:this._dialogOpenerContext.telemetryWhere,by:je[e]}),this._dialogSrv.showEditLabelsDialogAsync({accountId:this.calendarCard.accountId,repositoryId:this.calendarCard.providerCard.repositoryId})}},{kind:"get",key:"isMembersAvailable",value:function isMembersAvailable(){return!this._isProviderTypeChanging&&!!this.cardRepository}},{kind:"get",key:"isMultipleMembersSupported",value:function isMultipleMembersSupported(){return(0,re.xZ)(this.calendarCard)}},{kind:"get",key:"isMemberRequired",value:function isMemberRequired(){return(0,re.Ms)(this.calendarCard)}},{kind:"get",key:"cardMembers",value:function cardMembers(){if(this.delayRender)return[];if(!this.cardProject)return[];if(!this._cardMembers){var e,t,r;let i=this._githubIntegrationSrv.getGitHubMemberById(this.calendarCard.accountId,this._currentMemberId);this._cardMembers=Y()(e=A()(t=x()(r=me()(this.calendarCard.providerCard.memberIds)).call(r,(e=>this._githubIntegrationSrv.getGitHubMemberById(this.calendarCard.accountId,e)))).call(t,(e=>e))).call(e,((e,t)=>(0,ne.mF)(e,t,i)))}return this._cardMembers}},{kind:"get",key:"cardRepositoryMembers",value:function cardRepositoryMembers(){if(this.delayRender||this._isProviderTypeChanging)return[];if(!this.cardRepository)return[];if(!this._cardRepositoryMembers){var e,t;let r=this._githubIntegrationSrv.getGitHubMemberById(this.calendarCard.accountId,this._currentMemberId);this._cardRepositoryMembers=x()(e=Y()(t=this.cardRepository.members).call(t,((e,t)=>(0,ne.mF)(e,t,r)))).call(e,(e=>CardEditorController_objectSpread(CardEditorController_objectSpread({},e),{},{isSelected:this.calendarCard.providerCard.memberIds.has(e.id)}))),this._cardMembers=null}return this._cardRepositoryMembers}},{kind:"get",key:"memberFilter",value:function memberFilter(){return this._memberFilter}},{kind:"set",key:"memberFilter",value:function memberFilter(e){this._memberFilter=e,e&&(this._memberFilterRegex=(0,U.n0)(e))}},{kind:"method",key:"filterMembersByFullName",value:function filterMembersByFullName(){return e=>!this.memberFilter||this._memberFilterRegex.test(e.fullName)}},{kind:"method",key:"toggleMember",value:function toggleMember(e,t){this._cardRepositoryMembers=null;let r=!this.calendarCard.providerCard.memberIds.has(t.id),n=t.id===this._currentMemberId,a=(0,re.Pv)(this.calendarCard,t.id);this._logCardEvent({event:r?n?i.cN.CardEvents.MemberAssignedSelf:i.cN.CardEvents.MemberAssigned:n?i.cN.CardEvents.MemberUnassignedSelf:i.cN.CardEvents.MemberUnassigned,data:{by:je[e],memberIds:a}}),this._setCardPropertiesAsync({memberIds:a})}},{kind:"get",key:"isDescriptionAvailable",value:function isDescriptionAvailable(){return!this.isReadOnly||this.description}},{kind:"get",key:"isDescriptionEditing",value:function isDescriptionEditing(){return this._isDescriptionEditing}},{kind:"set",key:"isDescriptionEditing",value:function isDescriptionEditing(e){this.isDescriptionEditing!==e&&(this._$scope.$evalAsync((()=>this._isDescriptionEditing=e)),e&&this._$timeout((()=>{J()(".pw-js-dialog-edit-card-description-input").trigger("focus"),this._$scope.$broadcast(i.FK.AutosizeControlsResizeRequested)}),0,!1))}},{kind:"get",key:"description",value:function description(){return this._description}},{kind:"set",key:"description",value:function description(e){this.description!==e&&(this._description=null==e?void 0:be()(e).call(e),this._logCardEvent({event:i.cN.CardEvents.DescriptionChanged}),this._setCardPropertiesAsync({description:this.description}))}},{kind:"get",key:"isCustomFieldsAvailable",value:function isCustomFieldsAvailable(){return this.cardProject&&this.cardCustomFields.length>0}},{kind:"get",key:"cardCustomFields",value:function cardCustomFields(){if(this.delayRender)return[];if(!this.cardProject)return[];if(!this._cardCustomFields){var e,t;this._dirtyCardCustomFieldValues||(this._dirtyCardCustomFieldValues=new(ge()));const r=this._calendarCardsSrv.getCalendarCardCustomFieldValues(this.calendarCard)||{};let n=new(ke())(Ee()(ie.p9));this._cardCustomFields=x()(e=A()(t=this.cardProject.customFields).call(t,(e=>n.has(e.type)))).call(e,(e=>{var t;let n=Be[e.name]||Ue[e.type],a={id:e.id,type:e.type,name:e.name,icon:n.icon,placeholder:this._$translate.instant(n.placeholder),showInCompactView:n.showInCompactView||!1,options:null===(t=e.options)||void 0===t?void 0:x()(t).call(t,(e=>({id:e.id,name:e.name})))};return F()(a,"value",{get:()=>{var e;let t=this._dirtyCardCustomFieldValues.has(a.id)?this._dirtyCardCustomFieldValues.get(a.id):r[a.id];return a.type===ie.p9.List?M()(e=a.options).call(e,(e=>e.id===t)):null!=t?t:""},set:async e=>{var t;switch(a.type){case ie.p9.Date:"now"===e&&(e=new Date);break;case ie.p9.List:e=(null===(t=e)||void 0===t?void 0:t.id)||null}if(r[a.id]!==e){r[a.id]=e;try{let t=this._provider.getProjectStatusField(this.cardProject);this._logCardEvent({event:t&&t.id===a.id?i.cN.CardEvents.StatusChanged:i.cN.CardEvents.CustomFieldChanged}),this._dirtyCardCustomFieldValues.set(a.id,e),await this._setCardPropertiesAsync({customFields:{[a.id]:e}})}finally{this._dirtyCardCustomFieldValues.delete(a.id)}}}}),a}))}return this._cardCustomFields}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this.calendarCard.cardUrl}},{kind:"get",key:"cardUrlTarget",value:function cardUrlTarget(){0}},{kind:"method",key:"openCardInSource",value:function openCardInSource(e){this._logCardEvent({event:i.cN.CardEvents.CardOpenClicked,data:{by:i.AH.DialogPanel}}),e.which===i.Jm.Left&&this.hideDialog()}},{kind:"method",key:"switchDetailedModeAsync",value:async function switchDetailedModeAsync(){await new(Ae())((e=>this._$scope.$emit(i.FK.CardDialogSwitchDetailedModeRequested,{resolve:e}))),this.isDetailed,this._logCardEvent({event:i.cN.CardEvents.EditDialogModeChanged,data:{by:i.AH.Dialog,isDetailed:!this.isDetailed}})}},{kind:"method",key:"hideDialog",value:function hideDialog(e){this._$scope.$emit(i.FK.CardDialogHideRequested,{dialogResult:e})}},{kind:"method",key:"initialize",value:function initialize(){var e;if(this.calendarCard.cardType!==ee.eT.GitHubCard){const e=this._tmpAccountId||this.calendarCard.accountId;this._calendarCardsSrv.changeCalendarCardType(this.calendarCard,ee.eT.GitHubCard,e);const{title:t,isAllDay:r,start:i,end:n}=this.calendarCard;this.calendarCard.providerCard=this._provider.getCalendarCardClass().fromSourceCard(this.calendarCard.id,e,ee.eT.GitHubCard),this._tmpCalendarId&&(this.calendarCard.providerCard.projectId=this._tmpCalendarId),this.calendarCard.title=t,this.calendarCard.isAllDay=r,this.calendarCard.start=i,this.calendarCard.end=n,this._tmpAccountId=null,this._tmpCalendarId=null}this.setCardProject(this.calendarCard.accountId,this.calendarCard.providerCard.projectId),this._isCompleted=this.calendarCard.providerCard.isCompleted,this._title=this.calendarCard.title,this._isAllDay=this.calendarCard.isAllDay,this._startDate=this.calendarCard.start,this._endDate=this.calendarCard.end,this._description=null===(e=this.calendarCard.description)||void 0===e?void 0:be()(e).call(e),this._addServiceListeners(),this.isDetailed}},{kind:"get",key:"isBusy",value:function isBusy(){return this._isBusy}},{kind:"set",key:"isBusy",value:function isBusy(e){this._$scope.$evalAsync((()=>this._isBusy=e))}},{kind:"get",key:"isNewCard",value:function isNewCard(){return this.calendarCard.isTempCard}},{kind:"get",key:"isNewCardValid",value:function isNewCardValid(){return this._isNewCardValid}},{kind:"get",key:"isCardReadOnly",value:function isCardReadOnly(){var e;return!!this.calendarCard.isReadOnly||this.calendarCard.providerCard.projectId&&!q()(e=this.selectedProjects).call(e,(e=>e.id===this.calendarCard.providerCard.projectId))}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return this.isCardReadOnly}},{kind:"get",key:"isToggleDatesDisabled",value:function isToggleDatesDisabled(){return this._isToggleDatesDisabled}},{kind:"set",key:"isToggleDatesDisabled",value:function isToggleDatesDisabled(e){this._$scope.$evalAsync((()=>this._isToggleDatesDisabled=e))}},{kind:"method",key:"copyCardUrlAsync",value:function copyCardUrlAsync(){return this._provider.copyCardUrlAsync(this.calendarCard,{telemetry:{by:i.AH.DialogPanel}})}},{kind:"method",key:"duplicateCardAsync",value:function duplicateCardAsync(){return this._duplicateCardAsync({event:i.cN.CardEvents.Duplicated,data:{by:i.AH.DialogPanel}})}},{kind:"method",key:"removeDatesAsync",value:function removeDatesAsync(){return this._removeCardDatesAsync({event:i.cN.CardEvents.DatesRemoved,data:{by:i.AH.DialogPanel}})}},{kind:"method",key:"deleteCardAsync",value:function deleteCardAsync(){return this._deleteCardAsync({event:i.cN.CardEvents.Deleted,data:{by:i.AH.DialogPanel}})}},{kind:"get",key:"cardTooltipOptions",value:function cardTooltipOptions(){return this._cardTooltipOptions||(this._cardTooltipOptions={getCardForTooltip:(e,t,r)=>this._calendarCardsSrv.getCalendarCardById(e,r,t)}),this._cardTooltipOptions}},{kind:"get",key:"delayRender",value:function delayRender(){return!this._renderDelayed}},{kind:"get",key:"showWeekNumbers",value:function showWeekNumbers(){return this._collectionSettings.global.settings.showWeekNumbers}},{kind:"get",key:"isMacOS",value:function isMacOS(){return this._platformSrv.isMacOS()}},{kind:"method",key:"saveCalendarCardAsync",value:async function saveCalendarCardAsync(){if(!this._isSaveCardCalled){if(this._isSaveCardCalled=!0,this.title&&this.isNewCard&&this._setCardPropertiesAsync({title:this.title}),!this.isNewCard)return this._isSaveCardCalled=!1,void this.hideDialog(i.Xs.CardEdited);try{if(this._isNewCardValid=!0,!this.isNewCardValid)return;this._appCommonSrv.setSchedulerBusy(!0),this._updateCardPromise&&await this._updateCardPromise,this._hasChanges=!1,this.hideDialog(i.Xs.CardCreated),this._collectionSettings.local.settings.lastUsedCalendarData={accountType:ee.Qm.GitHub,accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId},this._collectionSettings.local.save();let e=await this._calendarCardsSrv.createCalendarCardAsync(this.calendarCard);this._$rootScope.$broadcast(i.FK.CardCreated,{calendarCard:e})}catch(e){this._$log.error("Planyway card creating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant(this._createCardMessagesByCardType[this.calendarCard.cardType].error),i.k$.Error),this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}finally{this._appCommonSrv.setSchedulerBusy(!1),this._isSaveCardCalled=!1}}}},{kind:"method",key:"confirmCloseAsync",value:async function confirmCloseAsync(){if(this.isNewCard){if(!this.cardRepository&&!this._isDeleting)return this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.NO_CARD_REPOSITORY_TITLE"),this._$translate.instant("DIALOGS.NO_CARD_REPOSITORY_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]});if(this._isSaveCardCalled)return!0;if(!this.hasChanges&&this._forceDetailedMode)return!0;if(!this._isDeleting)return await this.saveCalendarCardAsync(),!1}return!0}},{kind:"get",key:"_parentDialogController",value:function _parentDialogController(){return this._parentDialogControllerInternal||(this._parentDialogControllerInternal=(0,U.sO)(this._$scope,Te.Z)),this._parentDialogControllerInternal}},{kind:"method",key:"_registerEditor",value:function _registerEditor(){var e;null===(e=this._parentDialogController)||void 0===e||e.registerCardEditorControllerAsync(this)}},{kind:"get",key:"_tmpAccountId",value:function _tmpAccountId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpAccountId}},{kind:"set",key:"_tmpAccountId",value:function _tmpAccountId(e){this._parentDialogController&&(this._parentDialogController._tmpAccountId=e)}},{kind:"get",key:"_tmpCalendarId",value:function _tmpCalendarId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpCalendarId}},{kind:"set",key:"_tmpCalendarId",value:function _tmpCalendarId(e){this._parentDialogController&&(this._parentDialogController._tmpCalendarId=e)}},{kind:"get",key:"_isProviderTypeChanging",value:function _isProviderTypeChanging(){return this._tmpAccountId||this._tmpCalendarId}},{kind:"method",key:"_onInputKeyDown",value:function _onInputKeyDown(e){e.stopPropagation()}},{kind:"method",key:"_onEditorKeyDown",value:function _onEditorKeyDown(e){var t;let r=e.which;i.gD.has(r)&&(r===i.VD.C&&(e.ctrlKey||e.metaKey)||(e.preventDefault(),e.stopPropagation(),(null===(t=j.V[this.calendarCard.cardType])||void 0===t?void 0:$()(t).call(t,r))&&!this.isCardReadOnly&&this._updateCardByHotkey(e.keyCode,{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey})))}},{kind:"method",key:"_updateCardByHotkey",value:function _updateCardByHotkey(e,t){switch(e){case i.VD.D:if(this.isNewCard)break;(t.ctrlKey||t.metaKey)&&this._duplicateCardAsync({event:i.cN.CardEvents.Duplicated,data:{by:i.AH.DialogHotkey}});break;case i.VD.E:this._isCompleted=!this.isCompleted,this._logCardEvent({event:this.isCompleted?i.cN.CardEvents.MarkedCompleted:i.cN.CardEvents.MarkedIncompleted,data:{by:i.AH.DialogHotkey}}),this._setCardPropertiesAsync({isCompleted:this.isCompleted}),this._$rootScope.$broadcast(i.FK.ProductTourStepPassed,{productTourStep:i._H.MarkComplete});break;case i.VD.L:if(!this.isLabelsAvailable)break;J()(".pw-js-dialog-edit-card-labels-menu-btn").trigger("click");break;case i.VD.M:if(!this.isMembersAvailable)break;J()(".pw-js-dialog-edit-card-members-menu-btn").trigger("click");break;case i.VD.Space:if(!this.isMembersAvailable)break;this._cardRepositoryMembers=null;let e=!this.calendarCard.providerCard.memberIds.has(this._currentMemberId),r=(0,re.Pv)(this.calendarCard,this._currentMemberId);this._logCardEvent({event:e?i.cN.CardEvents.MemberAssignedSelf:i.cN.CardEvents.MemberUnassignedSelf,data:{memberIds:r,by:i.AH.DialogHotkey}}),this._setCardPropertiesAsync({memberIds:r});break;case i.VD.Delete:case i.VD.Backspace:if(t.shiftKey||t.metaKey){if(this.isNewCard)break;this._deleteCardAsync({event:i.cN.CardEvents.Deleted,data:{by:i.AH.DialogHotkey}})}else this._removeCardDatesAsync({event:i.cN.CardEvents.DatesRemoved,data:{by:i.AH.DialogHotkey}})}}},{kind:"get",key:"_currentMemberId",value:function _currentMemberId(){return this._planywayIntegrationSrv.getConnectedAccountById(this.calendarCard.accountId).githubUserId}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"set",key:"_hasChanges",value:function _hasChanges(e){this._$scope.$emit(i.FK.CardDialogSetHasChangesRequested,{hasChanges:e})}},{kind:"get",key:"_createCardMessagesByCardType",value:function _createCardMessagesByCardType(){return this._createCardMessagesByCardTypeLazy||(this._createCardMessagesByCardTypeLazy={[ee.eT.GitHubCard]:{error:"NOTIFICATIONS.CREATE_GITHUB_ISSUE_ERROR"}}),this._createCardMessagesByCardTypeLazy}},{kind:"method",key:"_addServiceListeners",value:function _addServiceListeners(){this._serviceEventsListenersAdded||(this._serviceEventsListenersAdded=!0,this._onAddOrUpdateCard=(e,t)=>{e.id===this.calendarCard.id&&this._addOrUpdateCard(e,t)},this._onDeleteCard=(e,t)=>{e.id===this.calendarCard.id&&(t.replacedWith?this._addOrUpdateCard(t.replacedWith,t):this._deleteCard())},this._calendarCardsSrv.addCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("deleted",this._onDeleteCard),this._onGitHubProjectChanged=e=>{this._selectedProjects=null,this._organizations=null,e.accountId===this.calendarCard.accountId&&e.id===this.calendarCard.providerCard.projectId&&this.setCardProject(e.accountId,e.id)},this._githubIntegrationSrv.addGitHubProjectEventListener("added",this._onGitHubProjectChanged),this._githubIntegrationSrv.addGitHubProjectEventListener("updated",this._onGitHubProjectChanged),this._githubIntegrationSrv.addGitHubProjectEventListener("deleted",this._onGitHubProjectChanged))}},{kind:"method",key:"_removeServiceListeners",value:function _removeServiceListeners(){this._serviceEventsListenersAdded&&(this._serviceEventsListenersAdded=!1,this._calendarCardsSrv.removeCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("deleted",this._onDeleteCard),this._githubIntegrationSrv.removeGitHubProjectEventListener("added",this._onGitHubProjectChanged),this._githubIntegrationSrv.removeGitHubProjectEventListener("updated",this._onGitHubProjectChanged),this._githubIntegrationSrv.removeGitHubProjectEventListener("deleted",this._onGitHubProjectChanged))}},{kind:"method",key:"_addOrUpdateCard",value:function _addOrUpdateCard(e,t){this.calendarCard=e.isTempCard?e:e.clone(),this._$scope.$evalAsync((()=>{var r;(this._isCompleted=e.providerCard.isCompleted,this._isAllDay=e.isAllDay,this._startDate=e.start,this._endDate=e.end,t.hasExternalChanges)&&(this._title=e.title,this._description=null===(r=e.description)||void 0===r?void 0:be()(r).call(r));this.setCardProject(e.accountId,e.providerCard.projectId),e.isTempCard&&(this._hasChanges=!0),this._updateCardPromise&&(this._updateCardPromise.resolve(),this._updateCardPromise=null)}))}},{kind:"method",key:"_moveToProjectAsync",value:async function _moveToProjectAsync(e){if(this.calendarCard.providerCard.projectId!==e.id)try{var t;this.isBusy=!0,await this._githubIntegrationSrv.loadProjectDataAsync(e.accountId,e.id);let r=this._githubIntegrationSrv.getGitHubProjectById(e.accountId,e.id);if(!r)return;this.setCardProject(e.accountId,e.id),await this._setCardPropertiesAsync({accountId:r.accountId,projectId:r.id,repositoryId:null===(t=this.availableRepositories[0])||void 0===t?void 0:t.id})}finally{this.isBusy=!1}}},{kind:"method",key:"_deleteCard",value:function _deleteCard(){this._hasChanges=!1,this.hideDialog(i.Xs.CardDeleted)}},{kind:"method",key:"_clearCardData",value:function _clearCardData(e){e&&e===ee.eT.GitHubCard||(this.calendarCard.providerCard.labelIds=new(ke()),this._cardLabels=null,this.calendarCard.providerCard.memberIds=new(ke()),this._cardMembers=null,this.calendarCard.providerCard.isCompleted=!1),e||(this.calendarCard.providerCard.projectId=null,this.calendarCard.providerCard.repositoryId=null)}},{kind:"method",key:"_setCardPropertiesAsync",value:async function _setCardPropertiesAsync(e){this._$timeout((()=>this._keepScrollFocus()),0,!1),this._hasChanges=!0;try{if(this.isNewCard){this._updateCardPromise&&await this._updateCardPromise;let e=null;this._updateCardPromise=new(Ae())((t=>e=t)),this._updateCardPromise.resolve=e}await this._calendarCardsSrv.updateCalendarCardPropertiesAsync(this.calendarCard,e)}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),i.k$.Error)}}},{kind:"method",key:"_duplicateCardAsync",value:async function _duplicateCardAsync(e){this._logCardEvent(e);try{this.isBusy=!0,this._appCommonSrv.setSchedulerBusy(!0);let e=await this._calendarCardsSrv.createCalendarCardAsync(this.calendarCard.duplicate());this._dialogSrv.showEditCardDialogAsync(e,{openerContext:this._dialogOpenerContext,noAnimation:this.isDetailed})}catch(e){this._$log.error("Planyway duplicate card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DUPLICATE_CARD_ERROR"),i.k$.Error),this._telemetrySrv.logError("Planyway duplicate card error",e,{class:this.constructor.name,method:this._duplicateCardAsync.name})}finally{this.isBusy=!1,this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_removeCardDatesAsync",value:async function _removeCardDatesAsync(e){if(!this.hasDates||this.isToggleDatesDisabled)return;if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.REMOVE_GITHUB_ISSUE_DATES_TITLE"),this._$translate.instant("DIALOGS.REMOVE_GITHUB_ISSUE_DATES_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,isDangerous:!0,dialogResult:!0}],dontAskType:i.Ek.RemoveFromCalendar})){this._logCardEvent(e);try{this.isToggleDatesDisabled=!0,await this._calendarCardsSrv.removeCalendarCardAsync(this.calendarCard)}catch(e){this._$log.error("Planyway remove card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.REMOVE_GITHUB_ISSUE_ERROR"),i.k$.Error),this._telemetrySrv.logError("Planyway remove card error",e,{class:this.constructor.name,method:this._removeCardDatesAsync.name})}finally{this.isToggleDatesDisabled=!1}}}},{kind:"method",key:"_deleteCardAsync",value:async function _deleteCardAsync(e){let t=this.isNewCard?{title:"DIALOGS.CANCEL_CREATE_GITHUB_ISSUE_TITLE",confirm:"DIALOGS.CANCEL_CREATE_GITHUB_ISSUE_CONFIRM",error:"NOTIFICATIONS.DELETE_GITHUB_ISSUE_ERROR"}:{title:"DIALOGS.DELETE_GITHUB_ISSUE_TITLE",confirm:"DIALOGS.DELETE_GITHUB_ISSUE_CONFIRM",error:"NOTIFICATIONS.DELETE_GITHUB_ISSUE_ERROR"};if(!this.isNewCard||this.hasChanges){if(!await this._dialogSrv.showConfirmAsync(this._$translate.instant(t.title),this._$translate.instant(t.confirm),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE_CARD"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))return}this._logCardEvent(e),this._isDeleting=!0;try{this._appCommonSrv.setSchedulerBusy(!0),await this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}catch(e){this._$log.error("Planyway delete card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant(t.error),i.k$.Error),this._telemetrySrv.logError("Planyway delete card error",e,{class:this.constructor.name,method:this._deleteCardAsync.name})}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_logCardEvent",value:function _logCardEvent(e){e.data=CardEditorController_objectSpread({accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId,isAllDay:this.isAllDay,start:this.startDate,end:this.endDate,memberIds:this.calendarCard.providerCard.memberIds,isAssignedToMe:this.calendarCard.providerCard.memberIds.has(this._currentMemberId)},e.data),this._$scope.$emit(i.FK.CardDialogLogCardEventRequested,e)}},{kind:"method",key:"_keepScrollFocus",value:function _keepScrollFocus(){this._$scope.$emit(i.FK.CardDialogKeepScrollFocusRequested)}}]}}));function CardTooltipController_getDecoratorsApi(){CardTooltipController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CardTooltipController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardTooltipController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardTooltipController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardTooltipController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardTooltipController_createElementDescriptor(e){var t,r=CardTooltipController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CardTooltipController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardTooltipController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardTooltipController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardTooltipController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardTooltipController_toPropertyKey(e){var t=function CardTooltipController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Ke="labels",Ve="members",We="customFields",Ze={Status:{icon:"icons-16:github-status-outline"},Priority:{icon:"icons-16:github-priority-outline"}};let qe=function CardTooltipController_decorate(e,t,r,i){var n,a=CardTooltipController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CardTooltipController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CardTooltipController_isDataDescriptor(n.descriptor)||CardTooltipController_isDataDescriptor(i.descriptor)){if(CardTooltipController_hasDecorators(n)||CardTooltipController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CardTooltipController_hasDecorators(n)){if(CardTooltipController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CardTooltipController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CardTooltipController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["appCommonSrv","calendarCardsSrv","githubIntegrationSrv","settingsSrv","calendarCard"])],(function(e){return{F:class CardTooltipController{constructor(t,r,i,n,a){e(this),this._appCommonSrv=t,this._calendarCardsSrv=r,this._githubIntegrationSrv=i,this._settingsSrv=n,this._calendarCard=a,this._showCardNumber=this._collectionSettings.global.settings.showCardNumber,this._githubProject=this._githubIntegrationSrv.getGitHubProjectById(this._calendarCard.accountId,this._calendarCard.providerCard.projectId),this._githubRepository=this._githubIntegrationSrv.getGitHubRepositoryById(this._calendarCard.accountId,this._calendarCard.providerCard.repositoryId)}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubCardTooltipCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"method",key:"isTooltipItemAvailable",value:function isTooltipItemAvailable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q()(t).call(t,(e=>{switch(e){case Ke:return this.cardLabels.length>0;case Ve:return this.cardMembers.length>0;case We:return this.cardCustomFields.length>0}}))}},{kind:"get",key:"cardLabels",value:function cardLabels(){var e,t,r;this._cardLabels||(this._cardLabels=Y()(e=A()(t=x()(r=me()(this._calendarCard.providerCard.labelIds)).call(r,(e=>this._githubIntegrationSrv.getGitHubLabelById(this._calendarCard.accountId,e)))).call(t,(e=>e))).call(e,((e,t)=>(0,U.A5)(e.name,t.name))));return this._cardLabels}},{kind:"get",key:"cardTitle",value:function cardTitle(){return this._showCardNumber&&this._calendarCard.providerCard.cardNumber?`#${this._calendarCard.providerCard.cardNumber} ${this._calendarCard.title}`:this._calendarCard.title}},{kind:"get",key:"hasDates",value:function hasDates(){return this._calendarCard.hasDates}},{kind:"get",key:"cardTimesText",value:function cardTimesText(){if(!this._calendarCard.hasDates)return;let e=this._calendarCard.realStart||this._calendarCard.start,t=this._calendarCard.realEnd||this._calendarCard.end,r=(0,U.KA)(e,t,!this.isAllDay);this._calendarCard.isAllDay&&(t=(0,U.E4)(t,1));let i=(0,U.bt)(e,t,this._appCommonSrv.getSchedulerWorkWeek()).minutes,n=(0,U.gG)(i);return n?`${r} (${n})`:r}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._calendarCard.isAllDay}},{kind:"get",key:"cardAccountId",value:function cardAccountId(){return this._calendarCard.accountId}},{kind:"get",key:"cardAccountName",value:function cardAccountName(){var e;return null===(e=this._provider.getAccountUser(this.cardAccountId))||void 0===e?void 0:e.fullName}},{kind:"get",key:"cardCalendarId",value:function cardCalendarId(){return this._calendarCard.providerCard.projectId}},{kind:"get",key:"cardCalendarName",value:function cardCalendarName(){var e;return null===(e=this._githubProject)||void 0===e?void 0:e.name}},{kind:"get",key:"cardCustomFields",value:function cardCustomFields(){var e,t;this._cardCustomFields||(this._cardCustomFields=A()(e=x()(t=this._githubProject.customFields).call(t,(e=>{let t=Ze[e.name];if(!t)return;let r=this._calendarCard.providerCard.customFields[e.id];if(r){var i;if(e.type===ie.p9.List)r=M()(i=e.options).call(i,(e=>e.id===r)).name;return{id:e.id,name:e.name,icon:t.icon,value:r}}}))).call(e,(e=>e)));return this._cardCustomFields}},{kind:"get",key:"cardRepositoryName",value:function cardRepositoryName(){var e;return null===(e=this._githubRepository)||void 0===e?void 0:e.name}},{kind:"get",key:"cardMembers",value:function cardMembers(){var e,t,r;this._cardMembers||(this._cardMembers=Y()(e=A()(t=x()(r=me()(this._calendarCard.providerCard.memberIds)).call(r,(e=>this._githubIntegrationSrv.getGitHubMemberById(this._calendarCard.accountId,e)))).call(t,(e=>e))).call(e,((e,t)=>(0,U.A5)(e.fullName,t.fullName))));return this._cardMembers}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}}]}}));var Qe=r(79319);function SidebarPanelController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function SidebarPanelController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=SidebarPanelController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=SidebarPanelController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function SidebarPanelController_getDecoratorsApi(){SidebarPanelController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!SidebarPanelController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=SidebarPanelController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:SidebarPanelController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=SidebarPanelController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function SidebarPanelController_createElementDescriptor(e){var t,r=SidebarPanelController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function SidebarPanelController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function SidebarPanelController_hasDecorators(e){return e.decorators&&e.decorators.length}function SidebarPanelController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function SidebarPanelController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function SidebarPanelController_toPropertyKey(e){var t=function SidebarPanelController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Ye=function SidebarPanelController_decorate(e,t,r,i){var n,a=SidebarPanelController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function SidebarPanelController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(SidebarPanelController_isDataDescriptor(n.descriptor)||SidebarPanelController_isDataDescriptor(i.descriptor)){if(SidebarPanelController_hasDecorators(n)||SidebarPanelController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(SidebarPanelController_hasDecorators(n)){if(SidebarPanelController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}SidebarPanelController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,SidebarPanelController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$rootScope","$scope","$translate","appCommonSrv","dialogSrv","githubIntegrationSrv","licenseSrv","planywayIntegrationSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class SidebarPanelController{constructor(t,r,n,a,o,s,l,c,d,u){var h=this;e(this),this._$rootScope=t,this._$scope=r,this._$translate=n,this._appCommonSrv=a,this._dialogSrv=o,this._githubIntegrationSrv=s,this._planywayIntegrationSrv=c,this._licenseSrv=l,this._telemetrySrv=d,this._collectionSrv=u,this._onGitHubProjectChanged=()=>this._$scope.$evalAsync((()=>this._githubProjects=null)),this._githubIntegrationSrv.addGitHubProjectEventListener("added",this._onGitHubProjectChanged),this._githubIntegrationSrv.addGitHubProjectEventListener("updated",this._onGitHubProjectChanged),this._githubIntegrationSrv.addGitHubProjectEventListener("deleted",this._onGitHubProjectChanged),this._githubIntegrationSrv.addGitHubProjectEventListener("cleared",this._onGitHubProjectChanged);const onSourceChanged=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.accountType&&t.accountType!==ee.Qm.GitHub||h._$scope.$evalAsync((()=>{if(h._accounts=null,h._githubProjects=null,h._notifyGitHubProjectsSelectionChanged(),e.name===i.FK.AccountAdded)h.addProjectToCollectionAsync(void 0,t)}))};this._$scope.$on(i.FK.AccountAdded,onSourceChanged),this._$scope.$on(i.FK.AccountDeleted,onSourceChanged),this._$scope.$on(i.FK.CalendarsChanged,onSourceChanged),this._$scope.$on(i.FK.CollectionChanged,onSourceChanged),this._$scope.$on(i.FK.SingleCalendarSelectionRequested,((e,t)=>{let{accountType:r,accountId:i,calendarId:n}=t;if(r!==ee.Qm.GitHub)for(let e of this._provider.getCurrentCollectionConnectedAccountIds())this._changeProjectsSelection(e,!1);else{for(let e of this.githubProjects)e.isSelected=e.accountId===i&&e.id===n;this._saveProjectsSelection(i)}})),this._$scope.$on("$destroy",(()=>{this._githubIntegrationSrv.removeGitHubProjectEventListener("added",this._onGitHubProjectChanged),this._githubIntegrationSrv.removeGitHubProjectEventListener("updated",this._onGitHubProjectChanged),this._githubIntegrationSrv.removeGitHubProjectEventListener("deleted",this._onGitHubProjectChanged),this._githubIntegrationSrv.removeGitHubProjectEventListener("cleared",this._onGitHubProjectChanged)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubSidebarPanelCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"get",key:"accounts",value:function accounts(){var e;this._accounts||(this._accounts=x()(e=this._provider.getCurrentCollectionConnectedAccounts()).call(e,(e=>{let t=SidebarPanelController_objectSpread({},e);return F()(t,"isInvalid",{get:()=>this._provider.invalidAccountIds.has(e.accountId)}),t})));return this._accounts}},{kind:"method",key:"reconnectAccountAsync",value:function reconnectAccountAsync(e){this._githubIntegrationSrv.reconnectAccountAsync(e)}},{kind:"method",key:"disconnectAccountAsync",value:async function disconnectAccountAsync(e){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_TITLE"),this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_CONFIRM",{accountName:e.accountName}),{buttons:[{text:this._$translate.instant("BUTTONS.SIGN_OUT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]})){if(!await this._planywayIntegrationSrv.disconnectAccountAsync(e))return;this._telemetrySrv.logSessionEvent(i.cN.GeneralEvents.AccountDisconnected,{accountType:ee.Qm.GitHub}),await this._provider.removeAccountFromAllCollectionsAsync(e)}}},{kind:"method",key:"isAccountCollapsed",value:function isAccountCollapsed(e){return this._provider.isAccountCollapsed(e.accountId)}},{kind:"method",key:"toggleAccountCollapsed",value:function toggleAccountCollapsed(e){this._provider.toggleAccountCollapsed(e.accountId)}},{kind:"get",key:"isIntegrationBusy",value:function isIntegrationBusy(){return this._githubIntegrationSrv.isIntegrationBusy()}},{kind:"get",key:"canAddProjectToCollection",value:function canAddProjectToCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"addProjectToCollectionAsync",value:async function addProjectToCollectionAsync(e,t){this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogOpened,{accountType:ee.Qm.GitHub,where:i.Zz.Sidebar});let r=await this._dialogSrv.showManageAccountCalendarsDialogAsync(t,e);r?(this._$rootScope.$broadcast(i.FK.CalendarsChanging,t),r.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarAdded,{accountType:ee.Qm.GitHub,count:r.connectedCalendarIds.length}),r.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.GitHub,count:r.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:ee.Qm.GitHub,where:i.Zz.Sidebar})}},{kind:"method",key:"isCreateProjectCalloutAvailable",value:function isCreateProjectCalloutAvailable(e){return 0===this._githubIntegrationSrv.getGitHubProjects(e.accountId).length&&!this._appCommonSrv.isSchedulerBusy()}},{kind:"method",key:"createProjectAsync",value:async function createProjectAsync(e,t){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogOpened,{where:i.bs.Sidebar}),await this._dialogSrv.showGitHubProjectDialogAsync(e,{account:t})||this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogClosed,{where:i.bs.Sidebar})}},{kind:"method",key:"canSelectAllProjects",value:function canSelectAllProjects(e){var t;return q()(t=this.githubProjects).call(t,(t=>t.accountId===e.accountId&&!t.isSelected))}},{kind:"method",key:"selectAllProjects",value:function selectAllProjects(e){this.canSelectAllProjects(e)&&(e.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))&&(this._changeProjectsSelection(e.accountId,!0),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedAll,{accountType:ee.Qm.GitHub,count:this.githubProjects.length}))}},{kind:"method",key:"canSelectNoneProjects",value:function canSelectNoneProjects(e){var t;return q()(t=this.githubProjects).call(t,(t=>t.accountId===e.accountId&&t.isSelected))}},{kind:"method",key:"selectNoneProjects",value:function selectNoneProjects(e){this.canSelectNoneProjects(e)&&(this._changeProjectsSelection(e.accountId,!1),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedNone,{accountType:ee.Qm.GitHub,count:0}))}},{kind:"get",key:"canRemoveAccountFromCollection",value:function canRemoveAccountFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeAccountFromCollection",value:function removeAccountFromCollection(e){this._provider.removeAccountFromCurrentCollectionAsync(e),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAccountRemoved,{accountType:e.accountType})}},{kind:"get",key:"githubProjects",value:function githubProjects(){var e;this._githubProjects||(this._githubProjects=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return x()(t=this._provider.getCurrentCollectionConnectedCalendars(e)).call(t,(t=>SidebarPanelController_objectSpread(SidebarPanelController_objectSpread({},this._githubIntegrationSrv.getGitHubProjectById(e,t.calendarId)),t)))})));return this._githubProjects}},{kind:"method",key:"isGitHubProjectBusy",value:function isGitHubProjectBusy(e){return e.isSelected&&this._githubIntegrationSrv.isConnectedGitHubProjectBusy(e.accountId,e.id)}},{kind:"method",key:"setCalendarSelection",value:function setCalendarSelection(e,t){if(e.isSelected!==t){if(t){if(!this._planywayIntegrationSrv.getConnectedAccountById(e.accountId).isPrimary&&!this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))return}e.isSelected=t,this._telemetrySrv.logSessionEvent(t?i.cN.CollectionEvents.CollectionCalendarSelected:i.cN.CollectionEvents.CollectionCalendarDeselected,{accountType:ee.Qm.GitHub,count:1}),this._saveProjectsSelection(e.accountId)}}},{kind:"method",key:"canShowOnlyThisProject",value:function canShowOnlyThisProject(e){return this.canSelectAllProjects(e)||this.canSelectNoneProjects(e)}},{kind:"method",key:"showOnlyThisProject",value:function showOnlyThisProject(e,t){this.canShowOnlyThisProject(e)&&(this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis,{accountType:ee.Qm.GitHub,count:1}),this._$rootScope.$broadcast(i.FK.SingleCalendarSelectionRequested,{accountType:ee.Qm.GitHub,accountId:e.accountId,calendarId:t.id}))}},{kind:"method",key:"canEditProject",value:function canEditProject(e,t){return!t.isReadOnly}},{kind:"method",key:"editProjectAsync",value:async function editProjectAsync(e,t,r){if(!r.isDataLoaded)try{this._appCommonSrv.setSchedulerBusy(!0),await this._githubIntegrationSrv.loadProjectDataAsync(r.accountId,r.id),r=this._githubIntegrationSrv.getGitHubProjectById(r.accountId,r.id)}finally{this._appCommonSrv.setSchedulerBusy(!1)}this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.EditGitHubProjectDialogOpened,{where:i.bs.Sidebar}),await this._dialogSrv.showGitHubProjectDialogAsync(e,{account:t,project:r})||this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.EditGitHubProjectDialogClosed,{where:i.bs.Sidebar})}},{kind:"get",key:"canRemoveProjectFromCollection",value:function canRemoveProjectFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeProjectFromCollection",value:function removeProjectFromCollection(e,t){let r=this._provider.getCurrentCollectionConnectedCalendar(e.accountId,t.id);r.isConnected=!1,this._provider.setCurrentCollectionConnectedCalendars(e.accountId,[r]),this._$rootScope.$broadcast(i.FK.CalendarsChanging,e),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.GitHub,count:1})}},{kind:"method",key:"canCloseProject",value:function canCloseProject(e,t){return!t.isReadOnly}},{kind:"method",key:"closeProjectAsync",value:async function closeProjectAsync(e,t){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.CLOSE_GITHUB_PROJECT_TITLE"),this._$translate.instant("DIALOGS.CLOSE_GITHUB_PROJECT_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))try{this._appCommonSrv.setSchedulerBusy(!0),await this._githubIntegrationSrv.updateProjectAsync(e.accountId,t.id,{closed:!0}),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.GitHubProjectClosed,{where:i.bs.Sidebar}),this._githubProjects=null,this._notifyGitHubProjectsSelectionChanged()}catch(e){this._$log.error("GitHub close project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub close project error",e,{class:this.constructor.name,method:this.closeProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CLOSE_GITHUB_PROJECT_ERROR"),i.k$.Error)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"canDeleteProject",value:function canDeleteProject(e,t){return!t.isReadOnly}},{kind:"method",key:"deleteProjectAsync",value:async function deleteProjectAsync(e,t){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.DELETE_GITHUB_PROJECT_TITLE"),this._$translate.instant("DIALOGS.DELETE_GITHUB_PROJECT_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))try{this._appCommonSrv.setSchedulerBusy(!0),await this._githubIntegrationSrv.deleteProjectAsync(e.accountId,t.id),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.GitHubProjectDeleted,{where:i.bs.Sidebar}),this._githubProjects=null,this._notifyGitHubProjectsSelectionChanged()}catch(e){this._$log.error("GitHub delete project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub delete project error",e,{class:this.constructor.name,method:this.deleteProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_GITHUB_PROJECT_ERROR"),i.k$.Error)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_changeProjectsSelection",value:function _changeProjectsSelection(e,t){for(let i of A()(r=this.githubProjects).call(r,(t=>t.accountId===e))){var r;i.isSelected=t}this._saveProjectsSelection(e)}},{kind:"method",key:"_saveProjectsSelection",value:function _saveProjectsSelection(e){var t,r;let i=x()(t=A()(r=this.githubProjects).call(r,(t=>t.accountId===e))).call(t,(e=>SidebarPanelController_objectSpread(SidebarPanelController_objectSpread({},this._provider.getCurrentCollectionConnectedCalendar(e.accountId,e.calendarId)),{},{isSelected:e.isSelected})));this._provider.setCurrentCollectionConnectedCalendars(e,i),this._notifyGitHubProjectsSelectionChanged()}},{kind:"method",key:"_notifyGitHubProjectsSelectionChanged",value:function _notifyGitHubProjectsSelectionChanged(){this._$rootScope.$broadcast(i.FK.CardsReloaded),this._$rootScope.$broadcast(i.FK.GitHubProjectSelectionChanged),this._$rootScope.$broadcast(i.FK.ChangeSchedulerViewRequested),this._$rootScope.$broadcast(i.FK.WorkPanelReloaded);for(let e of[i.y.Calendars,i.y.GitHubLabels,i.y.GitHubStatuses,i.y.GitHubAssignees])this._$rootScope.$broadcast(i.FK.TimelineResourcesReloaded,{resourcesType:e})}}]}}));function TaskListCardController_getDecoratorsApi(){TaskListCardController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListCardController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListCardController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListCardController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListCardController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListCardController_createElementDescriptor(e){var t,r=TaskListCardController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListCardController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListCardController_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListCardController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListCardController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListCardController_toPropertyKey(e){var t=function TaskListCardController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Xe=function TaskListCardController_decorate(e,t,r,i){var n,a=TaskListCardController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListCardController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListCardController_isDataDescriptor(n.descriptor)||TaskListCardController_isDataDescriptor(i.descriptor)){if(TaskListCardController_hasDecorators(n)||TaskListCardController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListCardController_hasDecorators(n)){if(TaskListCardController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListCardController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListCardController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$rootScope","$scope","$timeout","$translate","appCommonSrv","settingsSrv"])],(function(e){return{F:class TaskListCardController{constructor(t,r,i,n,a,o,s){e(this),this._$element=t,this._$scope=i,this._$rootScope=r,this._$timeout=n,this._$translate=a,this._appCommonSrv=o,this._settingsSrv=s}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubTaskListCardCtrl"}},{kind:"field",key:"_card",value:void 0},{kind:"field",key:"_isTaskListCardCreating",value:void 0},{kind:"get",key:"card",value:function card(){return this._card}},{kind:"get",key:"cardTitle",value:function cardTitle(){return this.showCardNumber&&this.card.cardNumber?`#${this.card.cardNumber} ${this.card.title}`:this.card.title}},{kind:"get",key:"cardProjectMembers",value:function cardProjectMembers(){return this.card.cardProjectMembers}},{kind:"get",key:"isTaskListCardCreating",value:function isTaskListCardCreating(){return this._isTaskListCardCreating}},{kind:"get",key:"showCardNumber",value:function showCardNumber(){return this._collectionSettings.global.settings.showCardNumber}},{kind:"get",key:"showLabelNames",value:function showLabelNames(){return this._githubCollectionSettings.local.taskLists.showLabelNames}},{kind:"set",key:"showLabelNames",value:function showLabelNames(e){this._githubCollectionSettings.local.taskLists.showLabelNames=e,this._collectionSettings.local.save()}},{kind:"get",key:"showWeekNumbers",value:function showWeekNumbers(){return this._collectionSettings.global.settings.showWeekNumbers}},{kind:"get",key:"defaultCardIsAllDay",value:function defaultCardIsAllDay(){return this.card.cardProject.defaultCardIsAllDay}},{kind:"get",key:"defaultCardDuration",value:function defaultCardDuration(){return this.card.cardProject.defaultCardDuration}},{kind:"set",key:"onOpenCardContextMenu",value:function onOpenCardContextMenu(e){this._onOpenCardContextMenu=e}},{kind:"method",key:"openCardContextMenu",value:function openCardContextMenu(e){this._onOpenCardContextMenu({cardId:this.card.id,mouseEvent:e})}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_githubCollectionSettings",value:function _githubCollectionSettings(){return{local:this._collectionSettings.local.settings.provider[i.lP.GitHub],global:this._collectionSettings.global.settings.provider[i.lP.GitHub]}}}]}}));function TaskListContextMenuController_getDecoratorsApi(){TaskListContextMenuController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListContextMenuController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListContextMenuController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListContextMenuController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListContextMenuController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListContextMenuController_createElementDescriptor(e){var t,r=TaskListContextMenuController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListContextMenuController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListContextMenuController_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListContextMenuController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListContextMenuController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListContextMenuController_toPropertyKey(e){var t=function TaskListContextMenuController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Je=function TaskListContextMenuController_decorate(e,t,r,i){var n,a=TaskListContextMenuController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListContextMenuController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListContextMenuController_isDataDescriptor(n.descriptor)||TaskListContextMenuController_isDataDescriptor(i.descriptor)){if(TaskListContextMenuController_hasDecorators(n)||TaskListContextMenuController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListContextMenuController_hasDecorators(n)){if(TaskListContextMenuController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListContextMenuController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListContextMenuController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$translate"])],(function(e){return{F:class TaskListContextMenuController{constructor(t){e(this),this._$translate=t}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubTaskListContextMenuCtrl"}},{kind:"set",key:"onSetContextMenu",value:function onSetContextMenu(e){this._onSetContextMenu=e}},{kind:"set",key:"onSortTaskList",value:function onSortTaskList(e){this._onSortTaskList=e}},{kind:"get",key:"taskListContextMenu",value:function taskListContextMenu(){return this._taskListContextMenu}},{kind:"get",key:"taskListSortTypes",value:function taskListSortTypes(){return this._taskListSortTypes||(this._taskListSortTypes=[{type:i.uS.DateCreatedNewest,name:this._$translate.instant("MENU.SORT_DATE_CREATED_NEWEST")},{type:i.uS.DateCreatedOldest,name:this._$translate.instant("MENU.SORT_DATE_CREATED_OLDEST")},{type:i.uS.CardName,name:this._$translate.instant("MENU.SORT_CARD_NAME")},{type:i.uS.StartDate,name:this._$translate.instant("MENU.SORT_START_DATE")},{type:i.uS.EndDate,name:this._$translate.instant("MENU.SORT_END_DATE")}]),this._taskListSortTypes}},{kind:"method",key:"setTaskListContextMenu",value:function setTaskListContextMenu(e){this._taskListContextMenu=e,this._onSetContextMenu({menuController:this._taskListContextMenu})}},{kind:"method",key:"sortTaskList",value:function sortTaskList(e,t){this._onSortTaskList({taskList:e,type:t})}}]}}));var et=r(89221),tt=r.n(et),rt=r(53706),it=r.n(rt),nt=r(13464),at=r.n(nt),ot=r(40703),st=r.n(ot),lt=r(90646),ct=r.n(lt),dt=r(26469),ut=r.n(dt);function TaskListsController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function TaskListsController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=TaskListsController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=TaskListsController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function TaskListsController_getDecoratorsApi(){TaskListsController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListsController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListsController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListsController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListsController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListsController_createElementDescriptor(e){var t,r=TaskListsController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListsController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListsController_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListsController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListsController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListsController_toPropertyKey(e){var t=function TaskListsController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ht=16384;function compareTaskListCards(e,t){return e.position-t.position}function compareTaskLists(e,t){return e.position-t.position}let pt=function TaskListsController_decorate(e,t,r,i){var n,a=TaskListsController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListsController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListsController_isDataDescriptor(n.descriptor)||TaskListsController_isDataDescriptor(i.descriptor)){if(TaskListsController_hasDecorators(n)||TaskListsController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListsController_hasDecorators(n)){if(TaskListsController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListsController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListsController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$rootScope","$scope","$log","$window","$timeout","$translate","$mdPanel","appCommonSrv","dialogSrv","githubCardsSrv","githubIntegrationSrv","htmlHelperSrv","licenseSrv","notificationSrv","onboardingSrv","platformSrv","planywayIntegrationSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class TaskListsController{constructor(t,r,n,a,o,s,l,c,d,u,h,p,v,m,f,C,y,g,_,k){e(this),this._$element=t,this._$rootScope=r,this._$scope=n,this._$log=a,this._$window=o,this._$timeout=s,this._$translate=l,this._appCommonSrv=d,this._dialogSrv=u,this._githubCardsSrv=h,this._githubIntegrationSrv=p,this._htmlHelperSrv=v,this._licenseSrv=m,this._notificationSrv=f,this._onboardingSrv=C,this._platformSrv=y,this._planywayIntegrationSrv=g,this._settingsSrv=_,this._telemetrySrv=k;const pushApplyCardsChangesQueue=e=>{this._applyCardsChangesQueue||(this._applyCardsChangesQueue=[],this._applyCardsChangesTimeout=this._$timeout((()=>{try{for(let e of this._applyCardsChangesQueue)e();this._updateCardContextMenu()}finally{this._applyCardsChangesQueue=null,this._applyCardsChangesTimeout=null}}))),this._applyCardsChangesQueue.push(e)};this._onAddOrUpdateCard=e=>{this.currentProject&&e.calendarId===this.currentProject.id&&(this.isTaskListCardCreating()||e.isTempCard||pushApplyCardsChangesQueue((()=>this._addOrUpdateCard(e))))},this._onDeleteCard=e=>{this.currentProject&&e.calendarId===this.currentProject.id&&pushApplyCardsChangesQueue((()=>this._deleteCard(e)))},this._onClearedCards=e=>{if(this.currentProject&&e.accountId===this.currentProject.accountId){this._applyCardsChangesQueue&&(this._applyCardsChangesQueue=null),this._applyCardsChangesTimeout&&this._$timeout.cancel(this._applyCardsChangesTimeout),this._loadedCardsMap.clear();for(let e of tt()(t=this._taskListsMap).call(t)){var t;e.resetCards()}}},this._isInitialized=!1,this._$rootScope.$on(i.FK.TaskListsViewChanged,(()=>{this._taskListsViewMode=null})),this._$scope.$on(i.FK.CardsFieldsSettingsChanged,(()=>{n.$broadcast("$$rebind::card")}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubTaskListsCtrl"}},{kind:"field",key:"_isInitialized",value:()=>!1},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"field",key:"_taskListsMap",value:()=>new(ge())},{kind:"field",key:"_loadedCardsMap",value:()=>new(ge())},{kind:"field",key:"_dirtyCardIsAllDay",value:()=>new(ge())},{kind:"field",key:"_dirtyCardStart",value:()=>new(ge())},{kind:"field",key:"_dirtyCardEnd",value:()=>new(ge())},{kind:"method",key:"initializeTaskLists",value:function initializeTaskLists(){if(this._isInitialized)return;this._$scope.$evalAsync((()=>this._isInitialized=!0));const loadTaskListsAsync=async()=>{if(!this.currentProject)return;if(!this._provider.isCurrentCollectionAccountReady(this.currentProject.accountId))return;let e=this._provider.getProjectStatusField(this.currentProject);if(!e)return;let t=[{id:te.$d,name:this._$translate.instant("MISC.NO_STATUS")},...e.options];O()(t).call(t,((e,t)=>{let r=this._convertFromGitHubCustomFieldOption(e,t);this._taskListsMap.set(e.id,r)}));for(let t of tt()(r=this._taskListsMap).call(r)){var r,i;t.id!==te.$d&&(M()(i=e.options).call(i,(e=>e.id===t.id))||this._taskListsMap.delete(t.id))}this._taskLists=null,this._taskListLanes=null,this._loadedCardsMap.clear(),await this._githubCardsSrv.loadCalendarCardsAsync(this.currentProject.accountId);let n=this._githubCardsSrv.getCalendarCards(this.currentProject.accountId);for(let e of n)e.accountId===this.currentProject.accountId&&e.providerCard.projectId===this.currentProject.id&&this._addOrUpdateCard(e)},reloadSelectedProjectAsync=async()=>{this._currentProject=null,this._currentProjectRepositories=null,this._taskListLanes=null,this._selectedProjectMembers=null,this._lastRejectedCardProperties=null,this._isReadOnly=null,this._loadTaskListsPromise||(this._loadTaskListsPromise=this._$timeout((()=>{if(!this._$scope.$$destroyed)return loadTaskListsAsync()})));try{await this._loadTaskListsPromise}finally{this._loadTaskListsPromise=null}};this._onUpdateGitHubProject=e=>{var t,r,i;if(!this.currentProject||e.id!==this.currentProject.id)return;if(this._currentProject=null,this._currentProjectRepositories=null,this._taskListLanes=null,this._selectedProjectMembers=null,this._isReadOnly=null,!this.currentProject)return;let n=this._provider.getProjectStatusField(this.currentProject);const a=x()(t=A()(r=this.taskLists).call(r,(e=>{let{id:t}=e;return t!==te.$d}))).call(t,(e=>{let{name:t}=e;return t})),o=x()(i=n.options).call(i,(e=>{let{name:t}=e;return t}));(0,U.cO)(a,o,!1)?(this._taskLists=null,this._taskListLanes=null):reloadSelectedProjectAsync()},this._githubIntegrationSrv.addGitHubProjectEventListener("updated",this._onUpdateGitHubProject),this._githubCardsSrv.addCalendarCardEventListener("added",this._onAddOrUpdateCard),this._githubCardsSrv.addCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._githubCardsSrv.addCalendarCardEventListener("deleted",this._onDeleteCard),this._githubCardsSrv.addCalendarCardEventListener("cleared",this._onClearedCards),this._$scope.$on(i.FK.CollectionChanging,(()=>{this._taskListsMap.clear(),this._loadedCardsMap.clear(),this._taskLists=null,this._taskListLanes=null})),this._$scope.$on(i.FK.CollectionChanged,reloadSelectedProjectAsync),this._$scope.$on(i.FK.GitHubTaskListsProjectChanged,reloadSelectedProjectAsync),this._$scope.$on(i.FK.CardsReloaded,reloadSelectedProjectAsync),this._$scope.$on(i.FK.TaskListsViewChanged,(()=>{this._taskListLanes=null})),this._$scope.$on(i.FK.FiltersChanged,(()=>{for(let t of tt()(e=this._taskListsMap).call(e)){var e;t.resetCards()}})),this._$scope.$on(i.FK.GitHubPollingCardsFetched,(async(e,t)=>{var r,i,n,a;let{projectsCards:o}=t;if(!this.currentProject||this.isTaskListCardCreating())return;const s=M()(o).call(o,(e=>{let{projectId:t}=e;return this.currentProject.id===t}));if(!s)return;const l=x()(r=Y()(i=[...tt()(n=this._loadedCardsMap).call(n)]).call(i,compareTaskListCards)).call(r,(e=>{let{id:t}=e;return t})),c=x()(a=s.githubCards).call(a,(e=>{let{id:t}=e;return t}));if(!(0,U.cO)(l,c,!1)){await reloadSelectedProjectAsync(),O()(c).call(c,((e,t)=>{this._loadedCardsMap.get(e).position=(t+1)*ht}));for(let e of tt()(d=this._taskListsMap).call(d)){var d;e.resetCards()}}})),this._$scope.$on(i.FK.GitHubProjectExternalRepositoriesUpdated,(()=>{this._currentProjectRepositories=null,this._taskListLanes=null,this._selectedProjectMembers=null,this._isReadOnly=null})),reloadSelectedProjectAsync();const e=Pe()((()=>{var e;let t=M()(e=this._$element).call(e,".pw-tasks-card:hover").scope();t&&this._$scope.$evalAsync((()=>t.cardHovered=!0))}),200);this._$element.on("mouseover",".pw-tasks-card",(()=>{this.isTaskListScrolling||this.isCardDragging||e()}));const t=Pe()((()=>{this._$scope.$evalAsync((()=>this._isTaskListScrolling=!1))}),200);J()("pw-scheduler").on("scroll",(()=>{this._isTaskListScrolling=!0,t()})),this._htmlHelperSrv.elementAdded(this._$element,".pw-js-tasks-list-scrollable-container",(e=>{e.on("scroll",(()=>{this._isTaskListScrolling=!0,t()}))})),this._htmlHelperSrv.elementAdded(this._$element,".pw-js-tasks-list-scrollable-list",(e=>{e.on("scroll",(()=>{this._isTaskListScrolling=!0,t()}))})),this._$scope.$on("$destroy",(()=>{this._githubIntegrationSrv.removeGitHubProjectEventListener("updated",this._onUpdateGitHubProject),this._githubCardsSrv.removeCalendarCardEventListener("added",this._onAddOrUpdateCard),this._githubCardsSrv.removeCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._githubCardsSrv.removeCalendarCardEventListener("deleted",this._onDeleteCard),this._githubCardsSrv.removeCalendarCardEventListener("cleared",this._onClearedCards)}))}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return null===this._isReadOnly&&(this._isReadOnly=this.currentProject.isReadOnly||0===this._githubIntegrationSrv.getGitHubProjectRepositories(this.currentProject.accountId,this.currentProject.id,!0).length),this._isReadOnly}},{kind:"get",key:"isBusy",value:function isBusy(){return!!this.currentProject&&(!this._appCommonSrv.isSchedulerBusy()&&this._githubIntegrationSrv.isConnectedGitHubProjectBusy(this.currentProject.accountId,this.currentProject.id))}},{kind:"get",key:"isInitialized",value:function isInitialized(){return this._isInitialized}},{kind:"get",key:"isTaskListsAvailable",value:function isTaskListsAvailable(){return!!this.currentProject}},{kind:"get",key:"isAddProjectCalloutAvailable",value:function isAddProjectCalloutAvailable(){return this._isAddProjectCalloutAvailable}},{kind:"get",key:"emptyStateImage",value:function emptyStateImage(){return this._platformSrv.getPlatformUrl(ut())}},{kind:"get",key:"currentProject",value:function currentProject(){if(!this._currentProject){var e;let t=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;let r=this._provider.getCurrentCollectionSelectedCalendarIds(e);return A()(t=x()(r).call(r,(t=>this._githubIntegrationSrv.getGitHubProjectById(e,t)))).call(t,(e=>e))}));this._currentProject=M()(t).call(t,(e=>e.id===this._githubCollectionSettings.global.taskLists.projectId))||t[0],this._selectedProjectMembers=null}return this._currentProject}},{kind:"get",key:"currentProjectRepositories",value:function currentProjectRepositories(){return this._currentProjectRepositories||(this._currentProjectRepositories=this._githubIntegrationSrv.getGitHubProjectRepositories(this.currentProject.accountId,this.currentProject.id,!1)),this._currentProjectRepositories}},{kind:"get",key:"selectedProjectMembers",value:function selectedProjectMembers(){if(!this.currentProject)return[];if(!this._selectedProjectMembers){var e,t;let r=this._getAccountMemberId(this.currentProject.accountId),i=this._githubIntegrationSrv.getGitHubMemberById(this.currentProject.accountId,r);this._selectedProjectMembers=Y()(e=P()(t=this.currentProjectRepositories).call(t,(e=>e.members)).uniqueBy((e=>e.id))).call(e,((e,t)=>(0,ne.mF)(e,t,i)))}return this._selectedProjectMembers}},{kind:"get",key:"taskListsView",value:function taskListsView(){return this._githubCollectionSettings.global.taskLists.view}},{kind:"get",key:"taskListsViewMode",value:function taskListsViewMode(){if(!this._taskListsViewMode){this._taskListsViewMode=this._githubCollectionSettings.global.taskLists.viewSettings[this.taskListsView].mode;let e=i.or[this._taskListsViewMode];if(e&&!this._licenseSrv.checkPaidFeatureAvailable(e,!1))switch(this.taskListsView){case i.cT.Kanban:return i.e_.None;case i.cT.List:return i.e_.List}}return this._taskListsViewMode}},{kind:"method",key:"showManageAccountCalendarsDialogAsync",value:async function showManageAccountCalendarsDialogAsync(e){var t;let r=M()(t=this._planywayIntegrationSrv.getConnectedAccounts()).call(t,(e=>{let{accountType:t}=e;return t===ee.Qm.GitHub}));if(!r)return;this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogOpened,{accountType:ee.Qm.GitHub,where:i.Zz.TaskLists});let n=await this._dialogSrv.showManageAccountCalendarsDialogAsync(r,e);n?(this._$rootScope.$broadcast(i.FK.CalendarsChanging,r),n.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarAdded,{accountType:ee.Qm.GitHub,count:n.connectedCalendarIds.length}),n.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.GitHub,count:n.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:ee.Qm.GitHub,where:i.Zz.TaskLists})}},{kind:"get",key:"isTaskListScrolling",value:function isTaskListScrolling(){return this._isTaskListScrolling}},{kind:"get",key:"taskLists",value:function taskLists(){var e,t;this._taskLists||(this._taskLists=Y()(e=me()(tt()(t=this._taskListsMap).call(t))).call(e,compareTaskLists));return this._taskLists}},{kind:"method",key:"toggleListCollapsed",value:function toggleListCollapsed(e){if(this.isTaskListCardCreating(e))return;e.isCollapsed=!e.isCollapsed,e.isCollapsed||e.resetCards();let t=this._githubCollectionSettings.local.taskLists.lists,r=t[e.id];delete t[e.id],t[e.id]=TaskListsController_objectSpread(TaskListsController_objectSpread({},r),{},{isCollapsed:e.isCollapsed}),this._collectionSettings.local.save()}},{kind:"get",key:"taskListContextMenu",value:function taskListContextMenu(){return this._taskListContextMenu}},{kind:"method",key:"setTaskListContextMenu",value:function setTaskListContextMenu(e){this._taskListContextMenu=e}},{kind:"method",key:"openTaskListContextMenu",value:function openTaskListContextMenu(e,t){t.preventDefault(),t.stopPropagation();let r=this._taskListsMap.get(e);r&&(this._telemetrySrv.logSessionEvent(i.cN.TaskListEvents.ContextMenuOpened,{by:"contextmenu"===t.type?i.AH.RightClick:i.AH.MenuButton}),this.taskListContextMenu.open(t,r))}},{kind:"method",key:"sortTaskListByMenu",value:function sortTaskListByMenu(e,t){this._telemetrySrv.logSessionEvent(i.cN.TaskListEvents.Sorted,{type:t,by:i.GW.ContextMenu}),this._sortTaskListAsync(e,t)}},{kind:"get",key:"taskListLanes",value:function taskListLanes(){var e,t,r,n,a;if(0===this.taskLists.length)return[];if(!this._taskListLanes){let o;switch(this.taskListsViewMode){case i.e_.Member:let s=this._getAccountMemberId(this.currentProject.accountId),l=this._githubIntegrationSrv.getGitHubMemberById(this.currentProject.accountId,s),c=P()(e=this.currentProjectRepositories).call(e,(e=>e.members)).uniqueBy((e=>e.id));o=[...Y()(t=x()(c).call(c,(e=>TaskListsController_objectSpread({},e)))).call(t,((e,t)=>(0,ne.mF)(e,t,l))),{id:te.$d,fullName:this._$translate.instant("MISC.UNASSIGNED_MEMBER_FULL_NAME")}];break;case i.e_.Label:let d=me()(tt()(r=it()(n=P()(a=this.currentProjectRepositories).call(a,(e=>e.labels))).call(n,((e,t)=>e.set(t.id,t)),new(ge()))).call(r));o=[...x()(d).call(d,(e=>TaskListsController_objectSpread({},e))),{id:te.$d,color:"default",name:this._$translate.instant("MISC.NO_LABEL")}];break;case i.e_.List:o=[...this._provider.getProjectStatusField(this.currentProject).options,{id:te.$d,name:this._$translate.instant("MISC.NO_STATUS")}];break;case i.e_.None:o=[{id:te.$d}]}this._taskListLanes=x()(o).call(o,(e=>{var t,r;let n;switch(this.taskListsViewMode){case i.e_.Member:case i.e_.Label:case i.e_.List:n=null===(t=this._githubCollectionSettings.local.taskLists.lanes[this.taskListsView][e.id])||void 0===t?void 0:t.isCollapsed}let a={id:e.id,resource:e,isCollapsed:null!==(r=n)&&void 0!==r&&r,resetCardsCount:()=>a._cardsCount=null,_cardsCount:null};return F()(a,"cardsCount",{get:()=>{if(null===a._cardsCount){a._cardsCount=0;for(let e of this.taskLists)for(let t of e.cards)if(this._isTaskListCardVisible(t))switch(this.taskListsViewMode){case i.e_.Member:t.memberIds.has(a.id)&&a._cardsCount++;break;case i.e_.Label:t.labelIds.has(a.id)&&a._cardsCount++;break;case i.e_.List:t.statusId===a.id&&a._cardsCount++;break;case i.e_.None:a._cardsCount++}}return a._cardsCount}}),a}))}return this._taskListLanes}},{kind:"method",key:"toggleLaneCollapsed",value:function toggleLaneCollapsed(e){if(this.isTaskLaneCardCreating(e))return;e.isCollapsed=!e.isCollapsed;let t=this._githubCollectionSettings.local.taskLists.lanes[this.taskListsView],r=t[e.id];delete t[e.id],t[e.id]=TaskListsController_objectSpread(TaskListsController_objectSpread({},r),{},{isCollapsed:e.isCollapsed}),this._collectionSettings.local.save()}},{kind:"method",key:"getLaneCardFilter",value:function getLaneCardFilter(e){switch(this.taskListsViewMode){case i.e_.Member:return t=>t.memberIds.has(e);case i.e_.Label:return t=>t.labelIds.has(e);case i.e_.List:return t=>t.statusId===e;default:return()=>!0}}},{kind:"method",key:"onCardInView",value:function onCardInView(e,t){e?(t.$resume(),t.$broadcast("$$rebind::card")):t.$suspend()}},{kind:"get",key:"sortableCardsOptions",value:function sortableCardsOptions(){return this._sortableCardsOptions||(this._sortableCardsOptions={connectWith:[".pw-tasks-lane__items"].join(", "),filter:[".pw-tasks-lane__item"].join(", "),ignore:[".pw-tasks-card--temp-card",".pw-tasks-card--temp-card *","input"].join(", "),autoScroll:!0,disableSorting:!1,restrictedSorting:()=>{switch(this.taskListsViewMode){case i.e_.Member:case i.e_.Label:return this.taskListsView===i.cT.List;case i.e_.List:case i.e_.None:return!1}},getRestrictedSortingTarget:(e,t)=>{var r,n;let a;switch(this.taskListsView){case i.cT.Kanban:a=J()(t.sortable.element).attr("data-list-id");break;case i.cT.List:a=J()(e.list.draggedElement).attr("data-list-id")}let o=M()(r=t.element.closest(".pw-tasks-lane")).call(r,`[data-list-id='${a}']`),s=t.element.attr("data-lane-id"),l=M()(n=this.taskListLanes).call(n,(e=>e.id===s)),c=this._loadedCardsMap.get(e.list.draggedElement.attr("data-id")),d=(e=>{let t=0;if(!l)return t;let r=this._taskListsMap.get(a),i=A()(e=r.cards).call(e,this.getLaneCardFilter(s));for(let e of i){if(e.position>c.position)return t;t++}return t})(),u={element:J()(M()(o).call(o,".pw-tasks-lane__item:not(.pw-tasks-lane__item--drop-anchor):not(.pw-tasks-lane__item--placeholder)")[d]),direction:"prev"};return u.element[0]||(u={element:M()(o).call(o,".pw-tasks-lane__item").last(),direction:"next"}),u},group:te.dl,placeholder:e=>{let t=e.clone();return t.addClass("pw-tasks-lane__item--placeholder"),t.css({width:e.width()}),M()(t).call(t,"input").removeAttr("id"),t},hint:e=>{let t=e.clone();return t.addClass("pw-tasks-lane__item--hint"),t.css({width:e.width()}),M()(t).call(t,"input").removeAttr("id"),t}}),this._sortableCardsOptions}},{kind:"get",key:"isCardDragging",value:function isCardDragging(){return this._isCardDragging}},{kind:"method",key:"onCardDragStart",value:function onCardDragStart(e){if(this.isReadOnly)return void e.preventDefault();this._loadedCardsMap.get(e.item.data("id")).isReadOnly?e.preventDefault():this._isCardDragging=!0}},{kind:"method",key:"onCardDragMoveHint",value:function onCardDragMoveHint(e){var t,r,n,a,o,s,l;let c=J()(e.elementUnderCursor),d=c.closest(".pw-tasks-lane__list"),u=c.closest(".pw-tasks-lane"),h=u.attr("data-resource-id");if(h&&h!==te.$d){let n=this._loadedCardsMap.get(e.sender.draggedElement.data("id")).cardRepository;switch(this.taskListsViewMode){case i.e_.Member:if(!M()(t=n.members).call(t,(e=>e.id===h)))return void e.preventDefault();break;case i.e_.Label:if(!M()(r=n.labels).call(r,(e=>e.id===h)))return void e.preventDefault()}}if(u.addClass("pw-tasks-lane--disabled"),this.taskListsView===i.cT.List)switch(this.taskListsViewMode){case i.e_.Member:case i.e_.Label:let t=J()(e.sender.draggedElement).closest(".pw-tasks-lane__list").attr("data-list-id");return d=M()(u).call(u,`[data-list-id='${t}']`),M()(n=this._$element).call(n,".pw-tasks-lane__items--target").removeClass("pw-tasks-lane__items--target"),M()(a=J()(d)).call(a,".pw-tasks-lane__items").addClass("pw-tasks-lane__items--target"),M()(o=this._$element).call(o,".pw-tasks-lane--target").removeClass("pw-tasks-lane--target"),void(M()(u).call(u,".pw-tasks-lane__item--placeholder")[0]&&J()(u).index()!==J()(e.sender.draggedElement).closest(".pw-tasks-lane").index()&&u.addClass("pw-tasks-lane--target"));case i.e_.List:return d=M()(u).call(u,`.pw-tasks-lane__items[data-list-id=${h}]`),M()(s=this._$element).call(s,".pw-tasks-lane__items").removeClass("pw-tasks-lane__items--target"),void J()(d).addClass("pw-tasks-lane__items--target")}if(0===d.length)return;let p=M()(d).call(d,".pw-tasks-lane__items");0!==p.length&&(M()(l=this._$element).call(l,".pw-tasks-lane__items").removeClass("pw-tasks-lane__items--target"),p.addClass("pw-tasks-lane__items--target"))}},{kind:"method",key:"onCardDragEnd",value:function onCardDragEnd(e,t,r){var n,a,o;if(this._isCardDragging=!1,M()(n=this._$element).call(n,".pw-tasks-lane--target").removeClass("pw-tasks-lane--target"),M()(a=this._$element).call(a,".pw-tasks-lane--disabled").removeClass("pw-tasks-lane--disabled"),M()(o=this._$element).call(o,".pw-tasks-lane__items--target").removeClass("pw-tasks-lane__items--target"),this._$rootScope.$broadcast(i.FK.CardDragEnded),e.newIndex===e.oldIndex)return;e.sender.draggable.dropped=!0;let s=this._taskListsMap.get(t);if(!s)return;let c=this._loadedCardsMap.get(e.item.data("id"));var u,h;if("remove"===e.action)return void d()(u=s.cards).call(u,l()(h=s.cards).call(h,c),1);e.preventDefault();let p,v=s.cards;r&&(v=A()(v).call(v,this.getLaneCardFilter(r)));let m,f={};switch(e.action){case"receive":switch(v.length>0&&(m=this._getCardInsertPosition(v,e.newIndex)),this.taskListsViewMode){case i.e_.Member:if(!c.memberIds.has(r))if(p=i.cN.CardEvents.MemberChanged,r===te.$d)c.members=[],f.memberIds=new(ke())([]);else{var C;let e=A()(C=c.cardRepository.members).call(C,(e=>e.id===r));e.length>0&&(c.members=e,f.memberIds=new(ke())([r]))}break;case i.e_.Label:if(!c.labelIds.has(r))if(p=i.cN.CardEvents.LabelChanged,r===te.$d)c.labels=[],f.labelIds=new(ke())([]);else{var y;let e=A()(y=c.cardRepository.labels).call(y,(e=>e.id===r));e.length>0&&(c.labels=e,f.labelIds=new(ke())([r]))}case i.e_.List:case i.e_.None:}c.statusId!==t&&(p||(p=i.cN.CardEvents.StatusChanged),c.statusId=t,f.customFields={[this._provider.getProjectStatusField(c.cardProject).id]:t===te.$d?null:t});break;case"sort":{let t=e.newIndex<e.oldIndex?e.newIndex:e.newIndex+1;switch(m=this._getCardInsertPosition(v,t),this.taskListsViewMode){case i.e_.Member:case i.e_.Label:if(this.taskListsView===i.cT.Kanban)p=i.cN.CardEvents.PositionChanged;break;case i.e_.List:case i.e_.None:p=i.cN.CardEvents.PositionChanged}break}}var g;(s.resetCards(),this._logCalendarCardEvent(c.calendarCard,{event:p,data:{by:i.AH.Mouse}}),m&&m.afterCard!==c)&&(c.position=m.position,this._githubCardsSrv.updateCardPosition(c.calendarCard,null===(g=m.afterCard)||void 0===g?void 0:g.id));this._setCalendarCardPropertiesAsync(c.calendarCard,f)}},{kind:"method",key:"onCardDragCancel",value:function onCardDragCancel(){var e,t,r;this._isCardDragging=!1,M()(e=this._$element).call(e,".pw-tasks-lane--target").removeClass("pw-tasks-lane--target"),M()(t=this._$element).call(t,".pw-tasks-lane--disabled").removeClass("pw-tasks-lane--disabled"),M()(r=this._$element).call(r,".pw-tasks-lane__items").removeClass("pw-tasks-lane__items--target"),this._$rootScope.$broadcast(i.FK.CardDragEnded)}},{kind:"method",key:"updateCardByHotkey",value:function updateCardByHotkey(e,t,r,n){var a,o;this.closeCardContextMenu(),null===(a=this.taskListContextMenu)||void 0===a||a.close();let s=null===(o=this._loadedCardsMap.get(t))||void 0===o?void 0:o.calendarCard;s&&this._provider.updateCardsByHotkey([s],r,n,i.LP.TaskLists,this._$element)}},{kind:"method",key:"showEditCardDialogAsync",value:async function showEditCardDialogAsync(e,t){var r;let n=null===(r=this._loadedCardsMap.get(e))||void 0===r?void 0:r.calendarCard;n&&!n.isTempCard&&(this._logCalendarCardEvent(n,{event:i.cN.CardEvents.EditDialogOpened}),await this._dialogSrv.showEditCardDialogAsync(n,{cardElement:t,openerContext:this._editCardDialogOpenerContext})?this._incrementActionCounter():this._logCalendarCardEvent(n,{event:i.cN.CardEvents.EditDialogClosed}))}},{kind:"get",key:"cardContextMenu",value:function cardContextMenu(){return this._cardContextMenu}},{kind:"method",key:"setCardContextMenu",value:function setCardContextMenu(e,t){this._cardContextMenu||(this._cardContextMenu={}),t.where=i.a6.TaskLists,this._cardContextMenu[e]=t}},{kind:"method",key:"openCardContextMenu",value:function openCardContextMenu(e,t,r){var n;let a=null===(n=this._loadedCardsMap.get(t))||void 0===n?void 0:n.calendarCard;this._logCalendarCardEvent(a,{event:i.cN.CardEvents.ContextMenuOpened,data:{by:"contextmenu"===r.type?i.AH.RightClick:i.AH.MenuButton}}),this.cardContextMenu[a.providerType].open(r,a)}},{kind:"method",key:"closeCardContextMenu",value:function closeCardContextMenu(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O()(e=Ee()(this.cardContextMenu)).call(e,(e=>{t.closeNested?e.closeNested():e.close()}))}},{kind:"method",key:"isTaskListCardCreateAvailable",value:function isTaskListCardCreateAvailable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isReadOnly)return!1;if(t.nextCard){var r;if(t.nextCard.isTempCard)return!1;let i=l()(r=e.cards).call(r,t.nextCard);if(i>0&&e.cards[i-1].isTempCard)return!1}else if(this.isTaskListCardCreating(e)&&this.isTaskLaneCardCreating(t.taskLane))return!1;return!0}},{kind:"method",key:"isTaskListCardCreating",value:function isTaskListCardCreating(e){return!(!this._tempCalendarCard||!this._loadedCardsMap.has(this._tempCalendarCard.id))&&(!e||this._githubCardsSrv.getCardStatusId(this._tempCalendarCard)===e.id)}},{kind:"method",key:"isTaskLaneCardCreating",value:function isTaskLaneCardCreating(e){if(!this._tempCalendarCard||!this._loadedCardsMap.has(this._tempCalendarCard.id))return!1;if(!e)return!0;switch(this.taskListsViewMode){case i.e_.Member:return this._tempCalendarCard.providerCard.memberIds.has(e.id);case i.e_.Label:return this._tempCalendarCard.providerCard.labelIds.has(e.id);case i.e_.List:case i.e_.None:return!0}}},{kind:"method",key:"getTaskLaneDefaultList",value:function getTaskLaneDefaultList(e){var t;return this.taskListsViewMode===i.e_.List?M()(t=this.taskLists).call(t,(t=>t.id===e.id)):this.taskLists[0]}},{kind:"method",key:"beginCardCreating",value:function beginCardCreating(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._tempCalendarCard)return;let n=A()(t=e.cards).call(t,(e=>!e.isTempCard)),a=n.length;switch(this.taskListsView){case i.cT.Kanban:n=A()(n).call(n,this.getLaneCardFilter(r.taskLane.id)),a=r.nextCard?l()(n).call(n,r.nextCard):n.length;break;case i.cT.List:if(this.taskListsViewMode===i.e_.List)a=r.nextCard?l()(n).call(n,r.nextCard):n.length}let{position:o}=this._getCardInsertPosition(n,a);this._$scope.$evalAsync((()=>{var t,n,a;let s={projectId:this.currentProject.id};if(e.id!==te.$d){let t=this._provider.getProjectStatusField(this.currentProject);s.customFields={[t.id]:e.id}}switch(this.taskListsViewMode){case i.e_.Member:s.memberIds=new(ke())([r.taskLane.id]);break;case i.e_.Label:s.labelIds=new(ke())([r.taskLane.id]);break;case i.e_.List:case i.e_.None:s.labelIds=null===(t=this._lastRejectedCardProperties)||void 0===t?void 0:t.labelIds,s.memberIds=null===(n=this._lastRejectedCardProperties)||void 0===n?void 0:n.memberIds}this._tempCalendarCard=this._githubCardsSrv.createTempCalendarCard(this.currentProject.accountId,{title:(null===(a=this._lastRejectedCardProperties)||void 0===a?void 0:a.title)||"",providerCard:s}),this._addOrUpdateCard(this._tempCalendarCard,o)}))}},{kind:"method",key:"submitCardCreating",value:function submitCardCreating(){this._appCommonSrv.isSchedulerBusy()||this._tempCalendarCard&&this._loadedCardsMap.has(this._tempCalendarCard.id)&&(this._tempCalendarCard.title||this._tempCalendarCard.hasDates?(this._logCalendarCardEvent(this._tempCalendarCard,{event:i.cN.CardEvents.Added}),(async()=>{let e=this._taskListsMap.get(this._githubCardsSrv.getCardStatusId(this._tempCalendarCard));if(e){var t;let i=at()(t=e.cards).call(t,(e=>e.isTempCard))===e.cards.length-1;if(await this._createCardAsync(e,this._tempCalendarCard)){var r;let t={taskLane:M()(r=this.taskListLanes).call(r,(e=>this.isTaskLaneCardCreating(e)))};return this._tempCalendarCard=null,this._lastRejectedCardProperties=null,this._incrementActionCounter(),void(i&&(this.beginCardCreating(e,t),this._$timeout((()=>{var e;return M()(e=this._$element).call(e,".pw-js-tasks-list-card-create-input").trigger("focus")}),0,!1)))}}this._$scope.$evalAsync((()=>{this._tempCalendarCard=null}))})()):this.rejectCardCreating())}},{kind:"method",key:"rejectCardCreating",value:function rejectCardCreating(){this._tempCalendarCard&&this._loadedCardsMap.has(this._tempCalendarCard.id)&&(this._lastRejectedCardProperties={title:this._tempCalendarCard.title,isCompleted:this._tempCalendarCard.providerCard.isCompleted,isAllDay:this._tempCalendarCard.isAllDay,start:this._tempCalendarCard.start,end:this._tempCalendarCard.end,labelIds:this._tempCalendarCard.providerCard.labelIds,memberIds:this._tempCalendarCard.providerCard.memberIds},this._githubCardsSrv.deleteCalendarCardAsync(this._tempCalendarCard),this._$scope.$evalAsync((()=>this._tempCalendarCard=null)))}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_githubCollectionSettings",value:function _githubCollectionSettings(){return{local:this._collectionSettings.local.settings.provider[i.lP.GitHub],global:this._collectionSettings.global.settings.provider[i.lP.GitHub]}}},{kind:"method",key:"_getAccountMemberId",value:function _getAccountMemberId(e){return this._planywayIntegrationSrv.getConnectedAccountById(e).githubUserId}},{kind:"method",key:"_incrementActionCounter",value:function _incrementActionCounter(){switch(this._appCommonSrv.getSchedulerMode()){case i.ud.Board:this._onboardingSrv.incrementActionCounter(i.Us.BoardEdit);break;case i.ud.Calendar:this._onboardingSrv.incrementActionCounter(i.Us.CalendarEdit);break;case i.ud.Timeline:this._onboardingSrv.incrementActionCounter(i.Us.TimelineEdit);break;case i.ud.TimeTracking:this._onboardingSrv.incrementActionCounter(i.Us.TimeTrackingEdit)}}},{kind:"method",key:"_convertFromGitHubCustomFieldOption",value:function _convertFromGitHubCustomFieldOption(e,t){var r,i;let n=this._githubCollectionSettings.local.taskLists.lists,a={id:e.id,name:e.name,position:t,isCollapsed:null!==(r=null===(i=n[e.id])||void 0===i?void 0:i.isCollapsed)&&void 0!==r&&r,resetCards:()=>{a._cards=null;for(let e of this.taskListLanes)e.resetCardsCount()},_cards:null};return F()(a,"cards",{get:()=>{var t,r,i,n;a._cards||(a._cards=Y()(t=A()(r=me()(tt()(i=this._loadedCardsMap).call(i))).call(r,(t=>t.statusId===e.id&&this._isTaskListCardVisible(t)))).call(t,compareTaskListCards),M()(n=this._$element).call(n,`[data-list-id='${a.id}']`).each(((e,t)=>{var r;return null===(r=J()(t).scope())||void 0===r?void 0:r.$broadcast("$$rebind::card")})));return a._cards}}),a}},{kind:"method",key:"_sortTaskListAsync",value:async function _sortTaskListAsync(e,t){var r,n,a,o,s,l;const c=[...e.cards];switch(t){case i.uS.DateCreatedNewest:Y()(r=e.cards).call(r,((e,t)=>t.createdDate-e.createdDate));break;case i.uS.DateCreatedOldest:Y()(n=e.cards).call(n,((e,t)=>e.createdDate-t.createdDate));break;case i.uS.CardName:Y()(a=e.cards).call(a,((e,t)=>(0,U.A5)(e.title,t.title)));break;case i.uS.StartDate:Y()(o=e.cards).call(o,((e,t)=>e.hasDates||t.hasDates?e.hasDates?t.hasDates?e.start-t.start:-1:1:0));break;case i.uS.EndDate:Y()(s=e.cards).call(s,((e,t)=>e.hasDates||t.hasDates?e.hasDates?t.hasDates?e.end-t.end:-1:1:0))}if(!Ce()(l=e.cards).call(l,((e,t)=>e.id===c[t].id)))try{this._appCommonSrv.setSchedulerBusy(!0);for(let[t,r]of st()(d=e.cards).call(d)){var d,u;r.position=(t+1)*ht,await this._githubCardsSrv.updateCardPosition(r.calendarCard,null===(u=e.cards[t-1])||void 0===u?void 0:u.id)}e.resetCards()}catch(e){this._$log.error("GitHub sort list error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub sort list error",e,{class:this.constructor.name,method:this._sortTaskListAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.TASK_LIST_SORT_ERROR"),i.k$.Error)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_addOrUpdateCard",value:function _addOrUpdateCard(e,t){let r=this._githubCardsSrv.getCardStatusId(e),i=this._taskListsMap.get(r);e.isTempCard||(e=e.clone());let n=this._loadedCardsMap.get(e.id);if(n&&(!i||n.statusId!==r)){let e=this._taskListsMap.get(n.statusId);e&&e.resetCards()}let a=this._convertFromCalendarCard(e);a.position=void 0!==t?t:n?n.position:(this._loadedCardsMap.size+1)*ht,this._loadedCardsMap.set(e.id,a),i&&i.resetCards()}},{kind:"method",key:"_deleteCard",value:function _deleteCard(e){let t=this._loadedCardsMap.get(e.id);if(!t)return;this._loadedCardsMap.delete(e.id);let r=this._taskListsMap.get(t.statusId);r&&r.resetCards()}},{kind:"method",key:"_checkCalendarCardEditAvailable",value:function _checkCalendarCardEditAvailable(e){if(e.cardRole===ee.D.Milestone)if(!this._licenseSrv.checkPaidFeatureAvailable(i.ZV.Milestones,!0))return!1;return!(e.recurrenceRule&&!this._licenseSrv.checkPaidFeatureAvailable(i.ZV.RecurringCards,!0))}},{kind:"method",key:"_setCalendarCardPropertiesAsync",value:async function _setCalendarCardPropertiesAsync(e,t){try{await this._githubCardsSrv.updateCalendarCardPropertiesAsync(e,t),this._incrementActionCounter()}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),i.k$.Error)}}},{kind:"method",key:"_createCardAsync",value:async function _createCardAsync(e,t){try{var r,n,a;this._appCommonSrv.setSchedulerBusy(!0);let e=this._loadedCardsMap.get(t.id),o=await this._githubCardsSrv.createCalendarCardAsync(t);this._addOrUpdateCard(o,e.position);let s=Y()(r=A()(n=me()(tt()(a=this._loadedCardsMap).call(a))).call(n,(e=>!e.isTempCard))).call(r,compareTaskListCards),c=l()(s).call(s,this._loadedCardsMap.get(o.id));if(c!==s.length-1){let e=s[c-1];this._githubCardsSrv.updateCardPosition(o,null==e?void 0:e.id)}return this._$rootScope.$broadcast(i.FK.CardCreated,{calendarCard:o}),!0}catch(e){return this._$log.error("GitHub create card from task list error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub create card from task list error",e,{class:this.constructor.name,method:this._createCardAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CREATE_GITHUB_ISSUE_ERROR"),i.k$.Error),!1}finally{this._appCommonSrv.setSchedulerBusy(!1),this._githubCardsSrv.deleteCalendarCardAsync(t)}}},{kind:"method",key:"_updateCardContextMenu",value:function _updateCardContextMenu(){var e,t,r;if(null===(e=this.cardContextMenu)||void 0===e||null===(t=e[i.lP.GitHub])||void 0===t||!t.pwData)return;let n=null===(r=this._loadedCardsMap.get(this.cardContextMenu[i.lP.GitHub].pwData.id))||void 0===r?void 0:r.calendarCard;n?this._$scope.$evalAsync((()=>this.cardContextMenu[i.lP.GitHub].pwData=n)):this.closeCardContextMenu()}},{kind:"method",key:"_logCalendarCardEvent",value:function _logCalendarCardEvent(e,t){this._telemetrySrv.logSessionEvent(t.event,TaskListsController_objectSpread({accountId:e.accountId,calendarId:e.calendarId,cardType:e.cardType,cardRole:e.cardRole,isAllDay:e.isAllDay,start:e.start,end:e.end,isNewCard:e.isTempCard,memberIds:e.providerCard.memberIds,isAssignedToMe:e.providerCard.memberIds.has(this._getAccountMemberId(e.accountId)),where:i.a6.TaskLists,by:i.AH.TaskLists,durationMinutes:e.providerCard.durationMinutes},t.data))}},{kind:"method",key:"_convertFromCalendarCard",value:function _convertFromCalendarCard(e){let t={id:e.id,accountType:ee.Qm.GitHub,accountId:e.accountId,calendarId:e.calendarId,cardType:e.cardType,cardRole:e.cardRole,calendarCard:e,createdDate:e.providerCard.createdDate,cardNumber:e.providerCard.cardNumber,cardProject:this.currentProject,cardRepository:this._githubIntegrationSrv.getGitHubRepositoryById(e.accountId,e.providerCard.repositoryId),cardProjectMembers:this.selectedProjectMembers,isTempCard:e.isTempCard,isReadOnly:e.isReadOnly,statusId:this._githubCardsSrv.getCardStatusId(e),changeDates:(r,n,a,o)=>{if(t.isAllDay===r&&(0,U.rs)(t.start,n)&&(0,U.rs)(t.end,a))return;if(!this._checkCalendarCardEditAvailable(t))return void o(t.isAllDay,t.start,t.end);let s,l={isAllDay:r,start:n,end:a};if(t.hasDates)if(t.isAllDay!==r)s=r?i.cN.CardEvents.IsAllDaySet:i.cN.CardEvents.IsAllDayUnset;else if((0,U.rs)(t.start,n)){if((0,U.rs)(t.end,a))return;s=i.cN.CardEvents.EndChanged}else s=i.cN.CardEvents.StartChanged;else s=i.cN.CardEvents.Scheduled,l.by=i.AH.HotAction;this._logCalendarCardEvent(e,{event:s,data:l}),t.isAllDay=r,t.start=n,t.end=a},removeDatesAsync:async()=>{try{this._logCalendarCardEvent(e,{event:i.cN.CardEvents.DatesRemoved}),await this._githubCardsSrv.removeCalendarCardAsync(e)}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),i.k$.Error)}},isMemberSelected:t=>e.providerCard.memberIds.has(t.id),toggleMemberAsync:async t=>{await this._provider.toggleCardsMemberAsync([e],t.id,{telemetry:{where:i.a6.TaskLists,by:i.AH.TaskLists}})}};return F()(t,"title",{get:()=>e.title,set:t=>{e.title=t}}),F()(t,"isCompleted",{get:()=>e.providerCard.isCompleted}),F()(t,"hasDates",{get:()=>(0,U.qb)(t.start)&&(0,U.qb)(t.end)}),F()(t,"isAllDay",{get:()=>{var r;return this._dirtyCardIsAllDay.has(t.id)?this._dirtyCardIsAllDay.get(t.id):null===(r=e.isAllDay)||void 0===r||r},set:e=>{t.isAllDay!==e&&this._dirtyCardIsAllDay.set(t.id,e)}}),F()(t,"start",{get:()=>this._dirtyCardStart.has(t.id)?this._dirtyCardStart.get(t.id):e.start,set:e=>{e&&!(0,U.rs)(t.start,e)&&this._dirtyCardStart.set(t.id,e)}}),F()(t,"end",{get:()=>this._dirtyCardEnd.has(t.id)?this._dirtyCardEnd.get(t.id):e.end,set:async r=>{if(r&&(!(0,U.rs)(t.end,r)||this._dirtyCardIsAllDay.has(t.id)||this._dirtyCardStart.has(t.id)))try{this._dirtyCardEnd.set(t.id,r),await this._setCalendarCardPropertiesAsync(e,{isAllDay:t.isAllDay,start:t.start,end:r})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),i.k$.Error)}finally{this._dirtyCardIsAllDay.delete(t.id),this._dirtyCardStart.delete(t.id),this._dirtyCardEnd.delete(t.id)}}}),F()(t,"shortDate",{get:()=>{if(t.hasDates)return(0,U.kC)(t.start,t.end)}}),F()(t,"labelsCount",{get:()=>t.labels.length}),F()(t,"labels",{get:()=>{var r,i,n,a;t._labels||(t._labels=x()(r=Y()(i=A()(n=x()(a=me()(e.providerCard.labelIds)).call(a,(t=>this._githubIntegrationSrv.getGitHubLabelById(e.accountId,t)))).call(n,(e=>e))).call(i,ne.Ny)).call(r,(e=>TaskListsController_objectSpread(TaskListsController_objectSpread({},e),{},{name:e.name||this._$translate.instant("MISC.LABEL_COLOR_NO_COLOR")}))),t._labelIds=null);return t._labels},set:e=>{t._labels=e,t._labelIds=null}}),F()(t,"labelIds",{get:()=>{var e;t._labelIds||(t._labelIds=new(ke())(t.labelsCount>0?x()(e=t.labels).call(e,(e=>{let{id:t}=e;return t})):[te.$d]));return t._labelIds}}),F()(t,"membersCount",{get:()=>t.members.length}),F()(t,"members",{get:()=>{var r,i,n;t._members||(t._members=me()(x()(r=A()(i=x()(n=e.providerCard.memberIds).call(n,(t=>this._githubIntegrationSrv.getGitHubMemberById(e.accountId,t)))).call(i,(e=>e))).call(r,(e=>TaskListsController_objectSpread({},e)))));return t._members},set:e=>{t._members=e,t._memberIds=null}}),F()(t,"memberIds",{get:()=>{var e;t._memberIds||(t._memberIds=new(ke())(t.membersCount>0?x()(e=t.members).call(e,(e=>{let{id:t}=e;return t})):[te.$d]));return t._memberIds}}),t}},{kind:"method",key:"_isTaskListCardVisible",value:function _isTaskListCardVisible(e){return!!e.isTempCard||(!e.hasDates||!this._githubCollectionSettings.global.taskLists.filters.onlyUnscheduled)&&!!this._githubCardsSrv.isCalendarCardVisible(e.calendarCard)}},{kind:"get",key:"_editCardDialogOpenerContext",value:function _editCardDialogOpenerContext(){return this._editCardDialogOpenerContextLazy||(this._editCardDialogOpenerContextLazy={setupCompactDialogPosition:e=>{switch(this._appCommonSrv.getLayoutOrientation()){case LayoutOrientation.VerticalReverse:e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_START,this._$mdPanel.yPosition.CENTER);break;case LayoutOrientation.Vertical:e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_END,this._$mdPanel.yPosition.CENTER)}},reattachCardElement:e=>{var t;return M()(t=this._$element).call(t,`.pw-tasks-card[data-id="${e.data("id")}"]`)},telemetryWhere:i.a6.TaskLists}),this._editCardDialogOpenerContextLazy}},{kind:"method",key:"_getCardInsertPosition",value:function _getCardInsertPosition(e,t){var r,i;const n=Y()(r=me()(tt()(i=this._loadedCardsMap).call(i))).call(r,compareTaskListCards);let a=e[t-1];a||(a=e.length>0?n[l()(n).call(n,e[0])-1]:ct()(n).call(n,-1));const o=a?n[l()(n).call(n,a)+1]:n[0];let s;return s=a||o?a?o?(a.position+o.position)/2:a.position+ht:o.position/2:ht,{position:s,afterCard:a}}}]}}));var vt=r(96115),mt=r.n(vt);function WorkPanelController_getDecoratorsApi(){WorkPanelController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!WorkPanelController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=WorkPanelController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:WorkPanelController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=WorkPanelController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function WorkPanelController_createElementDescriptor(e){var t,r=WorkPanelController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function WorkPanelController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function WorkPanelController_hasDecorators(e){return e.decorators&&e.decorators.length}function WorkPanelController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function WorkPanelController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function WorkPanelController_toPropertyKey(e){var t=function WorkPanelController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ft="toggleExpand";let Ct=function WorkPanelController_decorate(e,t,r,i){var n,a=WorkPanelController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function WorkPanelController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(WorkPanelController_isDataDescriptor(n.descriptor)||WorkPanelController_isDataDescriptor(i.descriptor)){if(WorkPanelController_hasDecorators(n)||WorkPanelController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(WorkPanelController_hasDecorators(n)){if(WorkPanelController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}WorkPanelController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,WorkPanelController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$rootScope","$scope","$translate","appCommonSrv","collectionSrv","dialogSrv","githubIntegrationSrv","licenseSrv","planywayIntegrationSrv","platformSrv","reportSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class WorkPanelController{constructor(t,r,n,a,o,s,l,c,d,u,h,p,v){e(this),this._$rootScope=t,this._$scope=r,this._$translate=n,this._appCommonSrv=a,this._collectionSrv=o,this._dialogSrv=s,this._githubIntegrationSrv=l,this._licenseSrv=c,this._planywayIntegrationSrv=d,this._platformSrv=u,this._reportSrv=h,this._settingsSrv=p,this._telemetrySrv=v;const reloadSelectedProjects=()=>{this._currentProject=null,this._isTaskListsAvailable=void 0,this._isCreateProjectCalloutAvailable=!0,this._isAddProjectCalloutAvailable=!1;for(let e of this._provider.getCurrentCollectionConnectedAccounts()){if(!this._provider.isCurrentCollectionAccountReady(e.accountId)){this._isCreateProjectCalloutAvailable=!1,this._isAddProjectCalloutAvailable=!1;break}this._githubIntegrationSrv.getGitHubProjects(e.accountId).length>0&&(this._isCreateProjectCalloutAvailable=!1,this._isAddProjectCalloutAvailable=!0)}};reloadSelectedProjects(),this._githubIntegrationSrv.addGitHubProjectEventListener("updated",reloadSelectedProjects),this._githubIntegrationSrv.addGitHubProjectEventListener("deleted",reloadSelectedProjects),this._$scope.$on(i.FK.CollectionAccountReady,reloadSelectedProjects),this._$scope.$on(i.FK.CollectionChanged,reloadSelectedProjects),this._$scope.$on(i.FK.CalendarsChanged,reloadSelectedProjects),this._$scope.$on(i.FK.GitHubProjectSelectionChanged,reloadSelectedProjects);const onSourceChanged=()=>{this._availableTaskListsViews=null,this._availableTaskListViewModes=null};this._$scope.$on(i.FK.CollectionChanging,onSourceChanged),this._$scope.$on(i.FK.ChangeSchedulerViewRequested,onSourceChanged),this._$scope.$on(i.FK.AccountAdded,onSourceChanged),this._$scope.$on(i.FK.AccountDeleted,onSourceChanged),this._$scope.$on("$destroy",(()=>{this._githubIntegrationSrv.removeGitHubProjectEventListener("updated",reloadSelectedProjects),this._githubIntegrationSrv.removeGitHubProjectEventListener("deleted",reloadSelectedProjects)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubWorkPanelCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.GitHub)},{kind:"get",key:"isTaskListsAvailable",value:function isTaskListsAvailable(){return void 0===this._isTaskListsAvailable&&(this._isTaskListsAvailable=this._provider.hasCurrentCollectionSelectedCalendars()),this._isTaskListsAvailable}},{kind:"get",key:"isCreateProjectCalloutAvailable",value:function isCreateProjectCalloutAvailable(){return this._isCreateProjectCalloutAvailable}},{kind:"get",key:"isAddProjectCalloutAvailable",value:function isAddProjectCalloutAvailable(){return this._isAddProjectCalloutAvailable}},{kind:"get",key:"calloutImageUrl",value:function calloutImageUrl(){return this._calloutImageUrl||(this._calloutImageUrl=this._platformSrv.getPlatformUrl(mt())),this._calloutImageUrl}},{kind:"get",key:"currentProject",value:function currentProject(){if(!this._currentProject){var e;let t=this._githubCollectionSettings.global.taskLists.projectId,r=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return x()(t=this._provider.getCurrentCollectionSelectedCalendarIds(e)).call(t,(t=>({accountId:e,calendarId:t})))})),i=M()(r).call(r,(e=>e.calendarId===t))||r[0];this.currentProject=this._githubIntegrationSrv.getGitHubProjectById(i.accountId,i.calendarId)}return this._currentProject}},{kind:"set",key:"currentProject",value:function currentProject(e){if(this._currentProject===e)return;let t=this._currentProject&&e;this._currentProject=e,t&&(this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.TaskListsGitHubProjectSwitched),this._githubCollectionSettings.global.taskLists.projectId=this._currentProject.id,this._collectionSettings.global.saveAsync(),this._$rootScope.$broadcast(i.FK.GitHubTaskListsProjectChanged))}},{kind:"method",key:"addProjectToCollectionAsync",value:async function addProjectToCollectionAsync(e){let t=this._provider.getCurrentCollectionConnectedAccounts(),r=M()(t).call(t,(e=>e.isPrimary))||t[0];this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogOpened,{accountType:r.accountType,where:i.Zz.TaskLists});let n=await this._dialogSrv.showManageAccountCalendarsDialogAsync(r,e);n?(this._$rootScope.$broadcast(i.FK.CalendarsChanging,r),n.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarAdded,{accountType:r.accountType,count:n.connectedCalendarIds.length}),n.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:r.accountType,count:n.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:r.accountType,where:i.Zz.TaskLists})}},{kind:"method",key:"createProjectAsync",value:async function createProjectAsync(e){let t=this._provider.getCurrentCollectionConnectedAccounts(),r=M()(t).call(t,(e=>e.isPrimary))||t[0];this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogOpened,{where:i.bs.TaskLists}),await this._dialogSrv.showGitHubProjectDialogAsync(e,{account:r})||this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.CreateGitHubProjectDialogClosed,{where:i.bs.TaskLists})}},{kind:"get",key:"setCalendarHandler",value:function setCalendarHandler(){return this._setCalendarHandler||(this._setCalendarHandler=e=>this.currentProject=e),this._setCalendarHandler}},{kind:"method",key:"isToolbarButtonAvailable",value:function isToolbarButtonAvailable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q()(t).call(t,(e=>e!==ft))}},{kind:"get",key:"isBoardMode",value:function isBoardMode(){return this._appCommonSrv.getSchedulerMode(!0)===i.ud.Board}},{kind:"get",key:"taskListsView",value:function taskListsView(){return this._githubCollectionSettings.global.taskLists.view}},{kind:"get",key:"availableTaskListsViews",value:function availableTaskListsViews(){return this._availableTaskListsViews||(this._availableTaskListsViews=[{value:i.cT.Kanban,icon:"kanban-outline",title:"MISC.KANBAN"},{value:i.cT.List,icon:"list-outline",title:"MISC.LIST"}]),this._availableTaskListsViews}},{kind:"get",key:"selectedTaskListsView",value:function selectedTaskListsView(){var e;return M()(e=this.availableTaskListsViews).call(e,(e=>e.value===this.taskListsView))}},{kind:"set",key:"selectedTaskListsView",value:function selectedTaskListsView(e){this.selectedTaskListsView!==e.value&&(this._availableTaskListViewModes=null,this._githubCollectionSettings.global.taskLists.view=e.value,this._collectionSettings.global.saveAsync(),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.TaskListsViewModeChanged,{taskListsView:e.value}),this._$rootScope.$broadcast(i.FK.TaskListsViewChanged))}},{kind:"method",key:"onViewMenuOpen",value:function onViewMenuOpen(){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.TaskListsViewModeMenuOpened)}},{kind:"get",key:"taskListsViewMode",value:function taskListsViewMode(){let taskListsViewMode=this._githubCollectionSettings.global.taskLists.viewSettings[this.taskListsView].mode,e=i.or[taskListsViewMode];if(e&&!this._licenseSrv.checkPaidFeatureAvailable(e,!1))switch(this.taskListsView){case i.cT.Kanban:return i.e_.None;case i.cT.List:return i.e_.List}return taskListsViewMode}},{kind:"get",key:"availableTaskListViewModes",value:function availableTaskListViewModes(){if(!this._availableTaskListViewModes){switch(this.taskListsView){case i.cT.Kanban:this._availableTaskListViewModes=[{value:i.e_.Member,icon:"icons-16:timeline-members-outline",title:this._$translate.instant("MENU.ASSIGNEE")},{value:i.e_.Label,icon:"icons-16:timeline-labels-outline",title:this._$translate.instant("MENU.LABEL")},{value:i.e_.None,icon:"icons-16:timeline-no-grouping-outline",title:this._$translate.instant("MENU.NO_GROUPING")}];break;case i.cT.List:this._availableTaskListViewModes=[{value:i.e_.Member,icon:"icons-16:timeline-members-outline",title:this._$translate.instant("MENU.ASSIGNEE")},{value:i.e_.Label,icon:"icons-16:timeline-labels-outline",title:this._$translate.instant("MENU.LABEL")},{value:i.e_.List,icon:"icons-16:timeline-lists-outline",title:this._$translate.instant("MENU.STATUS")}]}for(let e of this._availableTaskListViewModes)e.subtitle=this._$translate.instant("MENU.GROUP_BY")}return this._availableTaskListViewModes}},{kind:"get",key:"selectedTaskListViewMode",value:function selectedTaskListViewMode(){var e;return null===(e=this.availableTaskListViewModes)||void 0===e?void 0:M()(e).call(e,(e=>e.value===this.taskListsViewMode))}},{kind:"set",key:"selectedTaskListViewMode",value:function selectedTaskListViewMode(e){if(this.selectedTaskListViewMode===e)return;let t=i.or[e.value];t&&!this._licenseSrv.checkPaidFeatureAvailable(t,!0)||(this._githubCollectionSettings.global.taskLists.viewSettings[this.taskListsView].mode=e.value,this._$rootScope.$broadcast(i.FK.TaskListsViewChanged),this._collectionSettings.global.saveAsync(),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.ViewModeChanged,{where:i.gV.TaskListToolbar}))}},{kind:"method",key:"onViewModeMenuOpen",value:function onViewModeMenuOpen(){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.ViewModeMenuOpened,{where:i.gV.TaskListToolbar})}},{kind:"get",key:"isOnlyUnscheduledShown",value:function isOnlyUnscheduledShown(){return this._githubCollectionSettings.global.taskLists.filters.onlyUnscheduled}},{kind:"set",key:"isOnlyUnscheduledShown",value:function isOnlyUnscheduledShown(e){this.isOnlyUnscheduledShown!==e&&(this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.TaskListsFiltersChanged,{taskListsOnlyUnscheduled:e}),this._githubCollectionSettings.global.taskLists.filters.onlyUnscheduled=e,this._collectionSettings.global.saveAsync(),this._$scope.$broadcast(i.FK.FiltersChanged))}},{kind:"method",key:"exportAsync",value:async function exportAsync(e){var t;if(!this._licenseSrv.checkPaidFeatureAvailable(i.ZV.ExportToFile,!0))return;this._telemetrySrv.logSessionEvent(i.cN.GeneralEvents.ReportBuilt,{type:i.C2.BoardCards,fileType:e});const r=M()(t=this._reportSrv.availableReports).call(t,(e=>e.type===i.C2.BoardCards));await r.buildAsync(e,{calendarId:this.currentProject.id,isOnlyUnscheduledShown:this.isOnlyUnscheduledShown})}},{kind:"get",key:"canRemoveProjectFromCollection",value:function canRemoveProjectFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeProjectFromCollection",value:function removeProjectFromCollection(e){var t;let r=M()(t=this._provider.getCurrentCollectionConnectedAccounts()).call(t,(t=>t.accountId===e.accountId)),n=this._provider.getCurrentCollectionConnectedCalendar(r.accountId,e.id);n.isConnected=!1,this._provider.setCurrentCollectionConnectedCalendars(r.accountId,[n]),this._$rootScope.$broadcast(i.FK.CalendarsChanging,r),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.GitHub,count:1})}},{kind:"method",key:"canCloseProject",value:function canCloseProject(e){return!e.isReadOnly}},{kind:"method",key:"closeProjectAsync",value:async function closeProjectAsync(e){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.CLOSE_GITHUB_PROJECT_TITLE"),this._$translate.instant("DIALOGS.CLOSE_GITHUB_PROJECT_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))try{this._appCommonSrv.setSchedulerBusy(!0),await this._githubIntegrationSrv.updateProjectAsync(e.accountId,e.id,{closed:!0}),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.GitHubProjectClosed,{where:i.bs.TaskLists}),this._currentProject=null,this._notifyGitHubProjectsSelectionChanged()}catch(e){this._$log.error("GitHub close project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub close project error",e,{class:this.constructor.name,method:this.closeProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CLOSE_GITHUB_PROJECT_ERROR"),i.k$.Error)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"canDeleteProject",value:function canDeleteProject(e){return!e.isReadOnly}},{kind:"method",key:"deleteProjectAsync",value:async function deleteProjectAsync(e){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.DELETE_GITHUB_PROJECT_TITLE"),this._$translate.instant("DIALOGS.DELETE_GITHUB_PROJECT_CONFIRM"),{buttons:[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))try{this._appCommonSrv.setSchedulerBusy(!0),await this._githubIntegrationSrv.deleteProjectAsync(e.accountId,e.id),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.GitHubProjectDeleted,{where:i.bs.TaskLists}),this._currentProject=null,this._notifyGitHubProjectsSelectionChanged()}catch(e){this._$log.error("GitHub delete project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub delete project error",e,{class:this.constructor.name,method:this.deleteProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_GITHUB_PROJECT_ERROR"),i.k$.Error)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"expandWorkPanel",value:function expandWorkPanel(){this._appCommonSrv.setExpandedLayoutPanel(i.sF.WorkPanel),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.LayoutPanelExpanded,{expandedLayoutPanel:i.sF.WorkPanel,by:i.UR.ToolbarButton})}},{kind:"method",key:"collapseWorkPanel",value:function collapseWorkPanel(){this._appCommonSrv.setExpandedLayoutPanel(null),this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.LayoutPanelCollapsed,{collapsedLayoutPanel:i.sF.WorkPanel,by:i.UR.ToolbarButton})}},{kind:"get",key:"isWorkPanelExpanded",value:function isWorkPanelExpanded(){return this._appCommonSrv.getExpandedLayoutPanel()===i.sF.WorkPanel}},{kind:"get",key:"isWorkPanelWidthCompact",value:function isWorkPanelWidthCompact(){return this._isWorkPanelWidthCompact}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_githubCollectionSettings",value:function _githubCollectionSettings(){return{local:this._collectionSettings.local.settings.provider[i.lP.GitHub],global:this._collectionSettings.global.settings.provider[i.lP.GitHub]}}},{kind:"method",key:"_notifyGitHubProjectsSelectionChanged",value:function _notifyGitHubProjectsSelectionChanged(){this._$rootScope.$broadcast(i.FK.CardsReloaded),this._$rootScope.$broadcast(i.FK.GitHubProjectSelectionChanged),this._$rootScope.$broadcast(i.FK.ChangeSchedulerViewRequested),this._$rootScope.$broadcast(i.FK.WorkPanelReloaded);for(let e of[i.y.Calendars,i.y.GitHubLabels,i.y.GitHubStatuses,i.y.GitHubAssignees])this._$rootScope.$broadcast(i.FK.TimelineResourcesReloaded,{resourcesType:e})}}]}}));var yt=r(62494),gt=r.n(yt);function CalendarIconDirective_getDecoratorsApi(){CalendarIconDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CalendarIconDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarIconDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarIconDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarIconDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarIconDirective_createElementDescriptor(e){var t,r=CalendarIconDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CalendarIconDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarIconDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarIconDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarIconDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarIconDirective_toPropertyKey(e){var t=function CalendarIconDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let _t=function CalendarIconDirective_decorate(e,t,r,i){var n,a=CalendarIconDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CalendarIconDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CalendarIconDirective_isDataDescriptor(n.descriptor)||CalendarIconDirective_isDataDescriptor(i.descriptor)){if(CalendarIconDirective_hasDecorators(n)||CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CalendarIconDirective_hasDecorators(n)){if(CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CalendarIconDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CalendarIconDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarIconDirective{constructor(){e(this),this.templateUrl=gt(),this.restrict="E",this.controller=CalendarIconController.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={_iconSize:"@?iconSize"}}}return{F:CalendarIconDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubProjectIcon"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CalendarIconDirective}}]}}));var kt=r(77169),wt=r.n(kt);function CalendarPickerDirective_getDecoratorsApi(){CalendarPickerDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CalendarPickerDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarPickerDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarPickerDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarPickerDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarPickerDirective_createElementDescriptor(e){var t,r=CalendarPickerDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CalendarPickerDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarPickerDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarPickerDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarPickerDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarPickerDirective_toPropertyKey(e){var t=function CalendarPickerDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let bt=function CalendarPickerDirective_decorate(e,t,r,i){var n,a=CalendarPickerDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CalendarPickerDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CalendarPickerDirective_isDataDescriptor(n.descriptor)||CalendarPickerDirective_isDataDescriptor(i.descriptor)){if(CalendarPickerDirective_hasDecorators(n)||CalendarPickerDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CalendarPickerDirective_hasDecorators(n)){if(CalendarPickerDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CalendarPickerDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CalendarPickerDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarPickerDirective{constructor(){e(this),this.templateUrl=wt(),this.restrict="E",this.controller=W.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={account:"<",calendars:"=",filterText:"<"}}}return{F:CalendarPickerDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubCalendarsPicker"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CalendarPickerDirective}}]}}));var Dt=r(21577),Et=r.n(Dt);function CardContextMenuDirective_getDecoratorsApi(){CardContextMenuDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CardContextMenuDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardContextMenuDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardContextMenuDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardContextMenuDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardContextMenuDirective_createElementDescriptor(e){var t,r=CardContextMenuDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CardContextMenuDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardContextMenuDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CardContextMenuDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardContextMenuDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardContextMenuDirective_toPropertyKey(e){var t=function CardContextMenuDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let St=function CardContextMenuDirective_decorate(e,t,r,i){var n,a=CardContextMenuDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CardContextMenuDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CardContextMenuDirective_isDataDescriptor(n.descriptor)||CardContextMenuDirective_isDataDescriptor(i.descriptor)){if(CardContextMenuDirective_hasDecorators(n)||CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CardContextMenuDirective_hasDecorators(n)){if(CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CardContextMenuDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CardContextMenuDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CardContextMenuDirective{constructor(){e(this),this.templateUrl=Et(),this.restrict="E",this.controller=pe.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={onSetContextMenu:"<",_source:"<source"}}}return{F:CardContextMenuDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubCardContextMenu"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CardContextMenuDirective}}]}}));var At=r(16070),It=r.n(At);class CardEditorDirective{static get directiveName(){return"pwGithubCardEditor"}static create(){return new CardEditorDirective}constructor(){this.templateUrl=It(),this.restrict="E",this.controller=He.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarCard:"<",isDetailed:"<?",isDense:"<?",hasChanges:"<?",_dialogOpenerContext:"<dialogOpenerContext",_forceDetailedMode:"<forceDetailedMode"}}link(e){e.$ctrl.initialize()}}var Pt=r(39803),Tt=r.n(Pt);function SidebarPanelDirective_getDecoratorsApi(){SidebarPanelDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!SidebarPanelDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=SidebarPanelDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:SidebarPanelDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=SidebarPanelDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function SidebarPanelDirective_createElementDescriptor(e){var t,r=SidebarPanelDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function SidebarPanelDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function SidebarPanelDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function SidebarPanelDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function SidebarPanelDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function SidebarPanelDirective_toPropertyKey(e){var t=function SidebarPanelDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let xt=function SidebarPanelDirective_decorate(e,t,r,i){var n,a=SidebarPanelDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function SidebarPanelDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(SidebarPanelDirective_isDataDescriptor(n.descriptor)||SidebarPanelDirective_isDataDescriptor(i.descriptor)){if(SidebarPanelDirective_hasDecorators(n)||SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(SidebarPanelDirective_hasDecorators(n)){if(SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}SidebarPanelDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,SidebarPanelDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class SidebarPanelDirective{constructor(){e(this),this.templateUrl=Tt(),this.restrict="E",this.controller=Ye.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={}}}return{F:SidebarPanelDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubSidebarPanel"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new SidebarPanelDirective}}]}}));var Rt=r(70903),$t=r.n(Rt);function TaskListCardDirective_getDecoratorsApi(){TaskListCardDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListCardDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListCardDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListCardDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListCardDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListCardDirective_createElementDescriptor(e){var t,r=TaskListCardDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListCardDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListCardDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListCardDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListCardDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListCardDirective_toPropertyKey(e){var t=function TaskListCardDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Lt=function TaskListCardDirective_decorate(e,t,r,i){var n,a=TaskListCardDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListCardDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListCardDirective_isDataDescriptor(n.descriptor)||TaskListCardDirective_isDataDescriptor(i.descriptor)){if(TaskListCardDirective_hasDecorators(n)||TaskListCardDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListCardDirective_hasDecorators(n)){if(TaskListCardDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListCardDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListCardDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class TaskListCardDirective{constructor(){e(this),this.templateUrl=$t(),this.restrict="E",this.controller=Xe.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={_card:"=card",_isTaskListCardCreating:"<isTaskListCardCreating",onOpenCardContextMenu:"&"}}}return{F:TaskListCardDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubTaskListCard"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new TaskListCardDirective}}]}}));var Mt=r(33491),Nt=r.n(Mt);function TaskListContextMenuDirective_getDecoratorsApi(){TaskListContextMenuDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListContextMenuDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListContextMenuDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListContextMenuDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListContextMenuDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListContextMenuDirective_createElementDescriptor(e){var t,r=TaskListContextMenuDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListContextMenuDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListContextMenuDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListContextMenuDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListContextMenuDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListContextMenuDirective_toPropertyKey(e){var t=function TaskListContextMenuDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Ft=function TaskListContextMenuDirective_decorate(e,t,r,i){var n,a=TaskListContextMenuDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListContextMenuDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListContextMenuDirective_isDataDescriptor(n.descriptor)||TaskListContextMenuDirective_isDataDescriptor(i.descriptor)){if(TaskListContextMenuDirective_hasDecorators(n)||TaskListContextMenuDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListContextMenuDirective_hasDecorators(n)){if(TaskListContextMenuDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListContextMenuDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListContextMenuDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class TaskListContextMenuDirective{constructor(){e(this),this.templateUrl=Nt(),this.restrict="E",this.controller=Je.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={onSetContextMenu:"&",onSortTaskList:"&"}}}return{F:TaskListContextMenuDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubTaskListContextMenu"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new TaskListContextMenuDirective}}]}}));var Gt=r(74782),Ot=r.n(Gt);function TaskListsDirective_getDecoratorsApi(){TaskListsDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!TaskListsDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=TaskListsDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:TaskListsDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=TaskListsDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function TaskListsDirective_createElementDescriptor(e){var t,r=TaskListsDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function TaskListsDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function TaskListsDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function TaskListsDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function TaskListsDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function TaskListsDirective_toPropertyKey(e){var t=function TaskListsDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let zt=function TaskListsDirective_decorate(e,t,r,i){var n,a=TaskListsDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function TaskListsDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(TaskListsDirective_isDataDescriptor(n.descriptor)||TaskListsDirective_isDataDescriptor(i.descriptor)){if(TaskListsDirective_hasDecorators(n)||TaskListsDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(TaskListsDirective_hasDecorators(n)){if(TaskListsDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}TaskListsDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,TaskListsDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class TaskListsDirective{constructor(t,r,i,n,a){e(this),this._$rootScope=t,this._$window=r,this._$timeout=i,this._$mdMenu=n,this._appCommonSrv=a,this.templateUrl=Ot(),this.restrict="E",this.controller=pt.controllerName,this.controllerAs="$ctrl",this.scope={}}}return{F:TaskListsDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubTasksLists"}},{kind:"method",decorators:[(0,U.SG)(["$rootScope","$window","$timeout","$mdMenu","appCommonSrv"])],static:!0,key:"create",value:function create(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new TaskListsDirective(...t)}},{kind:"method",key:"link",value:function link(e,t){const r=J()("body");t.on("click",".pw-tasks-card",(t=>{let r=J()(t.target),i=r.closest(".pw-tasks-card");i[0]&&(r.closest(".pw-js-tasks-list-item-date-time-picker-range")[0]||e.$ctrl.showEditCardDialogAsync(i.data("id"),i))}));let n,a,o=!1;t.on("contextmenu",".pw-tasks-lane__list-header",(t=>{let r=J()(t.target);if(r.is("input:focus"))return;let i=r.closest(".pw-tasks-lane__list-header");if(!i[0])return;if(t.preventDefault(),t.stopPropagation(),o)return;o=!0,this._$timeout((()=>o=!1),250,!1);let n=i.data("list-id");e.$ctrl.openTaskListContextMenu(n,t)})),t.on("contextmenu",".pw-tasks-card",(t=>{let r=J()(t.target);if(r.is("input:focus"))return;let i=r.closest(".pw-tasks-card");if(!i[0]||i.is(".pw-js-tasks-list-card-create-panel"))return;if(t.preventDefault(),t.stopPropagation(),o)return;o=!0,this._$timeout((()=>o=!1),250,!1);let n=i.data("id"),a=i.data("account-id");e.$ctrl.openCardContextMenu(a,n,t)})),t.on("mousedown",".pw-js-tasks-list-create-panel, .pw-js-tasks-list-card-create-panel, .pw-js-tasks-list-edit-panel",(e=>{J()(e.target).is("input, textarea")||e.preventDefault()})),t.on("keydown",".pw-js-tasks-list-create-panel",(t=>{switch(t.stopPropagation(),t.which){case i.VD.Enter:case i.VD.Enter2:e.$ctrl.submitTaskListCreating();break;case i.VD.Escape:e.$ctrl.rejectTaskListCreating()}})),t.on("keydown",".pw-js-tasks-list-edit-panel",(t=>{switch(t.stopPropagation(),t.which){case i.VD.Enter:case i.VD.Enter2:case i.VD.Escape:e.$ctrl.submitTaskListEditing()}})),t.on("keydown",".pw-js-tasks-list-card-create-panel",(t=>{switch(t.stopPropagation(),t.which){case i.VD.Enter:case i.VD.Enter2:e.$ctrl.submitCardCreating();break;case i.VD.Escape:e.$ctrl.rejectCardCreating()}}));let s,l,c,d=!1,u=!1;const onDocumentMousedown=o=>{let u=J()(o.target);if(!u.closest(".md-dialog-container, .md-panel")[0]){if(e.$ctrl.isTaskListCardCreating()&&!u.closest(".pw-js-tasks-list-card-create-panel")[0]&&!u.closest(".pw-date-time-picker-range__content")[0]&&!u.closest(".pw-date-time-picker-range__time-picker")[0]&&!u.closest(".k-timepicker-list")[0]&&!u.closest(".pw-menu-github-members-content")[0]&&!M()(r).call(r,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0])return n=u,void(a=()=>e.$ctrl.submitCardCreating());n=null,e.$ctrl.isBusy||0!==u.closest(t).length&&0===u.closest(".pw-js-not-grabbable").length&&0===u.closest(".md-button").length&&(o.which===i.Jm.Middle&&o.preventDefault(),c&&c[0]||(c=M()(t).call(t,".pw-js-tasks-list-scrollable-container")),d=!0,t.addClass("pw-task-lists--grab"),s={x:o.pageX,y:o.pageY},l={top:c.scrollTop(),left:c.scrollLeft()})}},onDocumentDragstart=()=>{n=null},onDocumentMousemove=e=>{if(d){if(0===e.buttons)return d=!1,u=!1,void t.removeClass("pw-task-lists--grab pw-task-lists--grabbing");e.preventDefault(),u||(u=!0,t.addClass("pw-task-lists--grabbing")),c.scrollTop(l.top-(e.pageY-s.y)),c.scrollLeft(l.left-(e.pageX-s.x))}},onDocumentMouseup=e=>{n&&(e.target!==n[0]&&n.trigger("click"),n=null),a&&(a(),a=null),(d||u)&&(d=!1,u=!1,t.removeClass("pw-task-lists--grab pw-task-lists--grabbing"))},onDocumentKeydown=r=>{if(i.gD.has(r.keyCode)){if(J()(r.target).is("input, textarea"))return;let i=M()(t).call(t,".pw-tasks-card:hover");if(0===i.length||i.is(".pw-js-tasks-list-card-create-panel"))return;r.preventDefault(),r.stopPropagation();let n=i.data("id"),a=i.data("account-id");e.$ctrl.updateCardByHotkey(a,n,r.keyCode,{altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey})}};this._$window.document.addEventListener("mousedown",onDocumentMousedown,!0),this._$window.document.addEventListener("pwMouseDown",onDocumentMousedown,!0),this._$window.document.addEventListener("dragstart",onDocumentDragstart,!0),this._$window.document.addEventListener("pwDragStart",onDocumentDragstart,!0),this._$window.document.addEventListener("mousemove",onDocumentMousemove,!0),this._$window.document.addEventListener("pwMouseMove",onDocumentMousemove,!0),this._$window.document.addEventListener("mouseup",onDocumentMouseup,!0),this._$window.document.addEventListener("pwMouseUp",onDocumentMouseup,!0),this._$window.document.addEventListener("keydown",onDocumentKeydown,!0),e.$on("$destroy",(()=>{this._$window.document.removeEventListener("mousedown",onDocumentMousedown,!0),this._$window.document.removeEventListener("pwMouseDown",onDocumentMousedown,!0),this._$window.document.removeEventListener("dragstart",onDocumentDragstart,!0),this._$window.document.removeEventListener("pwDragStart",onDocumentDragstart,!0),this._$window.document.removeEventListener("mousemove",onDocumentMousemove,!0),this._$window.document.removeEventListener("pwMouseMove",onDocumentMousemove,!0),this._$window.document.removeEventListener("mouseup",onDocumentMouseup,!0),this._$window.document.removeEventListener("pwMouseUp",onDocumentMouseup,!0),this._$window.document.removeEventListener("keydown",onDocumentKeydown,!0)}))}}]}}));var jt=r(15776),Ut=r.n(jt);function WorkPanelDirective_getDecoratorsApi(){WorkPanelDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!WorkPanelDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=WorkPanelDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:WorkPanelDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=WorkPanelDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function WorkPanelDirective_createElementDescriptor(e){var t,r=WorkPanelDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function WorkPanelDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function WorkPanelDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function WorkPanelDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function WorkPanelDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function WorkPanelDirective_toPropertyKey(e){var t=function WorkPanelDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Bt=function WorkPanelDirective_decorate(e,t,r,i){var n,a=WorkPanelDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function WorkPanelDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(WorkPanelDirective_isDataDescriptor(n.descriptor)||WorkPanelDirective_isDataDescriptor(i.descriptor)){if(WorkPanelDirective_hasDecorators(n)||WorkPanelDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(WorkPanelDirective_hasDecorators(n)){if(WorkPanelDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}WorkPanelDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,WorkPanelDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class WorkPanelDirective{constructor(){e(this),this.templateUrl=Ut(),this.restrict="E",this.controller=Ct.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={_isWorkPanelWidthCompact:"=isWorkPanelWidthCompact"}}}return{F:WorkPanelDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGithubWorkPanel"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new WorkPanelDirective}}]}}));const Ht={services:[],controllers:[CalendarIconController,W,pe,He,qe,Qe.s,Ye,Xe,Je,pt,Ct],directives:[_t,bt,St,CardEditorDirective,xt,Lt,Ft,zt,Bt]};function CalendarIconController_getDecoratorsApi(){CalendarIconController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CalendarIconController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarIconController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarIconController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarIconController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarIconController_createElementDescriptor(e){var t,r=CalendarIconController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CalendarIconController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarIconController_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarIconController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarIconController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarIconController_toPropertyKey(e){var t=function CalendarIconController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Kt=function CalendarIconController_decorate(e,t,r,i){var n,a=CalendarIconController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CalendarIconController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CalendarIconController_isDataDescriptor(n.descriptor)||CalendarIconController_isDataDescriptor(i.descriptor)){if(CalendarIconController_hasDecorators(n)||CalendarIconController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CalendarIconController_hasDecorators(n)){if(CalendarIconController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CalendarIconController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CalendarIconController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$scope","googleIntegrationSrv"])],(function(e){return{F:class CalendarIconController{constructor(t,r){e(this),this._$scope=t,this._googleIntegrationSrv=r,this._iconSize="small",this._$scope.$on("$destroy",(()=>{this._onGoogleCalendarUpdated&&(this._googleIntegrationSrv.removeGoogleCalendarEventListener("updated",this._onGoogleCalendarUpdated),this._onGoogleCalendarUpdated=null)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleCalendarIconCtrl"}},{kind:"get",key:"iconSize",value:function iconSize(){return this._iconSize}},{kind:"set",key:"calendarId",value:function calendarId(e){this._calendarId=e,this._loadCalendar()}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e,this._loadCalendar()}},{kind:"get",key:"calendarColor",value:function calendarColor(){return this._calendarColor}},{kind:"method",key:"_loadCalendar",value:function _loadCalendar(){if(!this._calendarId||!this._accountId)return;let e=this._googleIntegrationSrv.getGoogleCalendarById(this._accountId,this._calendarId);if(e){let t=e.color.base,r=this._calendarColor!==t;this._calendarColor=t,r&&this._$scope.$broadcast("$$rebind::calendar")}this._onGoogleCalendarUpdated||(this._onGoogleCalendarUpdated=e=>{e.id===this._calendarId&&(this._loadCalendar(),this._$scope.$broadcast("$$rebind::calendar"))},this._googleIntegrationSrv.addGoogleCalendarEventListener("updated",this._onGoogleCalendarUpdated))}}]}}));r(21695);function CalendarPickerController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function CalendarPickerController_getDecoratorsApi(){CalendarPickerController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!CalendarPickerController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarPickerController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarPickerController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarPickerController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarPickerController_createElementDescriptor(e){var t,r=CalendarPickerController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function CalendarPickerController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarPickerController_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarPickerController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarPickerController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarPickerController_toPropertyKey(e){var t=function CalendarPickerController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Vt=function CalendarPickerController_decorate(e,t,r,i){var n,a=CalendarPickerController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function CalendarPickerController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(CalendarPickerController_isDataDescriptor(n.descriptor)||CalendarPickerController_isDataDescriptor(i.descriptor)){if(CalendarPickerController_hasDecorators(n)||CalendarPickerController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(CalendarPickerController_hasDecorators(n)){if(CalendarPickerController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}CalendarPickerController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,CalendarPickerController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$scope","googleIntegrationSrv","licenseSrv","platformSrv"])],(function(e){return{F:class CalendarPickerController{constructor(t,r,i,n){e(this),this._$scope=t,this._googleIntegrationSrv=r,this._licenseSrv=i,this._platformSrv=n}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleCalendarPickerCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.Google)},{kind:"field",key:"account",value:void 0},{kind:"get",key:"filterText",value:function filterText(){return this._filterText||""}},{kind:"set",key:"filterText",value:function filterText(e){this._filterText=e,this._filteredCalendars=null}},{kind:"get",key:"filteredCalendars",value:function filteredCalendars(){var e;this._filteredCalendars||(this._filteredCalendars=A()(e=this.calendars).call(e,(e=>{var t;return $()(t=e.name.toLowerCase()).call(t,this.filterText.toLowerCase())})));return this._filteredCalendars}},{kind:"get",key:"calendars",value:function calendars(){if(!this._calendars){var e,t,r,a;let l=P()(e=A()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>e!==this.account.accountId))).call(e,(e=>this._provider.getCurrentCollectionConnectedCalendarIds(e)));var o;if(this._calendars=x()(r=A()(a=this._googleIntegrationSrv.getGoogleCalendars(this.account.accountId)).call(a,(e=>!$()(l).call(l,e.id)))).call(r,(e=>{e=function CalendarPickerController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=CalendarPickerController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=CalendarPickerController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}({},e);let t=this._provider.getCurrentCollectionConnectedCalendar(this.account.accountId,e.id);return F()(e,"isConnected",{get:()=>t.isConnected,set:e=>{(!e||this.account.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))&&(t.isConnected=e)}}),e})),this.account.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!1))if(Ce()(o=this._calendars).call(o,(e=>!e.isConnected))){var s;let e=M()(s=this._calendars).call(s,(e=>e.isPrimary));e&&(e.isConnected=!0)}}return this._calendars}},{kind:"set",key:"calendars",value:function calendars(e){this._calendars=e}},{kind:"get",key:"notFoundImgUrl",value:function notFoundImgUrl(){return this._platformSrv.getPlatformUrl(V())}}]}}));var Wt=r(45181),Zt=r.n(Wt),qt=r(83999);function controllers_CardContextMenuController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function controllers_CardContextMenuController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=controllers_CardContextMenuController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=controllers_CardContextMenuController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function controllers_CardContextMenuController_getDecoratorsApi(){controllers_CardContextMenuController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!controllers_CardContextMenuController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=controllers_CardContextMenuController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:controllers_CardContextMenuController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=controllers_CardContextMenuController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function controllers_CardContextMenuController_createElementDescriptor(e){var t,r=controllers_CardContextMenuController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function controllers_CardContextMenuController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function controllers_CardContextMenuController_hasDecorators(e){return e.decorators&&e.decorators.length}function controllers_CardContextMenuController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function controllers_CardContextMenuController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function controllers_CardContextMenuController_toPropertyKey(e){var t=function controllers_CardContextMenuController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Qt="complete",Yt="attendees",Xt="copyUrl",Jt="delete",er={[ee.eT.GoogleEvent]:[Qt,Yt,Xt,Jt]};let tr=function controllers_CardContextMenuController_decorate(e,t,r,i){var n,a=controllers_CardContextMenuController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function controllers_CardContextMenuController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(controllers_CardContextMenuController_isDataDescriptor(n.descriptor)||controllers_CardContextMenuController_isDataDescriptor(i.descriptor)){if(controllers_CardContextMenuController_hasDecorators(n)||controllers_CardContextMenuController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(controllers_CardContextMenuController_hasDecorators(n)){if(controllers_CardContextMenuController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}controllers_CardContextMenuController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,controllers_CardContextMenuController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$scope","collectionSrv","googleIntegrationSrv","licenseSrv"])],(function(e){return{F:class CardContextMenuController{constructor(t,r,n,a,o){e(this),this._$element=t,this._$scope=r,this._collectionSrv=n,this._googleIntegrationSrv=a,this._licenseSrv=o,this._$scope.$on(i.FK.OpenNestedContextMenuRequested,((e,t)=>{const{calendarCard:r,nestedMenu:n,source:a,sourceElement:o}=t;if(r.providerType!==i.lP.Google||this._source!==a)return;let s=new(J().Event)("contextmenu",{target:M()(o).call(o,`.k-event[data-uid="${r.uid}"]`)[0]}),l=this._getContextMenuScope(n);l&&(this._cardContextMenu=l.$mdMenu,this.setCardContextMenu(this._cardContextMenu),this.cardContextMenu.open(s,r),l.$once("$pwContextMenuClosed",(()=>{let e=this._getContextMenuScope("google-context");e&&(this._cardContextMenu=e.$mdMenu,this.setCardContextMenu(this._cardContextMenu))})))}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleEventContextMenuCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.Google)},{kind:"get",key:"source",value:function source(){return this._source}},{kind:"set",key:"source",value:function source(e){this._source=e}},{kind:"set",key:"onSetContextMenu",value:function onSetContextMenu(e){this._onSetContextMenu=e}},{kind:"get",key:"cardContextMenu",value:function cardContextMenu(){return this._cardContextMenu}},{kind:"method",key:"setCardContextMenu",value:function setCardContextMenu(e){this._cardContextMenu=e,this._onSetContextMenu({providerType:i.lP.Google,menuController:this._cardContextMenu})}},{kind:"method",key:"isContextMenuItemAvailable",value:function isContextMenuItemAvailable(){if(!this.cardContextMenu)return!1;let e=this.cardContextMenu.pwData;if(!e)return!1;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return q()(r).call(r,(t=>{var r,i,n;if(!(null===(r=er[e.cardType])||void 0===r?void 0:$()(r).call(r,t)))return!1;switch(t){case Qt:return!e.isReadOnly;case Yt:return!e.isReadOnly&&this.getContextMenuAttendees(e).length>0;case"copyAsTimeRecord":return q()(i=A()(n=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(n,(e=>e.timeTrackingCardType))).call(i,(e=>{var t;return q()(t=e.getCurrentCollectionConnectedAccountIds()).call(t,(t=>e.getCurrentCollectionSelectedCalendarIds(t).length>0))}));case"copyUrl":return!e.isTempCard;case Jt:return!e.isReadOnly}return!0}))}},{kind:"method",key:"toggleCardIsCompleted",value:function toggleCardIsCompleted(e){this._provider.toggleCardsIsCompletedAsync([e],{applyRecurringActionToHead:this._cardContextMenu.applyRecurringActionToHead,telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"getContextMenuAttendees",value:function getContextMenuAttendees(e){var t;if(!e)return[];if(!this._contextMenuAttendees||this._contextMenuAttendees.calendarCard!==e){var r;this._contextMenuAttendees={calendarCard:e};let t=[];t.push(...x()(r=this._googleIntegrationSrv.getGoogleContacts(e.accountId)).call(r,(e=>controllers_CardContextMenuController_objectSpread(controllers_CardContextMenuController_objectSpread({},e),{},{memberType:i.wO.Google}))));for(let r of e.providerCard.googleAttendees)q()(t).call(t,(e=>e.email===r.email))||t.push(controllers_CardContextMenuController_objectSpread(controllers_CardContextMenuController_objectSpread({},this._googleIntegrationSrv.getFakeContact(r.email)),{},{memberType:i.wO.Google}));this._newContactEmail&&t.push(controllers_CardContextMenuController_objectSpread(controllers_CardContextMenuController_objectSpread({},this._googleIntegrationSrv.getFakeContact(this._newContactEmail)),{},{memberType:i.wO.Google,isFakeFromSearch:!0})),this._contextMenuAttendees.availableAttendees=t}return Y()(t=this._contextMenuAttendees.availableAttendees).call(t,((t,r)=>(0,U.GI)(controllers_CardContextMenuController_objectSpread(controllers_CardContextMenuController_objectSpread({},t),{},{isSelected:this.isContextMenuAttendeeSelected(e,t)}),controllers_CardContextMenuController_objectSpread(controllers_CardContextMenuController_objectSpread({},r),{},{isSelected:this.isContextMenuAttendeeSelected(e,r)})))),this._contextMenuAttendees.availableAttendees}},{kind:"method",key:"isContextMenuAttendeeSelected",value:function isContextMenuAttendeeSelected(e,t){var r;return!!e&&q()(r=e.providerCard.googleAttendees).call(r,(e=>e.email===t.email))}},{kind:"get",key:"attendeeFilter",value:function attendeeFilter(){return this._attendeeFilter}},{kind:"set",key:"attendeeFilter",value:function attendeeFilter(e){this._attendeeFilter=e;let t=null;if(e){var r,i;this._attendeeFilterRegex=(0,U.n0)(e);let n=e.toLowerCase();!(0,qt.G)(e)||null!==(r=this._contextMenuAttendees)&&void 0!==r&&null!==(i=r.availableAttendees)&&void 0!==i&&q()(i).call(i,(e=>e.email.toLowerCase()===n))||(t=e)}this._$scope.$evalAsync((()=>{this._newContactEmail=t,this._contextMenuAttendees=null}))}},{kind:"method",key:"filterAttendeesByFullNameAndEmail",value:function filterAttendeesByFullNameAndEmail(){return e=>{return!this.attendeeFilter||(!!this._attendeeFilterRegex.test(e.fullName)||!!e.email&&(Zt()(t=e.email).call(t,this.attendeeFilter)||this._attendeeFilterRegex.test(e.email.split("@")[0])));var t}}},{kind:"method",key:"toggleEventAttendee",value:function toggleEventAttendee(e,t){this._provider.toggleEventsAttendeeAsync([e],t,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"copyCardAsTimeRecord",value:function copyCardAsTimeRecord(e){this._licenseSrv.checkPaidFeatureAvailable(i.ZV.TimeTracking,!0)&&this._provider.copyCardAsTimeRecordAsync(e)}},{kind:"method",key:"copyCardUrl",value:function copyCardUrl(e){this._provider.copyCardUrlAsync(e,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"deleteCard",value:function deleteCard(e){this._provider.deleteCardsAsync([e],{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}},{kind:"method",key:"_getContextMenuScope",value:function _getContextMenuScope(e){var t;let r=M()(t=this._$element).call(t,`md-menu[data-menu='${e}']`);if(0!==r.length)return r.scope()}}]}}));var rr=r(60312),ir=r.n(rr),nr=r(77738),ar=r.n(nr),or=r(71315);function controllers_CardEditorController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function controllers_CardEditorController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=controllers_CardEditorController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=controllers_CardEditorController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function controllers_CardEditorController_getDecoratorsApi(){controllers_CardEditorController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!controllers_CardEditorController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=controllers_CardEditorController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:controllers_CardEditorController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=controllers_CardEditorController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function controllers_CardEditorController_createElementDescriptor(e){var t,r=controllers_CardEditorController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function controllers_CardEditorController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function controllers_CardEditorController_hasDecorators(e){return e.decorators&&e.decorators.length}function controllers_CardEditorController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function controllers_CardEditorController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function controllers_CardEditorController_toPropertyKey(e){var t=function controllers_CardEditorController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const sr="complete",lr="openInSource",cr="copyUrl",dr="deleteCard",ur={[ee.eT.GoogleEvent]:[sr,lr,cr,dr]},hr={dialog:i.AH.Dialog,panel:i.AH.DialogPanel},pr=(0,U.$Y)(new Date("2020-09-03")),vr=1440,mr="plural",fr="singular",Cr="minutes",yr="hours",gr="days",_r="weeks",kr={[mr]:{[Cr]:"MISC.REMINDER_UNIT_MINUTES",[yr]:"MISC.REMINDER_UNIT_HOURS",[gr]:"MISC.REMINDER_UNIT_DAYS",[_r]:"MISC.REMINDER_UNIT_WEEKS"},[fr]:{[Cr]:"MISC.REMINDER_UNIT_MINUTE",[yr]:"MISC.REMINDER_UNIT_HOUR",[gr]:"MISC.REMINDER_UNIT_DAY",[_r]:"MISC.REMINDER_UNIT_WEEK"}};let wr=function controllers_CardEditorController_decorate(e,t,r,i){var n,a=controllers_CardEditorController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function controllers_CardEditorController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(controllers_CardEditorController_isDataDescriptor(n.descriptor)||controllers_CardEditorController_isDataDescriptor(i.descriptor)){if(controllers_CardEditorController_hasDecorators(n)||controllers_CardEditorController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(controllers_CardEditorController_hasDecorators(n)){if(controllers_CardEditorController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}controllers_CardEditorController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,controllers_CardEditorController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$rootScope","$scope","$log","$window","$timeout","$translate","appCommonSrv","calendarCardsSrv","dialogSrv","googleIntegrationSrv","notificationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class CardEditorController{constructor(t,r,n,a,o,s,l,c,d,u,h,p,v,m,f,C){e(this),this._$element=t,this._$rootScope=r,this._$scope=n,this._$log=a,this._$window=o,this._$timeout=s,this._$translate=l,this._appCommonSrv=c,this._calendarCardsSrv=d,this._dialogSrv=u,this._googleIntegrationSrv=h,this._notificationSrv=p,this._planywayIntegrationSrv=v,this._platformSrv=m,this._settingsSrv=f,this._telemetrySrv=C;const y=J()("body");let g;this._selectedCalendars=null,this._isDescriptionEditing=!1,this._isNewCardValid=!0,this._googleSendUpdates=null,this._$scope.$on(i.FK.GoogleCalendarSelectionChanged,(()=>this._selectedCalendars=null)),this._$scope.$on(i.FK.CardTypeChanged,(()=>this._providerWhitelist=null)),this._$timeout((()=>{this._renderDelayed=!0,this._$scope.$broadcast("md-resize-textarea")}),150),this._$scope.$on(i.FK.CardDialogKeyDown,((e,t)=>{let{keyboardEvent:r}=t;J()(r.target).is("input, textarea")?this._onInputKeyDown(r):this._onEditorKeyDown(r)})),this._$element.on("mousedown",(e=>{g=!(!J()(e.target).is("input, textarea")&&!M()(y).call(y,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0])})),this._$element.on("click",(()=>{var e;g||(null===(e=this.clickRequester)||void 0===e||e.click(),this.clickRequester=null)})),this._$element.on("click",".pw-js-dialog-edit-card-description-render",(e=>{this.isBusy||this.isReadOnly||J()(e.target).closest("a")[0]||this._$window.getSelection().toString()||(this.isDescriptionEditing=!0)})),this._$element.on("focus",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!0})),this._$element.on("blur",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!1})),this._$scope.$on("$destroy",(()=>{this._removeServiceListeners(),this.isNewCard&&!this._isSaveCardCalled&&this._clearCardData(),this._keepScrollFocus()})),this._registerEditor(),this.$onInit=()=>{const updateTitle=()=>{this._logCardEvent({event:i.cN.CardEvents.TitleChanged}),this._setCardPropertiesAsync({title:this.title})};this._updateTitle=this.isNewCard?Pe()(updateTitle,300):updateTitle}}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleEventEditorCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.Google)},{kind:"field",key:"calendarCard",value:void 0},{kind:"field",key:"isDetailed",value:void 0},{kind:"field",key:"isDense",value:void 0},{kind:"field",key:"hasChanges",value:void 0},{kind:"field",key:"_forceDetailedMode",value:void 0},{kind:"field",key:"clickRequester",value:void 0},{kind:"get",key:"calendarAccountId",value:function calendarAccountId(){return void 0===this._calendarAccountId&&(this._calendarAccountId=this.isNewCard?null:this.calendarCard.accountId),this._calendarAccountId}},{kind:"get",key:"setCalendarHandler",value:function setCalendarHandler(){return this._setCalendarHandler||(this._setCalendarHandler=e=>{let t=this._planywayIntegrationSrv.getConnectedAccountById(e.accountId);if(t.accountType===ee.Qm.Google)this._moveToGoogleCalendarAsync(e),this._logCardEvent({event:i.cN.CardEvents.GoogleCalendarChanged,data:{accountId:e.accountId,calendarId:e.id}});else{let r=(0,z.fL)(t.accountType);if(!r)return;this._logCardEvent({event:i.cN.CardEvents.CardProviderChanged,data:{providerType:r,accountId:e.accountId,calendarId:e.id}}),this._tmpAccountId=e.accountId,this._tmpCalendarId=e.id,this.calendarCard.providerType=r}}),this._setCalendarHandler}},{kind:"get",key:"providerWhitelist",value:function providerWhitelist(){return this._providerWhitelist||this.isNewCard||(this._providerWhitelist=[i.lP.Google]),this._providerWhitelist}},{kind:"method",key:"isCardButtonVisible",value:function isCardButtonVisible(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q()(t).call(t,(e=>{var t;if(!(null===(t=ur[this.calendarCard.cardType])||void 0===t?void 0:$()(t).call(t,e)))return!1;switch(e){case lr:return!this.isNewCard&&this.cardUrl;case cr:return!this.isNewCard;case dr:return!this.isReadOnly;default:return!0}}))}},{kind:"method",key:"cancelDialog",value:function cancelDialog(){this.hideDialog(i.Xs.Cancelled)}},{kind:"get",key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this.isCompleted!==e&&(this._isCompleted=e,this._logCardEvent({event:e?i.cN.CardEvents.MarkedCompleted:i.cN.CardEvents.MarkedIncompleted,data:{by:i.AH.Dialog}}),this._setCardPropertiesAsync({isCompleted:e}))}},{kind:"get",key:"title",value:function title(){return this._title}},{kind:"set",key:"title",value:function title(e){this.title!==e&&(this.isNewCard||e)&&(this._title=e,this._updateTitle())}},{kind:"get",key:"hasDates",value:function hasDates(){return this.calendarCard.hasDates}},{kind:"get",key:"isCardDatesYearShown",value:function isCardDatesYearShown(){return!(0,U.FT)(this.startDate,new Date)||!(0,U.FT)(this.endDate,new Date)}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this.isAllDay!==e&&(this._isAllDay=e,this.isAllDay?(this._startDate=(0,U.$Y)(this.startDate),this._endDate=this.endDate):(this._startDate=(0,U.nT)(this.startDate),this._endDate=(0,U.mH)((0,U.nT)(this.endDate),xe.XM)),this._logCardEvent({event:e?i.cN.CardEvents.IsAllDaySet:i.cN.CardEvents.IsAllDayUnset}),this._setCardPropertiesAsync({isAllDay:e,start:this.startDate,end:this.endDate}),this._cardReminders=null)}},{kind:"get",key:"startDate",value:function startDate(){return this._startDate}},{kind:"set",key:"startDate",value:function startDate(e){if(e&&!(0,U.rs)(this.startDate,e))if(this.hasDates){if(this.isAllDay){let t=(0,U.i2)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,U.E4)(this.startDate,t)}else{let t=(0,U.CX)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,U.mH)(this.startDate,t)}this._logCardEvent({event:i.cN.CardEvents.StartChanged}),this._setCardPropertiesAsync({start:e,end:this.endDate})}else this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:i.cN.CardEvents.Scheduled,data:{by:i.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})}},{kind:"get",key:"endDate",value:function endDate(){return this._endDate}},{kind:"set",key:"endDate",value:function endDate(e){e&&!(0,U.rs)(this.endDate,e)&&(this.hasDates?(this._endDate=e,this._logCardEvent({event:i.cN.CardEvents.EndChanged}),this._setCardPropertiesAsync({end:e})):(this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:i.cN.CardEvents.Scheduled,data:{by:i.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})))}},{kind:"get",key:"isRecurringAvailable",value:function isRecurringAvailable(){return!(this.isReadOnly&&!this.recurrenceRule)&&(this.hasDates&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this.recurrenceRule!==e&&(this._recurrenceRule=e,this._logCardEvent({event:i.cN.CardEvents.RecurrenceRuleChanged,data:{recurrenceRule:e}}),this._setCardPropertiesAsync({recurrenceRule:e}))}},{kind:"get",key:"isRecurrentCard",value:function isRecurrentCard(){return!(!this.recurrenceRule&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"calendarColor",value:function calendarColor(){if(this.cardGoogleCalendar)return this._calendarColor||(this._calendarColor={colorName:this.cardGoogleCalendar.colorName,color:this.cardGoogleCalendar.color.light}),this._calendarColor}},{kind:"get",key:"selectedCalendars",value:function selectedCalendars(){var e;null===this._selectedCalendars&&(this._selectedCalendars=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{let t=this._provider.getCurrentCollectionSelectedCalendarIds(e);return x()(t).call(t,(t=>this._googleIntegrationSrv.getGoogleCalendarById(e,t)))})));return this._selectedCalendars}},{kind:"get",key:"cardGoogleCalendar",value:function cardGoogleCalendar(){return this._cardGoogleCalendar}},{kind:"method",key:"setCardGoogleCalendar",value:function setCardGoogleCalendar(e,t){this._cardGoogleCalendar=this._googleIntegrationSrv.getGoogleCalendarById(e,t)}},{kind:"get",key:"googleCalendars",value:function googleCalendars(){return this._googleCalendars||(this._googleCalendars=this._googleIntegrationSrv.getGoogleCalendars(this.calendarCard.accountId),this.setCardGoogleCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.googleCalendarId)),this._googleCalendars}},{kind:"get",key:"availableTransparencies",value:function availableTransparencies(){return this._availableTransparencies||(this._availableTransparencies=[{title:this._$translate.instant("MENU.GOOGLE_EVENT_BUSY"),value:i.xj.Opaque},{title:this._$translate.instant("MENU.GOOGLE_EVENT_FREE"),value:i.xj.Transparent}]),this._availableTransparencies}},{kind:"get",key:"eventTransparency",value:function eventTransparency(){return this._eventTransparency}},{kind:"set",key:"eventTransparency",value:function eventTransparency(e){this._eventTransparency!==e&&(this._eventTransparency=e,this._logCardEvent({event:i.cN.CardEvents.AvailabilityChanged,data:{transparency:this.eventTransparency.value}}),this._setCardPropertiesAsync({googleShowAsFree:this.eventTransparency.value===i.xj.Transparent}))}},{kind:"get",key:"isRemindersAvailable",value:function isRemindersAvailable(){return!this.isReadOnly||this.cardReminders.length>0}},{kind:"get",key:"canAddReminder",value:function canAddReminder(){return this.cardReminders.length<5}},{kind:"get",key:"cardReminders",value:function cardReminders(){if(this.delayRender)return[];if(!this.cardGoogleCalendar)return[];var e,t;this._cardReminders||(this._cardRemindersLastIntervalUnits||(this._cardRemindersLastIntervalUnits=new(ge())),this._cardRemindersLastIntervalUnitsAllDay||(this._cardRemindersLastIntervalUnitsAllDay=new(ge())),this._cardReminders=Y()(e=x()(t=this.calendarCard.providerCard.googleReminders).call(t,(e=>{let t=controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},e),{},{id:ar()(),type:ee.k$.RemindStart,delete:()=>{var e,r;this._logCardEvent({event:i.cN.CardEvents.ReminderDeleted,data:{deliveryType:t.deliveryType.value,remindBeforeValue:t.remindValue,remindBeforeUnit:t.selectedRemindUnit.unit,remindTime:t.remindTime}});let n=x()(e=A()(r=this.cardReminders).call(r,(e=>e.id!==t.id))).call(e,(e=>({method:e.deliveryType.value,minutes:e.remindBefore})));this._setCardPropertiesAsync({googleReminders:n})}});if(F()(t,"minRemindValue",{get:()=>this.isAllDay?1:0}),F()(t,"maxRemindValue",{get:()=>{switch(t._remindUnit){case"weeks":return 4;case"days":return 28;case"hours":return 672;case"minutes":return 40320}}}),t._deliveryType=t.method,t.remindBefore=t.minutes,this.isAllDay){let e,r,i=t.remindBefore%vr,n=t.remindBefore+vr-i,a=this._cardRemindersLastIntervalUnitsAllDay.get(t.remindBefore);a&&a.remindBefore===n?({unit:e,value:r}=a):(({unit:e,value:r}=(0,U.GP)(n)),this._cardRemindersLastIntervalUnitsAllDay.set(t.remindBefore,{remindBefore:n,unit:e,value:r})),t._remindUnit=e,t._remindValue=(0,U.uZ)(r,t.minRemindValue,t.maxRemindValue),t._remindTime=(0,U.mH)(pr,vr-i)}else{let e,r,i=t.remindBefore,n=this._cardRemindersLastIntervalUnits.get(t.remindBefore);n&&n.remindBefore===i?({unit:e,value:r}=n):(({unit:e,value:r}=(0,U.GP)(i)),this._cardRemindersLastIntervalUnits.set(t.remindBefore,{remindBefore:i,unit:e,value:r})),t._remindUnit=e,t._remindValue=r}return F()(t,"availableDeliveryTypes",{get:()=>(t._availableDeliveryTypes||(t._availableDeliveryTypes=[{title:this._$translate.instant("MENU.GOOGLE_EVENT_DELIVERY_TYPE_EMAIL"),value:i.n_.Email},{title:this._$translate.instant("MENU.GOOGLE_EVENT_DELIVERY_TYPE_POPUP"),value:i.n_.Popup}]),t._availableDeliveryTypes)}),F()(t,"deliveryType",{get:()=>{var e;return M()(e=t.availableDeliveryTypes).call(e,(e=>e.value===t._deliveryType))},set:e=>{var r;if(t._deliveryType===e.value)return;t._deliveryType=e.value,this._googleUserSettings.local.lastReminderDeliveryType=t.deliveryType.value,this._userSettings.local.save(),this._logCardEvent({event:i.cN.CardEvents.ReminderChanged,data:{deliveryType:t.deliveryType.value,remindBeforeValue:t.remindValue,remindBeforeUnit:t.selectedRemindUnit.unit,remindTime:t.remindTime}});let n=x()(r=this.cardReminders).call(r,(e=>({method:e.deliveryType.value,minutes:e.remindBefore})));this._setCardPropertiesAsync({googleReminders:n})}}),F()(t,"remindValue",{get:()=>t._remindValue,set:e=>{var r;if(!ir()(e))return;if(e=(0,U.uZ)(e,t.minRemindValue,t.maxRemindValue),t._remindValue===e)return;if(t._remindValue=e,this.isAllDay){let r=vr-(0,U.CX)(pr,t._remindTime),i=(0,U.a5)(t._remindUnit,e);t.remindBefore=i-vr+r,this._googleUserSettings.local.lastRemindBeforeAllDay=t.remindBefore,this._cardRemindersLastIntervalUnitsAllDay.set(t.remindBefore,{remindBefore:i,unit:t._remindUnit,value:e})}else{let r=(0,U.a5)(t._remindUnit,e);t.remindBefore=r,this._googleUserSettings.local.lastRemindBefore=t.remindBefore,this._cardRemindersLastIntervalUnits.set(t.remindBefore,{remindBefore:r,unit:t._remindUnit,value:e})}this._userSettings.local.save(),this._logCardEvent({event:i.cN.CardEvents.ReminderChanged,data:{deliveryType:t.deliveryType.value,remindBeforeValue:t.remindValue,remindBeforeUnit:t.selectedRemindUnit.unit,remindTime:t.remindTime}});let n=x()(r=this.cardReminders).call(r,(e=>({method:e.deliveryType.value,minutes:e.remindBefore})));this._setCardPropertiesAsync({googleReminders:n})}}),F()(t,"availableRemindUnits",{get:()=>(t._availableUnits||(this.isAllDay?t._availableUnits=[{title:this._$translate.instant("MISC.REMINDER_UNIT_DAYS"),unit:"days"},{title:this._$translate.instant("MISC.REMINDER_UNIT_WEEKS"),unit:"weeks"}]:t._availableUnits=[{title:this._$translate.instant("MISC.REMINDER_UNIT_MINUTES"),unit:"minutes"},{title:this._$translate.instant("MISC.REMINDER_UNIT_HOURS"),unit:"hours"},{title:this._$translate.instant("MISC.REMINDER_UNIT_DAYS"),unit:"days"},{title:this._$translate.instant("MISC.REMINDER_UNIT_WEEKS"),unit:"weeks"}]),t._availableUnits)}),F()(t,"selectedRemindUnit",{get:()=>{var e;return M()(e=t.availableRemindUnits).call(e,(e=>e.unit===t._remindUnit))},set:e=>{var r;if(t._remindUnit===e.unit)return;if(t._remindUnit=e.unit,t._remindValue=(0,U.uZ)(t._remindValue,t.minRemindValue,t.maxRemindValue),this.isAllDay){let r=vr-(0,U.CX)(pr,t._remindTime),i=(0,U.a5)(e.unit,t._remindValue);t.remindBefore=i-vr+r,this._googleUserSettings.local.lastRemindBeforeAllDay=t.remindBefore,this._cardRemindersLastIntervalUnitsAllDay.set(t.remindBefore,{remindBefore:i,unit:e.unit,value:t._remindValue})}else{let r=(0,U.a5)(e.unit,t._remindValue);t.remindBefore=r,this._googleUserSettings.local.lastRemindBefore=t.remindBefore,this._cardRemindersLastIntervalUnits.set(t.remindBefore,{remindBefore:r,unit:e.unit,value:t._remindValue})}this._userSettings.local.save(),this._logCardEvent({event:i.cN.CardEvents.ReminderChanged,data:{deliveryType:t.deliveryType.value,remindBeforeValue:t.remindValue,remindBeforeUnit:t.selectedRemindUnit.unit,remindTime:t.remindTime}});let n=x()(r=this.cardReminders).call(r,(e=>({method:e.deliveryType.value,minutes:e.remindBefore})));this._setCardPropertiesAsync({googleReminders:n})}}),F()(t,"remindTime",{get:()=>{if(this.isAllDay)return t._remindTime},set:e=>{var r;if(!e||(0,U.rs)(t._remindTime,e))return;if(t._remindTime=e,!this.isAllDay)return;{let e=vr-(0,U.CX)(pr,t._remindTime),r=(0,U.a5)(t._remindUnit,t._remindValue);t.remindBefore=r-vr+e,this._googleUserSettings.local.lastRemindBeforeAllDay=t.remindBefore,this._userSettings.local.save(),this._cardRemindersLastIntervalUnitsAllDay.set(t.remindBefore,{remindBefore:r,unit:t._remindUnit,value:t._remindValue})}this._keepScrollFocus(),this._logCardEvent({event:i.cN.CardEvents.ReminderChanged,data:{deliveryType:t.deliveryType.value,remindBeforeValue:t.remindValue,remindBeforeUnit:t.selectedRemindUnit.unit,remindTime:t.remindTime}});let n=x()(r=this.cardReminders).call(r,(e=>({method:e.deliveryType.value,minutes:e.remindBefore})));this._setCardPropertiesAsync({googleReminders:n})}}),F()(t,"minRemindTime",{get:()=>pr}),F()(t,"maxRemindTime",{get:()=>(t._maxRemindTime||(t._maxRemindTime=(0,U.mH)(t.minRemindTime,vr)),t._maxRemindTime)}),t}))).call(e,U.$t),this._cardReminderPresets=null);return this._cardReminders}},{kind:"get",key:"cardReminderPresets",value:function cardReminderPresets(){return this._cardReminderPresets||(this.isAllDay?this._cardReminderPresets=[{type:ee.k$.RemindStart,remindBefore:30,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_AT_DAY_BEFORE_23_30",{time:kendo.toString((0,U.D0)(pr,23,30),"t")})},{type:ee.k$.RemindStart,remindBefore:900,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_AT_DAY_BEFORE_9_00",{time:kendo.toString((0,U.D0)(pr,9),"t")})},{type:ee.k$.RemindStart,remindBefore:2340,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_AT_2_DAYS_BEFORE_9_00",{time:kendo.toString((0,U.D0)(pr,9),"t")})},{type:ee.k$.RemindStart,remindBefore:9540,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_AT_1_WEEK_BEFORE_9_00",{time:kendo.toString((0,U.D0)(pr,9),"t")})},{type:ee.k$.RemindStart,remindBefore:null}]:this._cardReminderPresets=[{type:ee.k$.RemindStart,remindBefore:5,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_5_MINUTES")},{type:ee.k$.RemindStart,remindBefore:10,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_10_MINUTES")},{type:ee.k$.RemindStart,remindBefore:15,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_15_MINUTES")},{type:ee.k$.RemindStart,remindBefore:30,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_30_MINUTES")},{type:ee.k$.RemindStart,remindBefore:60,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_1_HOUR")},{type:ee.k$.RemindStart,remindBefore:1440,text:this._$translate.instant("DIALOGS.REMIND_BEFORE_1_DAY")},{type:ee.k$.RemindStart,remindBefore:null}]),this._cardReminderPresets}},{kind:"method",key:"addReminderAsync",value:async function addReminderAsync(e,t){var r;if(!this.canAddReminder)return;let n,a;if(null===t.remindBefore){let e=await this._dialogSrv.showAddCustomReminderDialogAsync({isEditingMode:!1,isAllDay:this.isAllDay,isNegativeReminderAvailable:!1,type:ee.k$.RemindStart,remindBefore:this.isAllDay?this._googleUserSettings.local.lastRemindBeforeAllDay:this._googleUserSettings.local.lastRemindBefore,relativeTo:".pw-js-edit-card-reminders"});if(!e)return;n=e.type,a=e.remindBefore,this.isAllDay?this._googleUserSettings.local.lastRemindBeforeAllDay=a:this._googleUserSettings.local.lastRemindBefore=a,this._userSettings.local.save()}else n=t.type,a=t.remindBefore;let o={id:ar()(),type:n,method:this._googleUserSettings.local.lastReminderDeliveryType,minutes:a},s=[...x()(r=this.cardReminders).call(r,(e=>({id:e.id,type:e.type,method:e.deliveryType.value,minutes:e.remindBefore}))),o];this._cardReminders=null;let{unit:l,value:c}=(0,U.GP)(o.minutes);this._logCardEvent({event:i.cN.CardEvents.ReminderAdded,data:{by:hr[e],reminderType:o.type,deliveryType:o.method,remindBeforeValue:c,remindBeforeUnit:l}}),this._setCardPropertiesAsync({googleReminders:s})}},{kind:"method",key:"editReminderAsync",value:async function editReminderAsync(e,t,r){var n,a;let o,s;if(null===r.remindBefore){let e=await this._dialogSrv.showAddCustomReminderDialogAsync({isEditingMode:!0,isAllDay:this.isAllDay,isNegativeReminderAvailable:!1,type:t.type,remindBefore:t.remindBefore,relativeTo:".pw-js-edit-card-reminders"});if(!e)return;o=e.type,s=e.remindBefore,this.isAllDay?this._googleUserSettings.local.lastRemindBeforeAllDay=s:this._googleUserSettings.local.lastRemindBefore=s,this._userSettings.local.save()}else o=t.type,s=r.remindBefore;const l=ar()();let c=[...x()(n=A()(a=this.cardReminders).call(a,(e=>e.id!==t.id))).call(n,(e=>({id:e.id,type:e.type,method:e.deliveryType.value,minutes:e.remindBefore}))),{id:l,type:o,method:t.method,minutes:s}];this._cardReminders=null;let{unit:d,value:u}=(0,U.GP)(s);this._logCardEvent({event:i.cN.CardEvents.ReminderChanged,data:{by:hr[e],reminderType:o,deliveryType:t.method,remindBeforeValue:u,remindBeforeUnit:d}}),this._setCardPropertiesAsync({googleReminders:c})}},{kind:"method",key:"getReminderPresetString",value:function getReminderPresetString(e){let t,r;if(this.isAllDay&&(0===e.remindValue&&e.selectedRemindUnit.unit===gr?(t=this._$translate.instant("DIALOGS.REMIND_BEFORE_ON_THE_DAY_OF_THE_CARD"),r=""):r=this._$translate.instant("DIALOGS.REMIND_BEFORE_AT")),void 0===t){let r=1===e.remindValue?fr:mr;t=`${e.remindValue} ${this._$translate.instant(kr[r][e.selectedRemindUnit.unit])}`}return void 0===r&&(r=this._$translate.instant("DIALOGS.REMIND_BEFORE")),`${t} ${r} ${kendo.toString(e.remindTime,"t")}`}},{kind:"get",key:"eventAttendees",value:function eventAttendees(){if(this.delayRender)return[];if(!this.cardGoogleCalendar)return[];var e,t,r;this._eventAttendees||(this._eventAttendees=Y()(e=x()(t=this.calendarCard.providerCard.googleAttendees).call(t,(e=>{var t;let r=this._googleIntegrationSrv.getGoogleContactByEmail(this.calendarCard.accountId,e.email);return r||(r=this._googleIntegrationSrv.getFakeContact(e.email)),controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},r),{},{accountId:this.calendarCard.accountId,status:M()(t=this.availableInviteStatuses).call(t,(t=>t.value===e.responseStatus))})}))).call(e,U.GI),this._isCurrentMemberAttendee&&(this._inviteStatus=M()(r=this._eventAttendees).call(r,(e=>e.email===this._currentUserEmail)).status));return this._eventAttendees}},{kind:"get",key:"availableAttendees",value:function availableAttendees(){if(this.delayRender)return[];if(!this.cardGoogleCalendar)return[];if(!this._availableAttendees){var e,t;this._availableAttendees=x()(e=this._googleIntegrationSrv.getGoogleContacts(this.calendarCard.accountId)).call(e,(e=>{var t;return controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},e),{},{accountId:this.calendarCard.accountId,memberType:i.wO.Google,isSelected:q()(t=this.eventAttendees).call(t,(t=>t.email===e.email))})}));for(let e of this.calendarCard.providerCard.googleAttendees){var r;q()(r=this._availableAttendees).call(r,(t=>t.email===e.email))||this._availableAttendees.push(controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},this._googleIntegrationSrv.getFakeContact(e.email)),{},{accountId:this.calendarCard.accountId,memberType:i.wO.Google,isSelected:!0}))}this._newContactEmail&&this._availableAttendees.push(controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},this._googleIntegrationSrv.getFakeContact(this._newContactEmail)),{},{accountId:this.calendarCard.accountId,memberType:i.wO.Google,isSelected:!1,isFakeFromSearch:!0})),Y()(t=this._availableAttendees).call(t,U.GI)}return this._availableAttendees}},{kind:"get",key:"attendeeFilter",value:function attendeeFilter(){return this._attendeeFilter}},{kind:"set",key:"attendeeFilter",value:function attendeeFilter(e){this._attendeeFilter=e;let t=null;if(e){var r;this._attendeeFilterRegex=(0,U.n0)(e);let i=e.toLowerCase();(0,qt.G)(e)&&!q()(r=this._availableAttendees).call(r,(e=>e.email.toLowerCase()===i))&&(t=e)}this._$scope.$evalAsync((()=>{this._newContactEmail=t,this._availableAttendees=null}))}},{kind:"method",key:"filterAttendeesByFullNameAndEmail",value:function filterAttendeesByFullNameAndEmail(){return e=>{return!this.attendeeFilter||(!!this._attendeeFilterRegex.test(e.fullName)||!!e.email&&(Zt()(t=e.email).call(t,this.attendeeFilter)||this._attendeeFilterRegex.test(e.email.split("@")[0])));var t}}},{kind:"method",key:"toggleAttendee",value:function toggleAttendee(e){var t;let r=e.email===this._currentUserEmail,n=q()(t=this.calendarCard.providerCard.googleAttendees).call(t,(t=>t.email===e.email));(!n||this.isNewCard||this.eventCanModify&&this.isCurrentMemberOrganizer)&&(this._availableAttendees=null,this._logCardEvent({event:n?r?i.cN.CardEvents.MemberUnassignedSelf:i.cN.CardEvents.MemberUnassigned:r?i.cN.CardEvents.MemberAssignedSelf:i.cN.CardEvents.MemberAssigned}),!n&&e.isFakeFromSearch&&(this.attendeeFilter=null),this._setCardPropertiesAsync({googleAttendees:(0,or.G0)(this.calendarCard,e,this._currentUserEmail)}))}},{kind:"get",key:"isDescriptionAvailable",value:function isDescriptionAvailable(){return!this.isReadOnly||this.description}},{kind:"get",key:"isDescriptionEditing",value:function isDescriptionEditing(){return this._isDescriptionEditing}},{kind:"set",key:"isDescriptionEditing",value:function isDescriptionEditing(e){this.isDescriptionEditing!==e&&(this._$scope.$evalAsync((()=>this._isDescriptionEditing=e)),e&&this._$timeout((()=>{J()(".pw-js-dialog-edit-card-description-input").trigger("focus"),this._$scope.$broadcast(i.FK.AutosizeControlsResizeRequested)}),0,!1))}},{kind:"get",key:"description",value:function description(){return this._description}},{kind:"set",key:"description",value:function description(e){this.description!==e&&(this._description=null==e?void 0:be()(e).call(e),this._logCardEvent({event:i.cN.CardEvents.DescriptionChanged}),this._setCardPropertiesAsync({description:this.description}))}},{kind:"get",key:"isInviteResponseAvailable",value:function isInviteResponseAvailable(){var e;return q()(e=this.calendarCard.providerCard.googleAttendees).call(e,(e=>e.email===this._currentUserEmail&&e.self))}},{kind:"get",key:"availableInviteStatuses",value:function availableInviteStatuses(){return this._availableInviteStatuses||(this._availableInviteStatuses=[{title:this._$translate.instant("BUTTONS.YES"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_ACCEPTED"),icon:"icons-12:checked",value:i.XO.Yes,showAsOption:!0},{title:this._$translate.instant("BUTTONS.NO"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_DECLINED"),icon:"icons-12:close",value:i.XO.No,showAsOption:!0},{title:this._$translate.instant("BUTTONS.MAYBE"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_TENTATIVE"),icon:"icons-12:help",value:i.XO.MayBe,showAsOption:!0},{tooltip:this._$translate.instant("MISC.INVITE_STATUS_NEED_ACTION"),value:i.XO.Undefined,showAsOption:!1}]),this._availableInviteStatuses}},{kind:"get",key:"inviteStatus",value:function inviteStatus(){return this._inviteStatus}},{kind:"set",key:"inviteStatus",value:function inviteStatus(e){if(this.inviteStatus!==e){var t;this._inviteStatus=e,this._logCardEvent({event:i.cN.CardEvents.InviteStatusChanged,data:{status:this.inviteStatus.value}});let r=x()(t=this.calendarCard.providerCard.googleAttendees).call(t,(e=>e.email===this._currentUserEmail?controllers_CardEditorController_objectSpread(controllers_CardEditorController_objectSpread({},e),{},{responseStatus:this.inviteStatus.value}):e));this._setCardPropertiesAsync({googleAttendees:r})}}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this.calendarCard.cardUrl}},{kind:"get",key:"cardUrlTarget",value:function cardUrlTarget(){return"_blank"}},{kind:"method",key:"openCardInSource",value:function openCardInSource(e){this._logCardEvent({event:i.cN.CardEvents.CardOpenClicked,data:{by:i.AH.DialogPanel}}),e.which===i.Jm.Left&&this.hideDialog()}},{kind:"method",key:"switchDetailedModeAsync",value:async function switchDetailedModeAsync(){await new(Ae())((e=>this._$scope.$emit(i.FK.CardDialogSwitchDetailedModeRequested,{resolve:e}))),this._logCardEvent({event:i.cN.CardEvents.EditDialogModeChanged,data:{by:i.AH.Dialog,isDetailed:!this.isDetailed}})}},{kind:"method",key:"hideDialog",value:function hideDialog(e){this._$scope.$emit(i.FK.CardDialogHideRequested,{dialogResult:e})}},{kind:"method",key:"initialize",value:function initialize(){var e,t;if(this.calendarCard.cardType!==ee.eT.GoogleEvent){var r;const e=this._tmpAccountId||this.calendarCard.accountId;this._calendarCardsSrv.changeCalendarCardType(this.calendarCard,ee.eT.GoogleEvent,e);const{title:t,isAllDay:i,start:n,end:a}=this.calendarCard;this.calendarCard.providerCard=this._provider.getCalendarCardClass().fromSourceCard(this.calendarCard.id,e,ee.eT.GoogleEvent),this.calendarCard.providerCard.googleCalendarId=null!==(r=this._tmpCalendarId)&&void 0!==r?r:this.calendarCard.providerCard.googleCalendarId,this.calendarCard.title=t,this.calendarCard.isAllDay=i,this.calendarCard.start=n,this.calendarCard.end=a,this._tmpAccountId=null,this._tmpCalendarId=null}this.setCardGoogleCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.googleCalendarId),this._isCompleted=this.calendarCard.providerCard.isCompleted,this._title=this.calendarCard.title,this._isAllDay=this.calendarCard.isAllDay,this._startDate=this.calendarCard.start,this._endDate=this.calendarCard.end,this._recurrenceRule=this.calendarCard.recurrenceRule,this._description=null===(e=this.calendarCard.description)||void 0===e?void 0:be()(e).call(e);let n=this.calendarCard.providerCard.googleShowAsFree?i.xj.Transparent:i.xj.Opaque;this._eventTransparency=M()(t=this.availableTransparencies).call(t,(e=>e.value===n)),this._addServiceListeners()}},{kind:"get",key:"isBusy",value:function isBusy(){return this._isBusy}},{kind:"set",key:"isBusy",value:function isBusy(e){this._$scope.$evalAsync((()=>this._isBusy=e))}},{kind:"get",key:"isNewCard",value:function isNewCard(){return this.calendarCard.isTempCard}},{kind:"get",key:"isNewCardValid",value:function isNewCardValid(){return this._isNewCardValid}},{kind:"method",key:"isCardFieldValid",value:function isCardFieldValid(e){switch(e){case"startDate":case"endDate":return this.hasDates;default:return!1}}},{kind:"get",key:"isCardReadOnly",value:function isCardReadOnly(){return this.calendarCard.isReadOnly}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){var e;return!!this.calendarCard.isReadOnly||this.calendarCard.providerCard.googleCalendarId&&!q()(e=this.selectedCalendars).call(e,(e=>e.id===this.calendarCard.providerCard.googleCalendarId))}},{kind:"get",key:"eventCanInviteOthers",value:function eventCanInviteOthers(){return this.calendarCard.providerCard.canInviteOthers}},{kind:"get",key:"eventCanModify",value:function eventCanModify(){return this.calendarCard.providerCard.canModify}},{kind:"get",key:"eventCanSeeOtherGuests",value:function eventCanSeeOtherGuests(){return this.calendarCard.providerCard.canSeeOtherGuests}},{kind:"get",key:"isCurrentMemberOrganizer",value:function isCurrentMemberOrganizer(){var e;return null===(e=this.calendarCard.providerCard.googleOrganizer)||void 0===e?void 0:e.self}},{kind:"get",key:"delayRender",value:function delayRender(){return!this._renderDelayed}},{kind:"get",key:"showWeekNumbers",value:function showWeekNumbers(){return this._collectionSettings.global.settings.showWeekNumbers}},{kind:"get",key:"isMacOS",value:function isMacOS(){return this._platformSrv.isMacOS()}},{kind:"method",key:"saveCalendarCardAsync",value:async function saveCalendarCardAsync(){if(!this._isSaveCardCalled){if(this._isSaveCardCalled=!0,this.title&&this.isNewCard&&this._setCardPropertiesAsync({title:this.title}),!this.isNewCard)return this._isSaveCardCalled=!1,void this.hideDialog(i.Xs.CardEdited);try{if(await this._$timeout((()=>this._isNewCardValid=!0)),await this._$timeout((()=>this._isNewCardValid=this.isCardFieldValid("startDate")&&this.isCardFieldValid("endDate"))),!this.isNewCardValid)return;this._appCommonSrv.setSchedulerBusy(!0),this._updateCardPromise&&await this._updateCardPromise,this._hasChanges=!1,this.hideDialog(i.Xs.CardCreated),this._collectionSettings.local.settings.lastUsedCalendarData={accountType:ee.Qm.Google,accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId},this._collectionSettings.local.save();let e=await this._calendarCardsSrv.createCalendarCardAsync(this.calendarCard);this._$rootScope.$broadcast(i.FK.CardCreated,{calendarCard:e})}catch(e){this._$log.error("Planyway card creating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CREATE_GOOGLE_EVENT_ERROR"),i.k$.Error),this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}finally{this._appCommonSrv.setSchedulerBusy(!1),this._isSaveCardCalled=!1}}}},{kind:"method",key:"copyCardUrlAsync",value:function copyCardUrlAsync(){return this._provider.copyCardUrlAsync(this.calendarCard,{telemetry:{by:i.AH.DialogPanel}})}},{kind:"method",key:"deleteCardAsync",value:function deleteCardAsync(){return this._deleteCardAsync({event:i.cN.CardEvents.Deleted,data:{by:i.AH.DialogPanel}})}},{kind:"method",key:"confirmCloseAsync",value:async function confirmCloseAsync(){if(this.isNewCard){if(this._isSaveCardCalled)return!0;if(!this.hasChanges&&this._forceDetailedMode)return!0;if(!this._isDeleting)return await this.saveCalendarCardAsync(),!1}return!0}},{kind:"get",key:"_parentDialogController",value:function _parentDialogController(){return this._parentDialogControllerInternal||(this._parentDialogControllerInternal=(0,U.sO)(this._$scope,Te.Z)),this._parentDialogControllerInternal}},{kind:"method",key:"_registerEditor",value:function _registerEditor(){var e;null===(e=this._parentDialogController)||void 0===e||e.registerCardEditorControllerAsync(this)}},{kind:"get",key:"_tmpAccountId",value:function _tmpAccountId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpAccountId}},{kind:"set",key:"_tmpAccountId",value:function _tmpAccountId(e){this._parentDialogController&&(this._parentDialogController._tmpAccountId=e)}},{kind:"get",key:"_tmpCalendarId",value:function _tmpCalendarId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpCalendarId}},{kind:"set",key:"_tmpCalendarId",value:function _tmpCalendarId(e){this._parentDialogController&&(this._parentDialogController._tmpCalendarId=e)}},{kind:"method",key:"_onInputKeyDown",value:function _onInputKeyDown(e){e.stopPropagation()}},{kind:"method",key:"_onEditorKeyDown",value:function _onEditorKeyDown(e){var t;let r=e.which;if(!i.gD.has(r))return;if(e.preventDefault(),e.stopPropagation(),!(null===(t=i.Vj[ee.eT.GoogleEvent])||void 0===t?void 0:$()(t).call(t,r)))return;if(this.isCardReadOnly)return;let n=!1;r===i.VD.E||r===i.VD.Space||r===i.VD.M?n=!0:r!==i.VD.Delete&&r!==i.VD.Backspace||(e.shiftKey||e.metaKey)&&(n=!0),n&&this._updateCardByHotkey(e.keyCode,{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey})}},{kind:"method",key:"_updateCardByHotkey",value:function _updateCardByHotkey(e,t){var r;switch(e){case i.VD.E:this._isCompleted=!this.isCompleted,this._logCardEvent({event:this.isCompleted?i.cN.CardEvents.MarkedCompleted:i.cN.CardEvents.MarkedIncompleted,data:{by:i.AH.DialogHotkey}}),this._setCardPropertiesAsync({isCompleted:this.isCompleted});break;case i.VD.M:J()(".pw-js-dialog-edit-event-attendees-menu-btn").trigger("click");break;case i.VD.Space:if(!this._currentUserEmail)break;let e=q()(r=this.calendarCard.providerCard.googleAttendees).call(r,(e=>e.email===this._currentUserEmail));if(e&&!this.isNewCard&&(!this.eventCanModify||!this.isCurrentMemberOrganizer))break;this._availableAttendees=null,this._logCardEvent({event:e?i.cN.CardEvents.MemberUnassignedSelf:i.cN.CardEvents.MemberAssignedSelf,data:{by:i.AH.DialogHotkey}}),this._setCardPropertiesAsync({googleAttendees:(0,or.G0)(this.calendarCard,{email:this._currentUserEmail},this._currentUserEmail)});break;case i.VD.Delete:case i.VD.Backspace:if(t.shiftKey||t.metaKey){if(this.isNewCard)break;this._deleteCardAsync({event:i.cN.CardEvents.Deleted,data:{by:i.AH.DialogHotkey}})}}}},{kind:"get",key:"_isCurrentMemberAttendee",value:function _isCurrentMemberAttendee(){var e;return q()(e=this.calendarCard.providerCard.googleAttendees).call(e,(e=>e.email===this._currentUserEmail))}},{kind:"get",key:"_currentUserEmail",value:function _currentUserEmail(){var e;return null===(e=this._googleIntegrationSrv.getGoogleUser(this.calendarCard.accountId))||void 0===e?void 0:e.email}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_googleUserSettings",value:function _googleUserSettings(){return{local:this._userSettings.local.settings.provider[i.lP.Google]}}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"set",key:"_hasChanges",value:function _hasChanges(e){this._$scope.$emit(i.FK.CardDialogSetHasChangesRequested,{hasChanges:e})}},{kind:"method",key:"_setCardPropertiesAsync",value:async function _setCardPropertiesAsync(e){this._$timeout((()=>this._keepScrollFocus()),0,!1),this._hasChanges=!0;try{var t;if(this.isNewCard){this._updateCardPromise&&await this._updateCardPromise;let e=null;this._updateCardPromise=new(Ae())((t=>e=t)),this._updateCardPromise.resolve=e}else this.calendarCard.recurrenceRule&&(void 0!==e.isAllDay&&e.isAllDay!==this.calendarCard.isAllDay||e.start&&!(0,U.rs)(e.start,this.calendarCard.start)||void 0!==e.recurrenceRule&&e.isAllDay!==this.calendarCard.recurrenceRule)&&(e.exceptionDates=[],this.calendarCard.deleteExceptionDates(),(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(this.calendarCard.cardType,this.calendarCard)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this._setCardPropertiesAsync.name})}})());null===this._googleSendUpdates&&(this._googleSendUpdates=await this._calendarCardsSrv.getIsSendUpdatesRequiredAsync(this.calendarCard,e));let r="googleAttendees"in e&&q()(t=this._eventAttendees).call(t,(t=>{var r;return q()(r=e.googleAttendees).call(r,(e=>{var r;return e.email===t.email&&e.responseStatus!==(null===(r=t.status)||void 0===r?void 0:r.value)}))}));await this._calendarCardsSrv.updateCalendarCardPropertiesAsync(this.calendarCard,e,{sendUpdates:this._googleSendUpdates||r})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),i.k$.Error)}}},{kind:"method",key:"_addServiceListeners",value:function _addServiceListeners(){this._serviceEventsListenersAdded||(this._serviceEventsListenersAdded=!0,this._onAddOrUpdateCard=(e,t)=>{e.id===this.calendarCard.id&&this._addOrUpdateCard(e,t)},this._onDeleteCard=(e,t)=>{e.id===this.calendarCard.id&&(t.replacedWith?this._addOrUpdateCard(t.replacedWith,t):this._deleteCard())},this._calendarCardsSrv.addCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("deleted",this._onDeleteCard),this._onGoogleCalendarChanged=()=>{this._selectedCalendars=null,this._googleCalendars=null},this._googleIntegrationSrv.addGoogleCalendarEventListener("added",this._onGoogleCalendarChanged),this._googleIntegrationSrv.addGoogleCalendarEventListener("updated",this._onGoogleCalendarChanged),this._googleIntegrationSrv.addGoogleCalendarEventListener("deleted",this._onGoogleCalendarChanged))}},{kind:"method",key:"_removeServiceListeners",value:function _removeServiceListeners(){this._serviceEventsListenersAdded&&(this._serviceEventsListenersAdded=!1,this._calendarCardsSrv.removeCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("deleted",this._onDeleteCard),this._googleIntegrationSrv.removeGoogleCalendarEventListener("added",this._onGoogleCalendarChanged),this._googleIntegrationSrv.removeGoogleCalendarEventListener("updated",this._onGoogleCalendarChanged),this._googleIntegrationSrv.removeGoogleCalendarEventListener("deleted",this._onGoogleCalendarChanged))}},{kind:"method",key:"_addOrUpdateCard",value:function _addOrUpdateCard(e,t){this.calendarCard=e.isTempCard?e:e.clone(),this._$scope.$evalAsync((()=>{var r,n,a,o,s;(this._isCompleted=e.providerCard.isCompleted,this._isAllDay=e.isAllDay,this._startDate=e.start,this._endDate=e.end,this._recurrenceRule=e.recurrenceRule,t.hasExternalChanges)&&(this._title=e.title,this._description=null===(s=e.description)||void 0===s?void 0:be()(s).call(s));let l=e.providerCard.googleShowAsFree?i.xj.Transparent:i.xj.Opaque;this._eventTransparency=M()(r=this.availableTransparencies).call(r,(e=>e.value===l));let c=null===(n=M()(a=e.providerCard.googleAttendees).call(a,(e=>e.self)))||void 0===n?void 0:n.responseStatus;this._inviteStatus=M()(o=this.availableInviteStatuses).call(o,(e=>e.value===c)),this._availableAttendees=null,this._eventAttendees=null,this._cardReminders=null,this.setCardGoogleCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.googleCalendarId),e.isTempCard&&(this._hasChanges=!0),this._updateCardPromise&&(this._updateCardPromise.resolve(),this._updateCardPromise=null)}))}},{kind:"method",key:"_moveToGoogleCalendarAsync",value:async function _moveToGoogleCalendarAsync(e){if(this.calendarCard.providerCard.googleCalendarId!==e.id)try{this.isBusy=!0,this.setCardGoogleCalendar(e.accountId,e.id),await this._setCardPropertiesAsync({accountId:e.accountId,googleCalendarId:e.id})}finally{this.isBusy=!1,this._calendarColor=null}}},{kind:"method",key:"_deleteCard",value:function _deleteCard(){this._hasChanges=!1,this.hideDialog(i.Xs.CardDeleted)}},{kind:"method",key:"_clearCardData",value:function _clearCardData(){this.calendarCard.providerCard.googleCalendarId=null,this.calendarCard.providerCard.googleAttendees=null,this.calendarCard.recurrenceRule=void 0,this.calendarCard.exceptionDates=void 0}},{kind:"method",key:"_deleteCardAsync",value:async function _deleteCardAsync(e){let t=this.isNewCard?{title:"DIALOGS.CANCEL_CREATE_GOOGLE_EVENT_TITLE",confirm:"DIALOGS.CANCEL_CREATE_GOOGLE_EVENT_CONFIRM",error:"NOTIFICATIONS.DELETE_GOOGLE_EVENT_ERROR"}:{title:"DIALOGS.DELETE_GOOGLE_EVENT_TITLE",confirm:"DIALOGS.DELETE_GOOGLE_EVENT_CONFIRM",error:"NOTIFICATIONS.DELETE_GOOGLE_EVENT_ERROR"};if(!this.isNewCard||this.hasChanges){if(!await this._dialogSrv.showConfirmAsync(this._$translate.instant(t.title),this._$translate.instant(t.confirm),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE_EVENT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))return}this._logCardEvent(e),this._isDeleting=!0;try{this._appCommonSrv.setSchedulerBusy(!0),!this.isNewCard&&this.calendarCard.recurrenceRule&&(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(this.calendarCard.cardType,this.calendarCard)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this._deleteCardAsync.name})}})(),await this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}catch(e){this._$log.error("Planyway delete card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant(t.error),i.k$.Error),this._telemetrySrv.logError("Planyway delete card error",e,{class:this.constructor.name,method:this._deleteCardAsync.name})}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_logCardEvent",value:function _logCardEvent(e){e.data=controllers_CardEditorController_objectSpread({accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId,isAllDay:this.isAllDay,start:this.startDate,end:this.endDate},e.data),this._$scope.$emit(i.FK.CardDialogLogCardEventRequested,e)}},{kind:"method",key:"_keepScrollFocus",value:function _keepScrollFocus(){this._$scope.$emit(i.FK.CardDialogKeepScrollFocusRequested)}}]}}));function controllers_CardTooltipController_getDecoratorsApi(){controllers_CardTooltipController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!controllers_CardTooltipController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=controllers_CardTooltipController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:controllers_CardTooltipController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=controllers_CardTooltipController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function controllers_CardTooltipController_createElementDescriptor(e){var t,r=controllers_CardTooltipController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function controllers_CardTooltipController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function controllers_CardTooltipController_hasDecorators(e){return e.decorators&&e.decorators.length}function controllers_CardTooltipController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function controllers_CardTooltipController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function controllers_CardTooltipController_toPropertyKey(e){var t=function controllers_CardTooltipController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let br=function controllers_CardTooltipController_decorate(e,t,r,i){var n,a=controllers_CardTooltipController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function controllers_CardTooltipController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(controllers_CardTooltipController_isDataDescriptor(n.descriptor)||controllers_CardTooltipController_isDataDescriptor(i.descriptor)){if(controllers_CardTooltipController_hasDecorators(n)||controllers_CardTooltipController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(controllers_CardTooltipController_hasDecorators(n)){if(controllers_CardTooltipController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}controllers_CardTooltipController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,controllers_CardTooltipController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["appCommonSrv","googleIntegrationSrv","calendarCard"])],(function(e){return{F:class CardTooltipController{constructor(t,r,i){e(this),this._appCommonSrv=t,this._googleIntegrationSrv=r,this._calendarCard=i,this._googleCalendar=this._googleIntegrationSrv.getGoogleCalendarById(this._calendarCard.accountId,this._calendarCard.providerCard.googleCalendarId)}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleEventTooltipCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.Google)},{kind:"get",key:"cardTitle",value:function cardTitle(){return this._calendarCard.title}},{kind:"get",key:"hasDates",value:function hasDates(){return this._calendarCard.hasDates}},{kind:"get",key:"cardTimesText",value:function cardTimesText(){if(!this._calendarCard.hasDates)return;let e=this._calendarCard.realStart||this._calendarCard.start,t=this._calendarCard.realEnd||this._calendarCard.end,r=(0,U.KA)(e,t,!this.isAllDay);this._calendarCard.isAllDay&&(t=(0,U.E4)(t,1));let i=(0,U.bt)(e,t,this._appCommonSrv.getSchedulerWorkWeek()).minutes,n=(0,U.gG)(i);return n?`${r} (${n})`:r}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._calendarCard.isAllDay}},{kind:"get",key:"isRecurring",value:function isRecurring(){return this._calendarCard.isRecurring?this._calendarCard.isRecurring():!!this._calendarCard.recurrenceRule||!!this._calendarCard.recurrenceId}},{kind:"get",key:"isException",value:function isException(){return this._calendarCard.isException?this._calendarCard.isException():!!this._calendarCard.recurrenceId}},{kind:"get",key:"cardAccountId",value:function cardAccountId(){return this._calendarCard.accountId}},{kind:"get",key:"cardAccountName",value:function cardAccountName(){var e;return null===(e=this._provider.getAccountUser(this.cardAccountId))||void 0===e?void 0:e.fullName}},{kind:"get",key:"cardCalendarId",value:function cardCalendarId(){return this._calendarCard.providerCard.googleCalendarId}},{kind:"get",key:"cardCalendarName",value:function cardCalendarName(){var e;return null===(e=this._googleCalendar)||void 0===e?void 0:e.name}}]}}));function controllers_SidebarPanelController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function controllers_SidebarPanelController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=controllers_SidebarPanelController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=controllers_SidebarPanelController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function controllers_SidebarPanelController_getDecoratorsApi(){controllers_SidebarPanelController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!controllers_SidebarPanelController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=controllers_SidebarPanelController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:controllers_SidebarPanelController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=controllers_SidebarPanelController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function controllers_SidebarPanelController_createElementDescriptor(e){var t,r=controllers_SidebarPanelController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function controllers_SidebarPanelController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function controllers_SidebarPanelController_hasDecorators(e){return e.decorators&&e.decorators.length}function controllers_SidebarPanelController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function controllers_SidebarPanelController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function controllers_SidebarPanelController_toPropertyKey(e){var t=function controllers_SidebarPanelController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Dr=function controllers_SidebarPanelController_decorate(e,t,r,i){var n,a=controllers_SidebarPanelController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function controllers_SidebarPanelController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(controllers_SidebarPanelController_isDataDescriptor(n.descriptor)||controllers_SidebarPanelController_isDataDescriptor(i.descriptor)){if(controllers_SidebarPanelController_hasDecorators(n)||controllers_SidebarPanelController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(controllers_SidebarPanelController_hasDecorators(n)){if(controllers_SidebarPanelController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}controllers_SidebarPanelController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,controllers_SidebarPanelController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$rootScope","$scope","$translate","appCommonSrv","dialogSrv","googleIntegrationSrv","licenseSrv","planywayIntegrationSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class SidebarPanelController{constructor(t,r,n,a,o,s,l,c,d,u){var h=this;e(this),this._$rootScope=t,this._$scope=r,this._$translate=n,this._appCommonSrv=a,this._dialogSrv=o,this._googleIntegrationSrv=s,this._planywayIntegrationSrv=c,this._licenseSrv=l,this._telemetrySrv=d,this._collectionSrv=u,this._onGoogleCalendarChanged=()=>this._$scope.$evalAsync((()=>this._googleCalendars=null)),this._googleIntegrationSrv.addGoogleCalendarEventListener("added",this._onGoogleCalendarChanged),this._googleIntegrationSrv.addGoogleCalendarEventListener("updated",this._onGoogleCalendarChanged),this._googleIntegrationSrv.addGoogleCalendarEventListener("deleted",this._onGoogleCalendarChanged),this._googleIntegrationSrv.addGoogleCalendarEventListener("cleared",this._onGoogleCalendarChanged);const onSourceChanged=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.accountType&&t.accountType!==ee.Qm.Google||h._$scope.$evalAsync((()=>{if(h._accounts=null,h._googleCalendars=null,h._notifyGoogleCalendarsSelectionChanged(),e.name===i.FK.AccountAdded)h.addCalendarToCollectionAsync(void 0,t)}))};this._$scope.$on(i.FK.AccountAdded,onSourceChanged),this._$scope.$on(i.FK.AccountDeleted,onSourceChanged),this._$scope.$on(i.FK.CalendarsChanged,onSourceChanged),this._$scope.$on(i.FK.CollectionChanged,onSourceChanged),this._$scope.$on(i.FK.SingleCalendarSelectionRequested,((e,t)=>{let{accountType:r,accountId:i,calendarId:n}=t;if(r!==ee.Qm.Google)for(let e of this._provider.getCurrentCollectionConnectedAccountIds())this._changeCalendarsSelection(e,!1);else{for(let e of this.googleCalendars)e.isSelected=e.accountId===i&&e.id===n;this._saveCalendarsSelection(i)}})),this._$scope.$on("$destroy",(()=>{this._googleIntegrationSrv.removeGoogleCalendarEventListener("added",this._onGoogleCalendarChanged),this._googleIntegrationSrv.removeGoogleCalendarEventListener("updated",this._onGoogleCalendarChanged),this._googleIntegrationSrv.removeGoogleCalendarEventListener("deleted",this._onGoogleCalendarChanged),this._googleIntegrationSrv.removeGoogleCalendarEventListener("cleared",this._onGoogleCalendarChanged)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"googleSidebarPanelCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.Google)},{kind:"get",key:"accounts",value:function accounts(){var e;this._accounts||(this._accounts=x()(e=this._provider.getCurrentCollectionConnectedAccounts()).call(e,(e=>{let t=controllers_SidebarPanelController_objectSpread({},e);return F()(t,"isInvalid",{get:()=>this._provider.invalidAccountIds.has(e.accountId)}),t})));return this._accounts}},{kind:"method",key:"reconnectAccountAsync",value:function reconnectAccountAsync(e){this._googleIntegrationSrv.reconnectAccountAsync(e)}},{kind:"method",key:"disconnectAccountAsync",value:async function disconnectAccountAsync(e){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_TITLE"),this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_CONFIRM",{accountName:e.accountName}),{buttons:[{text:this._$translate.instant("BUTTONS.SIGN_OUT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]})){if(!await this._planywayIntegrationSrv.disconnectAccountAsync(e))return;this._telemetrySrv.logSessionEvent(i.cN.GeneralEvents.AccountDisconnected,{accountType:ee.Qm.Google}),await this._provider.removeAccountFromAllCollectionsAsync(e)}}},{kind:"method",key:"isAccountCollapsed",value:function isAccountCollapsed(e){return this._provider.isAccountCollapsed(e.accountId)}},{kind:"method",key:"toggleAccountCollapsed",value:function toggleAccountCollapsed(e){this._provider.toggleAccountCollapsed(e.accountId)}},{kind:"get",key:"isIntegrationBusy",value:function isIntegrationBusy(){return this._googleIntegrationSrv.isIntegrationBusy()}},{kind:"get",key:"canAddCalendarToCollection",value:function canAddCalendarToCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"addCalendarToCollectionAsync",value:async function addCalendarToCollectionAsync(e,t){this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogOpened,{accountType:ee.Qm.Google,where:i.Zz.Sidebar});let r=await this._dialogSrv.showManageAccountCalendarsDialogAsync(t,e);r?(this._$rootScope.$broadcast(i.FK.CalendarsChanging,t),r.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarAdded,{accountType:ee.Qm.Google,count:r.connectedCalendarIds.length}),r.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.Google,count:r.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:ee.Qm.Google,where:i.Zz.Sidebar})}},{kind:"method",key:"canSelectAllCalendars",value:function canSelectAllCalendars(e){var t;return q()(t=this.googleCalendars).call(t,(t=>t.accountId===e.accountId&&!t.isSelected))}},{kind:"method",key:"selectAllCalendars",value:function selectAllCalendars(e){this.canSelectAllCalendars(e)&&(e.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))&&(this._changeCalendarsSelection(e.accountId,!0),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedAll,{accountType:ee.Qm.Google,count:this.googleCalendars.length}))}},{kind:"method",key:"canSelectNoneCalendars",value:function canSelectNoneCalendars(e){var t;return q()(t=this.googleCalendars).call(t,(t=>t.accountId===e.accountId&&t.isSelected))}},{kind:"method",key:"selectNoneCalendars",value:function selectNoneCalendars(e){this.canSelectNoneCalendars(e)&&(this._changeCalendarsSelection(e.accountId,!1),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedNone,{accountType:ee.Qm.Google,count:0}))}},{kind:"get",key:"canRemoveAccountFromCollection",value:function canRemoveAccountFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeAccountFromCollection",value:function removeAccountFromCollection(e){this._provider.removeAccountFromCurrentCollectionAsync(e),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionAccountRemoved,{accountType:e.accountType})}},{kind:"get",key:"googleCalendars",value:function googleCalendars(){var e;this._googleCalendars||(this._googleCalendars=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return x()(t=this._provider.getCurrentCollectionConnectedCalendars(e)).call(t,(t=>controllers_SidebarPanelController_objectSpread(controllers_SidebarPanelController_objectSpread({},this._googleIntegrationSrv.getGoogleCalendarById(e,t.calendarId)),t)))})));return this._googleCalendars}},{kind:"method",key:"isGoogleCalendarBusy",value:function isGoogleCalendarBusy(e){return e.isSelected&&this._googleIntegrationSrv.isConnectedGoogleCalendarBusy(e.accountId,e.id)}},{kind:"method",key:"setCalendarSelection",value:function setCalendarSelection(e,t){if(e.isSelected!==t){if(t){if(!this._planywayIntegrationSrv.getConnectedAccountById(e.accountId).isPrimary&&!this._licenseSrv.checkPaidFeatureAvailable(i.ZV.GoogleConnect,!0))return}e.isSelected=t,this._telemetrySrv.logSessionEvent(t?i.cN.CollectionEvents.CollectionCalendarSelected:i.cN.CollectionEvents.CollectionCalendarDeselected,{accountType:ee.Qm.Google,count:1}),this._saveCalendarsSelection(e.accountId)}}},{kind:"method",key:"canShowOnlyThisCalendar",value:function canShowOnlyThisCalendar(e){return this.canSelectAllCalendars(e)||this.canSelectNoneCalendars(e)}},{kind:"method",key:"showOnlyThisCalendar",value:function showOnlyThisCalendar(e,t){this.canShowOnlyThisCalendar(e)&&(this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis,{accountType:ee.Qm.Google,count:1}),this._$rootScope.$broadcast(i.FK.SingleCalendarSelectionRequested,{accountType:ee.Qm.Google,accountId:e.accountId,calendarId:t.id}))}},{kind:"get",key:"canRemoveCalendarFromCollection",value:function canRemoveCalendarFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeCalendarFromCollection",value:function removeCalendarFromCollection(e,t){let r=this._provider.getCurrentCollectionConnectedCalendar(e.accountId,t.id);r.isConnected=!1,this._provider.setCurrentCollectionConnectedCalendars(e.accountId,[r]),this._$rootScope.$broadcast(i.FK.CalendarsChanging,e),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.Google,count:1})}},{kind:"method",key:"_changeCalendarsSelection",value:function _changeCalendarsSelection(e,t){for(let i of A()(r=this.googleCalendars).call(r,(t=>t.accountId===e))){var r;i.isSelected=t}this._saveCalendarsSelection(e)}},{kind:"method",key:"_saveCalendarsSelection",value:function _saveCalendarsSelection(e){var t,r;let i=x()(t=A()(r=this.googleCalendars).call(r,(t=>t.accountId===e))).call(t,(e=>controllers_SidebarPanelController_objectSpread(controllers_SidebarPanelController_objectSpread({},this._provider.getCurrentCollectionConnectedCalendar(e.accountId,e.calendarId)),{},{isSelected:e.isSelected})));this._provider.setCurrentCollectionConnectedCalendars(e,i),this._notifyGoogleCalendarsSelectionChanged()}},{kind:"method",key:"_notifyGoogleCalendarsSelectionChanged",value:function _notifyGoogleCalendarsSelectionChanged(){this._$rootScope.$broadcast(i.FK.CardsReloaded),this._$rootScope.$broadcast(i.FK.GoogleCalendarSelectionChanged),this._$rootScope.$broadcast(i.FK.ChangeSchedulerViewRequested),this._$rootScope.$broadcast(i.FK.WorkPanelReloaded),this._$rootScope.$broadcast(i.FK.TimelineResourcesReloaded,{resourcesType:i.y.Calendars})}}]}}));var Er=r(43286),Sr=r.n(Er);function directives_CalendarIconDirective_getDecoratorsApi(){directives_CalendarIconDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!directives_CalendarIconDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=directives_CalendarIconDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:directives_CalendarIconDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=directives_CalendarIconDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function directives_CalendarIconDirective_createElementDescriptor(e){var t,r=directives_CalendarIconDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function directives_CalendarIconDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function directives_CalendarIconDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function directives_CalendarIconDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function directives_CalendarIconDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function directives_CalendarIconDirective_toPropertyKey(e){var t=function directives_CalendarIconDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Ar=function directives_CalendarIconDirective_decorate(e,t,r,i){var n,a=directives_CalendarIconDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function directives_CalendarIconDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(directives_CalendarIconDirective_isDataDescriptor(n.descriptor)||directives_CalendarIconDirective_isDataDescriptor(i.descriptor)){if(directives_CalendarIconDirective_hasDecorators(n)||directives_CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(directives_CalendarIconDirective_hasDecorators(n)){if(directives_CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}directives_CalendarIconDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,directives_CalendarIconDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarIconDirective{constructor(){e(this),this.templateUrl=Sr(),this.restrict="E",this.controller=Kt.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarId:"@",accountId:"@",_iconSize:"@?iconSize"}}}return{F:CalendarIconDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGoogleCalendarIcon"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CalendarIconDirective}}]}}));var Ir=r(32618),Pr=r.n(Ir);function directives_CalendarPickerDirective_getDecoratorsApi(){directives_CalendarPickerDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!directives_CalendarPickerDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=directives_CalendarPickerDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:directives_CalendarPickerDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=directives_CalendarPickerDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function directives_CalendarPickerDirective_createElementDescriptor(e){var t,r=directives_CalendarPickerDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function directives_CalendarPickerDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function directives_CalendarPickerDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function directives_CalendarPickerDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function directives_CalendarPickerDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function directives_CalendarPickerDirective_toPropertyKey(e){var t=function directives_CalendarPickerDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Tr=function directives_CalendarPickerDirective_decorate(e,t,r,i){var n,a=directives_CalendarPickerDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function directives_CalendarPickerDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(directives_CalendarPickerDirective_isDataDescriptor(n.descriptor)||directives_CalendarPickerDirective_isDataDescriptor(i.descriptor)){if(directives_CalendarPickerDirective_hasDecorators(n)||directives_CalendarPickerDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(directives_CalendarPickerDirective_hasDecorators(n)){if(directives_CalendarPickerDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}directives_CalendarPickerDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,directives_CalendarPickerDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarPickerDirective{constructor(){e(this),this.templateUrl=Pr(),this.restrict="E",this.controller=Vt.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={account:"<",calendars:"=",filterText:"<"}}}return{F:CalendarPickerDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGoogleCalendarsPicker"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CalendarPickerDirective}}]}}));var xr=r(50442),Rr=r.n(xr);function directives_CardContextMenuDirective_getDecoratorsApi(){directives_CardContextMenuDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!directives_CardContextMenuDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=directives_CardContextMenuDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:directives_CardContextMenuDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=directives_CardContextMenuDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function directives_CardContextMenuDirective_createElementDescriptor(e){var t,r=directives_CardContextMenuDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function directives_CardContextMenuDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function directives_CardContextMenuDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function directives_CardContextMenuDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function directives_CardContextMenuDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function directives_CardContextMenuDirective_toPropertyKey(e){var t=function directives_CardContextMenuDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let $r=function directives_CardContextMenuDirective_decorate(e,t,r,i){var n,a=directives_CardContextMenuDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function directives_CardContextMenuDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(directives_CardContextMenuDirective_isDataDescriptor(n.descriptor)||directives_CardContextMenuDirective_isDataDescriptor(i.descriptor)){if(directives_CardContextMenuDirective_hasDecorators(n)||directives_CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(directives_CardContextMenuDirective_hasDecorators(n)){if(directives_CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}directives_CardContextMenuDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,directives_CardContextMenuDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CardContextMenuDirective{constructor(){e(this),this.templateUrl=Rr(),this.restrict="E",this.controller=tr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={onSetContextMenu:"<",_source:"<source"}}}return{F:CardContextMenuDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGoogleCardContextMenu"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CardContextMenuDirective}}]}}));var Lr=r(86055),Mr=r.n(Lr);class CardEditorDirective_CardEditorDirective{static get directiveName(){return"pwGoogleEventEditor"}static create(){return new CardEditorDirective_CardEditorDirective}constructor(){this.templateUrl=Mr(),this.restrict="E",this.controller=wr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarCard:"<",isDetailed:"<?",isDense:"<?",hasChanges:"<?",_forceDetailedMode:"<forceDetailedMode"}}link(e){e.$ctrl.initialize()}}var Nr=r(25021),Fr=r.n(Nr);function directives_SidebarPanelDirective_getDecoratorsApi(){directives_SidebarPanelDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!directives_SidebarPanelDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=directives_SidebarPanelDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:directives_SidebarPanelDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=directives_SidebarPanelDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function directives_SidebarPanelDirective_createElementDescriptor(e){var t,r=directives_SidebarPanelDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function directives_SidebarPanelDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function directives_SidebarPanelDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function directives_SidebarPanelDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function directives_SidebarPanelDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function directives_SidebarPanelDirective_toPropertyKey(e){var t=function directives_SidebarPanelDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Gr=function directives_SidebarPanelDirective_decorate(e,t,r,i){var n,a=directives_SidebarPanelDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function directives_SidebarPanelDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(directives_SidebarPanelDirective_isDataDescriptor(n.descriptor)||directives_SidebarPanelDirective_isDataDescriptor(i.descriptor)){if(directives_SidebarPanelDirective_hasDecorators(n)||directives_SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(directives_SidebarPanelDirective_hasDecorators(n)){if(directives_SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}directives_SidebarPanelDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,directives_SidebarPanelDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class SidebarPanelDirective{constructor(){e(this),this.templateUrl=Fr(),this.restrict="E",this.controller=Dr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={}}}return{F:SidebarPanelDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwGoogleSidebarPanel"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new SidebarPanelDirective}}]}}));const Or={services:[],controllers:[Kt,Vt,tr,wr,br,Dr],directives:[Ar,Tr,$r,CardEditorDirective_CardEditorDirective,Gr]};function controllers_CalendarIconController_getDecoratorsApi(){controllers_CalendarIconController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!controllers_CalendarIconController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=controllers_CalendarIconController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:controllers_CalendarIconController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=controllers_CalendarIconController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function controllers_CalendarIconController_createElementDescriptor(e){var t,r=controllers_CalendarIconController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function controllers_CalendarIconController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function controllers_CalendarIconController_hasDecorators(e){return e.decorators&&e.decorators.length}function controllers_CalendarIconController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function controllers_CalendarIconController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function controllers_CalendarIconController_toPropertyKey(e){var t=function controllers_CalendarIconController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let zr=function controllers_CalendarIconController_decorate(e,t,r,i){var n,a=controllers_CalendarIconController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function controllers_CalendarIconController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(controllers_CalendarIconController_isDataDescriptor(n.descriptor)||controllers_CalendarIconController_isDataDescriptor(i.descriptor)){if(controllers_CalendarIconController_hasDecorators(n)||controllers_CalendarIconController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(controllers_CalendarIconController_hasDecorators(n)){if(controllers_CalendarIconController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}controllers_CalendarIconController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,controllers_CalendarIconController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$scope","iCalIntegrationSrv"])],(function(e){return{F:class CalendarIconController{constructor(t,r){e(this),this._$scope=t,this._iCalIntegrationSrv=r,this._iconSize="small",this._$scope.$on("$destroy",(()=>{this._onICalCalendarUpdated&&(this._iCalIntegrationSrv.removeICalCalendarEventListener("updated",this._onICalCalendarUpdated),this._onICalCalendarUpdated=null)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"iCalCalendarIconCtrl"}},{kind:"get",key:"iconSize",value:function iconSize(){return this._iconSize}},{kind:"set",key:"calendarId",value:function calendarId(e){this._calendarId=e,this._loadCalendar()}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e,this._loadCalendar()}},{kind:"get",key:"calendarColor",value:function calendarColor(){return this._calendarColor}},{kind:"get",key:"iCalCalendarType",value:function iCalCalendarType(){return this._iCalCalendarType}},{kind:"method",key:"_loadCalendar",value:function _loadCalendar(){if(!this._calendarId||!this._accountId)return;let e=this._iCalIntegrationSrv.getICalCalendarById(this._accountId,this._calendarId);if(e){let t=e.color,r=e.type,i=this._calendarColor!==t||this._iCalCalendarType!==r;this._calendarColor=t,this._iCalCalendarType=r,i&&this._$scope.$broadcast("$$rebind::calendar")}this._onICalCalendarUpdated||(this._onICalCalendarUpdated=e=>{e.id===this._calendarId&&(this._loadCalendar(),this._$scope.$broadcast("$$rebind::calendar"))},this._iCalIntegrationSrv.addICalCalendarEventListener("updated",this._onICalCalendarUpdated))}}]}}));function scripts_controllers_CardContextMenuController_getDecoratorsApi(){scripts_controllers_CardContextMenuController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_controllers_CardContextMenuController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_controllers_CardContextMenuController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_controllers_CardContextMenuController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_controllers_CardContextMenuController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_controllers_CardContextMenuController_createElementDescriptor(e){var t,r=scripts_controllers_CardContextMenuController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_controllers_CardContextMenuController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_controllers_CardContextMenuController_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_controllers_CardContextMenuController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_controllers_CardContextMenuController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_controllers_CardContextMenuController_toPropertyKey(e){var t=function scripts_controllers_CardContextMenuController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let jr=function scripts_controllers_CardContextMenuController_decorate(e,t,r,i){var n,a=scripts_controllers_CardContextMenuController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_controllers_CardContextMenuController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_controllers_CardContextMenuController_isDataDescriptor(n.descriptor)||scripts_controllers_CardContextMenuController_isDataDescriptor(i.descriptor)){if(scripts_controllers_CardContextMenuController_hasDecorators(n)||scripts_controllers_CardContextMenuController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_controllers_CardContextMenuController_hasDecorators(n)){if(scripts_controllers_CardContextMenuController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_controllers_CardContextMenuController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_controllers_CardContextMenuController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["collectionSrv","licenseSrv"])],(function(e){return{F:class CardContextMenuController{constructor(t,r){e(this),this._collectionSrv=t,this._licenseSrv=r}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"iCalEventContextMenuCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.ICal)},{kind:"get",key:"source",value:function source(){return this._source}},{kind:"set",key:"source",value:function source(e){this._source=e}},{kind:"set",key:"onSetContextMenu",value:function onSetContextMenu(e){this._onSetContextMenu=e}},{kind:"get",key:"cardContextMenu",value:function cardContextMenu(){return this._cardContextMenu}},{kind:"method",key:"setCardContextMenu",value:function setCardContextMenu(e){this._cardContextMenu=e,this._onSetContextMenu({providerType:i.lP.ICal,menuController:this._cardContextMenu})}},{kind:"method",key:"isContextMenuItemAvailable",value:function isContextMenuItemAvailable(){if(!this.cardContextMenu)return!1;let e=this.cardContextMenu.pwData;if(!e)return!1;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return q()(r).call(r,(t=>{var r,i,n;if(!(null===(r=CardTypeMenuItems[e.cardType])||void 0===r?void 0:$()(r).call(r,t)))return!1;switch(t){case"copyAsTimeRecord":return q()(i=A()(n=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(n,(e=>e.timeTrackingCardType))).call(i,(e=>{var t;return q()(t=e.getCurrentCollectionConnectedAccountIds()).call(t,(t=>e.getCurrentCollectionSelectedCalendarIds(t).length>0))}));case"copyUrl":return!e.isTempCard}return!0}))}},{kind:"method",key:"copyCardAsTimeRecord",value:function copyCardAsTimeRecord(e){this._licenseSrv.checkPaidFeatureAvailable(i.ZV.TimeTracking,!0)&&this._provider.copyCardAsTimeRecordAsync(e)}},{kind:"method",key:"copyCardUrl",value:function copyCardUrl(e){this._provider.copyCardUrlAsync(e,{telemetry:{where:this._cardContextMenu.where,by:i.AH.ContextMenu}})}}]}}));r(32513);function scripts_controllers_CardEditorController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function scripts_controllers_CardEditorController_getDecoratorsApi(){scripts_controllers_CardEditorController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_controllers_CardEditorController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_controllers_CardEditorController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_controllers_CardEditorController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_controllers_CardEditorController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_controllers_CardEditorController_createElementDescriptor(e){var t,r=scripts_controllers_CardEditorController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_controllers_CardEditorController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_controllers_CardEditorController_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_controllers_CardEditorController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_controllers_CardEditorController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_controllers_CardEditorController_toPropertyKey(e){var t=function scripts_controllers_CardEditorController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Ur="copyUrl",Br={[ee.eT.ICalEvent]:[Ur]};let Hr=function scripts_controllers_CardEditorController_decorate(e,t,r,i){var n,a=scripts_controllers_CardEditorController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_controllers_CardEditorController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_controllers_CardEditorController_isDataDescriptor(n.descriptor)||scripts_controllers_CardEditorController_isDataDescriptor(i.descriptor)){if(scripts_controllers_CardEditorController_hasDecorators(n)||scripts_controllers_CardEditorController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_controllers_CardEditorController_hasDecorators(n)){if(scripts_controllers_CardEditorController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_controllers_CardEditorController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_controllers_CardEditorController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$element","$scope","$timeout","calendarCardsSrv","iCalIntegrationSrv","telemetrySrv"])],(function(e){return{F:class CardEditorController{constructor(t,r,n,a,o,s){e(this),this._$element=t,this._$scope=r,this._$timeout=n,this._calendarCardsSrv=a,this._iCalIntegrationSrv=o,this._telemetrySrv=s,this._$timeout((()=>{this._renderDelayed=!0,this._$scope.$broadcast("md-resize-textarea")}),150),this._$scope.$on("$destroy",(()=>{this._removeServiceListeners(),this._$scope.$emit(i.FK.CardDialogKeepScrollFocusRequested)})),this._registerEditor()}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"iCalEventEditorCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.ICal)},{kind:"field",key:"calendarCard",value:void 0},{kind:"field",key:"isDetailed",value:void 0},{kind:"field",key:"isDense",value:void 0},{kind:"method",key:"isCardButtonVisible",value:function isCardButtonVisible(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q()(t).call(t,(e=>{var t;return!!(null===(t=Br[this.calendarCard.cardType])||void 0===t?void 0:$()(t).call(t,e))&&(e!==Ur||!this.isNewCard)}))}},{kind:"method",key:"cancelDialog",value:function cancelDialog(){this.hideDialog(i.Xs.Cancelled)}},{kind:"get",key:"title",value:function title(){return this._title}},{kind:"get",key:"hasDates",value:function hasDates(){return this.calendarCard.hasDates}},{kind:"get",key:"isCardDatesYearShown",value:function isCardDatesYearShown(){return!(0,U.FT)(this.startDate,new Date)||!(0,U.FT)(this.endDate,new Date)}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"get",key:"startDate",value:function startDate(){return this._startDate}},{kind:"get",key:"endDate",value:function endDate(){return this._endDate}},{kind:"get",key:"isRecurringAvailable",value:function isRecurringAvailable(){return!(this.isReadOnly&&!this.recurrenceRule)&&(this.hasDates&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"get",key:"isRecurrentCard",value:function isRecurrentCard(){return!(!this.recurrenceRule&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"calendarColor",value:function calendarColor(){if(this.cardICalCalendar)return this._calendarColor||(this._calendarColor=this.cardICalCalendar.color),this._calendarColor}},{kind:"get",key:"cardICalCalendar",value:function cardICalCalendar(){return this._cardICalCalendar}},{kind:"method",key:"setCardICalCalendar",value:function setCardICalCalendar(e,t){this._cardICalCalendar=this._iCalIntegrationSrv.getICalCalendarById(e,t)}},{kind:"get",key:"isDescriptionAvailable",value:function isDescriptionAvailable(){return!this.isReadOnly||this.description}},{kind:"get",key:"description",value:function description(){return this._description}},{kind:"method",key:"switchDetailedModeAsync",value:async function switchDetailedModeAsync(){await new(Ae())((e=>this._$scope.$emit(i.FK.CardDialogSwitchDetailedModeRequested,{resolve:e}))),this._logCardEvent({event:i.cN.CardEvents.EditDialogModeChanged,data:{by:i.AH.Dialog,isDetailed:!this.isDetailed}})}},{kind:"method",key:"hideDialog",value:function hideDialog(e){this._$scope.$emit(i.FK.CardDialogHideRequested,{dialogResult:e})}},{kind:"method",key:"initialize",value:function initialize(){var e;if(this.calendarCard.cardType!==ee.eT.ICalEvent){const e=this._tmpAccountId||this.calendarCard.accountId;this._calendarCardsSrv.changeCalendarCardType(this.calendarCard,ee.eT.ICalEvent,e);const{title:t,isAllDay:r,start:i,end:n}=this.calendarCard;this.calendarCard.providerCard=this._provider.getCalendarCardClass().fromSourceCard(this.calendarCard.id,e,ee.eT.ICalEvent),this.calendarCard.title=t,this.calendarCard.isAllDay=r,this.calendarCard.start=i,this.calendarCard.end=n,this._tmpAccountId=null,this._tmpCalendarId=null}this.setCardICalCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.iCalCalendarId),this._title=this.calendarCard.title,this._isAllDay=this.calendarCard.isAllDay,this._startDate=this.calendarCard.start,this._endDate=this.calendarCard.end,this._recurrenceRule=this.calendarCard.recurrenceRule,this._description=null===(e=this.calendarCard.description)||void 0===e?void 0:be()(e).call(e),this._addServiceListeners()}},{kind:"get",key:"isBusy",value:function isBusy(){return this._isBusy}},{kind:"set",key:"isBusy",value:function isBusy(e){this._$scope.$evalAsync((()=>this._isBusy=e))}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return!0}},{kind:"get",key:"delayRender",value:function delayRender(){return!this._renderDelayed}},{kind:"method",key:"copyCardUrlAsync",value:function copyCardUrlAsync(){return this._provider.copyCardUrlAsync(this.calendarCard,{telemetry:{by:i.AH.DialogPanel}})}},{kind:"get",key:"_parentDialogController",value:function _parentDialogController(){return this._parentDialogControllerInternal||(this._parentDialogControllerInternal=(0,U.sO)(this._$scope,Te.Z)),this._parentDialogControllerInternal}},{kind:"method",key:"_registerEditor",value:function _registerEditor(){var e;null===(e=this._parentDialogController)||void 0===e||e.registerCardEditorControllerAsync(this)}},{kind:"get",key:"_tmpAccountId",value:function _tmpAccountId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpAccountId}},{kind:"set",key:"_tmpAccountId",value:function _tmpAccountId(e){this._parentDialogController&&(this._parentDialogController._tmpAccountId=e)}},{kind:"get",key:"_tmpCalendarId",value:function _tmpCalendarId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpCalendarId}},{kind:"set",key:"_tmpCalendarId",value:function _tmpCalendarId(e){this._parentDialogController&&(this._parentDialogController._tmpCalendarId=e)}},{kind:"method",key:"_addServiceListeners",value:function _addServiceListeners(){this._serviceEventsListenersAdded||(this._serviceEventsListenersAdded=!0,this._onAddOrUpdateCard=(e,t)=>{e.id===this.calendarCard.id&&this._addOrUpdateCard(e,t)},this._onDeleteCard=(e,t)=>{e.id===this.calendarCard.id&&(t.replacedWith?this._addOrUpdateCard(t.replacedWith,t):this._deleteCard())},this._calendarCardsSrv.addCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("deleted",this._onDeleteCard))}},{kind:"method",key:"_removeServiceListeners",value:function _removeServiceListeners(){this._serviceEventsListenersAdded&&(this._serviceEventsListenersAdded=!1,this._calendarCardsSrv.removeCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("deleted",this._onDeleteCard))}},{kind:"method",key:"_addOrUpdateCard",value:function _addOrUpdateCard(e,t){this.calendarCard=e.isTempCard?e:e.clone(),this._$scope.$evalAsync((()=>{var r;(this._isAllDay=e.isAllDay,this._startDate=e.start,this._endDate=e.end,this._recurrenceRule=e.recurrenceRule,t.hasExternalChanges)&&(this._title=e.title,this._description=null===(r=e.description)||void 0===r?void 0:be()(r).call(r))}))}},{kind:"method",key:"_deleteCard",value:function _deleteCard(){this.hideDialog(i.Xs.CardDeleted)}},{kind:"method",key:"_logCardEvent",value:function _logCardEvent(e){e.data=function scripts_controllers_CardEditorController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=scripts_controllers_CardEditorController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=scripts_controllers_CardEditorController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}({accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId},e.data),this._$scope.$emit(i.FK.CardDialogLogCardEventRequested,e)}}]}}));function scripts_controllers_CardTooltipController_getDecoratorsApi(){scripts_controllers_CardTooltipController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_controllers_CardTooltipController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_controllers_CardTooltipController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_controllers_CardTooltipController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_controllers_CardTooltipController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_controllers_CardTooltipController_createElementDescriptor(e){var t,r=scripts_controllers_CardTooltipController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_controllers_CardTooltipController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_controllers_CardTooltipController_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_controllers_CardTooltipController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_controllers_CardTooltipController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_controllers_CardTooltipController_toPropertyKey(e){var t=function scripts_controllers_CardTooltipController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Kr=function scripts_controllers_CardTooltipController_decorate(e,t,r,i){var n,a=scripts_controllers_CardTooltipController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_controllers_CardTooltipController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_controllers_CardTooltipController_isDataDescriptor(n.descriptor)||scripts_controllers_CardTooltipController_isDataDescriptor(i.descriptor)){if(scripts_controllers_CardTooltipController_hasDecorators(n)||scripts_controllers_CardTooltipController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_controllers_CardTooltipController_hasDecorators(n)){if(scripts_controllers_CardTooltipController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_controllers_CardTooltipController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_controllers_CardTooltipController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["appCommonSrv","iCalIntegrationSrv","calendarCard"])],(function(e){return{F:class CardTooltipController{constructor(t,r,i){e(this),this._appCommonSrv=t,this._iCalIntegrationSrv=r,this._calendarCard=i,this._iCalCalendar=this._iCalIntegrationSrv.getICalCalendarById(this._calendarCard.accountId,this._calendarCard.providerCard.iCalCalendarId)}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"iCalEventTooltipCtrl"}},{kind:"get",key:"cardTitle",value:function cardTitle(){return this._calendarCard.title}},{kind:"get",key:"hasDates",value:function hasDates(){return this._calendarCard.hasDates}},{kind:"get",key:"cardTimesText",value:function cardTimesText(){if(!this._calendarCard.hasDates)return;let e=this._calendarCard.realStart||this._calendarCard.start,t=this._calendarCard.realEnd||this._calendarCard.end,r=(0,U.KA)(e,t,!this.isAllDay);this._calendarCard.isAllDay&&(t=(0,U.E4)(t,1));let i=(0,U.bt)(e,t,this._appCommonSrv.getSchedulerWorkWeek()).minutes,n=(0,U.gG)(i);return n?`${r} (${n})`:r}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._calendarCard.isAllDay}},{kind:"get",key:"isRecurring",value:function isRecurring(){return this._calendarCard.isRecurring?this._calendarCard.isRecurring():!!this._calendarCard.recurrenceRule||!!this._calendarCard.recurrenceId}},{kind:"get",key:"isException",value:function isException(){return this._calendarCard.isException?this._calendarCard.isException():!!this._calendarCard.recurrenceId}},{kind:"get",key:"cardAccountId",value:function cardAccountId(){return this._calendarCard.accountId}},{kind:"get",key:"cardCalendarId",value:function cardCalendarId(){return this._calendarCard.providerCard.iCalCalendarId}},{kind:"get",key:"cardCalendarName",value:function cardCalendarName(){var e;return null===(e=this._iCalCalendar)||void 0===e?void 0:e.name}}]}}));function scripts_controllers_SidebarPanelController_ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=A()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function scripts_controllers_SidebarPanelController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,a=null!=arguments[t]?arguments[t]:{};t%2?O()(r=scripts_controllers_SidebarPanelController_ownKeys(Object(a),!0)).call(r,(function(t){(0,n.Z)(e,t,a[t])})):w()?D()(e,w()(a)):O()(i=scripts_controllers_SidebarPanelController_ownKeys(Object(a))).call(i,(function(t){F()(e,t,_()(a,t))}))}return e}function scripts_controllers_SidebarPanelController_getDecoratorsApi(){scripts_controllers_SidebarPanelController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_controllers_SidebarPanelController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_controllers_SidebarPanelController_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_controllers_SidebarPanelController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_controllers_SidebarPanelController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_controllers_SidebarPanelController_createElementDescriptor(e){var t,r=scripts_controllers_SidebarPanelController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_controllers_SidebarPanelController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_controllers_SidebarPanelController_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_controllers_SidebarPanelController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_controllers_SidebarPanelController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_controllers_SidebarPanelController_toPropertyKey(e){var t=function scripts_controllers_SidebarPanelController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Vr=function scripts_controllers_SidebarPanelController_decorate(e,t,r,i){var n,a=scripts_controllers_SidebarPanelController_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_controllers_SidebarPanelController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_controllers_SidebarPanelController_isDataDescriptor(n.descriptor)||scripts_controllers_SidebarPanelController_isDataDescriptor(i.descriptor)){if(scripts_controllers_SidebarPanelController_hasDecorators(n)||scripts_controllers_SidebarPanelController_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_controllers_SidebarPanelController_hasDecorators(n)){if(scripts_controllers_SidebarPanelController_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_controllers_SidebarPanelController_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_controllers_SidebarPanelController_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,U.SG)(["$rootScope","$scope","$translate","appCommonSrv","dialogSrv","iCalIntegrationSrv","planywayIntegrationSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class SidebarPanelController{constructor(t,r,n,a,o,s,l,c,d){var u=this;e(this),this._$rootScope=t,this._$scope=r,this._$translate=n,this._appCommonSrv=a,this._dialogSrv=o,this._iCalIntegrationSrv=s,this._planywayIntegrationSrv=l,this._telemetrySrv=c,this._collectionSrv=d,this._onICalCalendarChanged=()=>this._$scope.$evalAsync((()=>this._iCalCalendars=null)),this._iCalIntegrationSrv.addICalCalendarEventListener("added",this._onICalCalendarChanged),this._iCalIntegrationSrv.addICalCalendarEventListener("updated",this._onICalCalendarChanged),this._iCalIntegrationSrv.addICalCalendarEventListener("deleted",this._onICalCalendarChanged),this._iCalIntegrationSrv.addICalCalendarEventListener("cleared",this._onICalCalendarChanged);const onSourceChanged=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.accountType&&t.accountType!==ee.Qm.ICal||u._$scope.$evalAsync((()=>{u._accounts=null,u._iCalCalendars=null,u._notifyICalCalendarsSelectionChanged()}))};this._$scope.$on(i.FK.AccountAdded,onSourceChanged),this._$scope.$on(i.FK.AccountDeleted,onSourceChanged),this._$scope.$on(i.FK.CalendarsChanged,onSourceChanged),this._$scope.$on(i.FK.CollectionChanged,onSourceChanged),this._$scope.$on(i.FK.SingleCalendarSelectionRequested,((e,t)=>{let{accountType:r,accountId:i,calendarId:n}=t;if(r!==ee.Qm.ICal)this._changeCalendarsSelection(!1);else{for(let e of this.iCalCalendars)e.isSelected=e.accountId===i&&e.id===n;this._saveCalendarsSelection(i)}})),this._$scope.$on("$destroy",(()=>{this._iCalIntegrationSrv.removeICalCalendarEventListener("added",this._onICalCalendarChanged),this._iCalIntegrationSrv.removeICalCalendarEventListener("updated",this._onICalCalendarChanged),this._iCalIntegrationSrv.removeICalCalendarEventListener("deleted",this._onICalCalendarChanged),this._iCalIntegrationSrv.removeICalCalendarEventListener("cleared",this._onICalCalendarChanged)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"iCalSidebarPanelCtrl"}},{kind:"field",key:"_provider",value:()=>(0,z.VH)(i.lP.ICal)},{kind:"get",key:"accounts",value:function accounts(){return this._accounts||(this._accounts=this._provider.getCurrentCollectionConnectedAccounts()),this._accounts}},{kind:"method",key:"isAccountCollapsed",value:function isAccountCollapsed(){return this._provider.isAccountCollapsed("otherCalendars")}},{kind:"method",key:"toggleAccountCollapsed",value:function toggleAccountCollapsed(){this._provider.toggleAccountCollapsed("otherCalendars")}},{kind:"method",key:"canSelectAllCalendars",value:function canSelectAllCalendars(){var e;return q()(e=this.iCalCalendars).call(e,(e=>!e.isSelected))}},{kind:"method",key:"selectAllCalendars",value:function selectAllCalendars(){this.canSelectAllCalendars()&&(this._changeCalendarsSelection(!0),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedAll,{accountType:ee.Qm.ICal,count:this.iCalCalendars.length}))}},{kind:"method",key:"canSelectNoneCalendars",value:function canSelectNoneCalendars(){var e;return q()(e=this.iCalCalendars).call(e,(e=>e.isSelected))}},{kind:"method",key:"selectNoneCalendars",value:function selectNoneCalendars(){this.canSelectNoneCalendars()&&(this._changeCalendarsSelection(!1),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedNone,{accountType:ee.Qm.ICal,count:0}))}},{kind:"get",key:"iCalCalendars",value:function iCalCalendars(){var e;this._iCalCalendars||(this._iCalCalendars=P()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return x()(t=this._provider.getCurrentCollectionConnectedCalendars(e)).call(t,(t=>scripts_controllers_SidebarPanelController_objectSpread(scripts_controllers_SidebarPanelController_objectSpread({},this._iCalIntegrationSrv.getICalCalendarById(e,t.calendarId)),t)))})));return this._iCalCalendars}},{kind:"method",key:"isICalCalendarBusy",value:function isICalCalendarBusy(e){return e.isSelected&&this._iCalIntegrationSrv.isConnectedICalCalendarBusy(e.accountId,e.id)}},{kind:"method",key:"isICalCalendarInvalid",value:function isICalCalendarInvalid(e){return this._iCalIntegrationSrv.isConnectedICalCalendarInvalid(e.accountId,e.id)}},{kind:"method",key:"setCalendarSelection",value:function setCalendarSelection(e,t){e.isSelected!==t&&(e.isSelected=t,this._telemetrySrv.logSessionEvent(t?i.cN.CollectionEvents.CollectionCalendarSelected:i.cN.CollectionEvents.CollectionCalendarDeselected,{accountType:ee.Qm.ICal,count:1}),this._saveCalendarsSelection(e.accountId))}},{kind:"method",key:"canShowOnlyThisCalendar",value:function canShowOnlyThisCalendar(){return this.canSelectAllCalendars()||this.canSelectNoneCalendars()}},{kind:"method",key:"showOnlyThisCalendar",value:function showOnlyThisCalendar(e){this.canShowOnlyThisCalendar()&&(this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis,{accountType:ee.Qm.ICal,count:1}),this._$rootScope.$broadcast(i.FK.SingleCalendarSelectionRequested,{accountType:ee.Qm.ICal,accountId:e.accountId,calendarId:e.id}))}},{kind:"method",key:"canEditCalendar",value:function canEditCalendar(){return!0}},{kind:"method",key:"editCalendarAsync",value:function editCalendarAsync(e){this._telemetrySrv.logSessionEvent(i.cN.CalendarEvents.ICalEditOpened),this._dialogSrv.showICalEditDialogAsync(e)}},{kind:"get",key:"canRemoveCalendarFromCollection",value:function canRemoveCalendarFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeCalendarFromCollection",value:function removeCalendarFromCollection(e){this._provider.removeAccountFromCurrentCollectionAsync(e),this._telemetrySrv.logSessionEvent(i.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ee.Qm.ICal,count:1})}},{kind:"method",key:"disconnectCalendarAsync",value:async function disconnectCalendarAsync(e){let t=this._planywayIntegrationSrv.getConnectedAccountById(e.accountId);await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_TITLE"),this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_CONFIRM",{accountName:t.accountName}),{buttons:[{text:this._$translate.instant("BUTTONS.SIGN_OUT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]})&&await this._iCalIntegrationSrv.disconnectAccountAsync(t)&&(this._telemetrySrv.logSessionEvent(i.cN.GeneralEvents.AccountDisconnected,{accountType:ee.Qm.ICal}),this._provider.removeAccountFromAllCollectionsAsync(t))}},{kind:"method",key:"_changeCalendarsSelection",value:function _changeCalendarsSelection(e){for(let t of this.iCalCalendars)t.isSelected=e,this._saveCalendarsSelection(t.accountId)}},{kind:"method",key:"_saveCalendarsSelection",value:function _saveCalendarsSelection(e){var t;let r=x()(t=this.iCalCalendars).call(t,(e=>scripts_controllers_SidebarPanelController_objectSpread(scripts_controllers_SidebarPanelController_objectSpread({},this._provider.getCurrentCollectionConnectedCalendar(e.accountId,e.calendarId)),{},{isSelected:e.isSelected})));this._provider.setCurrentCollectionConnectedCalendars(e,r),this._notifyICalCalendarsSelectionChanged()}},{kind:"method",key:"_notifyICalCalendarsSelectionChanged",value:function _notifyICalCalendarsSelectionChanged(){this._$rootScope.$broadcast(i.FK.CardsReloaded),this._$rootScope.$broadcast(i.FK.TimelineResourcesReloaded,{resourcesType:i.y.Calendars})}}]}}));var Wr=r(51732),Zr=r.n(Wr);function scripts_directives_CalendarIconDirective_getDecoratorsApi(){scripts_directives_CalendarIconDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_directives_CalendarIconDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_directives_CalendarIconDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_directives_CalendarIconDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_directives_CalendarIconDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_directives_CalendarIconDirective_createElementDescriptor(e){var t,r=scripts_directives_CalendarIconDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_directives_CalendarIconDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_directives_CalendarIconDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_directives_CalendarIconDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_directives_CalendarIconDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_directives_CalendarIconDirective_toPropertyKey(e){var t=function scripts_directives_CalendarIconDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let qr=function scripts_directives_CalendarIconDirective_decorate(e,t,r,i){var n,a=scripts_directives_CalendarIconDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_directives_CalendarIconDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_directives_CalendarIconDirective_isDataDescriptor(n.descriptor)||scripts_directives_CalendarIconDirective_isDataDescriptor(i.descriptor)){if(scripts_directives_CalendarIconDirective_hasDecorators(n)||scripts_directives_CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_directives_CalendarIconDirective_hasDecorators(n)){if(scripts_directives_CalendarIconDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_directives_CalendarIconDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_directives_CalendarIconDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarIconDirective{constructor(){e(this),this.templateUrl=Zr(),this.restrict="E",this.controller=zr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarId:"@",accountId:"@",_iconSize:"@?iconSize"}}}return{F:CalendarIconDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwIcalCalendarIcon"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CalendarIconDirective}}]}}));var Qr=r(64890),Yr=r.n(Qr);function scripts_directives_CardContextMenuDirective_getDecoratorsApi(){scripts_directives_CardContextMenuDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_directives_CardContextMenuDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_directives_CardContextMenuDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_directives_CardContextMenuDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_directives_CardContextMenuDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_directives_CardContextMenuDirective_createElementDescriptor(e){var t,r=scripts_directives_CardContextMenuDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_directives_CardContextMenuDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_directives_CardContextMenuDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_directives_CardContextMenuDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_directives_CardContextMenuDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_directives_CardContextMenuDirective_toPropertyKey(e){var t=function scripts_directives_CardContextMenuDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Xr=function scripts_directives_CardContextMenuDirective_decorate(e,t,r,i){var n,a=scripts_directives_CardContextMenuDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_directives_CardContextMenuDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_directives_CardContextMenuDirective_isDataDescriptor(n.descriptor)||scripts_directives_CardContextMenuDirective_isDataDescriptor(i.descriptor)){if(scripts_directives_CardContextMenuDirective_hasDecorators(n)||scripts_directives_CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_directives_CardContextMenuDirective_hasDecorators(n)){if(scripts_directives_CardContextMenuDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_directives_CardContextMenuDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_directives_CardContextMenuDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CardContextMenuDirective{constructor(){e(this),this.templateUrl=Yr(),this.restrict="E",this.controller=jr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={onSetContextMenu:"<",_source:"<source"}}}return{F:CardContextMenuDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwIcalCardContextMenu"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new CardContextMenuDirective}}]}}));var Jr=r(21041),ei=r.n(Jr);class directives_CardEditorDirective_CardEditorDirective{static get directiveName(){return"pwIcalEventEditor"}static create(){return new directives_CardEditorDirective_CardEditorDirective}constructor(){this.templateUrl=ei(),this.restrict="E",this.controller=Hr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarCard:"<",isDetailed:"<?",isDense:"<?"}}link(e){e.$ctrl.initialize()}}var ti=r(5286),ri=r.n(ti);function scripts_directives_SidebarPanelDirective_getDecoratorsApi(){scripts_directives_SidebarPanelDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;O()(r=["method","field"]).call(r,(function(r){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}F()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!scripts_directives_SidebarPanelDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return F()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=scripts_directives_SidebarPanelDirective_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:scripts_directives_SidebarPanelDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return F()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=scripts_directives_SidebarPanelDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function scripts_directives_SidebarPanelDirective_createElementDescriptor(e){var t,r=scripts_directives_SidebarPanelDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function scripts_directives_SidebarPanelDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function scripts_directives_SidebarPanelDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function scripts_directives_SidebarPanelDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function scripts_directives_SidebarPanelDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function scripts_directives_SidebarPanelDirective_toPropertyKey(e){var t=function scripts_directives_SidebarPanelDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[o()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let ii=function scripts_directives_SidebarPanelDirective_decorate(e,t,r,i){var n,a=scripts_directives_SidebarPanelDirective_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function scripts_directives_SidebarPanelDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=M()(t).call(t,isSameElement)))if(scripts_directives_SidebarPanelDirective_isDataDescriptor(n.descriptor)||scripts_directives_SidebarPanelDirective_isDataDescriptor(i.descriptor)){if(scripts_directives_SidebarPanelDirective_hasDecorators(n)||scripts_directives_SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(scripts_directives_SidebarPanelDirective_hasDecorators(n)){if(scripts_directives_SidebarPanelDirective_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}scripts_directives_SidebarPanelDirective_coalesceGetterSetter(n,i)}else t.push(n)}return t}(x()(n=s.d).call(n,scripts_directives_SidebarPanelDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class SidebarPanelDirective{constructor(){e(this),this.templateUrl=ri(),this.restrict="E",this.controller=Vr.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={}}}return{F:SidebarPanelDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwIcalSidebarPanel"}},{kind:"method",decorators:[(0,U.SG)([])],static:!0,key:"create",value:function create(){return new SidebarPanelDirective}}]}}));const ni={services:[],controllers:[zr,jr,Hr,Kr,Vr],directives:[qr,Xr,directives_CardEditorDirective_CardEditorDirective,ii]};var ai=r(25913),oi=r(5137);const si={[i.lP.GitHub]:Ht,[i.lP.Google]:Or,[i.lP.ICal]:ni,[i.lP.Outlook]:ai.Z,[i.lP.Trello]:oi.Z};function getProviderDependencies(e){let t=si[e];if(!t)throw TypeError(`Unable to find provider of type "${e}"`);return t}},43603:(e,t,r)=>{r.d(t,{V:()=>C});r(52020),r(88546),r(99595),r(66775),r(2201),r(57445),r(10349),r(88946),r(73324),r(62079),r(66924),r(35704),r(39290),r(27525),r(35820),r(86981),r(8244),r(23513),r(54847),r(87994),r(91829),r(76555),r(89221),r(78490),r(90869);var i=r(82617),n=(r(46930),r(8937));r(20115),r(29704),r(15985),r(45911),r(47436);const a='<g fill="none"><path d="M9.348 3.723l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm0-1A5 5 0 106 1a5 5 0 000 10z" fill="\\#8b8e93"/></g>',o='<g fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm3.348-8.277l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/></g>',s="\n# if (!hiddenElements.cardNumber) { #\n# if (data.providerCard.cardNumber) { #\n    #: '\\#' + data.providerCard.cardNumber + ' ' #\n# } #\n# } #\n",l='\n# var cardMembers = cardProvider.getCardMembers(data); #\n# if (cardMembers.length > 0 && (!hiddenElements.membersIcon)) { #\n<div class="pw-card__icons">\n    # if (cardMembers.length === 1) { #\n        # var cardMember = cardMembers[0]; #\n        # if (cardMember.avatarUrl) {#\n        <div class="pw-card__members pw-member-avatar">\n            <img\n                class="pw-member-avatar__image"\n                src="#= cardMember.avatarUrl #"\n            >\n        </div>\n        # } #\n    # } else if (cardMembers.length > 1) { #\n    <div class="pw-card__members mdi mdi-account-multiple"></div>\n    # } #\n</div>\n# } #\n',c='\n# if (!hiddenElements.calendar) { #\n# var calendarName = cardProvider.getCardCalendarName(data) #\n# if (calendarName) { #\n<div class="pw-card__calendar">\n    #: calendarName #\n</div>\n# } #\n# } #\n',d='\n# if (!hiddenElements.status) { #\n# if (status) { #\n<div class="pw-card__status">\n    #: status.name #\n</div>\n# } #\n# } #\n',u=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n# var status = cardProvider.getCardStatusField(data); #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${o}</svg>\n    <svg width="12px" height="12px">${a}</svg>\n</div>\n\n<div class="pw-card__content pw-js-card-content">\n    ${l}\n\n    <div class="pw-card__title pw-js-card-title">\n        \x3c!-- Нет переносов для правильной работы text-decoration: line-through --\x3e\n        <span class="pw-card__title-text">${s} #: data.title || data.noTitle #</span>\n    </div>\n\n    <div class="pw-card__details">\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n\n        ${c}\n        # if (!hiddenElements.calendar && !hiddenElements.status && data.accountId && data.calendarId && status) { #\n        <p class="pw-card__divider"> /</p>\n        # } #\n        ${d}\n    </div>\n`,h=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n# var status = cardProvider.getCardStatusField(data); #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${o}</svg>\n    <svg width="12px" height="12px">${a}</svg>\n</div>\n\n# if (data.timeShortText) { #\n<span class="pw-card__time pw-card__time-short pw-js-card-time-short">#: data.timeShortText #</span>\n# } #\n\n<div class="pw-card__content pw-js-card-content">\n    ${l}\n\n    <div class="pw-card__title pw-js-card-title">\n        \x3c!-- Нет переносов для правильной работы text-decoration: line-through --\x3e\n        <span class="pw-card__title-text">${s} #: data.title || data.noTitle #</span>\n    </div>\n\n    # if (!hiddenElements.calendar || !hiddenElements.status || !hiddenElements.dates) { #\n    <div class="pw-card__details">\n        # if (!hiddenElements.dates && data.timeDateText) { #\n        <span class="pw-card__time pw-js-card-time-date">#: data.timeDateText #</span>\n        # } else { #\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n        # } #\n\n        ${c}\n        # if (!hiddenElements.calendar && !hiddenElements.status && data.accountId && data.calendarId && status) { #\n        <p class="pw-card__divider"> /</p>\n        # } #\n        ${d}\n    </div>\n    # } #\n</div>\n`;kendo.template(u,{useWithBlock:!1}),kendo.template(h,{useWithBlock:!1});var p=r(84705),v=r.n(p);const m=v()('\n<div\n    class="pw-calendar-icon pw-calendar-icon--github-project pw-calendar-icon--github-project_normal"\n>\n    <svg width="24" height="24"><path d="M3 4.16667C3 3.52267 3.52267 3 4.16667 3H19.8333C20.4773 3 21 3.52267 21 4.16667L21 19.8333C21 20.1428 20.8771 20.4395 20.6583 20.6583C20.4395 20.8771 20.1428 21 19.8333 21H4.16668C3.85726 21 3.56051 20.8771 3.34172 20.6583C3.12293 20.4395 3.00001 20.1428 3.00001 19.8333L3 4.16667ZM9.00001 8.99999V20H19.8333C19.8776 20 19.9199 19.9824 19.9512 19.9512C19.9825 19.9199 20 19.8775 20 19.8333V8.99999H9.00001ZM20 7.99999L20 4.16667C20 4.12246 19.9824 4.08007 19.9512 4.04882C19.9199 4.01756 19.8775 4 19.8333 4H9L9.00001 7.99999H20ZM4.00001 8.99999V19.8333C4.00001 19.9253 4.07468 20 4.16668 20H8.00001V8.99999H4.00001ZM8.00001 7.99999L8 4H4.16667C4.12246 4 4.08007 4.01756 4.04882 4.04882C4.01756 4.08007 4 4.12246 4 4.16667L4.00001 7.99999H8.00001Z" fill="\\#212121"/></svg>\n</div>\n').call('\n<div\n    class="pw-calendar-icon pw-calendar-icon--github-project pw-calendar-icon--github-project_normal"\n>\n    <svg width="24" height="24"><path d="M3 4.16667C3 3.52267 3.52267 3 4.16667 3H19.8333C20.4773 3 21 3.52267 21 4.16667L21 19.8333C21 20.1428 20.8771 20.4395 20.6583 20.6583C20.4395 20.8771 20.1428 21 19.8333 21H4.16668C3.85726 21 3.56051 20.8771 3.34172 20.6583C3.12293 20.4395 3.00001 20.1428 3.00001 19.8333L3 4.16667ZM9.00001 8.99999V20H19.8333C19.8776 20 19.9199 19.9824 19.9512 19.9512C19.9825 19.9199 20 19.8775 20 19.8333V8.99999H9.00001ZM20 7.99999L20 4.16667C20 4.12246 19.9824 4.08007 19.9512 4.04882C19.9199 4.01756 19.8775 4 19.8333 4H9L9.00001 7.99999H20ZM4.00001 8.99999V19.8333C4.00001 19.9253 4.07468 20 4.16668 20H8.00001V8.99999H4.00001ZM8.00001 7.99999L8 4H4.16667C4.12246 4 4.08007 4.01756 4.04882 4.04882C4.01756 4.08007 4 4.12246 4 4.16667L4.00001 7.99999H8.00001Z" fill="\\#212121"/></svg>\n</div>\n'),f=v()('\n<div class="pw-timeline-resource__label-point" style="background-color: #= data.resourceData.color.base #"></div>\n<div class="pw-timeline-resource__name pw-timeline-resource__label-name" style="color: #= data.resourceData.color.dark #">\n    #: data.name #\n</div>\n').call('\n<div class="pw-timeline-resource__label-point" style="background-color: #= data.resourceData.color.base #"></div>\n<div class="pw-timeline-resource__name pw-timeline-resource__label-name" style="color: #= data.resourceData.color.dark #">\n    #: data.name #\n</div>\n');kendo.template(m,{useWithBlock:!1}),kendo.template(f,{useWithBlock:!1});r(20750),r(89409);const C={[i.eT.GitHubCard]:[n.VD.D,n.VD.E,n.VD.L,n.VD.M,n.VD.Space,n.VD.Delete,n.VD.Backspace]}},79319:(e,t,r)=>{r.d(t,{s:()=>P});var i=r(40024),n=r.n(i),a=r(88946),o=r.n(a),s=r(99595),l=r.n(s),c=r(57445),d=r.n(c),u=r(51791),h=r.n(u),p=r(90143),v=r.n(p),m=r(56626),f=r.n(m),C=r(67552),y=r.n(C),g=r(26881),_=r(86981),k=r.n(_),w=r(91829),b=r.n(w),D=r(84705),E=r.n(D),S=r(8937),A=r(29704),I=r(56777);r(43603);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;l()(r=["method","field"]).call(r,(function(r){l()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;l()(r=["method","field"]).call(r,(function(r){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}d()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==h()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(s)||s);e=l.element,this.addElementPlacement(e,t),l.finisher&&i.push(l.finisher);var c=l.extras;if(c){for(var d=0;d<c.length;d++)this.addElementPlacement(c[d],t);r.push.apply(r,c)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return d()(t,f(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:y()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return d()(t,f(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let P=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var s=0;s<i.length;s++)a=i[s](a);var l=t((function initialize(e){a.initializeInstanceElements(e,c.elements)}),r),c=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=k()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(o()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,c.elements),a.runClassFinishers(l.F,c.finishers)}([(0,A.SG)(["$rootScope","$scope","$log","$translate","$window","$mdDialog","appCommonSrv","dialogSrv","githubCardsSrv","githubIntegrationSrv","notificationSrv","planywayIntegrationSrv","settingsSrv","telemetrySrv","account","project"])],(function(e){return{F:class ProjectDialogController{constructor(t,r,i,n,a,o,s,l,c,d,u,h,p,v,m,f){var C,y,g,_;(e(this),this._$rootScope=t,this._$scope=r,this._$log=i,this._$translate=n,this._$window=a,this._$mdDialog=o,this._appCommonSrv=s,this._dialogSrv=l,this._githubCardsSrv=c,this._githubIntegrationSrv=d,this._notificationSrv=u,this._planywayIntegrationSrv=h,this._settingsSrv=p,this._telemetrySrv=v,this._account=m,this._project=f,f)?(this._name=f.name,this._description=f.description,this.permissionLevel=k()(C=this.permissionLevels).call(C,(e=>e.public===f.public)),this.organization=k()(y=this.organizations).call(y,(e=>{var t;return b()(t=e.projectsIds).call(t,f.id)}))):(this.permissionLevel=k()(g=this.permissionLevels).call(g,(e=>!e.public)),this.organization=k()(_=this.organizations).call(_,(e=>e.viewerCanCreateProjects)))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"githubProjectDialogCtrl"}},{kind:"field",key:"_provider",value:()=>(0,I.VH)(S.lP.GitHub)},{kind:"get",key:"isBusy",value:function isBusy(){return this._isBusy}},{kind:"set",key:"isBusy",value:function isBusy(e){this._$scope.$evalAsync((()=>this._isBusy=e))}},{kind:"get",key:"isNewProject",value:function isNewProject(){return!this._project}},{kind:"get",key:"canEditProject",value:function canEditProject(){return this.isNewProject||!this._project.isReadOnly}},{kind:"get",key:"permissionLevels",value:function permissionLevels(){return this._permissionLevels||(this._permissionLevels=[{public:!1,title:this._$translate.instant("DIALOGS.GITHUB_PRIVATE_TITLE"),subtitle:this._$translate.instant("DIALOGS.GITHUB_PRIVATE_SUBTITLE")},{public:!0,title:this._$translate.instant("DIALOGS.GITHUB_PUBLIC_TITLE"),subtitle:this._$translate.instant("DIALOGS.GITHUB_PUBLIC_SUBTITLE")}]),this._permissionLevels}},{kind:"get",key:"permissionLevel",value:function permissionLevel(){return this._permissionLevel}},{kind:"set",key:"permissionLevel",value:function permissionLevel(e){this._permissionLevel!==e&&(this._permissionLevel=e)}},{kind:"get",key:"organizations",value:function organizations(){return this._organizations||(this._organizations=this._githubIntegrationSrv.getGitHubOrganizations(this._account.accountId)),this._organizations}},{kind:"get",key:"organization",value:function organization(){return this._organization}},{kind:"set",key:"organization",value:function organization(e){var t;this._organization!==e&&(this._organization=e,e.viewerCanAdminister||(this.permissionLevel=k()(t=this.permissionLevels).call(t,(e=>!e.public))))}},{kind:"get",key:"name",value:function name(){return this._name}},{kind:"set",key:"name",value:function name(e){this._name!==e&&(this._name=e)}},{kind:"get",key:"description",value:function description(){return this._description}},{kind:"set",key:"description",value:function description(e){this._description!==e&&(this._description=e)}},{kind:"get",key:"canCreateProject",value:function canCreateProject(){var e;return!(null===(e=this.name)||void 0===e||!E()(e).call(e))&&this.organization&&this.organization.viewerCanCreateProjects&&this.permissionLevel}},{kind:"method",key:"createProjectAsync",value:async function createProjectAsync(){if(!this.isBusy)try{this.isBusy=!0;let e=await this._githubIntegrationSrv.createProjectAsync(this._account.accountId,{name:this.name,ownerId:this.organization.id}),t=!1;const r={};this.description&&(r.description=this.description,t=!0),this.organization.viewerCanAdminister&&(r.public=this.permissionLevel.public,t=!0),t&&await this._githubIntegrationSrv.updateProjectAsync(this._account.accountId,e.id,r);let i=this._provider.getCurrentCollectionConnectedCalendar(this._account.accountId,e.id);i.isConnected=!0,i.isSelected=!0,this._provider.setCurrentCollectionConnectedCalendars(this._account.accountId,[i]),this._$rootScope.$broadcast(S.FK.CalendarsChanging,this._account),this._telemetrySrv.logSessionEvent(S.cN.CalendarEvents.GitHubProjectCreated),this._$mdDialog.hide(!0)}catch(e){this._$log.error("GitHub create project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub create project error",e,{class:this.constructor.name,method:this.createProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CREATE_GITHUB_PROJECT_ERROR"),S.k$.Error)}finally{this.isBusy=!1}}},{kind:"method",key:"editProjectAsync",value:async function editProjectAsync(){if(!this.isBusy)try{this.isBusy=!0;let e=!1;if(this.canEditProject){let t={};this._project.name!==this.name&&(t.name=this.name,e=!0),this._project.description!==this.description&&(t.description=this.description,e=!0),this._project.public!==this.permissionLevel.public&&this.organization.viewerCanAdminister&&(t.public=this.permissionLevel.public,e=!0),e&&(await this._githubIntegrationSrv.updateProjectAsync(this._account.accountId,this._project.id,t),this._telemetrySrv.logSessionEvent(S.cN.CalendarEvents.GitHubProjectEdited))}this._$mdDialog.hide(e)}catch(e){this._$log.error("GitHub update project error:"),this._$log.error(e),this._telemetrySrv.logError("GitHub update project error",e,{class:this.constructor.name,method:this.editProjectAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_GITHUB_PROJECT_ERROR"),S.k$.Error)}finally{this.isBusy=!1}}},{kind:"method",key:"cancelDialog",value:function cancelDialog(){this._$mdDialog.cancel()}}]}}))},45911:(e,t,r)=>{r.d(t,{Ms:()=>isMemberRequired,Pv:()=>toggleMember,iG:()=>toggleLabel,xZ:()=>isMultipleMembersSupported});var i=r(40024),n=r.n(i),a=r(99595),o=r.n(a),s=r(57445),l=r.n(s),c=r(51791),d=r.n(c),u=r(90143),h=r.n(u),p=r(56626),v=r.n(p),m=r(67552),f=r.n(m),C=r(86981),y=r.n(C),g=r(62079),_=r.n(g),k=r(52020),w=r.n(k),b=r(88546),D=r.n(b),E=r(66775),S=r.n(E),A=r(2201),I=r.n(A),P=r(26171),T=r(26881),x=r(23513),R=r.n(x),$=r(45181),L=r.n($),M=r(88946),N=r.n(M),F=r(66924),G=r.n(F),O=r(73324),z=r.n(O),j=r(91829),U=r.n(j),B=r(10349),H=r.n(B),K=r(76555),V=r.n(K),W=r(58218),Z=r.n(W),q=r(27885),Q=r(82617),Y=r(20115),X=r(29704),J=r(20750),ee=r(47436),te=r(48764).Buffer;function ownKeys(e,t){var r=_()(e);if(w()){var i=w()(e);t&&(i=z()(i).call(i,(function(t){return D()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?o()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,P.Z)(e,t,n[t])})):S()?I()(e,S()(n)):o()(i=ownKeys(Object(n))).call(i,(function(t){l()(e,t,D()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}l()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(o()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),o()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==d()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];h()(o).call(o,d()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(s)||s);e=l.element,this.addElementPlacement(e,t),l.finisher&&i.push(l.finisher);var c=l.extras;if(c){for(var u=0;u<c.length;u++)this.addElementPlacement(c[u],t);r.push.apply(r,c)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,v(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return N()(t=(0,T.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:N()(e).call(e,this.fromElementDescriptor,this)};return l()(t,v(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=y()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(N()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)})(null,(function(e){class CalendarCard{constructor(t,r,i){e(this),this._id=t,this._accountId=r,this.cardType=i,this.labelIds=new(R()),this.memberIds=new(R()),this.customFields={},this._lastDataVersionId=0}}return{F:CalendarCard,d:[{kind:"get",key:"id",value:function id(){return this._id}},{kind:"get",key:"accountId",value:function accountId(){return this._accountId}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e}},{kind:"get",key:"calendarId",value:function calendarId(){return this.projectId}},{kind:"get",key:"issueId",value:function issueId(){return this._issueId}},{kind:"set",key:"issueId",value:function issueId(e){this._issueId=e}},{kind:"get",key:"cardType",value:function cardType(){return this._cardType}},{kind:"set",key:"cardType",value:function cardType(e){this._cardType=e}},{kind:"get",key:"cardRole",value:function cardRole(){return this.customData.cardRole}},{kind:"set",key:"cardRole",value:function cardRole(e){this.customData.cardRole=e}},{kind:"get",key:"title",value:function title(){return this._title||""}},{kind:"set",key:"title",value:function title(e){this._title=e}},{kind:"get",key:"description",value:function description(){return this._description||""}},{kind:"set",key:"description",value:function description(e){this._description=e}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this._isAllDay=e}},{kind:"get",key:"start",value:function start(){return this._start}},{kind:"set",key:"start",value:function start(e){this._start=e?new Date(e):void 0,this._previousStart=this._start}},{kind:"get",key:"previousStart",value:function previousStart(){return this._previousStart}},{kind:"get",key:"end",value:function end(){return this.cardRole===Q.D.Milestone?this._start:this._end}},{kind:"set",key:"end",value:function end(e){this._end=e?new Date(e):void 0,this._previousEnd=this._end}},{kind:"get",key:"previousEnd",value:function previousEnd(){return this.cardRole===Q.D.Milestone?this._previousStart:this._previousEnd}},{kind:"get",key:"hasDates",value:function hasDates(){return(0,X.qb)(this.start)&&(0,X.qb)(this.end)}},{kind:"get",key:"isTempCard",value:function isTempCard(){var e;return L()(e=this.id).call(e,Y.$d)}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return this._isReadOnly}},{kind:"get",key:"isSingleDate",value:function isSingleDate(){return this.cardRole===Q.D.Milestone}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this._projectItemUrl}},{kind:"get",decorators:[(0,X.lv)()],key:"cardNumber",value:function cardNumber(){return this._cardNumber}},{kind:"get",key:"createdDate",value:function createdDate(){return this._createdDate}},{kind:"get",decorators:[(0,X.lv)()],key:"projectId",value:function projectId(){return this._projectId}},{kind:"set",key:"projectId",value:function projectId(e){this._projectId=e}},{kind:"get",decorators:[(0,X.lv)()],key:"repositoryId",value:function repositoryId(){return this._repositoryId}},{kind:"set",key:"repositoryId",value:function repositoryId(e){this._repositoryId=e}},{kind:"get",decorators:[(0,X.lv)()],key:"capabilities",value:function capabilities(){return this._capabilities}},{kind:"get",decorators:[(0,X.lv)()],key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this._isCompleted=e}},{kind:"get",decorators:[(0,X.lv)()],key:"labelIds",value:function labelIds(){return this._labelIds}},{kind:"set",key:"labelIds",value:function labelIds(e){let t=!1;if(this._labelIds&&this._labelIds.size===e.size){for(let r of this._labelIds)if(!e.has(r)){t=!0;break}}else t=!0;t&&(this._labelIds=e,0===this._labelIds.size&&this._labelIds.add(Y.$d))}},{kind:"get",decorators:[(0,X.lv)()],key:"memberIds",value:function memberIds(){return this._memberIds}},{kind:"set",key:"memberIds",value:function memberIds(e){let t=!1;if(this._memberIds&&this._memberIds.size===e.size){for(let r of this._memberIds)if(!e.has(r)){t=!0;break}}else t=!0;t&&(this._memberIds=e,0===this._memberIds.size&&this._memberIds.add(Y.$d))}},{kind:"get",decorators:[(0,X.lv)()],key:"hasMembers",value:function hasMembers(){return this.memberIds.size>0&&(1!==this.memberIds.size||!this.memberIds.has(Y.$d))}},{kind:"get",key:"customFields",value:function customFields(){return this._customFields}},{kind:"set",key:"customFields",value:function customFields(e){this._customFields=e}},{kind:"get",key:"customData",value:function customData(){return this._customData||(this._customData={}),this._customData.cardRole||(this._customData.cardRole=Q.D.Card),this._customData}},{kind:"get",key:"lastChangeId",value:function lastChangeId(){return this._lastChangeId}},{kind:"set",key:"lastChangeId",value:function lastChangeId(e){return this._lastChangeId=e}},{kind:"get",key:"lastDataVersionId",value:function lastDataVersionId(){return this._lastDataVersionId}},{kind:"method",static:!0,key:"fromSourceCard",value:function fromSourceCard(e,t,r,i){var n,a,o,s;let l=new CalendarCard(e,t,r);if(!i)return l;const{githubProjectItem:c,githubIssue:d,githubProject:u,githubRepository:h}=i;l._isReadOnly=!d.viewerCanUpdate;let{description:p,cardData:v}=CalendarCard._deserializeDescriptionCardData(d.body);return v&&(l.start=v.start,l.end=v.end,l.isAllDay=v.isAllDay,l._lastDataVersionId=v.dataVersionId,l._customData=v.customData),l._createdDate=new Date(c.createdAt),l._capabilities=ee.X8[h.viewerPermission],l._issueId=d.issueId,l._cardNumber=d.number,l._projectId=u.id,l._repositoryId=d.repository.id,l.title=d.title,l.description=p,l.isCompleted="CLOSED"===d.state,l.labelIds=new(R())(N()(n=d.labels.nodes).call(n,(e=>e.id))),l.memberIds=new(R())(N()(a=d.assignees.nodes).call(a,(e=>e.id))),l.customFields=G()(N()(o=z()(s=c.fieldValues.nodes).call(s,(e=>e.field))).call(o,(e=>[e.field.id,(0,J.W8)(e)]))),l._projectItemUrl=`${u.url}?pane=issue&itemId=${c.databaseId}`,l._lastCard=CalendarCard._getLastCard(l),l}},{kind:"method",key:"toSourceCard",value:function toSourceCard(e){const{includeFields:t=[]}=e;let r={issueId:this.issueId,repositoryId:this.repositoryId},i={title:()=>r.title=this.title,body:()=>{U()(t).call(t,"cardData")||(r.body=this._serializeDescriptionCardData())},state:()=>r.state=this.isCompleted?"CLOSED":"OPEN",labelIds:()=>{var e;return r.labelIds=z()(e=H()(this.labelIds)).call(e,(e=>e!==Y.$d))},memberIds:()=>{var e;return r.assigneeIds=z()(e=H()(this.memberIds)).call(e,(e=>e!==Y.$d))},cardData:()=>r.body=this._serializeDescriptionCardData()};for(let e of t){let t=i[e];t&&t()}return this._lastCard=CalendarCard._getLastCard(this),r}},{kind:"method",key:"incrementDataVersion",value:function incrementDataVersion(){this._lastDataVersionId+=100}},{kind:"method",key:"duplicate",value:function duplicate(){let e=this.clone();return e.isCompleted=!1,e._id=Y.$d,e._lastCard=CalendarCard._getLastCard(e),e}},{kind:"method",key:"clone",value:function clone(){let e=new CalendarCard(this.id,this.accountId,this.cardType);return this.hasDates&&(e.isAllDay=this.isAllDay,e.start=this.start,e.end=this.end),e.title=this.title,e.description=this.description,e._isReadOnly=this.isReadOnly,e._capabilities=this.capabilities,e._cardNumber=this.cardNumber,e._createdDate=this.createdDate,e.issueId=this.issueId,e.projectId=this.projectId,e.repositoryId=this.repositoryId,e.isCompleted=this.isCompleted,e.labelIds=new(R())(this.labelIds),e.memberIds=new(R())(this.memberIds),e.customFields=_objectSpread({},this.customFields),e._projectItemUrl=this._projectItemUrl,e._customData=_objectSpread({},this.customData),e.lastChangeId=this.lastChangeId,e._lastDataVersionId=this._lastDataVersionId,e._lastCard=this._lastCard,e}},{kind:"method",key:"equals",value:function equals(e){if(!e)return!1;function toCardObject(e){var t,r;return{id:e.id,cardType:e.cardType,title:e.title,description:e.description,isAllDay:e.isAllDay,start:e.start,end:e.end,issueId:e._issueId,cardNumber:e.cardNumber,createdDate:e.createdDate,projectId:e.projectId,repositoryId:e.repositoryId,isCompleted:e.isCompleted,labelIds:V()(t=H()(e.labelIds)).call(t),memberIds:V()(r=H()(e.memberIds)).call(r),customFields:e.customFields,customData:e.customData}}let t=toCardObject(this),r=toCardObject(e),i=(0,X.h0)(t,r);return i}},{kind:"method",key:"getCompareId",value:function getCompareId(){return this.lastChangeId}},{kind:"method",static:!0,key:"_deserializeCardData",value:function _deserializeCardData(e){if(!U()(e).call(e,"{")){let t=te.from(e,"base64"),r=q.ZP.inflate(t);e=te.from(r).toString()}let t=JSON.parse(e);if(t)return{version:t.version,dataVersionId:t.dataVersionId||0,isAllDay:t.isAllDay,start:(0,X.HE)(t.start,t.isAllDay),end:(0,X.HE)(t.end,t.isAllDay),customData:t.customData}}},{kind:"method",static:!0,key:"_deserializeDescriptionCardData",value:function _deserializeDescriptionCardData(e){let t=(0,J.YE)(e);if(t.data)try{let e=CalendarCard._deserializeCardData(t.data);if(e)return{cardData:e,description:t.description}}catch{}return{description:t.description}}},{kind:"method",static:!0,key:"_getLastCard",value:function _getLastCard(e){let t=e.clone();return t._lastCard=void 0,t}},{kind:"method",key:"_serializeCardData",value:function _serializeCardData(){if(!this.hasDates&&this.cardRole===Q.D.Card)return;let e={version:"v4",dataVersionId:this.lastDataVersionId,isAllDay:this.isAllDay,start:this.isAllDay?(0,X.tC)(this.start):this.start,end:this.isAllDay?(0,X.tC)(this.end):this.end,customData:this.customData},t=Z()(e,((e,t)=>{if(null!==t&&t!==Number.POSITIVE_INFINITY)return t})),r=te.from(t),i=q.ZP.deflate(r);return te.from(i).toString("base64")}},{kind:"method",key:"_serializeDescriptionCardData",value:function _serializeDescriptionCardData(){let e=this._serializeCardData();return e?`${this.description}\n\n[](Planyway_Data-DO_NOT_DELETE)[](${e})`:this.description}}]}}));function toggleLabel(e,t){let{providerCard:r}=e,i=new(R())(r.labelIds);return i.has(t)?i.delete(t):i.add(t),0===i.size?i.add(Y.$d):i.size>1&&i.delete(Y.$d),i}function isMemberRequired(e){return!1}function isMultipleMembersSupported(e){return!0}function toggleMember(e,t){let{providerCard:r}=e,i=new(R())(r.memberIds);return i.has(t)?i.delete(t):i.add(t),0===i.size?i.add(Y.$d):i.size>1&&i.delete(Y.$d),i}},47436:(e,t,r)=>{r.d(t,{X8:()=>g,p9:()=>_});var i=r(23513),n=r.n(i),a=r(8937);const o=(0,a.hP)({Admin:"ADMIN",None:"NONE",Read:"READ",Write:"WRITE"}),s="assignees",l="customField",c="copyUrl",d="complete",u="dates",h="description",p="delete",v="duplicate",m="update",f="labels",C="title",y="remove",g={[o.Admin]:new(n())([m,C,u,h,f,s,l,y,p,v,d,c]),[o.None]:new(n()),[o.Read]:new(n())([C,h,l,y,p,v,d,c]),[o.Write]:new(n())([m,C,u,h,f,s,l,y,p,v,d,c])},_=(0,a.hP)({Text:"TEXT",Number:"NUMBER",Date:"DATE",List:"SINGLE_SELECT"})},20750:(e,t,r)=>{r.d(t,{Ny:()=>compareGitHubLabels,W8:()=>getGitHubCustomFieldValue,YE:()=>parseGitHubCardDescription,mF:()=>compareGitHubMembers});var i=r(68052),n=r.n(i),a=r(29704),o=r(47436);function compareGitHubLabels(e,t){return(0,a.A5)(e.name,t.name)}function compareGitHubMembers(e,t,r){return r&&e.id===r.id?-1:r&&t.id===r.id?1:(0,a.A5)(e.fullName,t.fullName)}function getGitHubCustomFieldValue(e){let t;switch(e.field.dataType){case o.p9.Date:t=e.value&&new Date(e.value);break;case o.p9.Number:t=e.value&&n()(e.value);break;default:t=e.value}return t}function parseGitHubCardDescription(e){let t={description:e,data:"",match:""};function extractPlanywayData(e){return e.match(/\n*\[]\(Planyway_Data-DO_NOT_DELETE\)\[]\((.*?)\)/)}if(e){let e;for(;e=extractPlanywayData(t.description);)t.data||(t.data=e[1],t.match=e[0]),t.description=t.description.replace(e[0],"")}return t}},21695:(e,t,r)=>{r.d(t,{Z:()=>Provider});var i=r(52020),n=r.n(i),a=r(88546),o=r.n(a),s=r(99595),l=r.n(s),c=r(66775),d=r.n(c),u=r(2201),h=r.n(u),p=r(57445),v=r.n(p),m=r(26171),f=r(88946),C=r.n(f),y=r(73324),g=r.n(y),_=r(62079),k=r.n(_),w=r(27525),b=r.n(w),D=r(35820),E=r.n(D),S=r(87994),A=r.n(S),I=r(91829),P=r.n(I),T=r(76555),x=r.n(T),R=r(54847),$=r.n(R),L=r(86981),M=r.n(L),N=r(8244),F=r.n(N),G=r(82617),O=r(16357),z=r(15985),j=r(46930),U=r(8937),B=r(20115),H=r(29704),K=r(71315);const V='<g fill="none"><path d="M9.348 3.723l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm0-1A5 5 0 106 1a5 5 0 000 10z" fill="\\#8b8e93"/></g>',W='<g fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm3.348-8.277l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/></g>',Z='\n# if (!hiddenElements.calendar) { #\n# var calendarName = cardProvider.getCardCalendarName(data) #\n# if (calendarName) { #\n<div class="pw-card__calendar">\n    #: calendarName #\n</div>\n# } #\n# } #\n',q=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n# if (cardProvider.getCardInviteStatus(data) === '${U.XO.No}') { #\n\x3c!-- Иконка отклоненного приглашения для событий Google --\x3e\n<div class="mdi mdi-close-circle pw-card__type-icon"></div>\n# } #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${W}</svg>\n    <svg width="12px" height="12px">${V}</svg>\n</div>\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    <div class="pw-card__details">\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n\n        ${Z}\n    </div>\n</div>\n`,Q=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n# if (cardProvider.getCardInviteStatus(data) === '${U.XO.No}') { #\n\x3c!-- Иконка отклоненного приглашения для событий Google --\x3e\n<div class="mdi mdi-close-circle pw-card__type-icon"></div>\n# } #\n\n# if (data.timeShortText) { #\n<span class="pw-card__time pw-card__time-short pw-js-card-time-short">#: data.timeShortText #</span>\n# } #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${W}</svg>\n    <svg width="12px" height="12px">${V}</svg>\n</div>\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    # if (!hiddenElements.calendar || !hiddenElements.dates) { #\n    <div class="pw-card__details">\n        # if (!hiddenElements.dates && data.timeDateText) { #\n        <span class="pw-card__time pw-js-card-time-date">#: data.timeDateText #</span>\n        # } else { #\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n        # } #\n\n        ${Z}\n    </div>\n    # } #\n</div>\n`,Y={hourSlot:kendo.template(q,{useWithBlock:!1}),daySlot:kendo.template(Q,{useWithBlock:!1})};function getCalendarIconTemplate(e,t){return`\n        <pw-google-calendar-icon\n            account-id="${e}"\n            calendar-id="${t}"\n            icon-size="small"\n        ></pw-google-calendar-icon>\n    `}var X=r(84705);const J=r.n(X)()('\n<div\n    class="pw-calendar-icon pw-calendar-icon--google-calendar pw-calendar-icon--google-calendar_normal"\n    style="background-color: #= data.resourceData.calendarColor #;"\n>\n    <svg width="24" height="24"><path d="M19.842 10.5c.102.535.158 1.095.158 1.68 0 4.57-3.122 7.82-7.837 7.82C7.653 20 4 16.42 4 12s3.653-8 8.163-8c2.205 0 4.046.795 5.46 2.085L15.32 8.34v-.005c-.857-.8-1.943-1.21-3.158-1.21-2.693 0-4.882 2.23-4.882 4.87s2.189 4.875 4.882 4.875c2.444 0 4.107-1.37 4.45-3.25h-4.45V10.5h7.68z" /></svg>\n</div>\n').call('\n<div\n    class="pw-calendar-icon pw-calendar-icon--google-calendar pw-calendar-icon--google-calendar_normal"\n    style="background-color: #= data.resourceData.calendarColor #;"\n>\n    <svg width="24" height="24"><path d="M19.842 10.5c.102.535.158 1.095.158 1.68 0 4.57-3.122 7.82-7.837 7.82C7.653 20 4 16.42 4 12s3.653-8 8.163-8c2.205 0 4.046.795 5.46 2.085L15.32 8.34v-.005c-.857-.8-1.943-1.21-3.158-1.21-2.693 0-4.882 2.23-4.882 4.87s2.189 4.875 4.882 4.875c2.444 0 4.107-1.37 4.45-3.25h-4.45V10.5h7.68z" /></svg>\n</div>\n'),ee={resourceIcon:kendo.template(J,{useWithBlock:!1})};var te=r(22159),re=r.n(te);function ownKeys(e,t){var r=k()(e);if(n()){var i=n()(e);t&&(i=g()(i).call(i,(function(t){return o()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?l()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,m.Z)(e,t,n[t])})):d()?h()(e,d()(n)):l()(i=ownKeys(Object(n))).call(i,(function(t){v()(e,t,o()(n,t))}))}return e}const ie={[G.eT.GoogleEvent]:[U.VD.E,U.VD.M,U.VD.Space,U.VD.Delete,U.VD.Backspace]};class Provider extends z.Z{get type(){return U.lP.Google}get integrationService(){return this._googleIntegrationSrv}get cardsService(){return this._googleCardsSrv}static get sortOrder(){return[]}initializeAsync(e){return this._googleIntegrationSrv.initCurrentCollectionAsync(e)}getCardTemplates(){return Y}getCalendarExtraCardStyle(e){return(e=>{let{shortId:t,color:{light:r,dark:i,highlight:n,controlHover:a}}=e;return`\n    .pw-card--google_${t} {\n        --background: ${r};\n        --title: ${i};\n        --subtitle: ${i};\n        --icon: ${i};\n        --border: transparent;\n        --control-hover: ${a};\n    }\n\n    .pw-card--google_${t}.k-state-selected,\n    .timeline-selected .pw-card--google_${t},\n    .pw-card-link-target .pw-card--google_${t},\n    .pw-card--google_${t}.pw-card--temp {\n        --background: ${n};\n        --border: ${i};\n    }\n`})(e)}getCardTooltipConfig(){return{templateUrl:re(),controllerName:"googleEventTooltipCtrl"}}getCardTemplateData(e){return{isReadOnly:e.isReadOnly,cardType:e.cardType,cardRole:e.cardRole,title:e.title,isAllDay:e.isAllDay,start:e.start,realStart:e.realStart,end:e.end,realEnd:e.realEnd,isCompleted:e.providerCard.isCompleted,googleCalendarId:e.providerCard.googleCalendarId,googleAttendees:e.providerCard.googleAttendees}}getCardEditorHtml(){return'\n            <pw-google-event-editor\n                class="pw-dialog-edit-card__editor"\n                calendar-card="$ctrl.calendarCard"\n                is-detailed="$ctrl.isDetailed"\n                force-detailed-mode="$ctrl.forceDetailedMode"\n                is-dense="$ctrl.isDense"\n                has-changes="$ctrl.hasChanges"\n            ></pw-google-event-editor>\n        '}getCardContextMenuHtml(){return'\n            <pw-google-card-context-menu\n                source="$ctrl.source"\n                on-set-context-menu="$ctrl.onSetContextMenu"\n            ></pw-google-card-context-menu>\n        '}getWorkPanelHtml(){}isWorkPanelAvailable(){return!1}getCalendarsPickerHtml(){return'\n            <pw-google-calendars-picker\n                account="$ctrl.account"\n                calendars="$ctrl.calendars"\n                filter-text="$ctrl.filterText"\n            ></pw-google-calendars-picker>\n        '}getCardId(e){return(0,K.Oi)(e.googleEvent.id,e.googleCalendar.shortId)}getCalendarCardClass(){return K.fb}isMilestonesSupported(){return!1}get _googleIntegrationSrv(){return this._googleIntegrationSrvLazy||(this._googleIntegrationSrvLazy=this._$injector.get("googleIntegrationSrv")),this._googleIntegrationSrvLazy}get _googleCardsSrv(){return this._googleCardsSrvLazy||(this._googleCardsSrvLazy=this._$injector.get("googleCardsSrv")),this._googleCardsSrvLazy}get _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=this._$injector.get("licenseSrv")),this._licenseSrvLazy}get accountType(){return G.Qm.Google}getAccountName(e){var t;return null===(t=this._googleIntegrationSrv.getGoogleUser(e))||void 0===t?void 0:t.fullName}getAccountEmail(e){var t;return null===(t=this._googleIntegrationSrv.getGoogleUser(e))||void 0===t?void 0:t.email}getAccountUser(e){return this._googleIntegrationSrv.getGoogleUser(e)}getAccountUserAsync(e){return this._googleIntegrationSrv.getGoogleUserAsync(e)}getCurrentCollectionConnectedCalendarIds(e){var t,r;let i=C()(t=this.integrationService.getGoogleCalendars(e)).call(t,(e=>e.id)),n=(0,H.Bn)(this._collectionSettings.global.settings.calendar,i);return g()(r=k()(n)).call(r,(e=>n[e].isConnected))}getCurrentCollectionConnectedCalendar(e,t){let r=this.integrationService.getGoogleCalendarById(e,t),i=this._collectionSettings.global.settings.calendar[t];return r&&i?_objectSpread({calendarId:t},i):{accountType:G.Qm.Google,calendarId:t,isConnected:!1,isSelected:!1}}getCurrentCollectionConnectedCalendars(e){var t,r,i;let n=C()(t=this.integrationService.getGoogleCalendars(e)).call(t,(e=>e.id)),a=(0,H.Bn)(this._collectionSettings.global.settings.calendar,n),o=this._planywayIntegrationSrv.getConnectedAccountById(e);return C()(r=g()(i=k()(a)).call(i,(e=>a[e].isConnected))).call(r,(e=>{let t=_objectSpread({calendarId:e},a[e]);return t.isSelected&&(o.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(U.ZV.GoogleConnect,!1)||(t.isSelected=!1,a[e].isSelected=!1)),t}))}getDefaultUserLocalProviderSettings(){return{lastRemindBefore:30,lastRemindBeforeAllDay:900,lastReminderDeliveryType:U.n_.Popup}}canCreateCard(e,t){var r;return t?!this._googleIntegrationSrv.getGoogleCalendarById(e,t).isReadOnly:b()(r=this.getCurrentCollectionSelectedCalendarIds(e)).call(r,(t=>!this._googleIntegrationSrv.getGoogleCalendarById(e,t).isReadOnly))}isTimeTrackingAvailable(){}getMainToolbarRightHtml(){}getMainToolbarFiltersMenuHtml(){}getSchedulerToolbarViewSettingsMenuHtml(){}getSupportedSchedulerModes(){return[{get value(){return U.ud.Calendar},set value(e){},title:this._$translate.instant("BUTTONS.CALENDAR")},{get value(){return U.ud.Timeline},set value(e){},title:this._$translate.instant("BUTTONS.TIMELINE")}]}getSupportedTimelineViews(){return[{value:U.tS.Board,icon:"icons-16:timeline-calendars-outline",title:this._$translate.instant("MENU.CALENDARS")},{value:U.tS.None,icon:"icons-16:timeline-no-grouping-outline",title:this._$translate.instant("MENU.NO_GROUPING")}]}getViewSettingsMenuFieldItems(){const e=this;return[{group:"dates",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_DATES"),get state(){return e._collectionSettings.global.settings.showDates},set state(t){e._collectionSettings.global.settings.showDates=t,e._$rootScope.$broadcast(U.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(U.cN.SettingsEvents.ShowDatesChanged)},get isAvailable(){switch(e._appCommonSrv.getSchedulerView()){case U.rW.Month:case U.rW.Timeline:return!0;default:return!1}}},{group:"calendar",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_CALENDAR"),get state(){return e._collectionSettings.global.settings.showCalendar},set state(t){e._collectionSettings.global.settings.showCalendar=t,e._$rootScope.$broadcast(U.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(U.cN.SettingsEvents.ShowCalendarChanged)},get isAvailable(){return!0}}]}addTimeRecordManuallyAsync(){return!1}getTimerParentCardByIdAsync(){}createTimeRecordCardByTimerAsync(){return E().resolve(!1)}static getSidebarPanelHtml(){return'\n            <pw-google-sidebar-panel\n                class="pw-provider-sidebar-panel"\n            ></pw-google-sidebar-panel>'}getNewCardObjectProviderCard(e){return{accountId:e.accountId,cardType:e.cardType,cardRole:e.cardRole,googleCalendarId:e.calendarId}}getTimelineResourceTemplates(){return ee}getTimelineResourcesByType(e,t){var r;let i=[];if(!this._googleIntegrationSrv.isCurrentCollectionInitialized)return i;const n=this._collectionSettings.global.settings.timelineHiddenResources[t],a=A()(r=this.getCurrentCollectionConnectedAccountIds()).call(r,(e=>{let t=this.getCurrentCollectionSelectedCalendarIds(e);return C()(t).call(t,(t=>this._googleIntegrationSrv.getGoogleCalendarById(e,t)))}));if(t===U.y.Calendars)for(let r of a)i.push({id:r.id,accountTypes:[G.Qm.Google],accountIds:[r.accountId],calendarIds:[r.id],type:t,getProvider:()=>this,name:r.name,isSelected:!P()(n).call(n,r.id),isPrimary:r.isPrimary,resourceData:{calendarType:U.kK.GoogleCalendar,calendarColor:r.color.base,calendarColorName:r.colorName},iconHtml:getCalendarIconTemplate(e,r.id)});return x()(i).call(i,((e,r)=>{if(t===U.y.Calendars){if(e.isPrimary)return-1;if(r.isPrimary)return 1}return(0,H.A5)(e.name,r.name)||(0,H.A5)(e.id,r.id)}))}getTimelineResourcesMenuByType(e,t){return t===U.y.Calendars?{title:this._$translate.instant("BUTTONS.CALENDARS"),description:this._googleIntegrationSrv.getGoogleUser(e).fullName,icon:"icons-16:google-outline",showAll:{text:this._$translate.instant("MENU.SHOW_ALL_CALENDARS"),icon:"icons-16:timeline-all-calendars-outline"},showNone:{text:this._$translate.instant("MENU.SHOW_NONE_CALENDARS"),icon:"icons-16:timeline-calendars-outline"}}:{}}expandTimelineResources(e,t){let r=t.field,i=t.defaultFieldValue;if(e.cardRole===G.D.Card){if(t.name===U.y.NoResources)return[B.xp];{let n=(0,H._M)(e,r,i);return t.multiple?n:[n]}}}updateProviderCardDataByTimelineResource(e,t){e.providerCard.googleCalendarId=t.id}isEventDataUpdated(e,t){return t.providerCard.googleCalendarId&&t.providerCard.googleCalendarId!==e.providerCard.googleCalendarId}isOwnCalendarCard(e){var t;return b()(t=e.providerCard.googleAttendees).call(t,(t=>t.email!==this._getUserEmail(e.accountId)))}isCardContextMenuAvailable(e){return!e.isTempCard}isCardResizeAvailable(e){return!e.isReadOnly}isCardSatisfiesSchedulerFilters(e){return this._appCommonSrv.getSchedulerMode(!0)!==U.ud.TimeTracking&&this._calendarCardsSrv.isCalendarCardVisible(e)}canModifyInScheduler(){return!0}canStartMoveInScheduler(e){return!e.isReadOnly&&e.providerCard.canModify}canEndMoveInScheduler(){return!0}canResizeInScheduler(){return!0}canUpdateInScheduler(e){return!e.isReadOnly&&e.providerCard.canModify}canSortInScheduler(){return!1}getMovedEvent(e){switch(this._appCommonSrv.getTimelineResourcesType()){case U.y.NoResources:return e;case U.y.Calendars:return e.providerCard.googleCalendarId=e.resourceId,e}}getCardExtraClasses(e){let t=[];t.push("pw-card--google");let r=this._googleIntegrationSrv.getGoogleCalendarById(e.accountId,e.providerCard.googleCalendarId);switch(r?(t.push(`pw-card--google_${r.shortId}`),r.colorName&&t.push(`pw-card--google_${r.colorName}`)):t.push("pw-card--google_default"),e.isTempCard&&t.push("pw-card--temp"),e.providerCard.isCompleted&&t.push("pw-card--completed"),this.getCardInviteStatus(e)){case U.XO.Yes:t.push("pw-card--google-yes");break;case U.XO.No:t.push("pw-card--google-no");break;case U.XO.MayBe:t.push("pw-card--google-maybe");break;case U.XO.Undefined:t.push("pw-card--google-undefined")}return t}getHiddenCardElements(){switch(this._appCommonSrv.getSchedulerView(!0)){case U.rW.OneDay:case U.rW.ThreeDay:case U.rW.Week:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!0};case U.rW.Month:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case U.rW.Timeline:switch(this._appCommonSrv.getTimelineResourcesType(!0)){case U.y.NoResources:case U.y.Calendars:case U.y.Lists:case U.y.Labels:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case U.y.Members:return{membersIcon:!0,calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates}}}}getCardMemberBackground(){}getCardCalendarName(e){var t;return null===(t=this._googleIntegrationSrv.getGoogleCalendarById(e.accountId,e.providerCard.googleCalendarId))||void 0===t?void 0:t.name}getCardLinks(){return[]}getDragInfo(e,t){if(0===e.length)return{canDrag:!0,allowedCardTypes:[]};if(t===B.iF)return{canDrag:!1,allowedCardTypes:[]};let r=this._appCommonSrv.getTimelineResourcesType();switch(r){case U.y.NoResources:return{canDrag:!0,allowedCardTypes:[G.eT.GoogleEvent]};case U.y.Calendars:{let i=this._appCommonSrv.getTimelineResourceById(r,t);if(b()(e).call(e,(e=>{var t;return!P()(t=i.accountIds).call(t,e.accountId)})))break;if(b()(e).call(e,(e=>e.cardType===G.eT.GoogleEvent&&!e.isOwn)))break;let n=this._googleIntegrationSrv.getGoogleCalendarById(i.accountIds[0],t);if(!n||n.isReadOnly)break;return{canDrag:!0,allowedCardTypes:[G.eT.GoogleEvent]}}}return{canDrag:!1,allowedCardTypes:[]}}getDraggingCard(e,t,r,i){let n=(0,H.bt)(e.realStart,e.realEnd,r),a={accountId:e.accountId,isOriginCard:e.uid===t.uid,isRecurring:e.isRecurring(),recurrenceId:e.recurrenceId,recurrenceRule:e.recurrenceRule,start:e.realStart,originStart:e.realStart,newStart:e.realStart,end:e.realEnd,originEnd:e.realEnd,newEnd:e.realEnd,isAllDay:e.realIsAllDay,originIsAllDay:e.realIsAllDay,isSingleDate:e.isSingleDate,isMultiDay:()=>e.isMultiDay(),canBeMultiDay:!0,defaultDuration:j.XM,durations:n,providerType:e.providerType,providerCard:e.providerCard,cardType:e.cardType,cardRole:e.cardRole,isOwn:e.providerCard.googleOrganizer.self};return i&&(a.sortOrder=e.providerCard[i]),a.originDurations=_objectSpread({},a.durations),a}getDraggedCardUpdateData(e,t,r){let i={isOriginCard:e.isOriginCard,start:e.newStart,end:e.newEnd,isAllDay:e.isAllDay,providerType:e.providerType,cardType:e.cardType};return t&&r&&(e.isRecurring||(i.resourceId=t)),i}getPreviewCard(e){let{accountId:t,calendarId:r,cardType:i,cardRole:n,isAllDay:a,start:o,end:s,providerCard:l={}}=e,c=this._googleIntegrationSrv.getGoogleCalendarById(t,l.googleCalendarId||r)||{};return{id:B.$d,accountId:t,isTempCard:!0,providerType:U.lP.Google,cardType:i,cardRole:n,isAllDay:a,start:o,end:s,providerCard:{googleCalendarId:c.id,googleAttendees:[]}}}async updateCardByMouseAsync(e,t,r){let i={cardRole:t.cardRole,isAllDay:t.isAllDay,start:t.start,end:t.end,googleCalendarId:t.providerCard.googleCalendarId},n=await this._applyRecurrenceActionsAsync([e],{createException:!0,recurringMode:r.recurringMode,telemetryCallback:r.telemetryCallback,[U.f.AllSeries]:async t=>{var r;let n=e.realStart||e.start,a=e.realEnd||e.end,o=null!==(r=t.realIsAllDay)&&void 0!==r?r:t.isAllDay,s=t.realStart||t.start,l=t.realEnd||t.end;if(void 0!==i.isAllDay&&i.isAllDay!==o)if(i.isAllDay){let e=(0,H.i2)((0,H.$Y)(n),i.start);i.start=(0,H.E4)((0,H.$Y)(s),e);let t=(0,H.i2)((0,H.$Y)(a),i.end);i.end=(0,H.E4)((0,H.$Y)(l),t)}else{let e=(0,H.i2)(n,(0,H.$Y)(i.start));i.start=(0,H.E4)((0,H.q_)(s,i.start),e);let t=(0,H.i2)(a,(0,H.$Y)(i.end));i.end=(0,H.E4)((0,H.q_)(l,i.end),t)}else if(o){let e=(0,H.i2)(n,i.start);i.start=(0,H.E4)(s,e);let t=(0,H.i2)(a,i.end);i.end=(0,H.E4)(l,t)}else{let e=(0,H.CX)(n,i.start);i.start=(0,H.mH)(s,e);let t=(0,H.CX)(a,i.end);i.end=(0,H.mH)(l,t)}i.end<i.start&&(i.end=new Date(i.start)),(void 0!==i.isAllDay&&i.isAllDay!==e.isAllDay||i.start&&!(0,H.rs)(i.start,n))&&await this.deleteRecurrenceExceptionsAsync(t)},properties:new($())([[e.id,i]])});await E().all(C()(n).call(n,(async n=>{try{var a;n=this._calendarCardsSrv.getCalendarCardById(n.accountId,n.cardType,n.id),r.telemetryCallback(n);let o=!1;return b()(a=n.providerCard.googleAttendees).call(a,(e=>e.email!==this._getUserEmail(n.accountId)))&&!t.providerCard.googleCalendarId&&e.providerCard.googleOrganizer.self&&(o=await this._dialogSrv.showSendEventUpdatesDialogAsync(e.title,O.c.Updates),o&&this.logCardEvent(e,U.cN.CardEvents.InviteSent,{attendeeCount:e.providerCard.googleAttendees.length})),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(n,i,{immediateUpdate:!0,sendUpdates:o})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.updateCardByMouseAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),U.k$.Error)}})))}getUpdateByMouseTelemetry(e,t,r){let i;var n;if(r)i={event:U.cN.CardEvents.Resized,data:{isAllDay:null!==(n=t.isAllDay)&&void 0!==n?n:e.isAllDay,start:t.start,end:t.end}};else if(t.isAllDay!==e.isAllDay||!(0,H.rs)(t.start,e.realStart||e.start)||!(0,H.rs)(t.end,e.realEnd||e.end)||void 0!==t.providerCard.googleCalendarId&&t.providerCard.googleCalendarId!==e.providerCard.googleCalendarId){var a;if(void 0!==t.providerCard.googleCalendarId&&t.providerCard.googleCalendarId!==e.providerCard.googleCalendarId)i={event:U.cN.CardEvents.LaneChanged,data:{calendarId:null!==(a=t.providerCard.googleCalendarId)&&void 0!==a?a:e.calendarId}};else if(!(0,H.rs)(t.start,e.realStart||e.start)||!(0,H.rs)(t.end,e.realEnd||e.end)){var o;i={event:U.cN.CardEvents.Moved,data:{isAllDay:null!==(o=t.isAllDay)&&void 0!==o?o:e.isAllDay,start:t.start,end:t.end}}}}return i}createCardByExternalCall(e,t,r,i,n,a){const{cardType:o}=a;let s={isAllDay:n,start:r,end:i};if(o===G.eT.GoogleEvent)s.providerCard={googleCalendarId:t};return this._calendarCardsSrv.createTempCalendarCard(e,o,s)}createCardByClick(e,t){let r={cardRole:t.cardRole,isAllDay:t.isAllDay,start:t.start,end:t.end,providerCard:{googleCalendarId:t.providerCard.googleCalendarId}};return this._calendarCardsSrv.createTempCalendarCard(e,t.cardType,r)}createCardByDropAsync(){}createTimeRecordCardByClick(){}createTimeRecordCardByDropAsync(){}get availableCardTypes(){return[G.eT.GoogleEvent]}get defaultCardType(){return G.eT.GoogleEvent}get availableCardRoles(){return[G.D.Card]}get defaultCardRole(){return G.D.Card}getCardTimeDurationText(){}getTotalCardsTimeDurationInDay(){return 0}hasEstimation(){return!1}hasTrackedTime(){return!1}isHotkeyAvailable(e,t,r){var i;return!!P()(i=ie[e.cardType]).call(i,t)&&(e.cardType===G.eT.GoogleEvent&&(!e.isReadOnly&&(t===U.VD.E||(t===U.VD.Space||t===U.VD.M||!(t!==U.VD.Delete&&t!==U.VD.Backspace||!r.shiftKey&&!r.metaKey)))))}updateCardsByHotkey(e,t,r,i,n){let a,o;if(i!==U.LP.Scheduler)throw new Error(`Unsupported hotkey source: ${i}`);a=U.a6.Scheduler,o=U.xI.Scheduler;let s={telemetry:{where:a,by:U.AH.Hotkey}};switch(t){case U.VD.E:this.toggleCardsIsCompletedAsync(e,s);break;case U.VD.M:{if(1!==e.length)break;let t=e[0];n.scope().$broadcast(U.FK.OpenNestedContextMenuRequested,{calendarCard:t,nestedMenu:"google-attendees",source:o,sourceElement:n});break}case U.VD.Space:let t=(0,H.vM)(e,"accountId");for(let[e,r]of t)this.toggleEventsAttendeeAsync(r,{email:this._getUserEmail(e)},s);break;case U.VD.Delete:case U.VD.Backspace:(r.shiftKey||r.metaKey)&&this.deleteCardsAsync(e,s)}}async toggleCardsIsCompletedAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b()(e).call(e,(e=>!this.canModifyInScheduler(e))))return;let r=g()(e).call(e,(e=>!e.isReadOnly));if(0===r.length)return;let i=await this.getRecurringModeAsync(e,U.aO.Edit,t.applyRecurringActionToHead);if(null===i)return;let telemetryCallback=e=>{let r,n,a=e.providerCard.isCompleted;if(e.cardType===G.eT.TrelloCheckItem)r=this._calendarCardsSrv.getCalendarCardById(e.accountId,G.eT.TrelloCard,e.providerCard.parentId),n=a?U.cN.CardEvents.CheckItemMarkedIncompleted:U.cN.CardEvents.CheckItemMarkedCompleted;else r=e,n=a?U.cN.CardEvents.MarkedIncompleted:U.cN.CardEvents.MarkedCompleted;this.logCardEvent(r,n,_objectSpread(_objectSpread({},t.telemetry),{},{recurringMode:i}))};if(i&&(r=await this._applyRecurrenceActionsAsync(r,{createException:!0,recurringMode:i,telemetryCallback,[U.f.OnlyOccurrence]:e=>{e.providerCard.isCompleted=!e.providerCard.isCompleted},[U.f.ThisAndFollowing]:e=>{e.providerCard.isCompleted=!e.providerCard.isCompleted}}),0===r.length))return;let n=!0;await E().all(C()(r).call(r,(e=>{try{let t=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id);return telemetryCallback(t),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(t,{isCompleted:!t.providerCard.isCompleted})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.toggleCardsIsCompletedAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),U.k$.Error),n=!1}}))),n&&this._incrementActionCounter()}async toggleEventsAttendeeAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=g()(e).call(e,(e=>{var r;if(!this.canModifyInScheduler(e)||e.isReadOnly)return!1;return b()(r=e.providerCard.googleAttendees).call(r,(e=>e.email===t.email))?e.providerCard.canModify&&e.providerCard.googleOrganizer.self:e.providerCard.canInviteOthers}));if(0===i.length)return;let n=await this.getRecurringModeAsync(e,U.aO.Edit,r.applyRecurringActionToHead);if(null===n)return;let telemetryCallback=e=>{var i;let a=b()(i=e.providerCard.googleAttendees).call(i,(e=>e.email===t.email)),o=t.email===this._getUserEmail(e.accountId),s=a?o?U.cN.CardEvents.MemberUnassignedSelf:U.cN.CardEvents.MemberUnassigned:o?U.cN.CardEvents.MemberAssignedSelf:U.cN.CardEvents.MemberAssigned;this.logCardEvent(e,s,_objectSpread(_objectSpread({},r.telemetry),{},{recurringMode:n}))};n&&(i=await this._applyRecurrenceActionsAsync(i,{createException:!0,recurringMode:n,telemetryCallback,[U.f.OnlyOccurrence]:e=>{e.providerCard.googleAttendees=(0,K.G0)(e,t,this._getUserEmail(e.accountId))},[U.f.ThisAndFollowing]:e=>{e.providerCard.googleAttendees=(0,K.G0)(e,t,this._getUserEmail(e.accountId))}}),0===i.length)||await E().all(C()(i).call(i,(async e=>{try{let r=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id),i={googleAttendees:(0,K.G0)(r,t,this._getUserEmail(r.accountId))},n=await this._calendarCardsSrv.getIsSendUpdatesRequiredAsync(r,i);return telemetryCallback(r),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(r,i,{sendUpdates:n})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.toggleEventsAttendeeAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),U.k$.Error)}})))}async deleteCardsAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=g()(e).call(e,(e=>!e.isReadOnly));if(0===r.length)return;let i=await this.getRecurringModeAsync(e,U.aO.Delete,t.applyRecurringActionToHead);if(null===i)return;let telemetryCallback=e=>{this.logCardEvent(e,U.cN.CardEvents.Deleted,_objectSpread(_objectSpread({},t.telemetry),{},{recurringMode:i}))};if(t.forceConfirm||!i){let e=r.length;if(!await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.DELETE_GOOGLE_EVENT_TITLE"),1===e?this._$translate.instant("DIALOGS.DELETE_GOOGLE_EVENT_CONFIRM"):this._$translate.instant("DIALOGS.DELETE_GOOGLE_EVENT_CONFIRM_MULTIPLE",{cardsCount:e}),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))return}i&&(r=await this._applyRecurrenceActionsAsync(r,{createException:!1,recurringMode:i,telemetryCallback,[U.f.AllSeries]:e=>{(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(e.cardType,e)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this.deleteCardsAsync.name})}})()}}),0===r.length)||await E().all(C()(r).call(r,(e=>{try{let t=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id);return telemetryCallback(t),this._calendarCardsSrv.deleteCalendarCardAsync(t)}catch(e){this._$log.error("Planyway delete card error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card error",e,{class:this.constructor.name,method:this.deleteCardsAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_GOOGLE_EVENT_ERROR"),U.k$.Error)}})))}getThirdPartyUserId(e){return e.googleUserId}logCardEvent(e,t){var r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._telemetrySrv.logSessionEvent(t,_objectSpread({accountId:e.accountId,calendarId:e.calendarId,isAllDay:e.isAllDay,start:e.realStart||e.start,end:e.realEnd||e.end,cardType:e.cardType,cardRole:e.cardRole,isNewCard:null!==(r=e.isTempCard)&&void 0!==r&&r,recurrenceRule:e.recurrenceHeadRule||e.recurrenceRule},i))}getCardInviteStatus(e){var t;let r,i=M()(t=e.providerCard.googleAttendees).call(t,(e=>e.self));var n;i&&(r=i.responseStatus,r!==U.XO.No&&i.organizer&&e.providerCard.googleAttendees.length>1&&F()(n=e.providerCard.googleAttendees).call(n,(e=>e.self||e.responseStatus===U.XO.No))&&(r=U.XO.No));return r}_getUserEmail(e){return this._googleIntegrationSrv.getGoogleUser(e).email}_incrementActionCounter(){switch(this._appCommonSrv.getSchedulerMode()){case U.ud.Board:this._onboardingSrv.incrementActionCounter(U.Us.BoardCreate);break;case U.ud.Calendar:this._onboardingSrv.incrementActionCounter(U.Us.CalendarCreate);break;case U.ud.Timeline:this._onboardingSrv.incrementActionCounter(U.Us.TimelineCreate);break;case U.ud.TimeTracking:this._onboardingSrv.incrementActionCounter(U.Us.TimeTrackingCreate)}}}},71315:(e,t,r)=>{r.d(t,{G0:()=>toggleAttendee,Oi:()=>getGoogleCardId,fb:()=>Z});var i=r(40024),n=r.n(i),a=r(99595),o=r.n(a),s=r(57445),l=r.n(s),c=r(51791),d=r.n(c),u=r(90143),h=r.n(u),p=r(56626),v=r.n(p),m=r(67552),f=r.n(m),C=r(62079),y=r.n(C),g=r(52020),_=r.n(g),k=r(88546),w=r.n(k),b=r(66775),D=r.n(b),E=r(2201),S=r.n(E),A=r(26171),I=r(26881),P=r(88946),T=r.n(P),x=r(23513),R=r.n(x),$=r(73324),L=r.n($),M=r(45181),N=r.n(M),F=r(91829),G=r.n(F),O=r(86981),z=r.n(O),j=(r(58218),r(27525)),U=r.n(j),B=r(82617),H=r(14587),K=(r(46930),r(8937)),V=r(20115),W=r(29704);function ownKeys(e,t){var r=y()(e);if(_()){var i=_()(e);t&&(i=L()(i).call(i,(function(t){return w()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}l()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(o()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),o()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==d()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];h()(o).call(o,d()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(s)||s);e=l.element,this.addElementPlacement(e,t),l.finisher&&i.push(l.finisher);var c=l.extras;if(c){for(var u=0;u<c.length;u++)this.addElementPlacement(c[u],t);r.push.apply(r,c)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,v(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return T()(t=(0,I.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:T()(e).call(e,this.fromElementDescriptor,this)};return l()(t,v(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Z=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=z()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(T()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarCard{constructor(t,r,i){e(this),this._id=t,this._accountId=r,this._cardType=i,this._timeZones={},this._googleReminders=[],this._googleAttendees=[];const n=this;this._customExpand=function(e,t){if(n._expandRecurrenceRule)try{var r,i,a;let o=T()(r=n._expandRecurrenceRule.between((0,W._q)(e),(0,W._q)(t))).call(r,(e=>(0,W.Pb)(e,"local"))),s=new(R())(T()(i=n.exceptionDates).call(i,(e=>e.getTime()))),l=n.end-n.start;return T()(a=L()(o).call(o,(e=>!s.has(e.getTime())))).call(a,(e=>this.toOccurrence({start:e,end:new Date(e.getTime()+l)})))}catch{}}}}return{F:CalendarCard,d:[{kind:"get",key:"id",value:function id(){return this._id}},{kind:"get",key:"accountId",value:function accountId(){return this._accountId}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e}},{kind:"get",key:"calendarId",value:function calendarId(){return this.googleCalendarId}},{kind:"get",key:"cardType",value:function cardType(){return this._cardType}},{kind:"set",key:"cardType",value:function cardType(e){this._cardType=e}},{kind:"get",key:"cardRole",value:function cardRole(){return B.D.Card}},{kind:"set",key:"cardRole",value:function cardRole(e){}},{kind:"get",key:"title",value:function title(){return this._title||""}},{kind:"set",key:"title",value:function title(e){this._title=e}},{kind:"get",key:"description",value:function description(){return this._description||""}},{kind:"set",key:"description",value:function description(e){this._description=e}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this._isAllDay=e}},{kind:"get",key:"start",value:function start(){return this._start}},{kind:"set",key:"start",value:function start(e){this._start=e?new Date(e):void 0,this._previousStart=this._start}},{kind:"get",key:"previousStart",value:function previousStart(){return this._previousStart}},{kind:"get",key:"end",value:function end(){return this._end}},{kind:"set",key:"end",value:function end(e){this._end=e?new Date(e):void 0,this._previousEnd=this._end}},{kind:"get",key:"previousEnd",value:function previousEnd(){return this._previousEnd}},{kind:"get",key:"hasDates",value:function hasDates(){return(0,W.qb)(this.start)&&(0,W.qb)(this.end)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this._recurrenceRule=e}},{kind:"get",key:"recurrenceException",value:function recurrenceException(){return this._recurrenceException}},{kind:"set",key:"recurrenceException",value:function recurrenceException(e){this._recurrenceException=e}},{kind:"get",key:"exceptionDates",value:function exceptionDates(){return this._exceptionDates||[]}},{kind:"set",key:"exceptionDates",value:function exceptionDates(e){var t;this._exceptionDates=e||[],this._recurrenceException=this._exceptionDates.length>0?T()(t=this._exceptionDates).call(t,W.wd).join():void 0}},{kind:"get",key:"recurrenceId",value:function recurrenceId(){return this._recurrenceId}},{kind:"set",key:"recurrenceId",value:function recurrenceId(e){this._recurrenceId=e}},{kind:"get",key:"exceptionDate",value:function exceptionDate(){return(0,W.HE)(this.originalStart)}},{kind:"get",key:"originalStart",value:function originalStart(){return this._originalStart}},{kind:"set",key:"originalStart",value:function originalStart(e){this._originalStart=e}},{kind:"get",key:"isTempCard",value:function isTempCard(){var e;return N()(e=this.id).call(e,V.$d)}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return this._isReadOnly}},{kind:"get",key:"isSingleDate",value:function isSingleDate(){return!1}},{kind:"get",key:"customExpand",value:function customExpand(){return this._customExpand}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this._googleEventUrl}},{kind:"get",decorators:[(0,W.lv)()],key:"googleCalendarId",value:function googleCalendarId(){return this._googleCalendarId}},{kind:"set",key:"googleCalendarId",value:function googleCalendarId(e){this._googleCalendarId=e}},{kind:"get",decorators:[(0,W.lv)()],key:"googleEventId",value:function googleEventId(){return this._googleEventId}},{kind:"get",decorators:[(0,W.lv)()],key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this._isCompleted=e}},{kind:"get",decorators:[(0,W.lv)()],key:"googleShowAsFree",value:function googleShowAsFree(){return this._googleShowAsFree}},{kind:"set",key:"googleShowAsFree",value:function googleShowAsFree(e){this._googleShowAsFree=e}},{kind:"get",key:"googleVisibility",value:function googleVisibility(){return this._googleVisibility}},{kind:"set",key:"googleVisibility",value:function googleVisibility(e){this._googleVisibility=e}},{kind:"get",decorators:[(0,W.lv)()],key:"googleOrganizer",value:function googleOrganizer(){return this._googleOrganizer}},{kind:"get",decorators:[(0,W.lv)()],key:"canModify",value:function canModify(){var e;return this.isTempCard||(null===(e=this.googleOrganizer)||void 0===e?void 0:e.self)||this._googleGuestsCanModify}},{kind:"get",decorators:[(0,W.lv)()],key:"canInviteOthers",value:function canInviteOthers(){var e;return this.isTempCard||(null===(e=this.googleOrganizer)||void 0===e?void 0:e.self)||this._googleGuestsCanInviteOthers}},{kind:"get",decorators:[(0,W.lv)()],key:"canSeeOtherGuests",value:function canSeeOtherGuests(){var e;return this.isTempCard||(null===(e=this.googleOrganizer)||void 0===e?void 0:e.self)||this._googleGuestsCanSeeOtherGuests}},{kind:"get",decorators:[(0,W.lv)()],key:"googleAttendees",value:function googleAttendees(){var e;return null!==(e=this._googleAttendees)&&void 0!==e?e:[]}},{kind:"set",key:"googleAttendees",value:function googleAttendees(e){this._googleAttendees=e}},{kind:"get",decorators:[(0,W.lv)()],key:"googleReminders",value:function googleReminders(){var e;return null!==(e=this._googleReminders)&&void 0!==e?e:[]}},{kind:"set",key:"googleReminders",value:function googleReminders(e){this._googleReminders=e}},{kind:"get",key:"lastChangeId",value:function lastChangeId(){return this._lastChangeId}},{kind:"set",key:"lastChangeId",value:function lastChangeId(e){return this._lastChangeId=e}},{kind:"method",static:!0,key:"fromSourceCard",value:function fromSourceCard(e,t,r,i){var n,a,o,s,l;let c=new CalendarCard(e,t,r);if(!i)return c;const{googleEvent:d,googleCalendar:u}=i;var h,p;if(c._isReadOnly=u.isReadOnly,c._googleEventId=d.id,c._googleCalendarId=u.id,G()(n=u.id).call(n,"@group.v.calendar.google.com")||(c._googleEventUrl=d.htmlLink),c.googleShowAsFree=d.transparency===K.xj.Transparent,c.googleVisibility=d.visibility,c._googleOrganizer=d.organizer,c._googleGuestsCanModify=null!==(a=d.guestsCanModify)&&void 0!==a&&a,c._googleGuestsCanInviteOthers=null===(o=d.guestsCanInviteOthers)||void 0===o||o,c._googleGuestsCanSeeOtherGuests=null===(s=d.guestsCanSeeOtherGuests)||void 0===s||s,c._googleAttendees=d.attendees,c._googleReminders=!d.reminders||d.reminders.useDefault?u.defaultReminders:d.reminders.overrides,c.title=d.summary?d.summary.replace(/^✓\s?/,""):"",c.description=d.description,c.isCompleted=!!d.summary&&N()(l=d.summary).call(l,"✓"),d.start.dateTime?(c.isAllDay=!1,c.start=new Date(d.start.dateTime),c.end=new Date(d.end.dateTime)):(c.isAllDay=!0,c.start=(0,W.HE)(d.start.date),c.end=(0,W.E4)((0,W.HE)(d.end.date),-1)),c._timeZones={start:d.start.timeZone,end:d.end.timeZone},d.recurrence){if(c._recurrenceRule=null===(h=z()(p=d.recurrence).call(p,(e=>N()(e).call(e,"RRULE:"))))||void 0===h?void 0:h.replace("RRULE:",""),!c.isAllDay)try{let e=H.Ci.parseString(c._recurrenceRule);e.dtstart=(0,W.c6)(c.start,d.start.timeZone),e.tzid=d.start.timeZone,c._expandRecurrenceRule=new H.Ci(e)}catch{}}else d.recurringEventId&&(c._recurrenceId=getGoogleCardId(d.recurringEventId,u.shortId),c._googleRecurringEventId=d.recurringEventId,c._originalStart=d.originalStartTime.dateTime||d.originalStartTime.date,c._timeZones.originalStart=d.originalStartTime.timeZone);return c.lastChangeId=new Date(d.updated).getTime(),c}},{kind:"method",key:"toSourceCard",value:function toSourceCard(e){const{googleCalendar:t,includeFields:r=[]}=e;let i={},n={summary:()=>i.summary=this.isCompleted?`✓ ${this.title}`:this.title,description:()=>i.description=this.description,start:()=>{this.isAllDay?i.start={date:(0,W.tC)(this.start),dateTime:null}:i.start={date:null,dateTime:this.start.toISOString()},this._timeZones.start?i.start.timeZone=this._timeZones.start:(this.recurrenceRule||this.recurrenceId)&&(i.start.timeZone=t.timeZone)},end:()=>{this.isAllDay?i.end={date:(0,W.tC)((0,W.E4)(this.end,1)),dateTime:null}:i.end={date:null,dateTime:this.end.toISOString()},this._timeZones.end?i.end.timeZone=this._timeZones.end:(this.recurrenceRule||this.recurrenceId)&&(i.end.timeZone=t.timeZone)},recurrence:()=>i.recurrence=this.recurrenceRule?[`RRULE:${this.recurrenceRule}`]:[],recurringEventId:()=>i.recurringEventId=this._googleRecurringEventId,originalStartTime:()=>{(0,W.of)(this.originalStart)?i.originalStartTime={date:this.originalStart,dateTime:null}:i.originalStartTime={date:null,dateTime:this.originalStart},i.originalStartTime.timeZone=this._timeZones.originalStart},transparency:()=>i.transparency=this.googleShowAsFree?K.xj.Transparent:K.xj.Opaque,attendees:()=>i.attendees=this.googleAttendees,reminders:()=>{i.reminders={useDefault:this.isTempCard&&0===this.googleReminders.length,overrides:this._googleReminders}}};for(let e of r){let t=n[e];t&&t()}return i}},{kind:"method",key:"clone",value:function clone(){let e=new CalendarCard(this.id,this.accountId,this.cardType);return this.hasDates&&(e.isAllDay=this.isAllDay,e.start=this.start,e.end=this.end),e.title=this.title,e.description=this.description,e.isCompleted=this.isCompleted,e.recurrenceRule=this.recurrenceRule,e.exceptionDates=[...this.exceptionDates],e.recurrenceId=this.recurrenceId,e.originalStart=this.originalStart,e._isReadOnly=this._isReadOnly,e._googleCalendarId=this.googleCalendarId,e._googleEventId=this.googleEventId,e._googleRecurringEventId=this._googleRecurringEventId,e._googleEventUrl=this._googleEventUrl,e._googleShowAsFree=this.googleShowAsFree,e._googleOrganizer=this.googleOrganizer,e._googleGuestsCanModify=this._googleGuestsCanModify,e._googleGuestsCanInviteOthers=this._googleGuestsCanInviteOthers,e._googleGuestsCanSeeOtherGuests=this._googleGuestsCanSeeOtherGuests,e._googleAttendees=[...this.googleAttendees],e._googleReminders=[...this.googleReminders],e._timeZones=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?o()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,A.Z)(e,t,n[t])})):D()?S()(e,D()(n)):o()(i=ownKeys(Object(n))).call(i,(function(t){l()(e,t,w()(n,t))}))}return e}({},this._timeZones),e.lastChangeId=this.lastChangeId,e}},{kind:"method",key:"equals",value:function equals(e){if(!e)return!1;function toCardObject(e){return{id:e.id,cardType:e.cardType,title:e.title,description:e.description,isCompleted:e.isCompleted,isAllDay:e.isAllDay,start:e.start,end:e.end,recurrenceRule:e.recurrenceRule,exceptionDates:e.exceptionDates,googleCalendarId:e.googleCalendarId,googleShowAsFree:e.googleShowAsFree,googleAttendees:e.googleAttendees,googleReminders:e.googleReminders}}let t=toCardObject(this),r=toCardObject(e),i=(0,W.h0)(t,r);return i}},{kind:"method",key:"getCompareId",value:function getCompareId(){return this.lastChangeId}}]}}));function getGoogleCardId(e,t){return(0,W.hr)(`${e}-${t}`)}function toggleAttendee(e,t,r){var i;let n,{providerCard:a}=e,o=U()(i=a.googleAttendees).call(i,(e=>e.email===t.email)),s=t.email===r;if(o){var l;n=L()(l=a.googleAttendees).call(l,(e=>e.email!==t.email))}else{let e=[{email:t.email,responseStatus:s?K.XO.Yes:void 0}];a.googleAttendees.length||s||!r||e.push({email:r,responseStatus:K.XO.Yes}),n=[...a.googleAttendees,...e]}return n}},37023:(e,t,r)=>{r.d(t,{M:()=>ie});var i=r(40024),n=r.n(i),a=r(57445),o=r.n(a),s=r(51791),l=r.n(s),c=r(56626),d=r.n(c),u=r(67552),h=r.n(u),p=r(26881),v=r(99595),m=r.n(v),f=r(54847),C=r.n(f),y=r(23513),g=r.n(y),_=r(89221),k=r.n(_),w=r(35820),b=r.n(w),D=r(88946),E=r.n(D),S=r(29898),A=r.n(S),I=r(91829),P=r.n(I),T=r(73324),x=r.n(T),R=r(27525),$=r.n(R),L=r(62079),M=r.n(L),N=r(39290),F=r.n(N),G=r(90143),O=r.n(G),z=r(86981),j=r.n(z),U=r(45181),B=r.n(U),H=r(10349),K=r.n(H),V=r(82617),W=r(16357),Z=r(56777),q=(r(21695),r(71315)),Q=r(46930),Y=r(8937),X=r(20115),J=r(54840),ee=r(29704);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;m()(r=["method","field"]).call(r,(function(r){m()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;m()(r=["method","field"]).call(r,(function(r){m()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(m()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),m()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];O()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var d=c.extras;if(d){for(var u=0;u<d.length;u++)this.addElementPlacement(d[u],t);r.push.apply(r,d)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,d(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return E()(t=(0,p.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:h()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:E()(e).call(e,this.fromElementDescriptor,this)};return o()(t,d(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const te=["id","htmlLink","status","attendees","summary","description","start","end","recurrence","recurringEventId","originalStartTime","transparency","visibility","organizer","guestsCanModify","guestsCanInviteOthers","guestsCanSeeOtherGuests","reminders","updated"],re=["googleCalendarId"];let ie=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=j()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(E()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,ee.SG)(["$rootScope","$log","$timeout","$translate","appCommonSrv","collectionSrv","dialogSrv","googleIntegrationSrv","notificationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class GoogleCardsService{constructor(t,r,i,n,a,o,s,l,c,d,u,h){e(this),this._$rootScope=t,this._$log=r,this._$timeout=i,this._$translate=n,this._appCommonSrv=a,this._collectionSrv=o,this._dialogSrv=s,this._googleIntegrationSrv=l,this._notificationSrv=c,this._platformSrv=d,this._settingsSrv=u,this._telemetrySrv=h,this._googleIntegrationSrv.addGoogleCalendarEventListener("updated",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(Y.FK.CardsReloaded)}})),this._googleIntegrationSrv.addGoogleCalendarEventListener("deleted",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadedCalendarIds.delete(e.id),t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(Y.FK.CardsReloaded)}})),this._$rootScope.$on(Y.FK.FiltersChanged,(()=>{var e;m()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{this._cache.get(e).ignoreFiltersCardIds.clear()}))}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"googleCardsSrv"}},{kind:"field",key:"provider",value:()=>(0,Z.VH)(Y.lP.Google)},{kind:"field",key:"_cache",value:()=>new(C())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_calendarCardsListeners",value:()=>({added:new(g()),updated:new(g()),deleted:new(g()),cleared:new(g())})},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){var t,r;this._initializedCollectionId=null;for(let e of k()(i=this._cache).call(i)){var i;e.destroy()}this._cache.clear(),m()(t=this.provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>this._resetAccountCache(e))),await b().all(E()(r=this.provider.getCurrentCollectionConnectedAccountIds()).call(r,(async t=>{this.reloadCalendars(t),await this.loadCalendarCardsAsync(t,e)}))),this._initializedCollectionId=this._currentCollectionId}},{kind:"method",key:"addGoogleAccountAsync",value:async function addGoogleAccountAsync(e){this._resetAccountCache(e),this.reloadCalendars(e),await this.loadCalendarCardsAsync(e),this._initializedCollectionId=this._currentCollectionId}},{kind:"method",key:"removeGoogleAccount",value:function removeGoogleAccount(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy(),this._cache.delete(e)}},{kind:"method",key:"reloadCalendars",value:function reloadCalendars(e){const t=this._cache.get(e);let r=this.provider.getCurrentCollectionSelectedCalendarIds(e);for(let e of A()(i=t.loadedCalendarIds).call(i)){var i;P()(r).call(r,e)||t.hiddenCalendarIds.add(e)}for(let e of r)t.loadedCalendarIds.has(e)?t.hiddenCalendarIds.delete(e):t.loadedCalendarIds.set(e,!0);this._requestReloadCalendarCards(e)}},{kind:"method",key:"isGoogleCalendarBusy",value:function isGoogleCalendarBusy(e,t){var r;return null!==(r=this._cache.get(e).busyCalendarIds.get(t))&&void 0!==r&&r}},{kind:"method",key:"needReloadCalendarCards",value:function needReloadCalendarCards(){var e;m()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{const t=this._cache.get(e);for(let e of A()(r=t.loadedCalendarIds).call(r)){var r;t.loadedCalendarIds.set(e,!0)}this._requestReloadCalendarCards(e)}))}},{kind:"method",key:"loadCalendarCardsAsync",value:async function loadCalendarCardsAsync(e,t){const r=this._cache.get(e);if(r.reloadCalendarCardsRequested){r.reloadCalendarCardsRequested=!1,t=t||this._appCommonSrv.getCancellationToken(`getCalendarCards_${e}`);try{r.loadCalendarCardsPromise=this._loadCalendarCardsAsync(e,t),await r.loadCalendarCardsPromise}catch(e){this._$log.error("Planyway get Google cards error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get Google calendar cards error",e,{class:this.constructor.name,method:this.loadCalendarCardsAsync.name})}finally{r.loadCalendarCardsPromise=null}}}},{kind:"method",key:"getCalendarCards",value:function getCalendarCards(e){var t,r;const i=this._cache.get(e);return x()(t=k()(r=i.calendarCards).call(r)).call(t,(e=>!i.hiddenCalendarIds.has(e.providerCard.googleCalendarId)))}},{kind:"method",key:"getCalendarCardByIdAsync",value:function getCalendarCardByIdAsync(e,t){return this.getCalendarCardById(e,t)}},{kind:"method",key:"getCalendarCardById",value:function getCalendarCardById(e,t){return this._cache.get(e).calendarCards.get(t)}},{kind:"method",key:"createCalendarCardAsync",value:async function createCalendarCardAsync(e){const t=e.accountId,r=this._cache.get(t);e.title||(e.title=this._$translate.instant("MISC.NO_TITLE"));let i,n=this._googleIntegrationSrv.getGoogleCalendarById(t,e.providerCard.googleCalendarId);if(e.recurrenceId){let r=this.getCalendarCardById(t,e.recurrenceId),{items:[a]}=await this._googleIntegrationSrv.restAsync(t,Y.Tu.Get,Y.KN.Calendar,`/calendars/${e.providerCard.googleCalendarId}/events/${r.providerCard.googleEventId}/instances`,"Get Google event recurring instance",{originalStart:e.originalStart});if(!a)throw new Error("Cannot get Google calendar recurring event instance for Google event");let o=e.toSourceCard({googleCalendar:n,includeFields:["summary","description","start","end","attendees"]});i=await this._googleIntegrationSrv.restAsync(t,Y.Tu.Patch,Y.KN.Calendar,`/calendars/${e.providerCard.googleCalendarId}/events/${a.id}`,"Update Google event recurring instance",o)}else{var a;let r=e.toSourceCard({googleCalendar:n,includeFields:["summary","description","start","end","recurrence","transparency","attendees","reminders"]}),o=`/calendars/${e.providerCard.googleCalendarId}/events`;const s=this._googleIntegrationSrv.getGoogleUser(t).email;if($()(a=r.attendees).call(a,(e=>e.email!==s))){await this._dialogSrv.showSendEventUpdatesDialogAsync(e.title,W.c.Invitation)&&(o+=`?sendUpdates=${Y.iz.All}`,this.provider.logCardEvent(e,Y.cN.CardEvents.InviteSent,{attendeeCount:e.providerCard.googleAttendees.length}))}i=await this._googleIntegrationSrv.restAsync(t,Y.Tu.Post,Y.KN.Calendar,o,"Create Google event",r)}let o=Q.fb.createCard(t,Y.lP.Google,V.eT.GoogleEvent,{googleEvent:i,googleCalendar:n});return r.loadedCalendarIds.has(o.providerCard.googleCalendarId)?(r.calendarCards.delete(e),r.calendarCards.add(o),r.ignoreFiltersCardIds.add(o.id)):r.calendarCards.delete(e),o}},{kind:"method",key:"createTempCalendarCard",value:function createTempCalendarCard(e,t,r){const i=this._cache.get(e),{cardType:n}=r;let a=new Q.fb(X.$d,e,Y.lP.Google,n);return t.cardRole&&(a.cardRole=t.cardRole),a.providerCard.googleCalendarId=t.providerCard.googleCalendarId,a.title=t.title||"",a.description=t.description||"",a.providerCard.isCompleted=t.providerCard.isCompleted,a.isAllDay=t.isAllDay,a.start=t.start,a.end=t.end,t.recurrenceRule?a.recurrenceRule=t.recurrenceRule:t.recurrenceId&&(a.recurrenceId=t.recurrenceId,a.originalStart=t.originalStart),t.providerCard.googleAttendees&&(a.providerCard.googleAttendees=[...t.providerCard.googleAttendees]),t.providerCard.googleReminders&&(a.providerCard.googleReminders=[...t.providerCard.googleReminders]),a.providerCard.googleShowAsFree=t.providerCard.googleShowAsFree,i.calendarCards.add(a),a}},{kind:"method",key:"changeCalendarCardType",value:function changeCalendarCardType(e,t,r,i,n){t===V.eT.GoogleEvent?this._cache.get(i).calendarCards.delete(e):r===V.eT.GoogleEvent&&(e.cardType=r,e.accountId=n,this._cache.get(n).calendarCards.add(e))}},{kind:"method",key:"getIsSendUpdatesRequiredAsync",value:async function getIsSendUpdatesRequiredAsync(e,t){var r,i,n,a;const o=e.accountId;if(e.isTempCard||e.cardType!==V.eT.GoogleEvent)return null;const s=this._googleIntegrationSrv.getGoogleUser(o).email;let l="googleAttendees"in t;if(!($()(r=e.providerCard.googleAttendees).call(r,(e=>e.email!==s))||l&&$()(i=t.googleAttendees).call(i,(e=>e.email!==s))))return null;let c=["title","description","isAllDay","start","end","recurrenceRule","googleAttendees"];if(!$()(c).call(c,(e=>e in t)))return null;if(l&&1===M()(t).length&&(0,ee.cO)(E()(n=t.googleAttendees).call(n,(e=>e.email)),E()(a=e.providerCard.googleAttendees).call(a,(e=>e.email))))return null;if(!e.providerCard.googleOrganizer.self&&!l)return null;let isCurrentUserInAttendees=e=>$()(e).call(e,(e=>e.email===s));if(l&&1===Math.abs(e.providerCard.googleAttendees.length-t.googleAttendees.length)&&(isCurrentUserInAttendees(e.providerCard.googleAttendees)&&!isCurrentUserInAttendees(t.googleAttendees)||!isCurrentUserInAttendees(e.providerCard.googleAttendees)&&isCurrentUserInAttendees(t.googleAttendees)))return null;let d=await this._dialogSrv.showSendEventUpdatesDialogAsync(e.title,W.c.Updates);return d&&this.provider.logCardEvent(e,Y.cN.CardEvents.InviteSent,{attendeeCount:e.providerCard.googleAttendees.length}),d}},{kind:"method",key:"updateCalendarCardAsync",value:async function updateCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.accountId,i=this._cache.get(r),{waitForUpdate:n,includeGoogleFields:a=[],movedFromCalendarId:o}=t;if(0!==a.length||o)try{let s=e.clone();if(o)if(this._appCommonSrv.setSchedulerBusy(!0),e.isTempCard);else{let t=await this._googleIntegrationSrv.restAsync(r,Y.Tu.Post,Y.KN.Calendar,`/calendars/${o}/events/${e.providerCard.googleEventId}/move?destination=${e.providerCard.googleCalendarId}`,"Move Google event");e.providerCard.lastChangeId=new Date(t.updated).getTime()}if(e.isTempCard)return void(i.loadedCalendarIds.has(e.providerCard.googleCalendarId)?i.calendarCards.update(e):i.calendarCards.delete(e));let l=this._googleIntegrationSrv.getGoogleCalendarById(r,e.providerCard.googleCalendarId),c=e.toSourceCard({googleCalendar:l,includeFields:a});n||(i.loadedCalendarIds.has(e.providerCard.googleCalendarId)?i.calendarCards.update(e):i.calendarCards.delete(e));let d=`/calendars/${e.providerCard.googleCalendarId}/events/${e.providerCard.googleEventId}`;t.sendUpdates&&(d+=`?sendUpdates=${Y.iz.All}`);let u=await this._googleIntegrationSrv.restAsync(r,Y.Tu.Patch,Y.KN.Calendar,d,"Update Google event",c,n?3:9),h=Q.fb.createCard(r,Y.lP.Google,V.eT.GoogleEvent,{googleEvent:u,googleCalendar:l});if(h.exceptionDates=e.exceptionDates,!i.calendarCards.get(e.id))return;n||!s.equals(h)?i.loadedCalendarIds.has(h.providerCard.googleCalendarId)?i.calendarCards.update(h):i.calendarCards.delete(h):e.providerCard.lastChangeId=new Date(u.updated).getTime(),o&&i.calendarCards.delete(e,{replacedWith:h})}catch(e){if(this._telemetrySrv.logError("Google update card error",e,{class:this.constructor.name,method:this.updateCalendarCardAsync.name}),n)throw e;this._$log.error("Google update card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),Y.k$.Error)}finally{o&&this._appCommonSrv.setSchedulerBusy(!1)}else i.loadedCalendarIds.has(e.providerCard.calendarId)?i.calendarCards.update(e):i.calendarCards.delete(e)}},{kind:"method",key:"updateCalendarCardPropertiesAsync",value:function updateCalendarCardPropertiesAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.accountId,n=this._cache.get(i);let{immediateUpdate:a=!1}=r;$()(re).call(re,(e=>e in t))&&(a=!0);let o=n.cardsUpdateBuffers.get(e.id);o||(o={changes:{}},a||n.cardsUpdateBuffers.set(e.id,o)),o.changes||(o.changes={});for(let[e,r]of F()(t))void 0!==r&&(o.changes[e]=r);return o.processUpdatePromise||(o.processUpdatePromise=this._processCardUpdateBufferAsync(i,e.id,o,r)),o.processUpdatePromise}},{kind:"method",key:"deleteCalendarCardAsync",value:async function deleteCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.accountId,i=this._cache.get(r),{waitForDelete:n}=t;try{var a,o,s;if(e.isTempCard)return void i.calendarCards.delete(e);let t=x()(a=k()(o=i.calendarCards).call(o)).call(a,(t=>t.recurrenceId===e.id));if(!n){i.calendarCards.delete(e);for(let e of t)i.calendarCards.delete(e)}const l=this._googleIntegrationSrv.getGoogleUser(r).email;let c=`/calendars/${e.providerCard.googleCalendarId}/events/${e.providerCard.googleEventId}`;if($()(s=e.providerCard.googleAttendees).call(s,(e=>e.email!==l))&&e.providerCard.googleOrganizer.self){await this._dialogSrv.showSendEventUpdatesDialogAsync(e.title,W.c.Cancellation)&&(c+=`?sendUpdates=${Y.iz.All}`)}if(await this._googleIntegrationSrv.restAsync(r,Y.Tu.Delete,Y.KN.Calendar,c,"Delete Google event",null,n?3:9),n){i.calendarCards.delete(e);for(let e of t)i.calendarCards.delete(e)}}catch(e){if(410===e.status)return;if(this._telemetrySrv.logError("Google delete event error",e,{class:this.constructor.name,method:this.deleteCalendarCardAsync.name}),n)throw e;this._$log.error("Google delete event error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_GOOGLE_EVENT_ERROR"),Y.k$.Error)}}},{kind:"method",key:"createRecurrenceGapAsync",value:async function createRecurrenceGapAsync(e,t){let r=this.getCalendarCardById(e,t.recurrenceId),{items:[i]}=await this._googleIntegrationSrv.restAsync(e,Y.Tu.Get,Y.KN.Calendar,`/calendars/${t.providerCard.googleCalendarId}/events/${r.providerCard.googleEventId}/instances`,"Get Google event recurring instance",{originalStart:t.originalStart});if(!i)throw new Error("Cannot get Google calendar recurring event instance for Google event");await this._googleIntegrationSrv.restAsync(e,Y.Tu.Delete,Y.KN.Calendar,`/calendars/${t.providerCard.googleCalendarId}/events/${i.id}`,"Delete Google event recurring instance")}},{kind:"method",key:"addExceptionToRecurrentAsync",value:function addExceptionToRecurrentAsync(e,t){let r=this.getCalendarCardById(e,t.recurrenceId);if(r)return r.addExceptionDate(t.exceptionDate),this.updateCalendarCardPropertiesAsync(r,{exceptionDates:r.exceptionDates})}},{kind:"method",key:"removeExceptionsFromRecurrentAsync",value:function removeExceptionsFromRecurrentAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{fromDate:i}=r,n=this.getCalendarCardById(e,t.id);if(n)return n.deleteExceptionDates(i),this.updateCalendarCardPropertiesAsync(n,{recurrenceRule:n.recurrenceRule,exceptionDates:n.exceptionDates})}},{kind:"method",key:"deleteRecurrenceExceptionsAsync",value:async function deleteRecurrenceExceptionsAsync(e){var t,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.accountId,a=this._cache.get(n);let{fromDate:o}=i,s=x()(t=k()(r=a.calendarCards).call(r)).call(t,(t=>t.recurrenceId===e.id&&!(o&&t.exceptionDate<o)));for(let e of s)a.calendarCards.delete(e);for(;s.length>0;){var l;await b().all(E()(l=O()(s).call(s,0,5)).call(l,(async e=>{try{await this._googleIntegrationSrv.restAsync(n,Y.Tu.Delete,Y.KN.Calendar,`/calendars/${e.providerCard.googleCalendarId}/events/${e.providerCard.googleEventId}`,"Delete Google event recurrence exception",null,9)}catch(e){this._$log.error("Google delete recurrence exception error:"),this._$log.error(e)}})))}}},{kind:"method",key:"addCalendarCardEventListener",value:function addCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeCalendarCardEventListener",value:function removeCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"method",key:"isCalendarCardLoaded",value:function isCalendarCardLoaded(e){const t=e.accountId,r=this._cache.get(t);return r.loadedCalendarIds.has(e.providerCard.googleCalendarId)&&!r.hiddenCalendarIds.has(e.providerCard.googleCalendarId)}},{kind:"method",key:"isCalendarCardVisible",value:function isCalendarCardVisible(e){const t=this._cache.get(e.accountId);if(e.isTempCard)return!0;if(!this.isCalendarCardLoaded(e))return!1;if(t.ignoreFiltersCardIds.has(e.id))return!0;let r=this._appCommonSrv.getFiltersCardSearchString();var i;if(r)return P()(i=e.title.toLowerCase()).call(i,r);switch(this._collectionSettings.global.settings.filters.cardsVisibility){case Y.Vh.Completed:if(!e.providerCard.isCompleted)return!1;break;case Y.Vh.Incompleted:if(e.providerCard.isCompleted)return!1}return!0}},{kind:"method",key:"setCalendarCardIgnoreFilters",value:function setCalendarCardIgnoreFilters(e){this._cache.get(e.accountId).ignoreFiltersCardIds.add(e.id)}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"method",key:"_resetAccountCache",value:function _resetAccountCache(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy();const r={loadedCalendarIds:new(C()),hiddenCalendarIds:new(g()),busyCalendarIds:new(C()),calendarsSyncTokens:new(C()),calendarCards:new J.v("id",Q.fb),reloadCalendarCardsRequested:!1,ignoreFiltersCardIds:new(g()),cardsUpdateBuffers:new(C()),destroy:()=>{r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout),r.calendarCards.clear({accountId:e});for(let e in this._calendarCardsListeners)r.calendarCards.removeEventListener(e,this._handleCalendarCardEvent)}};this._cache.set(e,r);for(let e in this._calendarCardsListeners)r.calendarCards.addEventListener(e,this._handleCalendarCardEvent)}},{kind:"field",key:"_handleCalendarCardEvent",value(){var e=this;return function(t){var r,i,n;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:o,silent:s}=a;if(!s)switch(o){case"added":if(!t.isTempCard&&!e.isCalendarCardLoaded(t))break;m()(r=e._calendarCardsListeners[o]).call(r,(e=>e(t,a)));break;case"updated":case"deleted":m()(i=e._calendarCardsListeners[o]).call(i,(e=>e(t,a)));break;case"cleared":m()(n=e._calendarCardsListeners[o]).call(n,(e=>e(a)))}}}},{kind:"method",key:"_waitActiveRequestsAsync",value:async function _waitActiveRequestsAsync(e){const t=this._cache.get(e);for(;;){var r,i;let n=[...this._googleIntegrationSrv.getRestPromises(e),...E()(r=k()(i=t.cardsUpdateBuffers).call(i)).call(r,(e=>e.processUpdatePromise))];if(0===n.length)break;await b().allSettled(n)}}},{kind:"method",key:"_requestReloadCalendarCards",value:function _requestReloadCalendarCards(e){const t=this._cache.get(e);t.reloadCalendarCardsRequested=!0,t.busyCalendarIds.clear()}},{kind:"method",key:"_setGoogleCalendarsBusy",value:function _setGoogleCalendarsBusy(e,t,r){const i=this._cache.get(e);this._$rootScope.$evalAsync((()=>{for(let e of t)i.busyCalendarIds.set(e,r)}))}},{kind:"method",key:"_getGoogleCalendarEventsAsync",value:async function _getGoogleCalendarEventsAsync(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=this._cache.get(e);let a=[];for(t=[...t];t.length>0;){var o;await b().all(E()(o=O()(t).call(t,0,4)).call(o,(async t=>{if(!this.provider.invalidAccountIds.has(e))try{let o;o=i?{syncToken:n.calendarsSyncTokens.get(t)}:{minDate:(0,ee.Bc)(new Date,-1),maxDate:(0,ee.Bc)(new Date,1)};let{items:s,nextSyncToken:l}=await this._googleIntegrationSrv.listAsync(e,`/calendars/${encodeURIComponent(t)}/events`,"Get Google calendar events",te,o);if(n.calendarsSyncTokens.set(t,l),r.isCanceled())return;a.push({accountId:e,calendarId:t,googleEvents:s})}catch(t){this._platformSrv.isOffline()||this.provider.invalidAccountIds.add(e),this._$log.error("Planyway get Google calendar events error:"),this._$log.error(t)}})))}return a}},{kind:"method",key:"_loadCalendarCardsAsync",value:async function _loadCalendarCardsAsync(e,t){await this._platformSrv.waitOnlineAsync();const r=this._cache.get(e);let i=[];for(let e of A()(n=r.loadedCalendarIds).call(n)){var n;r.loadedCalendarIds.get(e)&&i.push(e)}const a=x()(i).call(i,(e=>!r.busyCalendarIds.has(e)));try{this._setGoogleCalendarsBusy(e,a,!0);let n=await this._getGoogleCalendarEventsAsync(e,i,t);if(t.isCanceled())return;for(let e of k()(o=r.calendarCards).call(o)){var o,s;e.isTempCard||(null===(s=r.loadedCalendarIds.get(e.providerCard.googleCalendarId))||void 0===s||s)&&r.calendarCards.delete(e.id)}for(let{calendarId:t,googleEvents:i}of n){let n={},a=[],o=this._googleIntegrationSrv.getGoogleCalendarById(e,t);for(let t of i){if(t.recurrence){var l;let e=j()(l=t.recurrence).call(l,(e=>B()(e).call(e,"EXDATE")));if(e){var c;let r=j()(c=[/^EXDATE:(?<datesString>[0-9TZ,]+)$/,/^EXDATE;TZID=(?<timeZone>[A-Za-z/]+):(?<datesString>[0-9T,]+)$/,/^EXDATE;VALUE=DATE-TIME:(?<datesString>[0-9T,]+)$/,/^EXDATE;VALUE=DATE:(?<datesString>[0-9,]+)$/]).call(c,(t=>t.test(e)));if(r){var d,u;let{datesString:i,timeZone:a}=e.match(r).groups,s=x()(d=E()(u=i.split(",")).call(u,(e=>(0,ee.RF)(e,a)))).call(d,(e=>(0,ee.qb)(e)));if(s.length>0){let e=(0,q.Oi)(t.id,o.shortId),r=n[e];r||(r=[],n[e]=r),r.push(...s)}}}}if(t.recurringEventId){let e=(0,q.Oi)(t.recurringEventId,o.shortId),r=n[e];r||(r=[],n[e]=r),r.push((0,ee.HE)(t.originalStartTime.dateTime||t.originalStartTime.date))}if("confirmed"!==t.status)continue;let r=this._createCalendarCardFromGoogleEvent(e,t,o);a.push(r)}for(let e of a)e.recurrenceRule&&(e.exceptionDates=n[e.id]),r.calendarCards.add(e);this._$rootScope.$broadcast(Y.FK.CollectionCalendarReady,{accountId:e,calendarId:t})}for(let e of i)r.loadedCalendarIds.set(e,!1)}finally{t.isCanceled()||this._setGoogleCalendarsBusy(e,a,!1)}r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout);const pollGoogleEventsAsync=async()=>{if(await this._platformSrv.waitOnlineAsync(),!this.provider.invalidAccountIds.has(e)){await this._waitActiveRequestsAsync(e);try{await this._pollGoogleEventsAsync(e)}catch(e){this._$log.error("Planyway poll Google events error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway poll Google events error",e,{class:this.constructor.name,method:this._pollGoogleEventsAsync.name})}r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollGoogleEventsAsync()),6e4,!1)}};r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollGoogleEventsAsync()),6e4,!1)}},{kind:"method",key:"_pollGoogleEventsAsync",value:async function _pollGoogleEventsAsync(e){var t;const r=this._cache.get(e),i=this._appCommonSrv.getCancellationToken(`pollGoogleEvents_${e}`);let n=K()(A()(t=r.loadedCalendarIds).call(t)),a=await this._getGoogleCalendarEventsAsync(e,n,i,!0);if(!i.isCanceled())for(let{calendarId:t,googleEvents:i}of a){if(!r.loadedCalendarIds.has(t))continue;let n=new(C());for(let e of k()(o=r.calendarCards).call(o)){var o;e.providerCard.googleCalendarId===t&&n.set(e.id,e)}let a=new(C()),s={},l=[],c=[],d=[],u=this._googleIntegrationSrv.getGoogleCalendarById(e,t);for(let t of i){if(t.recurringEventId){let e=(0,q.Oi)(t.recurringEventId,u.shortId),r=s[e];r||(r=[],s[e]=r),r.push(t.originalStartTime.dateTime||t.originalStartTime.date)}let i=(0,q.Oi)(t.id,u.shortId),n=r.calendarCards.get(i);if("confirmed"!==t.status)n&&l.push(n);else{let r=this._createCalendarCardFromGoogleEvent(e,t,u);if(a.set(r.id,r),n){if(n.equals(r))continue;c.push(r)}else d.push(r)}}for(let[e,t]of F()(s)){let i=r.calendarCards.get(e);if(i){for(let e of t)i.addExceptionDate(e);r.calendarCards.update(i)}}for(let e of l)r.calendarCards.delete(e);for(let e of c)e.recurrenceRule&&(e.exceptionDates=r.calendarCards.get(e.id).exceptionDates),r.calendarCards.update(e);for(let e of d)e.recurrenceRule&&(e.exceptionDates=s[e.id]),r.calendarCards.add(e)}}},{kind:"method",key:"_createCalendarCardFromGoogleEvent",value:function _createCalendarCardFromGoogleEvent(e,t,r){let i=Q.fb.createCard(e,Y.lP.Google,V.eT.GoogleEvent,{googleEvent:t,googleCalendar:r}),n=i.providerCard;return(n.googleVisibility===Y.yb.Private||n.googleVisibility===Y.yb.Confidential)&&!n.title&&n.isReadOnly&&(n.title=n.googleShowAsFree?this._$translate.instant("MISC.GOOGLE_EVENT_FREE"):this._$translate.instant("MISC.GOOGLE_EVENT_BUSY")),i}},{kind:"method",key:"_processCardUpdateBufferAsync",value:async function _processCardUpdateBufferAsync(e,t,r,i){if(r.processUpdatePromise)return r.processUpdatePromise;const n=this._cache.get(e),{immediateUpdate:a,sendUpdates:o}=i;try{for(a||await(0,ee.$U)(200);r.changes;){let i=r.changes;r.changes=null;let n=this.getCalendarCardById(e,t);if(!n)return;let a={title:"summary",description:"description",isCompleted:"summary",start:"start",end:"end",recurrenceRule:"recurrence",googleShowAsFree:"transparency",googleAttendees:"attendees",googleReminders:"reminders"},s=[],l=null;for(let e in i){let t=a[e];t&&s.push(t),"googleCalendarId"===e&&(l=n.providerCard.googleCalendarId),e in n?n[e]=i[e]:e in n.providerCard&&(n.providerCard[e]=i[e])}(i.start||i.end)&&n.correctRecurrenceDates(),await this.updateCalendarCardAsync(n,{waitForUpdate:!1,sendUpdates:o,includeGoogleFields:s,movedFromCalendarId:l})}}finally{n.cardsUpdateBuffers.delete(t)}}}]}}))},68841:(e,t,r)=>{r.d(t,{z:()=>ce});var i=r(40024),n=r.n(i),a=r(57445),o=r.n(a),s=r(51791),l=r.n(s),c=r(90143),d=r.n(c),u=r(56626),h=r.n(u),p=r(67552),v=r.n(p),m=r(62079),f=r.n(m),C=r(52020),y=r.n(C),g=r(73324),_=r.n(g),k=r(88546),w=r.n(k),b=r(66775),D=r.n(b),E=r(2201),S=r.n(E),A=r(26171),I=r(26881),P=r(23513),T=r.n(P),x=r(54847),R=r.n(x),$=r(89221),L=r.n($),M=r(99595),N=r.n(M),F=r(35820),G=r.n(F),O=r(88946),z=r.n(O),j=r(8244),U=r.n(j),B=r(10349),H=r.n(B),K=r(53706),V=r.n(K),W=r(76555),Z=r.n(W),q=r(86981),Q=r.n(q),Y=r(99560),X=r.n(Y),J=r(6767),ee=r.n(J),te=r(82617),re=r(56777),ie=(r(21695),r(8937)),ne=r(54840),ae=r(29704);function ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=_()(i).call(i,(function(t){return w()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?N()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,A.Z)(e,t,n[t])})):D()?S()(e,D()(n)):N()(i=ownKeys(Object(n))).call(i,(function(t){o()(e,t,w()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;N()(r=["method","field"]).call(r,(function(r){N()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;N()(r=["method","field"]).call(r,(function(r){N()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(N()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),N()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return z()(t=(0,I.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:z()(e).call(e,this.fromElementDescriptor,this)};return o()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const oe=["id","summary","backgroundColor","timeZone","primary","accessRole","hidden","deleted","defaultReminders"],se=["emailAddresses","names","photos"].join(),le={[ie.FK.AccountAdding]:ie.FK.AccountAdded,[ie.FK.AccountDeleting]:ie.FK.AccountDeleted,[ie.FK.CalendarsChanging]:ie.FK.CalendarsChanged};let ce=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=Q()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(z()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,ae.SG)(["$injector","$rootScope","$log","$timeout","$window","$translate","appCommonSrv","dialogSrv","notificationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class GoogleIntegrationService{constructor(t,r,i,n,a,o,s,l,c,d,u,h,p,v){e(this),this._$injector=t,this._$rootScope=r,this._$log=i,this._$timeout=n,this._$window=a,this._$translate=o,this._appCommonSrv=s,this._dialogSrv=l,this._notificationSrv=c,this._planywayIntegrationSrv=d,this._platformSrv=u,this._settingsSrv=h,this._telemetrySrv=p,this._collectionSrv=v,this._initializedAccounts=new(T());const onSourceChanged=async(e,t)=>{if(t&&t.accountType!==te.Qm.Google)return;switch(e.name){case ie.FK.AccountAdding:await this._addGoogleAccountAsync(t.accountId);break;case ie.FK.AccountDeleting:this._removeGoogleAccount(t.accountId)}let r=le[e.name];r&&this._$rootScope.$broadcast(r,t)};this._$rootScope.$on(ie.FK.AccountAdding,onSourceChanged),this._$rootScope.$on(ie.FK.AccountDeleting,onSourceChanged),this._$rootScope.$on(ie.FK.CalendarsChanging,onSourceChanged)}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"googleIntegrationSrv"}},{kind:"field",key:"_provider",value:()=>(0,re.VH)(ie.lP.Google)},{kind:"field",key:"_cache",value:()=>new(R())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_isIntegrationBusy",value:()=>!1},{kind:"field",key:"_googleCalendarsListeners",value:()=>({added:new(T()),updated:new(T()),deleted:new(T()),cleared:new(T())})},{kind:"get",key:"_googleCardsSrv",value:function _googleCardsSrv(){return this._googleCardsSrvLazy||(this._googleCardsSrvLazy=this._$injector.get("googleCardsSrv")),this._googleCardsSrvLazy}},{kind:"method",key:"isIntegrationBusy",value:function isIntegrationBusy(){return this._isIntegrationBusy}},{kind:"method",key:"reconnectAccountAsync",value:async function reconnectAccountAsync(e){this._telemetrySrv.logSessionEvent(ie.cN.CollectionEvents.CollectionAddAccountDialogOpened,{where:ie.Zz.SidebarReconnectAccount});let t=await this._dialogSrv.showAddAccountDialogAsync({account:e});t?t.accountId===e.accountId?this._telemetrySrv.logSessionEvent(ie.cN.GeneralEvents.AccountReconnected,{accountType:t.accountType}):this._telemetrySrv.logSessionEvent(ie.cN.GeneralEvents.AccountConnected,{accountType:t.accountType}):this._telemetrySrv.logSessionEvent(ie.cN.CollectionEvents.CollectionAddAccountDialogClosed,{where:ie.Zz.SidebarReconnectAccount})}},{kind:"method",key:"refreshAccessTokenAsync",value:async function refreshAccessTokenAsync(e){let t=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!t)return;let r=await this._planywayIntegrationSrv.refreshAccountAsync({accountId:e,accountType:te.Qm.Google});if(r)return r.accountName=t.accountName,r.accountEmail=t.accountEmail,this._provider.invalidAccountIds.has(e)&&this._$rootScope.$evalAsync((()=>this._provider.invalidAccountIds.delete(e))),r;this._platformSrv.isOffline()||this._$rootScope.$evalAsync((()=>this._provider.invalidAccountIds.add(e)))}},{kind:"method",key:"listAsync",value:async function listAsync(e,t,r,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{syncToken:a,minDate:o,maxDate:s,maxRetryCount:l=3}=n;try{let n=[],c=null;do{let d=await this.restAsync(e,ie.Tu.Get,ie.KN.Calendar,t,r,{syncToken:a,timeMin:null==o?void 0:o.toISOString(),timeMax:null==s?void 0:s.toISOString(),pageToken:c,showDeleted:!0,fields:i?`items(${i.join()}),nextPageToken,nextSyncToken`:void 0},l);if(d.nextPageToken&&d.nextPageToken===c)throw new Error("List Google request failed! Duplicated next page token");if(n.push(...d.items),c=d.nextPageToken,d.nextSyncToken)return{items:n,nextSyncToken:d.nextSyncToken}}while(c)}catch(n){if(410===n.status)return this._$log.warn("List Google request sync token is no longer valid, a full sync is required"),this.listAsync(e,t,r,i,{maxRetryCount:l});throw n}}},{kind:"method",key:"getRestPromises",value:function getRestPromises(e){if(!this._initializedAccounts.has(e))return new(T());return this._cache.get(e).restPromises}},{kind:"method",key:"restAsync",value:async function restAsync(e,t,r,i,n,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,s={token:await this._getAccessTokenAsync(e),maxRetryCount:o};try{switch(t){case ie.Tu.Get:case ie.Tu.Delete:s.query=a;break;default:s.body=a}return await this._restAsync(e,t,r+i,n,s)}catch(a){if(401===a.status||!a.status){let a=await this.refreshAccessTokenAsync(e);if(a)return s.token=a.googleCredentials.accessToken,this._restAsync(e,t,r+i,n,s)}throw a}}},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){try{var t,r;this._appCommonSrv.setSchedulerBusy(!0),this._initializedCollectionId=null,this._initializedAccounts.clear();for(let e of L()(i=this._cache).call(i)){var i;e.destroy()}this._cache.clear(),N()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>this._resetAccountCache(e))),await G().all(z()(r=this._provider.getCurrentCollectionConnectedAccountIds()).call(r,(async t=>{await this._initGoogleConnectAsync(t,e)}))),this._initializedCollectionId=this._currentCollectionId,this._googleCardsSrv.initCurrentCollectionAsync(e)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"isCurrentCollectionAccountReady",value:function isCurrentCollectionAccountReady(e){var t;return!!this._initializedAccounts.has(e)&&U()(t=this._provider.getCurrentCollectionSelectedCalendarIds(e)).call(t,(t=>this.getGoogleCalendarById(e,t)))}},{kind:"method",key:"getGoogleUserAsync",value:async function getGoogleUserAsync(e){let t=await this._getGoogleUserDataAsync(e);return this._fromGoogleUser(e,t)}},{kind:"method",key:"getGoogleUser",value:function getGoogleUser(e){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).user}},{kind:"method",key:"getGoogleContacts",value:function getGoogleContacts(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return H()(L()(t=r.contacts).call(t))}},{kind:"method",key:"getGoogleContactByEmail",value:function getGoogleContactByEmail(e,t){if(!this._initializedAccounts.has(e))return;const r=this._cache.get(e);return r.user.email===t?r.user:r.contacts.get(t)}},{kind:"method",key:"getFakeContact",value:function getFakeContact(e){return this._fromGoogleUser(void 0,{resourceName:`fakeContact/${e}`,emailAddresses:[{value:e}]})}},{kind:"method",key:"getGoogleCalendars",value:function getGoogleCalendars(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return L()(t=r.calendars).call(t)}},{kind:"method",key:"getGoogleCalendarById",value:function getGoogleCalendarById(e,t){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).calendars.get(t)}},{kind:"method",key:"isConnectedGoogleCalendarBusy",value:function isConnectedGoogleCalendarBusy(e,t){return this._googleCardsSrv.isGoogleCalendarBusy(e,t)}},{kind:"method",key:"addGoogleCalendarEventListener",value:function addGoogleCalendarEventListener(e,t){let r=this._googleCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeGoogleCalendarEventListener",value:function removeGoogleCalendarEventListener(e,t){let r=this._googleCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"field",key:"_handleCalendarEvent",value(){var e=this;return function(t){var r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:n,silent:a}=i;if(a)return;if(N()(r=e._googleCalendarsListeners[n]).call(r,(e=>e(t,i))),"cleared"===n)return void e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars});const o=t.accountId;if(e._provider.getCurrentCollectionConnectedCalendar(o,t.id).isSelected){switch(n){case"added":case"updated":case"deleted":e.isCurrentCollectionAccountReady(o)&&e._$rootScope.$broadcast(ie.FK.CollectionAccountReady,{accountId:o})}switch(n){case"updated":t.name!==i.oldValue.name&&e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars});break;case"deleted":e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars})}}}}},{kind:"method",key:"_getGoogleUserDataAsync",value:function _getGoogleUserDataAsync(e){return this.restAsync(e,ie.Tu.Get,ie.KN.User,"/userinfo","Get Google user info")}},{kind:"method",key:"_getContactsAsync",value:async function _getContactsAsync(e){try{let r=[],i=null;do{var t;let n=await this.restAsync(e,ie.Tu.Get,ie.KN.People,"/people/me/connections","Get Google User Contacts",{pageToken:i,personFields:se});if(n.nextPageToken&&n.nextPageToken===i)throw new Error("List Google Contacts request failed! Duplicated next page token");null!==(t=n.connections)&&void 0!==t&&t.length&&r.push(...n.connections),i=n.nextPageToken}while(i);return V()(r).call(r,((t,r)=>{let i=this._fromGoogleUser(e,r);return i.email&&t.push(i),t}),[])}catch(e){if(403===e.status)return[];throw e}}},{kind:"method",key:"_setIntegrationBusy",value:function _setIntegrationBusy(e){this._$rootScope.$evalAsync((()=>this._isIntegrationBusy=e))}},{kind:"method",key:"_resetAccountCache",value:function _resetAccountCache(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy();const r={restPromises:new(T()),calendars:new ne.v("id"),styleElements:new(R()),contacts:new(R()),destroy:()=>{r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout),r.calendars.clear();for(let e in this._googleCalendarsListeners)r.calendars.removeEventListener(e,this._handleCalendarEvent)}};this._cache.set(e,r);for(let e in this._googleCalendarsListeners)r.calendars.addEventListener(e,this._handleCalendarEvent)}},{kind:"method",key:"_addGoogleAccountAsync",value:async function _addGoogleAccountAsync(e){try{this._appCommonSrv.setSchedulerBusy(!0),this._initializedCollectionId=null,this._initializedAccounts.delete(e),this._provider.invalidAccountIds.delete(e),this._resetAccountCache(e),await this._initGoogleConnectAsync(e),this._initializedCollectionId=this._currentCollectionId,this._googleCardsSrv.addGoogleAccountAsync(e)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_removeGoogleAccount",value:function _removeGoogleAccount(e){var t;this._initializedAccounts.delete(e),null===(t=this._cache.get(e))||void 0===t||t.destroy(),this._cache.delete(e),this._googleCardsSrv.removeGoogleAccount(e)}},{kind:"method",key:"_initGoogleConnectAsync",value:async function _initGoogleConnectAsync(e,t){if(t=t||this._appCommonSrv.getCancellationToken(`initGoogleConnect_${e}`),!this._currentCollectionId)return;if(this._initializedAccounts.has(e))return;await this._platformSrv.waitOnlineAsync();const r=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!r)return;const i=this._cache.get(e);try{this._setIntegrationBusy(!0);let n=await this._getAccessTokenAsync(e);if(t.isCanceled())return;if(!n)return this._initializedAccounts.add(e),void this._setIntegrationBusy(!1);let[a,o]=await G().all([this._getGoogleUserDataAsync(e),this._getContactsAsync(e)]);i.user=this._fromGoogleUser(e,a),r.accountName=i.user.fullName,r.accountEmail=i.user.email,i.contacts=new(R())(z()(o).call(o,(e=>[e.email,e])));let s=await this._getGoogleCalendarsAsync(e);if(t.isCanceled())return;this._initializedAccounts.add(e),this._setIntegrationBusy(!1);for(let t of s)t.isDeleted||(i.calendars.add(t),this._setupGoogleCalendarStyle(e,t));i.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(i.calendarsUpdatesPollingTimeout);const pollGoogleCalendarsAsync=async()=>{await this._platformSrv.waitOnlineAsync();try{await this._pollGoogleCalendarsAsync(e)}catch(e){this._$log.error("Planyway poll Google calendars error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway poll Google calendars error",e,{class:this.constructor.name,method:this._pollGoogleCalendarsAsync.name})}i.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollGoogleCalendarsAsync()),6e4,!1)};i.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollGoogleCalendarsAsync()),6e4,0,!1)}catch(t){this._initializedAccounts.add(e),this._setIntegrationBusy(!1),this._$log.error("Google load data error:"),this._$log.error(t),this._telemetrySrv.logError("Google load data error",t,{class:this.constructor.name,method:this._initGoogleConnectAsync.name}),this._planywayIntegrationSrv.getPrimaryAccount().accountId===e?await this._planywayIntegrationSrv.signOutAsync():(this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.LOAD_GOOGLE_DATA_ERROR"),ie.k$.Error),this._platformSrv.isOffline()||this._provider.invalidAccountIds.add(e))}}},{kind:"method",key:"_pollGoogleCalendarsAsync",value:async function _pollGoogleCalendarsAsync(e){if(this._provider.invalidAccountIds.has(e))return;const t=this._appCommonSrv.getCancellationToken(`pollGoogleCalendars_${e}`);let r=await this._getGoogleCalendarsAsync(e,!0);if(t.isCanceled())return;if(0===r.length)return;const i=this._cache.get(e);let n=new(R());for(let e of L()(a=i.calendars).call(a)){var a;n.set(e.id,e)}let o=new(R()),s=!1;for(let e of r){o.set(e.id,e);let t=n.get(e.id);e.isDeleted?t&&(i.calendars.delete(e),s=!0):t?t.name===e.name&&(0,ae.h0)(t.color,e.color)&&t.timeZone===e.timeZone&&t.isReadOnly===e.isReadOnly||(i.calendars.update(e),s=!0):(i.calendars.add(e),s=!0)}s&&this._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars})}},{kind:"method",key:"_getGoogleCalendarsAsync",value:async function _getGoogleCalendarsAsync(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._cache.get(e);try{var i;let{items:n,nextSyncToken:a}=await this.listAsync(e,"/users/me/calendarList","Get Google calendars",oe,{syncToken:t?r.calendarsSyncToken:void 0});return r.calendarsSyncToken=a,Z()(i=z()(n).call(n,(t=>{var i,n;let a="owner"!==t.accessRole&&"writer"!==t.accessRole;return{id:t.id,shortId:X()(t.id),accountId:e,name:getGoogleCalendarName(t,r.user),color:getGoogleColor(t.backgroundColor),timeZone:t.timeZone,isPrimary:null!==(i=t.primary)&&void 0!==i&&i,isReadOnly:a,isDeleted:t.hidden||t.deleted,defaultReminders:null!==(n=t.defaultReminders)&&void 0!==n?n:[]}}))).call(i,((e,t)=>e.isPrimary?-1:t.isPrimary?1:(0,ae.A5)(e.name,t.name)||(0,ae.A5)(e.id,t.id)))}catch(t){return this._platformSrv.isOffline()||this._provider.invalidAccountIds.add(e),this._$log.error("Planyway get Google calendars error:"),this._$log.error(t),[]}}},{kind:"method",key:"_getAccessTokenAsync",value:async function _getAccessTokenAsync(e){let t=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!t)return;if(t.googleCredentials.accessToken&&new Date(t.googleCredentials.expirationDate)>new Date)return t.googleCredentials.accessToken;let r=await this.refreshAccessTokenAsync(e);return r?r.googleCredentials.accessToken:void 0}},{kind:"method",key:"_setupGoogleCalendarStyle",value:function _setupGoogleCalendarStyle(e,t){const r=this._cache.get(e);let i=r.styleElements.get(t.shortId);i||(i=this._$window.document.createElement("style"),i.setAttribute("type","text/css"),this._$window.document.head.appendChild(i),r.styleElements.set(t.shortId,i)),i.innerHTML=this._provider.getCalendarExtraCardStyle(t)}},{kind:"method",key:"_fromGoogleUser",value:function _fromGoogleUser(e,t){let r,i,n,a,o;if("resourceName"in t){let e=this._getPrimaryGoogleFieldValue(t,"emailAddresses");if(e){var s,l,c;let d=this._getPrimaryGoogleFieldValue(t,"names"),u=this._getPrimaryGoogleFieldValue(t,"photos");r=e.value,i=e.value,n=null==d?void 0:d.displayName,a=d?(0,ae.Oo)(`${(null==d||null===(s=d.givenName)||void 0===s?void 0:s.substring(0,1))||""}${(null==d||null===(l=d.familyName)||void 0===l?void 0:l.substring(0,1))||""}`):(0,ae.Oo)((null==e||null===(c=e.value)||void 0===c?void 0:c.substring(0,1))||""),o=null==u?void 0:u.url}}else{var d,u,h;r=t.email,i=t.email,n=t.name,a=t.given_name||t.family_name?(0,ae.Oo)(`${(null===(d=t.given_name)||void 0===d?void 0:d.substring(0,1))||""}${(null===(u=t.family_name)||void 0===u?void 0:u.substring(0,1))||""}`):(0,ae.Oo)((null===(h=t.email)||void 0===h?void 0:h.substring(0,1))||""),o=t.picture}return{id:r,accountId:e,email:i,fullName:n,initials:a,avatarUrl:o}}},{kind:"method",key:"_getPrimaryGoogleFieldValue",value:function _getPrimaryGoogleFieldValue(e,t){let r=e[t];if(!r||!r.length)return;let i=Q()(r).call(r,(e=>{var t;return null===(t=e.metadata)||void 0===t?void 0:t.primary}));return i||(i=r[0]),i}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,r,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=this._cache.get(e);let o,s,l=this._telemetrySrv.logRequest(i,t,r,_objectSpread(_objectSpread({},n.query),n.body)),c=200;try{return s=this._platformSrv.restAsync(t,r,n),a&&a.restPromises.add(s),await s}catch(e){throw c=e.status,o=e.response,e}finally{this._telemetrySrv.logRequestEnd(l,c,o),a&&a.restPromises.delete(s)}}}]}}));function getGoogleCalendarName(e,t){var r;return e.id!==e.summary||e.id!==(null==t?void 0:t.email)?e.summary:null!==(r=null==t?void 0:t.fullName)&&void 0!==r?r:e.summary}function getGoogleColor(e){if(!e)return{};let t=ee()(e),r=t.mix(ee()("#ffffff"),.9);return{base:t.darken(.2).hex(),light:r.darken(.1).hex(),dark:r.darken(.8).hex(),highlight:r.darken(.2).hex(),controlHover:r.darken(.05).hex()}}},32513:(e,t,r)=>{r.d(t,{Z:()=>Provider});var i=r(52020),n=r.n(i),a=r(88546),o=r.n(a),s=r(99595),l=r.n(s),c=r(66775),d=r.n(c),u=r(2201),h=r.n(u),p=r(57445),v=r.n(p),m=r(26171),f=r(73324),C=r.n(f),y=r(62079),g=r.n(y),_=r(88946),k=r.n(_),w=r(35820),b=r.n(w),D=r(87994),E=r.n(D),S=r(91829),A=r.n(S),I=r(76555),P=r.n(I),T=r(82617),x=r(8937),R=r(20115),$=r(29704),L=r(15985),M=r(33001);const N='\n# if (!hiddenElements.calendar) { #\n# var calendarName = cardProvider.getCardCalendarName(data) #\n# if (calendarName) { #\n<div class="pw-card__calendar">\n    #: calendarName #\n</div>\n# } #\n# } #\n',F=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    <div class="pw-card__details">\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n\n        ${N}\n    </div>\n</div>\n`,G=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n# if (data.timeShortText) { #\n<span class="pw-card__time pw-card__time-short pw-js-card-time-short">#: data.timeShortText #</span>\n# } #\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    # if (!hiddenElements.calendar || !hiddenElements.dates) { #\n    <div class="pw-card__details">\n        # if (!hiddenElements.dates && data.timeDateText) { #\n        <span class="pw-card__time pw-js-card-time-date">#: data.timeDateText #</span>\n        # } else { #\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n        # } #\n\n        ${N}\n    </div>\n    # } #\n</div>\n`,O={hourSlot:kendo.template(F,{useWithBlock:!1}),daySlot:kendo.template(G,{useWithBlock:!1})};function getCalendarIconTemplate(e,t){return`\n        <pw-ical-calendar-icon\n            account-id="${e}"\n            calendar-id="${t}"\n            icon-size="small"\n        ></pw-ical-calendar-icon>\n    `}var z=r(84705);const j=r.n(z)()('\n<div\n    class="\n        pw-calendar-icon pw-calendar-icon--ical-calendar\n        pw-calendar-icon--ical-calendar_normal\n        pw-calendar-icon--ical-calendar_#= data.resourceData.calendarColor #\n        pw-calendar-icon--ical-calendar_#= data.resourceData.iCalCalendarType #\n        mdi mdi-calendar\n    "\n>\n</div>\n').call('\n<div\n    class="\n        pw-calendar-icon pw-calendar-icon--ical-calendar\n        pw-calendar-icon--ical-calendar_normal\n        pw-calendar-icon--ical-calendar_#= data.resourceData.calendarColor #\n        pw-calendar-icon--ical-calendar_#= data.resourceData.iCalCalendarType #\n        mdi mdi-calendar\n    "\n>\n</div>\n'),U={resourceIcon:kendo.template(j,{useWithBlock:!1})};var B=r(77447),H=r.n(B);function ownKeys(e,t){var r=g()(e);if(n()){var i=n()(e);t&&(i=C()(i).call(i,(function(t){return o()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?l()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,m.Z)(e,t,n[t])})):d()?h()(e,d()(n)):l()(i=ownKeys(Object(n))).call(i,(function(t){v()(e,t,o()(n,t))}))}return e}class Provider extends L.Z{get type(){return x.lP.ICal}get integrationService(){return this._iCalIntegrationSrv}get cardsService(){return this._iCalCardsSrv}static get sortOrder(){return[]}initializeAsync(e){return this._iCalIntegrationSrv.initCurrentCollectionAsync(e)}getCardTemplates(){return O}getCalendarExtraCardStyle(e){return""}getCardTooltipConfig(){return{templateUrl:H(),controllerName:"iCalEventTooltipCtrl"}}getCardTemplateData(e){return{isReadOnly:e.isReadOnly,cardType:e.cardType,cardRole:e.cardRole,title:e.title,isAllDay:e.isAllDay,start:e.start,realStart:e.realStart,end:e.end,realEnd:e.realEnd}}getCardEditorHtml(){return'\n            <pw-ical-event-editor\n                class="pw-dialog-edit-card__editor"\n                calendar-card="$ctrl.calendarCard"\n                is-detailed="$ctrl.isDetailed"\n                is-dense="$ctrl.isDense"\n                has-changes="$ctrl.hasChanges"\n            ></pw-ical-event-editor>\n        '}getCardContextMenuHtml(){return'\n            <pw-ical-card-context-menu\n                source="$ctrl.source"\n                on-set-context-menu="$ctrl.onSetContextMenu"\n            ></pw-ical-card-context-menu>\n        '}getWorkPanelHtml(){}isWorkPanelAvailable(){return!1}getCalendarsPickerHtml(){}getCardId(e){return(0,M.z)(e.iCalEvent.id)}getCalendarCardClass(){return M.f}isMilestonesSupported(){return!1}get _iCalIntegrationSrv(){return this._iCalIntegrationSrvLazy||(this._iCalIntegrationSrvLazy=this._$injector.get("iCalIntegrationSrv")),this._iCalIntegrationSrvLazy}get _iCalCardsSrv(){return this._iCalCardsSrvLazy||(this._iCalCardsSrvLazy=this._$injector.get("iCalCardsSrv")),this._iCalCardsSrvLazy}get accountType(){return T.Qm.ICal}getAccountName(){}getAccountEmail(){}getAccountUser(){}getAccountUserAsync(e){return this._iCalIntegrationSrv.getICalUser(e)}getCurrentCollectionConnectedCalendarIds(e){var t;let r=(0,$.Bn)(this._collectionSettings.global.settings.calendar,[e]);return C()(t=g()(r)).call(t,(e=>r[e].isConnected))}getCurrentCollectionConnectedCalendar(e,t){let r=this.integrationService.getICalCalendarById(e,t),i=this._collectionSettings.global.settings.calendar[t];return r&&i?_objectSpread({calendarId:t},i):{accountType:T.Qm.ICal,calendarId:t,isConnected:!1,isSelected:!1}}getCurrentCollectionConnectedCalendars(e){var t,r;let i=(0,$.Bn)(this._collectionSettings.global.settings.calendar,[e]);return k()(t=C()(r=g()(i)).call(r,(e=>i[e].isConnected))).call(t,(e=>_objectSpread({calendarId:e},i[e])))}canCreateCard(){return!1}isTimeTrackingAvailable(){}getMainToolbarRightHtml(){}getMainToolbarFiltersMenuHtml(){}getSchedulerToolbarViewSettingsMenuHtml(){}getSupportedSchedulerModes(){return[{get value(){return x.ud.Calendar},set value(e){},title:this._$translate.instant("BUTTONS.CALENDAR")},{get value(){return x.ud.Timeline},set value(e){},title:this._$translate.instant("BUTTONS.TIMELINE")}]}getSupportedTimelineViews(){return[{value:x.tS.Board,icon:"icons-16:timeline-calendars-outline",title:this._$translate.instant("MENU.CALENDARS")},{value:x.tS.None,icon:"icons-16:timeline-no-grouping-outline",title:this._$translate.instant("MENU.NO_GROUPING")}]}getViewSettingsMenuFieldItems(){const e=this;return[{group:"dates",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_DATES"),get state(){return e._collectionSettings.global.settings.showDates},set state(t){e._collectionSettings.global.settings.showDates=t,e._$rootScope.$broadcast(x.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(x.cN.SettingsEvents.ShowDatesChanged)},get isAvailable(){switch(e._appCommonSrv.getSchedulerView()){case x.rW.Month:case x.rW.Timeline:return!0;default:return!1}}},{group:"calendar",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_CALENDAR"),get state(){return e._collectionSettings.global.settings.showCalendar},set state(t){e._collectionSettings.global.settings.showCalendar=t,e._$rootScope.$broadcast(x.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(x.cN.SettingsEvents.ShowCalendarChanged)},get isAvailable(){return!0}}]}addTimeRecordManuallyAsync(){return!1}getTimerParentCardByIdAsync(){}createTimeRecordCardByTimerAsync(){return b().resolve(!1)}static getSidebarPanelHtml(){return'\n            <pw-ical-sidebar-panel\n                class="pw-provider-sidebar-panel"\n            ></pw-ical-sidebar-panel>'}async addAccountToCurrentCollectionAsync(e){this._collectionSettings.global.settings.calendar[e.accountId]={accountType:T.Qm.ICal,isConnected:!0,isSelected:!0},this._userSettings.global.settings.collection[this._currentCollectionId].account[e.accountId]=[e.accountId],await b().all([this._userSettings.global.saveAsync(),this._collectionSettings.global.saveAsync()]),this._$rootScope.$broadcast(x.FK.AccountAdding,e)}getNewCardObjectProviderCard(){}getTimelineResourceTemplates(){return U}getTimelineResourcesByType(e,t){var r;let i=[];if(!this._iCalIntegrationSrv.isCurrentCollectionInitialized)return i;const n=this._collectionSettings.global.settings.timelineHiddenResources[t],a=E()(r=this.getCurrentCollectionConnectedAccountIds()).call(r,(e=>{let t=this.getCurrentCollectionSelectedCalendarIds(e);return k()(t).call(t,(t=>this._iCalIntegrationSrv.getICalCalendarById(e,t)))}));if(t===x.y.Calendars)for(let r of a)i.push({id:r.id,accountTypes:[T.Qm.ICal],accountIds:[r.accountId],calendarIds:[r.id],type:t,getProvider:()=>this,name:r.name,isSelected:!A()(n).call(n,r.id),resourceData:{calendarType:x.kK.ICalCalendar,calendarColor:r.color,iCalCalendarType:r.type},iconHtml:getCalendarIconTemplate(e,r.id)});return P()(i).call(i,((e,t)=>(0,$.A5)(e.name,t.name)||(0,$.A5)(e.id,t.id)))}getTimelineResourcesMenuByType(e,t){return t===x.y.Calendars?{title:this._$translate.instant("BUTTONS.CALENDARS"),description:this._iCalIntegrationSrv.getICalUser(e).fullName,icon:"icons-16:calendar-outline",showAll:{text:this._$translate.instant("MENU.SHOW_ALL_CALENDARS"),icon:"icons-16:timeline-all-calendars-outline"},showNone:{text:this._$translate.instant("MENU.SHOW_NONE_CALENDARS"),icon:"icons-16:timeline-calendars-outline"}}:{}}expandTimelineResources(e,t){let r=t.field,i=t.defaultFieldValue;if(e.cardRole===T.D.Card){if(t.name===x.y.NoResources)return[R.xp];{let n=(0,$._M)(e,r,i);return t.multiple?n:[n]}}}updateProviderCardDataByTimelineResource(){}isEventDataUpdated(){return!1}isOwnCalendarCard(){return!1}isCardContextMenuAvailable(e){return!e.isTempCard}isCardResizeAvailable(){return!1}isCardSatisfiesSchedulerFilters(e){return this._appCommonSrv.getSchedulerMode(!0)!==x.ud.TimeTracking&&this._calendarCardsSrv.isCalendarCardVisible(e)}canModifyInScheduler(){return!1}canStartMoveInScheduler(){return!1}canEndMoveInScheduler(){return!0}canResizeInScheduler(){return!1}canUpdateInScheduler(){return!1}canSortInScheduler(){return!1}getMovedEvent(){}getCardExtraClasses(e){let t=[],r=this._iCalIntegrationSrv.getICalCalendarById(e.accountId,e.providerCard.iCalCalendarId);return r&&(t.push("pw-card--ical"),t.push(`pw-card--ical_${r.type}`),t.push(`pw-card--ical_${r.color}`)),t}getHiddenCardElements(){switch(this._appCommonSrv.getSchedulerView(!0)){case x.rW.OneDay:case x.rW.ThreeDay:case x.rW.Week:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!0};case x.rW.Month:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case x.rW.Timeline:switch(this._appCommonSrv.getTimelineResourcesType(!0)){case x.y.NoResources:case x.y.Calendars:case x.y.Lists:case x.y.Labels:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case x.y.Members:return{membersIcon:!0,calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates}}}}getCardMemberBackground(){}getCardCalendarName(e){var t;return null===(t=this._iCalIntegrationSrv.getICalCalendarById(e.accountId,e.providerCard.iCalCalendarId))||void 0===t?void 0:t.name}getCardLinks(){return[]}getDragInfo(){return{canDrag:!1,allowedCardTypes:[]}}getDraggingCard(){}getDraggedCardUpdateData(){}getPreviewCard(){}updateCardByMouseAsync(){}getUpdateByMouseTelemetry(){}createCardByExternalCall(){}createCardByClick(){}createCardByDropAsync(){}createTimeRecordCardByClick(){}createTimeRecordCardByDropAsync(){}getCardTimeDurationText(){}getTotalCardsTimeDurationInDay(){return 0}hasEstimation(){return!1}hasTrackedTime(){return!1}isHotkeyAvailable(){return!1}updateCardsByHotkey(){}deleteCardsAsync(){}logCardEvent(e,t){var r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._telemetrySrv.logSessionEvent(t,_objectSpread({accountId:e.accountId,calendarId:e.calendarId,isAllDay:e.isAllDay,start:e.realStart||e.start,end:e.realEnd||e.end,cardType:e.cardType,cardRole:e.cardRole,isNewCard:null!==(r=e.isTempCard)&&void 0!==r&&r,recurrenceRule:e.recurrenceHeadRule||e.recurrenceRule},i))}}},7257:(e,t,r)=>{r.d(t,{u:()=>PwICalEditDialogContainer});var i=r(62079),n=r.n(i),a=r(52020),o=r.n(a),s=r(73324),l=r.n(s),c=r(88546),d=r.n(c),u=r(99595),h=r.n(u),p=r(66775),v=r.n(p),m=r(2201),f=r.n(m),C=r(57445),y=r.n(C),g=r(26171),_=r(88946),k=r.n(_),w=r(67294),b=r(67558),D=r(2734),E=r(59708),S=r(23972),A=r(6327),I=r(8937),P=r(32248),T=r(61252),x=r(85893);const PreviewCard=e=>{let{calendar:t,color:r}=e;const{t:i}=(0,b.$)(),{palette:n,transitions:a}=(0,D.Z)(),{light:o,dark:s}=n.iCals.getColorComponents(r);return(0,x.jsxs)(E.Z,{sx:{height:"35px",borderRadius:"3px",padding:"4px 6px 1px",backgroundColor:o,transition:a.create("background-color")},children:[(0,x.jsx)(S.Z,{sx:{color:s,fontSize:"13px",fontWeight:500,lineHeight:"16px"},children:i("DIALOGS.ICAL_EDIT_PREVIEW_CARD_TEXT")}),(0,x.jsx)(S.Z,{sx:{color:s,fontSize:"12px",lineHeight:"16px",marginTop:"3px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})]})},PwICalEditDialog=e=>{let{calendar:t,onEditCalendar:r,open:i,onClose:n}=e;const{t:a}=(0,b.$)(),{palette:o}=(0,D.Z)(),{logSessionEvent:s}=(0,A.f)(),[l,c]=(0,w.useState)(t.color),d=(0,w.useMemo)((()=>{var e;return k()(e=o.iCals.getColorList()).call(e,(e=>({color:e,value:o.iCals.getColorComponents(e).base})))}),[o]),u=[{isDangerous:!1,isPrimary:!1,text:a("BUTTONS.CANCEL"),onClick:n},{isDangerous:!1,isPrimary:!0,text:a("BUTTONS.SAVE"),onClick:()=>{t.color!==l&&(s(I.cN.CalendarEvents.ICalColorChanged,{oldColor:t.color,newColor:l}),r({color:l})),n()}}];return(0,x.jsx)(T.X,{actionButtons:u,disableRestoreFocus:!0,open:i,title:a("DIALOGS.ICAL_EDIT_CHOOSE_COLOR"),onClose:n,children:(0,x.jsxs)(E.Z,{gap:2,sx:{width:"220px",margin:"auto"},children:[(0,x.jsx)(PreviewCard,{calendar:t,color:l}),(0,x.jsx)(P.j,{colors:d,selectedColor:l,onChange:e=>c(e)})]})})};function ownKeys(e,t){var r=n()(e);if(o()){var i=o()(e);t&&(i=l()(i).call(i,(function(t){return d()(e,t).enumerable}))),r.push.apply(r,i)}return r}const PwICalEditDialogContainer=e=>{let{iCalIntegrationSrv:t,calendar:r,open:i,onClose:n}=e;return(0,x.jsx)(PwICalEditDialog,{calendar:r,open:i,onClose:n,onEditCalendar:e=>{t.updateICalCalendarProperties(r.accountId,r.id,function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?h()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,g.Z)(e,t,n[t])})):v()?f()(e,v()(n)):h()(i=ownKeys(Object(n))).call(i,(function(t){y()(e,t,d()(n,t))}))}return e}({},e))}})};PwICalEditDialogContainer.injections=["iCalIntegrationSrv"]},33001:(e,t,r)=>{r.d(t,{f:()=>A,z:()=>getICalCardId});var i=r(40024),n=r.n(i),a=r(99595),o=r.n(a),s=r(57445),l=r.n(s),c=r(51791),d=r.n(c),u=r(90143),h=r.n(u),p=r(56626),v=r.n(p),m=r(67552),f=r.n(m),C=r(86981),y=r.n(C),g=r(26881),_=r(88946),k=r.n(_),w=r(45181),b=r.n(w),D=(r(58218),r(82617)),E=r(20115),S=r(29704);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}l()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(o()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),o()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==d()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];h()(o).call(o,d()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(s)||s);e=l.element,this.addElementPlacement(e,t),l.finisher&&i.push(l.finisher);var c=l.extras;if(c){for(var u=0;u<c.length;u++)this.addElementPlacement(c[u],t);r.push.apply(r,c)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,v(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return k()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:k()(e).call(e,this.fromElementDescriptor,this)};return l()(t,v(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let A=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=y()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(k()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}(null,(function(e){class CalendarCard{constructor(t,r,i){e(this),this._id=t,this._accountId=r,this._cardType=i}}return{F:CalendarCard,d:[{kind:"get",key:"id",value:function id(){return this._id}},{kind:"get",key:"accountId",value:function accountId(){return this._accountId}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e}},{kind:"get",key:"calendarId",value:function calendarId(){return this.iCalCalendarId}},{kind:"get",key:"cardType",value:function cardType(){return this._cardType}},{kind:"set",key:"cardType",value:function cardType(e){this._cardType=e}},{kind:"get",key:"cardRole",value:function cardRole(){return D.D.Card}},{kind:"set",key:"cardRole",value:function cardRole(e){}},{kind:"get",key:"title",value:function title(){return this._title||""}},{kind:"set",key:"title",value:function title(e){this._title=e}},{kind:"get",key:"description",value:function description(){return this._description||""}},{kind:"set",key:"description",value:function description(e){this._description=e}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this._isAllDay=e}},{kind:"get",key:"start",value:function start(){return this._start}},{kind:"set",key:"start",value:function start(e){this._start=e?new Date(e):void 0,this._previousStart=this._start}},{kind:"get",key:"previousStart",value:function previousStart(){return this._previousStart}},{kind:"get",key:"end",value:function end(){return this._end}},{kind:"set",key:"end",value:function end(e){this._end=e?new Date(e):void 0,this._previousEnd=this._end}},{kind:"get",key:"previousEnd",value:function previousEnd(){return this._previousEnd}},{kind:"get",key:"hasDates",value:function hasDates(){return(0,S.qb)(this.start)&&(0,S.qb)(this.end)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this._recurrenceRule=e}},{kind:"get",key:"recurrenceException",value:function recurrenceException(){return this._recurrenceException}},{kind:"set",key:"recurrenceException",value:function recurrenceException(e){this._recurrenceException=e}},{kind:"get",key:"exceptionDates",value:function exceptionDates(){return this._exceptionDates||[]}},{kind:"set",key:"exceptionDates",value:function exceptionDates(e){var t;this._exceptionDates=e||[],this._recurrenceException=this._exceptionDates.length>0?k()(t=this._exceptionDates).call(t,S.wd).join():void 0}},{kind:"get",key:"recurrenceId",value:function recurrenceId(){return this._recurrenceId}},{kind:"set",key:"recurrenceId",value:function recurrenceId(e){this._recurrenceId=e}},{kind:"get",key:"exceptionDate",value:function exceptionDate(){return(0,S.HE)(this.originalStart)}},{kind:"get",key:"originalStart",value:function originalStart(){return this._originalStart}},{kind:"set",key:"originalStart",value:function originalStart(e){this._originalStart=e}},{kind:"get",key:"isTempCard",value:function isTempCard(){var e;return b()(e=this.id).call(e,E.$d)}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return!0}},{kind:"get",key:"isSingleDate",value:function isSingleDate(){return!1}},{kind:"get",key:"customExpand",value:function customExpand(){return this._customExpand}},{kind:"get",decorators:[(0,S.lv)()],key:"iCalCalendarId",value:function iCalCalendarId(){return this._iCalCalendarId}},{kind:"get",decorators:[(0,S.lv)()],key:"iCalType",value:function iCalType(){return this._iCalType}},{kind:"method",static:!0,key:"fromSourceCard",value:function fromSourceCard(e,t,r,i){let n=new CalendarCard(e,t,r);if(!i)return n;const{iCalEvent:a,calendarId:o,calendarType:s}=i;return n._iCalCalendarId=o,n._iCalType=s,n.title=a.title,n.description=a.description,n.isAllDay=a.isAllDay,n.start=a.start,n.end=a.end,n._recurrenceRule=a.recurrenceRule,n.exceptionDates=[...a.exceptionDates],n._recurrenceId=a.recurrenceId,n._originalStart=a.originalStart,n._customExpand=a.customExpand,n}},{kind:"method",key:"clone",value:function clone(){let e=new CalendarCard(this.id,this.accountId,this.cardType);return this.hasDates&&(e.isAllDay=this.isAllDay,e.start=this.start,e.end=this.end),e.title=this.title,e.description=this.description,e.recurrenceRule=this.recurrenceRule,e.exceptionDates=[...this.exceptionDates],e.recurrenceId=this.recurrenceId,e.originalStart=this.originalStart,e._iCalCalendarId=this.iCalCalendarId,e._iCalType=this.iCalType,e}},{kind:"method",key:"equals",value:function equals(e){if(!e)return!1;function toCardObject(e){return{id:e.id,cardType:e.cardType,title:e.title,description:e.description,isAllDay:e.isAllDay,start:e.start,end:e.end,recurrenceRule:e.recurrenceRule,exceptionDates:e.exceptionDates}}let t=toCardObject(this),r=toCardObject(e),i=(0,S.h0)(t,r);return i}},{kind:"method",key:"getCompareId",value:function getCompareId(){return 0}}]}}));function getICalCardId(e){return e}},19485:(e,t,r)=>{r.d(t,{B:()=>re});var i=r(40024),n=r.n(i),a=r(57445),o=r.n(a),s=r(51791),l=r.n(s),c=r(56626),d=r.n(c),u=r(67552),h=r.n(u),p=r(86981),v=r.n(p),m=r(62079),f=r.n(m),C=r(52020),y=r.n(C),g=r(88546),_=r.n(g),k=r(66775),w=r.n(k),b=r(2201),D=r.n(b),E=r(26171),S=r(26881),A=r(99595),I=r.n(A),P=r(54847),T=r.n(P),x=r(23513),R=r.n(x),$=r(35820),L=r.n($),M=r(88946),N=r.n(M),F=r(29898),G=r.n(F),O=r(91829),z=r.n(O),j=r(73324),U=r.n(j),B=r(89221),H=r.n(B),K=r(90143),V=r.n(K),W=r(10349),Z=r.n(W),q=r(82617),Q=r(56777),Y=(r(32513),r(46930)),X=r(8937),J=r(54840),ee=r(29704);function ownKeys(e,t){var r=f()(e);if(y()){var i=y()(e);t&&(i=U()(i).call(i,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?I()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,E.Z)(e,t,n[t])})):w()?D()(e,w()(n)):I()(i=ownKeys(Object(n))).call(i,(function(t){o()(e,t,_()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;I()(r=["method","field"]).call(r,(function(r){I()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;I()(r=["method","field"]).call(r,(function(r){I()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(I()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),I()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];V()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var d=c.extras;if(d){for(var u=0;u<d.length;u++)this.addElementPlacement(d[u],t);r.push.apply(r,d)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,d(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return N()(t=(0,S.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:h()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:N()(e).call(e,this.fromElementDescriptor,this)};return o()(t,d(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const te=3e5;let re=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=v()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(N()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,ee.SG)(["$injector","$rootScope","$log","$timeout","$translate","appCommonSrv","collectionSrv","iCalIntegrationSrv","notificationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class ICalCardsService{constructor(t,r,i,n,a,o,s,l,c,d,u,h){e(this),this._$injector=t,this._$rootScope=r,this._$log=i,this._$timeout=n,this._$translate=a,this._appCommonSrv=o,this._collectionSrv=s,this._iCalIntegrationSrv=l,this._notificationSrv=c,this._platformSrv=d,this._settingsSrv=u,this._telemetrySrv=h,this._iCalIntegrationSrv.addICalCalendarEventListener("updated",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(X.FK.CardsReloaded)}})),this._iCalIntegrationSrv.addICalCalendarEventListener("deleted",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadedCalendarIds.delete(e.id),t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(X.FK.CardsReloaded)}})),this._$rootScope.$on(X.FK.FiltersChanged,(()=>{var e;I()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{this._cache.get(e).ignoreFiltersCardIds.clear()}))}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"iCalCardsSrv"}},{kind:"field",key:"provider",value:()=>(0,Q.VH)(X.lP.ICal)},{kind:"field",key:"_cache",value:()=>new(T())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_calendarCardsListeners",value:()=>({added:new(R()),updated:new(R()),deleted:new(R()),cleared:new(R())})},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){var t,r;this._initializedCollectionId=null;for(let[e,t]of this._cache){t.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(t.calendarsUpdatesPollingTimeout),t.calendarCards.clear({accountId:e});for(let e in this._calendarCardsListeners)t.calendarCards.removeEventListener(e,this._handleCalendarCardEvent)}this._cache.clear(),I()(t=this.provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>{const t={loadedCalendarIds:new(T()),hiddenCalendarIds:new(R()),busyCalendarIds:new(T()),invalidCalendarIds:new(R()),calendarCards:new J.v("id",Y.fb),reloadCalendarCardsRequested:!1,ignoreFiltersCardIds:new(R())};this._cache.set(e,t);for(let e in this._calendarCardsListeners)t.calendarCards.addEventListener(e,this._handleCalendarCardEvent)})),await L().all(N()(r=this.provider.getCurrentCollectionConnectedAccountIds()).call(r,(async t=>{this.reloadCalendars(t),await this.loadCalendarCardsAsync(t,e)}))),this._initializedCollectionId=this._currentCollectionId}},{kind:"method",key:"reloadCalendars",value:function reloadCalendars(e){const t=this._cache.get(e);let r=this.provider.getCurrentCollectionSelectedCalendarIds(e);for(let e of G()(i=t.loadedCalendarIds).call(i)){var i;z()(r).call(r,e)||t.hiddenCalendarIds.add(e)}for(let e of r)t.loadedCalendarIds.has(e)?t.hiddenCalendarIds.delete(e):t.loadedCalendarIds.set(e,!0);this._requestReloadCalendarCards(e)}},{kind:"method",key:"isICalCalendarBusy",value:function isICalCalendarBusy(e,t){var r;return null!==(r=this._cache.get(e).busyCalendarIds.get(t))&&void 0!==r&&r}},{kind:"method",key:"isICalCalendarInvalid",value:function isICalCalendarInvalid(e,t){return this._cache.get(e).invalidCalendarIds.has(t)}},{kind:"method",key:"needReloadCalendarCards",value:function needReloadCalendarCards(){var e;I()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{const t=this._cache.get(e);for(let e of G()(r=t.loadedCalendarIds).call(r)){var r;t.loadedCalendarIds.set(e,!0)}t.invalidCalendarIds.clear(),this._requestReloadCalendarCards(e)}))}},{kind:"method",key:"loadCalendarCardsAsync",value:async function loadCalendarCardsAsync(e,t){const r=this._cache.get(e);if(r.reloadCalendarCardsRequested){r.reloadCalendarCardsRequested=!1,t=t||this._appCommonSrv.getCancellationToken(`getCalendarCards_${e}`);try{r.loadCalendarCardsPromise=this._loadCalendarCardsAsync(e,t),await r.loadCalendarCardsPromise}catch(e){this._$log.error("Planyway get iCal cards error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get ICal calendar cards error",e,{class:this.constructor.name,method:this.loadCalendarCardsAsync.name})}finally{r.loadCalendarCardsPromise=null}}}},{kind:"method",key:"getCalendarCards",value:function getCalendarCards(e){var t,r;const i=this._cache.get(e);return U()(t=H()(r=i.calendarCards).call(r)).call(t,(e=>!i.hiddenCalendarIds.has(e.providerCard.iCalCalendarId)))}},{kind:"method",key:"getCalendarCardByIdAsync",value:function getCalendarCardByIdAsync(e,t){return this.getCalendarCardById(e,t)}},{kind:"method",key:"getCalendarCardById",value:function getCalendarCardById(e,t){return this._cache.get(e).calendarCards.get(t)}},{kind:"method",key:"addCalendarCardEventListener",value:function addCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeCalendarCardEventListener",value:function removeCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"method",key:"isCalendarCardLoaded",value:function isCalendarCardLoaded(e){const t=e.accountId,r=this._cache.get(t);return r.loadedCalendarIds.has(e.providerCard.iCalCalendarId)&&!r.hiddenCalendarIds.has(e.providerCard.iCalCalendarId)}},{kind:"method",key:"isCalendarCardVisible",value:function isCalendarCardVisible(e){const t=this._cache.get(e.accountId);if(e.isTempCard)return!0;if(!this.isCalendarCardLoaded(e))return!1;if(t.ignoreFiltersCardIds.has(e.id))return!0;let r=this._appCommonSrv.getFiltersCardSearchString();var i;return!r||z()(i=e.title.toLowerCase()).call(i,r)}},{kind:"method",key:"setCalendarCardIgnoreFilters",value:function setCalendarCardIgnoreFilters(e){this._cache.get(e.accountId).ignoreFiltersCardIds.add(e.id)}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"field",key:"_handleCalendarCardEvent",value(){var e=this;return function(t){var r,i,n;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:o,silent:s}=a;if(!s)switch(o){case"added":if(!t.isTempCard&&!e.isCalendarCardLoaded(t))break;I()(r=e._calendarCardsListeners[o]).call(r,(e=>e(t,a)));break;case"updated":case"deleted":I()(i=e._calendarCardsListeners[o]).call(i,(e=>e(t,a)));break;case"cleared":I()(n=e._calendarCardsListeners[o]).call(n,(e=>e(a)))}}}},{kind:"method",key:"_requestReloadCalendarCards",value:function _requestReloadCalendarCards(e){const t=this._cache.get(e);t.reloadCalendarCardsRequested=!0,t.busyCalendarIds.clear()}},{kind:"method",key:"_setICalCalendarsBusy",value:function _setICalCalendarsBusy(e,t,r){const i=this._cache.get(e);this._$rootScope.$evalAsync((()=>{for(let e of t)i.busyCalendarIds.set(e,r)}))}},{kind:"method",key:"_loadCalendarCardsAsync",value:async function _loadCalendarCardsAsync(e,t){const r=this._cache.get(e);let i=[];for(let e of G()(n=r.loadedCalendarIds).call(n)){var n;r.loadedCalendarIds.get(e)&&i.push(e)}const a=U()(i).call(i,(e=>!r.busyCalendarIds.has(e)));try{this._setICalCalendarsBusy(e,a,!0);let n=await this._getICalCalendarsDataAsync(e,i,t);if(t.isCanceled())return;for(let e of H()(o=r.calendarCards).call(o)){var o,s;(null===(s=r.loadedCalendarIds.get(e.providerCard.iCalCalendarId))||void 0===s||s)&&r.calendarCards.delete(e.id)}for(let{calendarId:t,type:i,events:a}of n){for(let n of a){let a=Y.fb.createCard(e,X.lP.ICal,q.eT.ICalEvent,{iCalEvent:n,calendarId:t,calendarType:i});r.calendarCards.add(a)}this._$rootScope.$broadcast(X.FK.CollectionCalendarReady,{accountId:e,calendarId:t})}for(let e of i)r.loadedCalendarIds.set(e,!1)}finally{t.isCanceled()||this._setICalCalendarsBusy(e,a,!1)}r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout);const pollICalCalendarsAsync=async()=>{try{await this._pollICalCalendarsAsync(e)}catch(e){this._$log.error("Planyway poll iCal calendars error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway poll iCal calendars error",e,{class:this.constructor.name,method:this._pollICalCalendarsAsync.name})}r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollICalCalendarsAsync()),te,!1)};r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollICalCalendarsAsync()),te,!1)}},{kind:"method",key:"_getICalCalendarsDataAsync",value:async function _getICalCalendarsDataAsync(e,t,r){const i=this._cache.get(e);let n=[];for(t=[...t];t.length>0;){var a;await L().all(N()(a=V()(t).call(t,0,4)).call(a,(async t=>{try{let i=this._iCalIntegrationSrv.getICalCalendarById(e,t),a=await this._iCalIntegrationSrv.getICalCalendarDataAsync(i.url);if(r.isCanceled())return;n.push(_objectSpread(_objectSpread({},a),{},{calendarId:t}))}catch(e){i.invalidCalendarIds.add(t),this._$log.error("Planyway get iCal calendar data error:"),this._$log.error(e)}})))}return n}},{kind:"method",key:"_pollICalCalendarsAsync",value:async function _pollICalCalendarsAsync(e){var t,r;const i=this._cache.get(e),n=this._appCommonSrv.getCancellationToken(`pollICalCalendars_${e}`);let a=U()(t=Z()(G()(r=i.loadedCalendarIds).call(r))).call(t,(e=>!i.invalidCalendarIds.has(e))),o=await this._getICalCalendarsDataAsync(e,a,n);if(!n.isCanceled())for(let{calendarId:t,type:r,events:n}of o){if(!i.loadedCalendarIds.has(t))continue;let a=new(T());for(let e of H()(s=i.calendarCards).call(s)){var s;e.providerCard.iCalCalendarId===t&&a.set(e.id,e)}let o=new(T());for(let i of n){let n=Y.fb.createCard(e,X.lP.ICal,q.eT.ICalEvent,{iCalEvent:i,calendarId:t,calendarType:r});o.set(n.id,n)}for(let[e,t]of o){let r=a.get(e);if(r){if(r.equals(t))continue;i.calendarCards.update(t)}else{if(t.recurrenceId){let e=a.get(t.recurrenceId);e&&(e.addExceptionDate(t.exceptionDate),i.calendarCards.update(e))}i.calendarCards.add(t)}}for(let e of G()(a).call(a))o.has(e)||i.calendarCards.delete(e)}}}]}}))},82638:(e,t,r)=>{r.d(t,{q:()=>se});var i=r(40024),n=r.n(i),a=r(57445),o=r.n(a),s=r(51791),l=r.n(s),c=r(90143),d=r.n(c),u=r(56626),h=r.n(u),p=r(67552),v=r.n(p),m=r(86981),f=r.n(m),C=r(62079),y=r.n(C),g=r(52020),_=r.n(g),k=r(73324),w=r.n(k),b=r(88546),D=r.n(b),E=r(66775),S=r.n(E),A=r(2201),I=r.n(A),P=r(26171),T=r(26881),x=r(23513),R=r.n(x),$=r(54847),L=r.n($),M=r(99595),N=r.n(M),F=r(88946),G=r.n(F),O=r(8244),z=r.n(O),j=r(89221),U=r.n(j),B=r(39290),H=r.n(B),K=r(91829),V=r.n(K),W=r(87994),Z=r.n(W),q=r(10349),Q=r.n(q),Y=r(99560),X=r.n(Y),J=r(82617),ee=r(99322),te=r(56777),re=(r(32513),r(20115)),ie=r(8937),ne=r(54840),ae=r(29704);function ownKeys(e,t){var r=y()(e);if(_()){var i=_()(e);t&&(i=w()(i).call(i,(function(t){return D()(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,i,n=null!=arguments[t]?arguments[t]:{};t%2?N()(r=ownKeys(Object(n),!0)).call(r,(function(t){(0,P.Z)(e,t,n[t])})):S()?I()(e,S()(n)):N()(i=ownKeys(Object(n))).call(i,(function(t){o()(e,t,D()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;N()(r=["method","field"]).call(r,(function(r){N()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,i=e.prototype;N()(r=["method","field"]).call(r,(function(r){N()(t).call(t,(function(t){var n=t.placement;if(t.kind===r&&("static"===n||"prototype"===n)){var a="static"===n?e:i;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var i=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],i=[],n={static:[],prototype:[],own:[]};if(N()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),N()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,n);r.push(t.element),r.push.apply(r,t.extras),i.push.apply(i,t.finishers)}),this),!t)return{elements:r,finishers:i};var a=this.decorateConstructor(r,t);return i.push.apply(i,a.finishers),a.finishers=i,a},addElementPlacement:function(e,t,r){var i=t[e.placement];if(!r&&-1!==l()(i).call(i,e.key))throw new TypeError("Duplicated element ("+e.key+")");i.push(e.key)},decorateElement:function(e,t){for(var r=[],i=[],n=e.decorators,a=n.length-1;a>=0;a--){var o=t[e.placement];d()(o).call(o,l()(o).call(o,e.key),1);var s=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,n[a])(s)||s);e=c.element,this.addElementPlacement(e,t),c.finisher&&i.push(c.finisher);var u=c.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:i,extras:r}},decorateConstructor:function(e,t){for(var r=[],i=t.length-1;i>=0;i--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[i])(n)||n);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var s=o+1;s<e.length;s++)if(e[o].key===e[s].key&&e[o].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return G()(t=(0,T.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),i=String(e.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:i,descriptor:v()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:G()(e).call(e,this.fromElementDescriptor,this)};return o()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var i=(0,t[r])(e);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");e=i}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(i.decorators=e.decorators),"field"===e.kind&&(i.initializer=e.value),i}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[n()];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const oe={[ie.FK.AccountAdding]:ie.FK.AccountAdded,[ie.FK.AccountDeleting]:ie.FK.AccountDeleted,[ie.FK.CalendarsChanging]:ie.FK.CalendarsChanged};let se=function _decorate(e,t,r,i){var n,a=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)a=i[o](a);var s=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),r),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},r=0;r<e.length;r++){var i,n=e[r];if("method"===n.kind&&(i=f()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(n)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");i.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");i.decorators=n.decorators}_coalesceGetterSetter(n,i)}else t.push(n)}return t}(G()(n=s.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(s.F,l.elements),a.runClassFinishers(s.F,l.finishers)}([(0,ae.SG)(["$injector","$rootScope","$log","$translate","appCommonSrv","dialogSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class ICalIntegrationService{constructor(t,r,i,n,a,o,s,l,c,d,u){e(this),this._$injector=t,this._$rootScope=r,this._$log=i,this._$translate=n,this._appCommonSrv=a,this._dialogSrv=o,this._planywayIntegrationSrv=s,this._platformSrv=l,this._settingsSrv=c,this._telemetrySrv=d,this._collectionSrv=u,this._initializedAccounts=new(R());const onSourceChanged=async(e,t)=>{if(t&&t.accountType!==J.Qm.ICal)return;let r=this._appCommonSrv.getCancellationToken(`source-changed-for-${t.accountType}`);switch(e.name){case ie.FK.AccountAdding:case ie.FK.AccountDeleting:await this.initCurrentCollectionAsync(r)}let i=oe[e.name];i&&this._$rootScope.$broadcast(i,t)};this._$rootScope.$on(ie.FK.AccountAdding,onSourceChanged),this._$rootScope.$on(ie.FK.AccountDeleting,onSourceChanged),this._$rootScope.$on(ie.FK.CalendarsChanging,onSourceChanged)}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"iCalIntegrationSrv"}},{kind:"field",key:"_provider",value:()=>(0,te.VH)(ie.lP.ICal)},{kind:"field",key:"_cache",value:()=>new(L())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_iCalCalendarsListeners",value:()=>({added:new(R()),updated:new(R()),deleted:new(R()),cleared:new(R())})},{kind:"get",key:"_iCalCardsSrv",value:function _iCalCardsSrv(){return this._iCalCardsSrvLazy||(this._iCalCardsSrvLazy=this._$injector.get("iCalCardsSrv")),this._iCalCardsSrvLazy}},{kind:"method",key:"connectAccountAsync",value:async function connectAccountAsync(){try{let e=await this._dialogSrv.showICalImportDialogAsync();if(!e)return;let t={accountId:X()(e.url),accountType:J.Qm.ICal,accountName:e.name,name:e.name,iCalType:e.type,url:e.url,color:e.color};return this._userSettings.global.settings.account[t.accountId]=t,await this._userSettings.global.saveAsync(),this._planywayIntegrationSrv.setConnectedAccount(t),t}catch(e){this._$log.error("ICal connect error:"),this._$log.error(e),this._telemetrySrv.logError("ICal connect error",e,{class:this.constructor.name,method:this.connectAccountAsync.name})}}},{kind:"method",key:"disconnectAccountAsync",value:async function disconnectAccountAsync(e){return this._planywayIntegrationSrv.deleteConnectedAccount(e),delete this._userSettings.global.settings.account[e.accountId],await this._userSettings.global.saveAsync(),!0}},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:function initCurrentCollectionAsync(e){try{var t,r;this._appCommonSrv.setSchedulerBusy(!0),this._initializedCollectionId=null,this._initializedAccounts.clear();for(let[,e]of this._cache){e.calendars.clear();for(let t in this._iCalCalendarsListeners)e.calendars.removeEventListener(t,this._handleCalendarEvent)}this._cache.clear(),N()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>{const t={calendars:new ne.v("id")};this._cache.set(e,t);for(let e in this._iCalCalendarsListeners)t.calendars.addEventListener(e,this._handleCalendarEvent)})),G()(r=this._provider.getCurrentCollectionConnectedAccountIds()).call(r,(e=>{if(!this._currentCollectionId)return;if(this._initializedAccounts.has(e))return;let t=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!t)return;const r=this._cache.get(e);this._initializedAccounts.add(e),r.calendars.add({id:e,accountId:e,type:t.iCalType,url:t.url,name:t.accountName,color:t.color})})),this._initializedCollectionId=this._currentCollectionId,this._iCalCardsSrv.initCurrentCollectionAsync(e)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"isCurrentCollectionAccountReady",value:function isCurrentCollectionAccountReady(e){var t;return!!this._initializedAccounts.has(e)&&z()(t=this._provider.getCurrentCollectionSelectedCalendarIds(e)).call(t,(t=>this.getICalCalendarById(e,t)))}},{kind:"method",key:"getICalUser",value:function getICalUser(e){let t=this._userSettings.global.settings.account[e];return{id:e,accountId:e,email:t.name,fullName:t.name}}},{kind:"method",key:"getICalCalendars",value:function getICalCalendars(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return U()(t=r.calendars).call(t)}},{kind:"method",key:"getICalCalendarById",value:function getICalCalendarById(e,t){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).calendars.get(t)}},{kind:"method",key:"checkICalCalendarAsync",value:async function checkICalCalendarAsync(e){try{let t=await this.getICalCalendarDataAsync(e);return{type:t.type,url:t.url,name:t.name}}catch(e){this._$log.error("Planyway iCal validation error:"),this._$log.error(e)}}},{kind:"method",key:"getICalCalendarDataAsync",value:async function getICalCalendarDataAsync(e){let t;try{if(t=await this._restAsync(ie.Tu.Get,`${re.Ao}/planyway/${this._planywayIntegrationSrv.userId}/proxy/ical`,"Load iCal",{query:{url:e}}),!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}}catch(e){throw this._telemetrySrv.logError("Planyway get iCal data error",e,{class:this.constructor.name,method:this.getICalCalendarDataAsync.name}),e}try{return this._parseICalCalendarData(e,t.data)}catch(e){throw this._telemetrySrv.logError("Planyway parse iCal data error",e,{class:this.constructor.name,method:this.getICalCalendarDataAsync.name}),e}}},{kind:"method",key:"updateICalCalendarProperties",value:function updateICalCalendarProperties(e,t,r){if(!this._initializedAccounts.has(e))return;let i=this.getICalCalendarById(e,t);if(!i)return;const n=this._cache.get(e);for(let[t,n]of H()(r))void 0!==n&&(i[t]=n,this._userSettings.global.settings.account[e][t]=n,this._userSettings.global.saveAsync());n.calendars.update(i)}},{kind:"method",key:"isConnectedICalCalendarBusy",value:function isConnectedICalCalendarBusy(e,t){return this._iCalCardsSrv.isICalCalendarBusy(e,t)}},{kind:"method",key:"isConnectedICalCalendarInvalid",value:function isConnectedICalCalendarInvalid(e,t){return this._iCalCardsSrv.isICalCalendarInvalid(e,t)}},{kind:"method",key:"addICalCalendarEventListener",value:function addICalCalendarEventListener(e,t){let r=this._iCalCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeICalCalendarEventListener",value:function removeICalCalendarEventListener(e,t){let r=this._iCalCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"field",key:"_handleCalendarEvent",value(){var e=this;return function(t){var r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:n,silent:a}=i;if(a)return;if(N()(r=e._iCalCalendarsListeners[n]).call(r,(e=>e(t,i))),"cleared"===n)return void e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars});const o=t.accountId;if(e._provider.getCurrentCollectionConnectedCalendar(o,t.id).isSelected){switch(n){case"added":case"updated":case"deleted":e.isCurrentCollectionAccountReady(o)&&e._$rootScope.$broadcast(ie.FK.CollectionAccountReady,{accountId:o})}switch(n){case"updated":e._$rootScope.$broadcast(ie.FK.SettingsChanged),e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars});break;case"deleted":e._$rootScope.$broadcast(ie.FK.TimelineResourcesReloaded,{resourcesType:ie.y.Calendars})}}}}},{kind:"method",key:"_parseICalCalendarData",value:function _parseICalCalendarData(e,t){let r=new ee.h.Component(ee.h.parse(t)),i=ee.h.getLastErrors();i.length>0&&(this._$log.error("Planyway iCal parsing error:"),this._$log.error(i[0]));let n=ie.B.Other,a=r.getFirstPropertyValue("prodid");a?V()(a).call(a,"Google Calendar")?n=ie.B.Google:V()(a).call(a,"Microsoft")&&(n=ie.B.Outlook):V()(e).call(e,"icloud")&&(n=ie.B.Apple);let o=r.getAllSubcomponents("vtimezone");for(let e of o){let t=e.getFirstPropertyValue("tzid");ee.h.TimezoneService.has(t)||ee.h.TimezoneService.register(e)}let s=new(L()),l=new(L()),c=new(L()),d=[],u=r.getAllSubcomponents("vevent");for(let t of u){let r=t.getFirstPropertyValue("uid");if(!r){this._$log.warn("iCal event uid property not found!");continue}let i=t.getFirstPropertyValue("summary"),n=t.getFirstPropertyValue("description"),a=t.getFirstPropertyValue("dtstart");if(!a){this._$log.warn("iCal event dtstart property not found!");continue}let o=t.getFirstPropertyValue("dtend");o||(o=a);let u=t.getFirstPropertyValue("rrule"),p=t.getFirstPropertyValue("recurrence-id"),v=t.getAllProperties("exdate"),m=X()(e)+X()(r),f=i||this._$translate.instant("MISC.NO_TITLE"),C=n,y=a.toJSDate(),g=o.toJSDate();g<y&&(g=y);let _=a.isDate&&o.isDate;_&&!(0,ae.rs)(y,g)&&(g=(0,ae.E4)(g,-1));let k,w,b,D=u&&u.toString();if(p){k=m,w=p.toJSDate(),b=p.toString(),m+=(0,ae.wd)(w);let e=l.get(k);if(e)e.relateException(t);else{let e=c.get(k);e?e.push(t):c.set(k,[t])}}let E=[];var h;if(v)E=G()(h=Z()(v).call(v,(e=>e.getValues()))).call(h,(e=>e.toJSDate()));let S;if(D){const e=new ee.h.Event(t,{exceptions:c.get(m)||[]});l.set(m,e);const r=g-y,i=this;S=function(t,n){let a=[];try{let i=e.iterator(),o=i.next();for(;o;){let s=o.toJSDate();if(s>n)break;s>=t-r&&!e.exceptions[o]&&a.push(this.toOccurrence({start:s,end:new Date(s.getTime()+r)})),o=i.next()}}catch(e){i._$log.error("Planyway iCal expand recurrent event error:"),i._$log.error(e)}return a}}else S=function(){return[this]};let A={id:m,title:f,description:C,isAllDay:_,start:y,end:g,recurrenceRule:D,exceptionDates:E,recurrenceId:k,exceptionDate:w,originalStart:b,customExpand:S};k&&d.push(A),s.set(m,A)}for(let e of d){let t=s.get(e.recurrenceId);t&&t.exceptionDates.push(e.exceptionDate)}return{type:n,url:e,name:r.getFirstPropertyValue("x-wr-calname")||e,events:Q()(U()(s).call(s))}}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,r){let i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(r,e,t,_objectSpread(_objectSpread({},n.query),n.body)),o=200;try{return await this._platformSrv.restAsync(e,t,_objectSpread(_objectSpread({},n),{},{usePlanywayAuth:!0}))}catch(e){throw o=e.status,i=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,o,i)}}}]}}))},56777:(e,t,r)=>{r.d(t,{IB:()=>getProviderClass,VH:()=>getProvider,dS:()=>getProviderByAccountType,fL:()=>getProviderTypeByAccountType,sP:()=>g,xT:()=>_,yI:()=>k});var i,n,a=r(76555),o=r.n(a),s=r(62079),l=r.n(s),c=r(86981),d=r.n(c),u=r(82617),h=r(8937),p=(r(43603),r(21695)),v=r(32513),m=r(3884),f=r(43611);let C;const y={[h.lP.Google]:{class:p.Z,accountType:u.Qm.Google},[h.lP.ICal]:{class:v.Z,accountType:u.Qm.ICal},[h.lP.Outlook]:{class:m.Z,accountType:u.Qm.Outlook}},g=o()(i=l()(y)).call(i,((e,t)=>h.Tr[e]-h.Tr[t]));C=h.lP.Trello,y[C]={class:f.Z,accountType:u.Qm.Trello};const _=C,k=o()(n=l()(y)).call(n,((e,t)=>h.Tr[e]-h.Tr[t]));function getProviderClass(e){let t=y[e];if(!t)throw TypeError(`Unable to find provider of type "${e}"`);return t.class}function getProvider(e){let t=y[e];if(!t)throw TypeError(`Unable to find provider of type "${e}"`);let r=t.instance;return r||(r=new t.class,t.instance=r),r}function getProviderTypeByAccountType(e){var t;return d()(t=l()(y)).call(t,(t=>y[t].accountType===e))}function getProviderByAccountType(e){return getProvider(getProviderTypeByAccountType(e))}}}]);