"use strict";(self.webpackChunk_planyway_planyway=self.webpackChunk_planyway_planyway||[]).push([[195],{3884:(e,t,r)=>{r.d(t,{Z:()=>Provider});var n=r(52020),i=r.n(n),a=r(88546),o=r.n(a),l=r(99595),s=r.n(l),d=r(66775),c=r.n(d),u=r(2201),h=r.n(u),p=r(57445),v=r.n(p),f=r(26171),C=r(88946),m=r.n(C),y=r(73324),k=r.n(y),_=r(62079),g=r.n(_),w=r(27525),E=r.n(w),D=r(35820),S=r.n(D),A=r(87994),b=r.n(A),I=r(91829),T=r.n(I),O=r(76555),P=r.n(O),x=r(54847),$=r.n(x),R=r(82617),N=r(46930),M=r(8937),F=r(20115),z=r(29704),L=r(15985),U=r(88078);const B='<g fill="none"><path d="M9.348 3.723l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm0-1A5 5 0 106 1a5 5 0 000 10z" fill="\\#8b8e93"/></g>',K='<g fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12A6 6 0 106 0a6 6 0 000 12zm3.348-8.277l-.707-.707-3.813 3.812L3.5 5.5l-.707.707 2.035 2.036 4.52-4.52z" fill="\\#8b8e93"/></g>',j='\n# if (!hiddenElements.calendar) { #\n# var calendarName = cardProvider.getCardCalendarName(data) #\n# if (calendarName) { #\n<div class="pw-card__calendar">\n    #: calendarName #\n</div>\n# } #\n# } #\n',G=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n# if (cardProvider.getCardInviteStatus(data) === '${M.Lz.No}') { #\n\x3c!-- Иконка отклоненного приглашения для событий Outlook --\x3e\n<div class="mdi mdi-close-circle pw-card__type-icon"></div>\n# } #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${K}</svg>\n    <svg width="12px" height="12px">${B}</svg>\n</div>\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    <div class="pw-card__details">\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n\n        ${j}\n    </div>\n</div>\n`,V=`\n# var hiddenElements = data.$ctrl.hiddenCardElements; #\n# var cardProvider = data.$ctrl.getCardProvider(data); #\n\n# if (cardProvider.getCardInviteStatus(data) === '${M.Lz.No}') { #\n\x3c!-- Иконка отклоненного приглашения для событий Outlook --\x3e\n<div class="mdi mdi-close-circle pw-card__type-icon"></div>\n# } #\n\n# if (data.timeShortText) { #\n<span class="pw-card__time pw-card__time-short pw-js-card-time-short">#: data.timeShortText #</span>\n# } #\n\n<div class="pw-card__complete-icon pw-js-card-complete-button">\n    <svg width="12px" height="12px">${K}</svg>\n    <svg width="12px" height="12px">${B}</svg>\n</div>\n\n<div class="pw-card__content pw-js-card-content">\n    <div class="pw-card__title pw-js-card-title">\n        <span class="pw-card__title-text">\n            #: data.title || data.noTitle #\n        </span>\n    </div>\n\n    # if (!hiddenElements.calendar || !hiddenElements.dates) { #\n    <div class="pw-card__details">\n        # if (!hiddenElements.dates && data.timeDateText) { #\n        <span class="pw-card__time pw-js-card-time-date">#: data.timeDateText #</span>\n        # } else { #\n        # if (data.timeText) { #\n        <span class="pw-card__time pw-js-card-time">#: data.timeText #</span>\n        # } #\n        # } #\n\n        ${j}\n    </div>\n    # } #\n</div>\n`,H={hourSlot:kendo.template(G,{useWithBlock:!1}),daySlot:kendo.template(V,{useWithBlock:!1})};function getCalendarIconTemplate(e,t){return`\n        <pw-outlook-calendar-icon\n            account-id="${e}"\n            calendar-id="${t}"\n            icon-size="small"\n        ></pw-outlook-calendar-icon>\n    `}var q=r(84705);const Z=r.n(q)()('\n<div\n    class="pw-calendar-icon pw-calendar-icon--outlook-calendar pw-calendar-icon--outlook-calendar_normal"\n    style="background-color: #= data.resourceData.calendarColor #;"\n>\n    <svg width="24" height="24"><path d="M13 3h8v8h-8V3ZM13 13h8v8h-8v-8ZM3 13h8v8H3v-8ZM3 3h8v8H3V3Z"/></svg>\n</div>\n').call('\n<div\n    class="pw-calendar-icon pw-calendar-icon--outlook-calendar pw-calendar-icon--outlook-calendar_normal"\n    style="background-color: #= data.resourceData.calendarColor #;"\n>\n    <svg width="24" height="24"><path d="M13 3h8v8h-8V3ZM13 13h8v8h-8v-8ZM3 13h8v8H3v-8ZM3 3h8v8H3V3Z"/></svg>\n</div>\n'),W={resourceIcon:kendo.template(Z,{useWithBlock:!1})};var Y=r(56977),Q=r.n(Y);function ownKeys(e,t){var r=g()(e);if(i()){var n=i()(e);t&&(n=k()(n).call(n,(function(t){return o()(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?s()(r=ownKeys(Object(i),!0)).call(r,(function(t){(0,f.Z)(e,t,i[t])})):c()?h()(e,c()(i)):s()(n=ownKeys(Object(i))).call(n,(function(t){v()(e,t,o()(i,t))}))}return e}const X={[R.eT.OutlookEvent]:[M.VD.E,M.VD.M,M.VD.Space,M.VD.Delete,M.VD.Backspace]};class Provider extends L.Z{get type(){return M.lP.Outlook}get integrationService(){return this._outlookIntegrationSrv}get cardsService(){return this._outlookCardsSrv}static get sortOrder(){return[]}initializeAsync(e){return this._outlookIntegrationSrv.initCurrentCollectionAsync(e)}getCardTemplates(){return H}getCalendarExtraCardStyle(e){return(e=>{let{shortId:t,color:{light:r,dark:n,highlight:i,controlHover:a}}=e;return`\n    .pw-card--outlook_${t} {\n        --background: ${r};\n        --title: ${n};\n        --subtitle: ${n};\n        --icon: ${n};\n        --border: transparent;\n        --control-hover: ${a};\n    }\n\n    .pw-card--outlook_${t}.k-state-selected,\n    .timeline-selected .pw-card--outlook_${t},\n    .pw-card-link-target .pw-card--outlook_${t},\n    .pw-card--outlook_${t}.pw-card--temp {\n        --background: ${i};\n        --border: ${n};\n    }\n`})(e)}getCardTooltipConfig(){return{templateUrl:Q(),controllerName:"outlookEventTooltipCtrl"}}getCardTemplateData(e){return{isReadOnly:e.isReadOnly,cardType:e.cardType,cardRole:e.cardRole,title:e.title,isAllDay:e.isAllDay,start:e.start,realStart:e.realStart,end:e.end,realEnd:e.realEnd,isCompleted:e.providerCard.isCompleted,outlookCalendarId:e.providerCard.outlookCalendarId,outlookShowAs:e.providerCard.outlookShowAs,outlookAttendees:e.providerCard.outlookAttendees,outlookLocations:e.providerCard.outlookLocations}}getCardEditorHtml(){return'\n            <pw-outlook-event-editor\n                class="pw-dialog-edit-card__editor"\n                calendar-card="$ctrl.calendarCard"\n                is-detailed="$ctrl.isDetailed"\n                force-detailed-mode="$ctrl.forceDetailedMode"\n                is-dense="$ctrl.isDense"\n                has-changes="$ctrl.hasChanges"\n            ></pw-outlook-event-editor>\n        '}getCardContextMenuHtml(){return'\n            <pw-outlook-card-context-menu\n                source="$ctrl.source"\n                on-set-context-menu="$ctrl.onSetContextMenu"\n            ></pw-outlook-card-context-menu>\n        '}getWorkPanelHtml(){}isWorkPanelAvailable(){return!1}getCalendarsPickerHtml(){return'\n            <pw-outlook-calendars-picker\n                account="$ctrl.account"\n                calendars="$ctrl.calendars"\n                filter-text="$ctrl.filterText"\n            ></pw-outlook-calendars-picker>\n        '}getCardId(e){return(0,U.h7)(e.outlookEvent.id,e.outlookCalendar.shortId)}getCalendarCardClass(){return U.fb}isMilestonesSupported(){return!1}get _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=this._$injector.get("licenseSrv")),this._licenseSrvLazy}get _outlookIntegrationSrv(){return this._outlookIntegrationSrvLazy||(this._outlookIntegrationSrvLazy=this._$injector.get("outlookIntegrationSrv")),this._outlookIntegrationSrvLazy}get _outlookCardsSrv(){return this._outlookCardsSrvLazy||(this._outlookCardsSrvLazy=this._$injector.get("outlookCardsSrv")),this._outlookCardsSrvLazy}get accountType(){return R.Qm.Outlook}getAccountName(e){var t;return null===(t=this._outlookIntegrationSrv.getOutlookUser(e))||void 0===t?void 0:t.fullName}getAccountEmail(e){var t;return null===(t=this._outlookIntegrationSrv.getOutlookUser(e))||void 0===t?void 0:t.email}getAccountUser(e){return this._outlookIntegrationSrv.getOutlookUser(e)}getAccountUserAsync(e){return this._outlookIntegrationSrv.getOutlookUserAsync(e)}getCurrentCollectionConnectedCalendarIds(e){var t,r;let n=m()(t=this.integrationService.getOutlookCalendars(e)).call(t,(e=>e.id)),i=(0,z.Bn)(this._collectionSettings.global.settings.calendar,n);return k()(r=g()(i)).call(r,(e=>i[e].isConnected))}getCurrentCollectionConnectedCalendar(e,t){let r=this.integrationService.getOutlookCalendarById(e,t),n=this._collectionSettings.global.settings.calendar[t];return r&&n?_objectSpread({calendarId:t},n):{accountType:R.Qm.Outlook,calendarId:t,isConnected:!1,isSelected:!1}}getCurrentCollectionConnectedCalendars(e){var t,r,n;let i=m()(t=this.integrationService.getOutlookCalendars(e)).call(t,(e=>e.id)),a=(0,z.Bn)(this._collectionSettings.global.settings.calendar,i),o=this._planywayIntegrationSrv.getConnectedAccountById(e);return m()(r=k()(n=g()(a)).call(n,(e=>a[e].isConnected))).call(r,(e=>{let t=_objectSpread({calendarId:e},a[e]);return t.isSelected&&(o.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(M.ZV.OutlookConnect,!1)||(t.isSelected=!1,a[e].isSelected=!1)),t}))}canCreateCard(e,t){var r;return t?!this._outlookIntegrationSrv.getOutlookCalendarById(e,t).isReadOnly:E()(r=this.getCurrentCollectionSelectedCalendarIds(e)).call(r,(t=>!this._outlookIntegrationSrv.getOutlookCalendarById(e,t).isReadOnly))}isTimeTrackingAvailable(){}getMainToolbarRightHtml(){}getMainToolbarFiltersMenuHtml(){}getSchedulerToolbarViewSettingsMenuHtml(){}getSupportedSchedulerModes(){return[{get value(){return M.ud.Calendar},set value(e){},title:this._$translate.instant("BUTTONS.CALENDAR")},{get value(){return M.ud.Timeline},set value(e){},title:this._$translate.instant("BUTTONS.TIMELINE")}]}getSupportedTimelineViews(){return[{value:M.tS.Board,icon:"icons-16:timeline-calendars-outline",title:this._$translate.instant("MENU.CALENDARS")},{value:M.tS.None,icon:"icons-16:timeline-no-grouping-outline",title:this._$translate.instant("MENU.NO_GROUPING")}]}getViewSettingsMenuFieldItems(){const e=this;return[{group:"dates",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_DATES"),get state(){return e._collectionSettings.global.settings.showDates},set state(t){e._collectionSettings.global.settings.showDates=t,e._$rootScope.$broadcast(M.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(M.cN.SettingsEvents.ShowDatesChanged)},get isAvailable(){switch(e._appCommonSrv.getSchedulerView()){case M.rW.Month:case M.rW.Timeline:return!0;default:return!1}}},{group:"calendar",type:"single",title:this._$translate.instant("MENU.CARD_FIELD_CALENDAR"),get state(){return e._collectionSettings.global.settings.showCalendar},set state(t){e._collectionSettings.global.settings.showCalendar=t,e._$rootScope.$broadcast(M.FK.CardsFieldsSettingsChanged),e._collectionSettings.global.saveAsync(),e._telemetrySrv.logSessionEvent(M.cN.SettingsEvents.ShowCalendarChanged)},get isAvailable(){return!0}}]}addTimeRecordManuallyAsync(){return!1}getTimerParentCardByIdAsync(){}createTimeRecordCardByTimerAsync(){return S().resolve(!1)}static getSidebarPanelHtml(){return'\n            <pw-outlook-sidebar-panel\n                class="pw-provider-sidebar-panel"\n            ></pw-outlook-sidebar-panel>'}getNewCardObjectProviderCard(e){return{accountId:e.accountId,cardType:e.cardType,cardRole:e.cardRole,outlookCalendarId:e.calendarId}}getTimelineResourceTemplates(){return W}getTimelineResourcesByType(e,t){var r;let n=[];if(!this._outlookIntegrationSrv.isCurrentCollectionInitialized)return n;const i=this._collectionSettings.global.settings.timelineHiddenResources[t],a=b()(r=this.getCurrentCollectionConnectedAccountIds()).call(r,(e=>{let t=this.getCurrentCollectionSelectedCalendarIds(e);return m()(t).call(t,(t=>this._outlookIntegrationSrv.getOutlookCalendarById(e,t)))}));if(t===M.y.Calendars)for(let r of a)n.push({id:r.id,accountTypes:[R.Qm.Outlook],accountIds:[r.accountId],calendarIds:[r.id],type:t,getProvider:()=>this,name:r.name,isSelected:!T()(i).call(i,r.id),isPrimary:r.isPrimary,resourceData:{calendarType:M.kK.OutlookCalendar,calendarColor:r.color.base},iconHtml:getCalendarIconTemplate(e,r.id)});return P()(n).call(n,((e,r)=>{if(t===M.y.Calendars){if(e.isPrimary)return-1;if(r.isPrimary)return 1}return(0,z.A5)(e.name,r.name)||(0,z.A5)(e.id,r.id)}))}getTimelineResourcesMenuByType(e,t){return t===M.y.Calendars?{title:this._$translate.instant("BUTTONS.CALENDARS"),description:this._outlookIntegrationSrv.getOutlookUser(e).fullName,icon:"icons-16:microsoft-outline",showAll:{text:this._$translate.instant("MENU.SHOW_ALL_CALENDARS"),icon:"icons-16:timeline-all-calendars-outline"},showNone:{text:this._$translate.instant("MENU.SHOW_NONE_CALENDARS"),icon:"icons-16:timeline-calendars-outline"}}:{}}expandTimelineResources(e,t){let r=t.field,n=t.defaultFieldValue;if(e.cardRole===R.D.Card){if(t.name===M.y.NoResources)return[F.xp];{let i=(0,z._M)(e,r,n);return t.multiple?i:[i]}}}updateProviderCardDataByTimelineResource(e,t){e.providerCard.outlookCalendarId=t.id}isEventDataUpdated(e,t){return t.providerCard.outlookCalendarId&&t.providerCard.outlookCalendarId!==e.providerCard.outlookCalendarId}isOwnCalendarCard(e){var t;return E()(t=e.providerCard.outlookAttendees).call(t,(t=>t.emailAddress.address!==this._getUserEmail(e.accountId)))}isCardContextMenuAvailable(e){return!e.isTempCard}isCardResizeAvailable(e){return!e.isReadOnly&&!e.recurrenceId&&!e.recurrenceRule}isCardSatisfiesSchedulerFilters(e){return this._appCommonSrv.getSchedulerMode(!0)!==M.ud.TimeTracking&&this._calendarCardsSrv.isCalendarCardVisible(e)}canModifyInScheduler(){return!0}canStartMoveInScheduler(e){return!e.isReadOnly&&e.providerCard.canModify}canEndMoveInScheduler(){return!0}canResizeInScheduler(){return!0}canUpdateInScheduler(e){return!e.isReadOnly&&e.providerCard.canModify}canSortInScheduler(){return!1}getMovedEvent(e){switch(this._appCommonSrv.getTimelineResourcesType()){case M.y.NoResources:return e;case M.y.Calendars:return e.providerCard.outlookCalendarId=e.resourceId,e}}getCardExtraClasses(e){let t=[];t.push("pw-card--outlook");let r=this._outlookIntegrationSrv.getOutlookCalendarById(e.accountId,e.providerCard.outlookCalendarId);switch(r?(t.push(`pw-card--outlook_${r.shortId}`),r.colorName&&t.push(`pw-card--outlook_${r.colorName}`)):t.push("pw-card--outlook_default"),e.isTempCard&&t.push("pw-card--temp"),this.getCardInviteStatus(e)){case M.Lz.Yes:t.push("pw-card--outlook-yes");break;case M.Lz.No:t.push("pw-card--outlook-no");break;case M.Lz.MayBe:t.push("pw-card--outlook-maybe");break;case M.Lz.Undefined:t.push("pw-card--outlook-undefined")}return e.providerCard.isCompleted&&t.push("pw-card--completed"),t}getHiddenCardElements(){switch(this._appCommonSrv.getSchedulerView(!0)){case M.rW.OneDay:case M.rW.ThreeDay:case M.rW.Week:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!0};case M.rW.Month:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case M.rW.Timeline:switch(this._appCommonSrv.getTimelineResourcesType(!0)){case M.y.NoResources:case M.y.Calendars:case M.y.Lists:case M.y.Labels:return{calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates};case M.y.Members:return{membersIcon:!0,calendar:!this._collectionSettings.global.settings.showCalendar,dates:!this._collectionSettings.global.settings.showDates}}}}getCardMemberBackground(){}getCardCalendarName(e){var t;return null===(t=this._outlookIntegrationSrv.getOutlookCalendarById(e.accountId,e.providerCard.outlookCalendarId))||void 0===t?void 0:t.name}getCardLinks(){return[]}getDragInfo(e,t){if(0===e.length)return{canDrag:!0,allowedCardTypes:[]};if(t===F.iF)return{canDrag:!1,allowedCardTypes:[]};let r=this._appCommonSrv.getTimelineResourcesType();switch(r){case M.y.NoResources:return{canDrag:!0,allowedCardTypes:[R.eT.OutlookEvent]};case M.y.Calendars:let n=this._appCommonSrv.getTimelineResourceById(r,t);if(E()(e).call(e,(e=>{var t;return!T()(t=n.accountIds).call(t,e.accountId)})))break;let i=this._outlookIntegrationSrv.getOutlookCalendarById(n.accountIds[0],t);if(!i||i.isReadOnly)break;return{canDrag:!0,allowedCardTypes:[R.eT.OutlookEvent]}}return{canDrag:!1,allowedCardTypes:[]}}getDraggingCard(e,t,r,n){let i=(0,z.bt)(e.realStart,e.realEnd,r),a={accountId:e.accountId,isOriginCard:e.uid===t.uid,isRecurring:e.isRecurring(),recurrenceId:e.recurrenceId,recurrenceRule:e.recurrenceRule,start:e.realStart,originStart:e.realStart,newStart:e.realStart,end:e.realEnd,originEnd:e.realEnd,newEnd:e.realEnd,isAllDay:e.realIsAllDay,originIsAllDay:e.realIsAllDay,isSingleDate:e.isSingleDate,isMultiDay:()=>e.isMultiDay(),canBeMultiDay:!0,defaultDuration:N.XM,durations:i,providerType:e.providerType,providerCard:e.providerCard,cardType:e.cardType,cardRole:e.cardRole};return n&&(a.sortOrder=e.providerCard[n]),a.originDurations=_objectSpread({},a.durations),a}getDraggedCardUpdateData(e){return{isOriginCard:e.isOriginCard,start:e.newStart,end:e.newEnd,isAllDay:e.isAllDay,providerType:e.providerType,cardType:e.cardType}}getPreviewCard(e){let{accountId:t,calendarId:r,cardType:n,cardRole:i,isAllDay:a,start:o,end:l,providerCard:s={}}=e,d=this._outlookIntegrationSrv.getOutlookCalendarById(t,s.outlookCalendarId||r)||{};return{id:F.$d,accountId:t,isTempCard:!0,providerType:M.lP.Outlook,cardType:n,cardRole:i,isAllDay:a,start:o,end:l,providerCard:{outlookCalendarId:d.id,outlookAttendees:[],outlookLocations:[]}}}async updateCardByMouseAsync(e,t,r){let n={cardRole:t.cardRole,isAllDay:t.isAllDay,start:t.start,end:t.end,outlookCalendarId:t.providerCard.outlookCalendarId},i=await this._applyRecurrenceActionsAsync([e],{createException:!0,recurringMode:r.recurringMode,telemetryCallback:r.telemetryCallback,[M.f.AllSeries]:async t=>{var r;let i=e.realStart||e.start,a=e.realEnd||e.end,o=null!==(r=t.realIsAllDay)&&void 0!==r?r:t.isAllDay,l=t.realStart||t.start,s=t.realEnd||t.end;if(void 0!==n.isAllDay&&n.isAllDay!==o)if(n.isAllDay){let e=(0,z.i2)((0,z.$Y)(i),n.start);n.start=(0,z.E4)((0,z.$Y)(l),e);let t=(0,z.i2)((0,z.$Y)(a),n.end);n.end=(0,z.E4)((0,z.$Y)(s),t)}else{let e=(0,z.i2)(i,(0,z.$Y)(n.start));n.start=(0,z.E4)((0,z.q_)(l,n.start),e);let t=(0,z.i2)(a,(0,z.$Y)(n.end));n.end=(0,z.E4)((0,z.q_)(s,n.end),t)}else if(o){let e=(0,z.i2)(i,n.start);n.start=(0,z.E4)(l,e);let t=(0,z.i2)(a,n.end);n.end=(0,z.E4)(s,t)}else{let e=(0,z.CX)(i,n.start);n.start=(0,z.mH)(l,e);let t=(0,z.CX)(a,n.end);n.end=(0,z.mH)(s,t)}n.end<n.start&&(n.end=new Date(n.start)),(void 0!==n.isAllDay&&n.isAllDay!==e.isAllDay||n.start&&!(0,z.rs)(n.start,i))&&await this.deleteRecurrenceExceptionsAsync(t)},properties:new($())([[e.id,n]])});await S().all(m()(i).call(i,(e=>{try{return e=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(e,n,{immediateUpdate:!0})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.updateCardByMouseAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),M.k$.Error)}})))}getUpdateByMouseTelemetry(e,t,r){let n;var i;if(r)n={event:M.cN.CardEvents.Resized,data:{isAllDay:null!==(i=t.isAllDay)&&void 0!==i?i:e.isAllDay,start:t.start,end:t.end}};else if(t.isAllDay!==e.isAllDay||!(0,z.rs)(t.start,e.realStart||e.start)||!(0,z.rs)(t.end,e.realEnd||e.end)||void 0!==t.providerCard.outlookCalendarId&&t.providerCard.outlookCalendarId===e.providerCard.outlookCalendarId){var a;if(void 0!==t.providerCard.outlookCalendarId&&t.providerCard.outlookCalendarId===e.providerCard.outlookCalendarId)n={event:M.cN.CardEvents.LaneChanged,data:{calendarId:null!==(a=t.providerCard.outlookCalendarId)&&void 0!==a?a:e.calendarId}};else if(!(0,z.rs)(t.start,e.realStart||e.start)||!(0,z.rs)(t.end,e.realEnd||e.end)){var o;n={event:M.cN.CardEvents.Moved,data:{isAllDay:null!==(o=t.isAllDay)&&void 0!==o?o:e.isAllDay,start:t.start,end:t.end}}}}return n}createCardByExternalCall(e,t,r,n,i,a){const{cardType:o}=a;let l={isAllDay:i,start:r,end:n};if(o===R.eT.OutlookEvent)l.providerCard={outlookCalendarId:t};return this._calendarCardsSrv.createTempCalendarCard(e,o,l)}createCardByClick(e,t){let r={cardRole:t.cardRole,isAllDay:t.isAllDay,start:t.start,end:t.end,providerCard:{outlookCalendarId:t.providerCard.outlookCalendarId,outlookOrganizer:{email:this._getUserEmail(e),self:!0}}};return this._calendarCardsSrv.createTempCalendarCard(e,t.cardType,r)}createCardByDropAsync(){}createTimeRecordCardByClick(){}createTimeRecordCardByDropAsync(){}get availableCardTypes(){return[R.eT.OutlookEvent]}get defaultCardType(){return R.eT.OutlookEvent}get availableCardRoles(){return[R.D.Card]}get defaultCardRole(){return R.D.Card}getCardTimeDurationText(){}getTotalCardsTimeDurationInDay(){return 0}hasEstimation(){return!1}hasTrackedTime(){return!1}isHotkeyAvailable(e,t,r){var n;return!!T()(n=X[e.cardType]).call(n,t)&&(e.cardType===R.eT.OutlookEvent&&(!e.isReadOnly&&(t===M.VD.E||(t===M.VD.Space||t===M.VD.M||!(t!==M.VD.Delete&&t!==M.VD.Backspace||!r.shiftKey&&!r.metaKey)))))}updateCardsByHotkey(e,t,r,n,i){let a,o;if(n!==M.LP.Scheduler)throw new Error(`Unsupported hotkey source: ${n}`);a=M.a6.Scheduler,o=M.xI.Scheduler;let l={telemetry:{where:a,by:M.AH.Hotkey}};switch(t){case M.VD.E:this.toggleCardsIsCompletedAsync(e,l);break;case M.VD.M:{if(1!==e.length)break;let t=e[0];i.scope().$broadcast(M.FK.OpenNestedContextMenuRequested,{calendarCard:t,nestedMenu:"outlook-attendees",source:o,sourceElement:i});break}case M.VD.Space:let t=(0,z.vM)(e,"accountId");for(let[e,r]of t)this.toggleEventsAttendeeAsync(r,{email:this._getUserEmail(e)},l);break;case M.VD.Delete:case M.VD.Backspace:(r.shiftKey||r.metaKey)&&this.deleteCardsAsync(e,l)}}async toggleEventsAttendeeAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=k()(e).call(e,(e=>{var r;if(!this.canModifyInScheduler(e)||e.isReadOnly)return!1;return E()(r=e.providerCard.outlookAttendees).call(r,(e=>e.emailAddress.address===t.email))?e.providerCard.canModify&&e.providerCard.outlookOrganizer.self:e.providerCard.canInviteOthers}));if(0===n.length)return;let i=await this.getRecurringModeAsync(e,M.aO.Edit,r.applyRecurringActionToHead);if(null===i)return;let telemetryCallback=e=>{var n;let a=E()(n=e.providerCard.outlookAttendees).call(n,(e=>e.emailAddress.address===t.email)),o=t.email===this._getUserEmail(e.accountId),l=a?o?M.cN.CardEvents.MemberUnassignedSelf:M.cN.CardEvents.MemberUnassigned:o?M.cN.CardEvents.MemberAssignedSelf:M.cN.CardEvents.MemberAssigned;this.logCardEvent(e,l,_objectSpread(_objectSpread({},r.telemetry),{},{recurringMode:i}))};i&&(n=await this._applyRecurrenceActionsAsync(n,{createException:!0,recurringMode:i,telemetryCallback,[M.f.OnlyOccurrence]:e=>{e.providerCard.outlookAttendees=(0,U.G0)(e,t,this._getUserEmail(e.accountId))},[M.f.ThisAndFollowing]:e=>{e.providerCard.outlookAttendees=(0,U.G0)(e,t,this._getUserEmail(e.accountId))}}),0===n.length)||await S().all(m()(n).call(n,(e=>{try{let r=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id),n={outlookAttendees:(0,U.G0)(r,t,this._getUserEmail(r.accountId))};return telemetryCallback(r),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(r,n)}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.toggleEventsAttendeeAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),M.k$.Error)}})))}async toggleCardsIsCompletedAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(E()(e).call(e,(e=>!this.canModifyInScheduler(e))))return;let r=k()(e).call(e,(e=>!e.isReadOnly));if(0===r.length)return;let n=await this.getRecurringModeAsync(e,M.aO.Edit,t.applyRecurringActionToHead);if(null===n)return;let telemetryCallback=e=>{let r,i,a=e.providerCard.isCompleted;if(e.cardType===R.eT.TrelloCheckItem)r=this._calendarCardsSrv.getCalendarCardById(e.accountId,R.eT.TrelloCard,e.providerCard.parentId),i=a?M.cN.CardEvents.CheckItemMarkedIncompleted:M.cN.CardEvents.CheckItemMarkedCompleted;else r=e,i=a?M.cN.CardEvents.MarkedIncompleted:M.cN.CardEvents.MarkedCompleted;this.logCardEvent(r,i,_objectSpread(_objectSpread({},t.telemetry),{},{recurringMode:n}))};if(n&&(r=await this._applyRecurrenceActionsAsync(r,{createException:!0,recurringMode:n,telemetryCallback,[M.f.OnlyOccurrence]:e=>{e.providerCard.isCompleted=!e.providerCard.isCompleted},[M.f.ThisAndFollowing]:e=>{e.providerCard.isCompleted=!e.providerCard.isCompleted}}),0===r.length))return;let i=!0;await S().all(m()(r).call(r,(e=>{try{let t=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id);return telemetryCallback(t),this._calendarCardsSrv.updateCalendarCardPropertiesAsync(t,{isCompleted:!t.providerCard.isCompleted})}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway card updating error",e,{class:this.constructor.name,method:this.toggleCardsIsCompletedAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),M.k$.Error),i=!1}}))),i&&this._incrementActionCounter()}async deleteCardsAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=k()(e).call(e,(e=>!e.isReadOnly));if(0===r.length)return;let n=await this.getRecurringModeAsync(e,M.aO.Delete,t.applyRecurringActionToHead);if(null===n)return;let telemetryCallback=e=>{this.logCardEvent(e,M.cN.CardEvents.Deleted,_objectSpread(_objectSpread({},t.telemetry),{},{recurringMode:n}))};if(t.forceConfirm||!n){let e=r.length;if(!await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.DELETE_OUTLOOK_EVENT_TITLE"),1===e?this._$translate.instant("DIALOGS.DELETE_OUTLOOK_EVENT_CONFIRM"):this._$translate.instant("DIALOGS.DELETE_OUTLOOK_EVENT_CONFIRM_MULTIPLE",{cardsCount:e}),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))return}n&&(r=await this._applyRecurrenceActionsAsync(r,{createException:!1,recurringMode:n,telemetryCallback,[M.f.AllSeries]:e=>{(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(e.cardType,e)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this.deleteCardsAsync.name})}})()}}),0===r.length)||await S().all(m()(r).call(r,(e=>{try{let t=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.cardType,e.id);return telemetryCallback(t),this._calendarCardsSrv.deleteCalendarCardAsync(t)}catch(e){this._$log.error("Planyway delete card error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card error",e,{class:this.constructor.name,method:this.deleteCardsAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_OUTLOOK_EVENT_ERROR"),M.k$.Error)}})))}_incrementActionCounter(){switch(this._appCommonSrv.getSchedulerMode()){case M.ud.Board:this._onboardingSrv.incrementActionCounter(M.Us.BoardCreate);break;case M.ud.Calendar:this._onboardingSrv.incrementActionCounter(M.Us.CalendarCreate);break;case M.ud.Timeline:this._onboardingSrv.incrementActionCounter(M.Us.TimelineCreate);break;case M.ud.TimeTracking:this._onboardingSrv.incrementActionCounter(M.Us.TimeTrackingCreate)}}getThirdPartyUserId(e){return e.outlookUserId}logCardEvent(e,t){var r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._telemetrySrv.logSessionEvent(t,_objectSpread({accountId:e.accountId,calendarId:e.calendarId,isAllDay:e.isAllDay,start:e.realStart||e.start,end:e.realEnd||e.end,cardType:e.cardType,cardRole:e.cardRole,isNewCard:null!==(r=e.isTempCard)&&void 0!==r&&r,recurrenceRule:e.recurrenceHeadRule||e.recurrenceRule},n))}getCardInviteStatus(e){return e.providerCard.outlookInviteStatus}_getUserEmail(e){return this._outlookIntegrationSrv.getOutlookUser(e).email}}},25913:(e,t,r)=>{r.d(t,{Z:()=>je});var n=r(40024),i=r.n(n),a=r(88946),o=r.n(a),l=r(99595),s=r.n(l),d=r(57445),c=r.n(d),u=r(51791),h=r.n(u),p=r(90143),v=r.n(p),f=r(56626),C=r.n(f),m=r(67552),y=r.n(m),k=r(86981),_=r.n(k),g=r(26881),w=r(29704);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let E=function _decorate(e,t,r,n){var i,a=_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(_isDataDescriptor(i.descriptor)||_isDataDescriptor(n.descriptor)){if(_hasDecorators(i)||_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(_hasDecorators(i)){if(_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["$scope","outlookIntegrationSrv"])],(function(e){return{F:class CalendarIconController{constructor(t,r){e(this),this._$scope=t,this._outlookIntegrationSrv=r,this._iconSize="small",this._$scope.$on("$destroy",(()=>{this._onOutlookCalendarUpdated&&(this._outlookIntegrationSrv.removeOutlookCalendarEventListener("updated",this._onOutlookCalendarUpdated),this._onOutlookCalendarUpdated=null)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookCalendarIconCtrl"}},{kind:"get",key:"iconSize",value:function iconSize(){return this._iconSize}},{kind:"set",key:"calendarId",value:function calendarId(e){this._calendarId=e,this._loadCalendar()}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e,this._loadCalendar()}},{kind:"get",key:"calendarColor",value:function calendarColor(){return this._calendarColor}},{kind:"method",key:"_loadCalendar",value:function _loadCalendar(){if(!this._calendarId||!this._accountId)return;let e=this._outlookIntegrationSrv.getOutlookCalendarById(this._accountId,this._calendarId);if(e){let t=e.color.base,r=this._calendarColor!==t;this._calendarColor=t,r&&this._$scope.$broadcast("$$rebind::calendar")}this._onOutlookCalendarUpdated||(this._onOutlookCalendarUpdated=e=>{e.id===this._calendarId&&(this._loadCalendar(),this._$scope.$broadcast("$$rebind::calendar"))},this._outlookIntegrationSrv.addOutlookCalendarEventListener("updated",this._onOutlookCalendarUpdated))}}]}}));var D=r(62079),S=r.n(D),A=r(52020),b=r.n(A),I=r(88546),T=r.n(I),O=r(66775),P=r.n(O),x=r(2201),$=r.n(x),R=r(26171),N=r(73324),M=r.n(N),F=r(91829),z=r.n(F),L=r(87994),U=r.n(L),B=r(8244),K=r.n(B),j=r(56777),G=(r(3884),r(8937)),V=r(42191),H=r.n(V);function ownKeys(e,t){var r=S()(e);if(b()){var n=b()(e);t&&(n=M()(n).call(n,(function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}function CalendarPickerController_getDecoratorsApi(){CalendarPickerController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CalendarPickerController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarPickerController_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarPickerController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarPickerController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarPickerController_createElementDescriptor(e){var t,r=CalendarPickerController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CalendarPickerController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarPickerController_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarPickerController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarPickerController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarPickerController_toPropertyKey(e){var t=function CalendarPickerController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let q=function CalendarPickerController_decorate(e,t,r,n){var i,a=CalendarPickerController_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CalendarPickerController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CalendarPickerController_isDataDescriptor(i.descriptor)||CalendarPickerController_isDataDescriptor(n.descriptor)){if(CalendarPickerController_hasDecorators(i)||CalendarPickerController_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CalendarPickerController_hasDecorators(i)){if(CalendarPickerController_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CalendarPickerController_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CalendarPickerController_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["$scope","licenseSrv","outlookIntegrationSrv","platformSrv"])],(function(e){return{F:class CalendarPickerController{constructor(t,r,n,i){e(this),this._$scope=t,this._licenseSrv=r,this._outlookIntegrationSrv=n,this._platformSrv=i}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookCalendarPickerCtrl"}},{kind:"field",key:"_provider",value:()=>(0,j.VH)(G.lP.Outlook)},{kind:"field",key:"account",value:void 0},{kind:"get",key:"filterText",value:function filterText(){return this._filterText||""}},{kind:"set",key:"filterText",value:function filterText(e){this._filterText=e,this._filteredCalendars=null}},{kind:"get",key:"filteredCalendars",value:function filteredCalendars(){var e;this._filteredCalendars||(this._filteredCalendars=M()(e=this.calendars).call(e,(e=>{var t;return z()(t=e.name.toLowerCase()).call(t,this.filterText.toLowerCase())})));return this._filteredCalendars}},{kind:"get",key:"calendars",value:function calendars(){if(!this._calendars){var e,t,r,n;let l=U()(e=M()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>e!==this.account.accountId))).call(e,(e=>this._provider.getCurrentCollectionConnectedCalendarIds(e)));var i;if(this._calendars=o()(r=M()(n=this._outlookIntegrationSrv.getOutlookCalendars(this.account.accountId)).call(n,(e=>!z()(l).call(l,e.id)))).call(r,(e=>{e=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?s()(r=ownKeys(Object(i),!0)).call(r,(function(t){(0,R.Z)(e,t,i[t])})):P()?$()(e,P()(i)):s()(n=ownKeys(Object(i))).call(n,(function(t){c()(e,t,T()(i,t))}))}return e}({},e);let t=this._provider.getCurrentCollectionConnectedCalendar(this.account.accountId,e.id);return c()(e,"isConnected",{get:()=>t.isConnected,set:e=>{(!e||this.account.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(G.ZV.OutlookConnect,!0))&&(t.isConnected=e)}}),e})),this.account.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(G.ZV.OutlookConnect,!1))if(K()(i=this._calendars).call(i,(e=>!e.isConnected))){var a;let e=_()(a=this._calendars).call(a,(e=>e.isPrimary));e&&(e.isConnected=!0)}}return this._calendars}},{kind:"set",key:"calendars",value:function calendars(e){this._calendars=e}},{kind:"get",key:"notFoundImgUrl",value:function notFoundImgUrl(){return this._platformSrv.getPlatformUrl(H())}}]}}));var Z=r(27525),W=r.n(Z),Y=r(76555),Q=r.n(Y),X=r(45181),J=r.n(X),ee=r(19755),te=r.n(ee),re=r(83999),ne=r(82617);function CardContextMenuController_ownKeys(e,t){var r=S()(e);if(b()){var n=b()(e);t&&(n=M()(n).call(n,(function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}function CardContextMenuController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?s()(r=CardContextMenuController_ownKeys(Object(i),!0)).call(r,(function(t){(0,R.Z)(e,t,i[t])})):P()?$()(e,P()(i)):s()(n=CardContextMenuController_ownKeys(Object(i))).call(n,(function(t){c()(e,t,T()(i,t))}))}return e}function CardContextMenuController_getDecoratorsApi(){CardContextMenuController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CardContextMenuController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardContextMenuController_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardContextMenuController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardContextMenuController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardContextMenuController_createElementDescriptor(e){var t,r=CardContextMenuController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CardContextMenuController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardContextMenuController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardContextMenuController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardContextMenuController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardContextMenuController_toPropertyKey(e){var t=function CardContextMenuController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ie="complete",ae="attendees",oe="copyUrl",le="delete",se={[ne.eT.OutlookEvent]:[ie,ae,oe,le]};let de=function CardContextMenuController_decorate(e,t,r,n){var i,a=CardContextMenuController_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CardContextMenuController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CardContextMenuController_isDataDescriptor(i.descriptor)||CardContextMenuController_isDataDescriptor(n.descriptor)){if(CardContextMenuController_hasDecorators(i)||CardContextMenuController_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CardContextMenuController_hasDecorators(i)){if(CardContextMenuController_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CardContextMenuController_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CardContextMenuController_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["$element","$scope","collectionSrv","licenseSrv","outlookIntegrationSrv"])],(function(e){return{F:class CardContextMenuController{constructor(t,r,n,i,a){e(this),this._$element=t,this._$scope=r,this._collectionSrv=n,this._licenseSrv=i,this._outlookIntegrationSrv=a,this._$scope.$on(G.FK.OpenNestedContextMenuRequested,((e,t)=>{const{calendarCard:r,nestedMenu:n,source:i,sourceElement:a}=t;if(r.providerType!==G.lP.Outlook||this._source!==i)return;let o=new(te().Event)("contextmenu",{target:_()(a).call(a,`.k-event[data-uid="${r.uid}"]`)[0]}),l=this._getContextMenuScope(n);l&&(this._cardContextMenu=l.$mdMenu,this.setCardContextMenu(this._cardContextMenu),this.cardContextMenu.open(o,r),l.$once("$pwContextMenuClosed",(()=>{let e=this._getContextMenuScope("outlook-context");e&&(this._cardContextMenu=e.$mdMenu,this.setCardContextMenu(this._cardContextMenu))})))}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookEventContextMenuCtrl"}},{kind:"field",key:"_provider",value:()=>(0,j.VH)(G.lP.Outlook)},{kind:"get",key:"source",value:function source(){return this._source}},{kind:"set",key:"source",value:function source(e){this._source=e}},{kind:"set",key:"onSetContextMenu",value:function onSetContextMenu(e){this._onSetContextMenu=e}},{kind:"get",key:"cardContextMenu",value:function cardContextMenu(){return this._cardContextMenu}},{kind:"method",key:"setCardContextMenu",value:function setCardContextMenu(e){this._cardContextMenu=e,this._onSetContextMenu({providerType:G.lP.Outlook,menuController:this._cardContextMenu})}},{kind:"method",key:"isContextMenuItemAvailable",value:function isContextMenuItemAvailable(){if(!this.cardContextMenu)return!1;let e=this.cardContextMenu.pwData;if(!e)return!1;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return W()(r).call(r,(t=>{var r,n,i;if(!(null===(r=se[e.cardType])||void 0===r?void 0:z()(r).call(r,t)))return!1;switch(t){case ie:return!e.isReadOnly;case ae:return!e.isReadOnly&&this.getContextMenuAttendees(e).length>0;case"copyAsTimeRecord":return W()(n=M()(i=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(i,(e=>e.timeTrackingCardType))).call(n,(e=>{var t;return W()(t=e.getCurrentCollectionConnectedAccountIds()).call(t,(t=>e.getCurrentCollectionSelectedCalendarIds(t).length>0))}));case"copyUrl":return!e.isTempCard;case le:return!e.isReadOnly}return!0}))}},{kind:"method",key:"getContextMenuAttendees",value:function getContextMenuAttendees(e){var t;if(!e)return[];if(!this._contextMenuAttendees||this._contextMenuAttendees.calendarCard!==e){var r;this._contextMenuAttendees={calendarCard:e};let t=[];t.push(...o()(r=this._outlookIntegrationSrv.getOutlookContacts(e.accountId)).call(r,(e=>CardContextMenuController_objectSpread(CardContextMenuController_objectSpread({},e),{},{memberType:G.wO.Outlook}))));for(let r of e.providerCard.outlookAttendees)W()(t).call(t,(e=>e.email===r.emailAddress.address))||t.push(CardContextMenuController_objectSpread(CardContextMenuController_objectSpread({},this._outlookIntegrationSrv.getFakeContact(r.emailAddress.address)),{},{memberType:G.wO.Outlook}));this._newContactEmail&&t.push(CardContextMenuController_objectSpread(CardContextMenuController_objectSpread({},this._outlookIntegrationSrv.getFakeContact(this._newContactEmail)),{},{memberType:G.wO.Outlook,isFakeFromSearch:!0})),this._contextMenuAttendees.availableAttendees=t}return Q()(t=this._contextMenuAttendees.availableAttendees).call(t,((t,r)=>(0,w.GI)(CardContextMenuController_objectSpread(CardContextMenuController_objectSpread({},t),{},{isSelected:this.isContextMenuAttendeeSelected(e,t)}),CardContextMenuController_objectSpread(CardContextMenuController_objectSpread({},r),{},{isSelected:this.isContextMenuAttendeeSelected(e,r)})))),this._contextMenuAttendees.availableAttendees}},{kind:"method",key:"isContextMenuAttendeeSelected",value:function isContextMenuAttendeeSelected(e,t){var r;return!!e&&W()(r=e.providerCard.outlookAttendees).call(r,(e=>e.emailAddress.address===t.email))}},{kind:"get",key:"attendeeFilter",value:function attendeeFilter(){return this._attendeeFilter}},{kind:"set",key:"attendeeFilter",value:function attendeeFilter(e){this._attendeeFilter=e;let t=null;if(e){var r,n;this._attendeeFilterRegex=(0,w.n0)(e);let i=e.toLowerCase();!(0,re.G)(e)||null!==(r=this._contextMenuAttendees)&&void 0!==r&&null!==(n=r.availableAttendees)&&void 0!==n&&W()(n).call(n,(e=>e.email.toLowerCase()===i))||(t=e)}this._$scope.$evalAsync((()=>{this._newContactEmail=t,this._contextMenuAttendees=null}))}},{kind:"method",key:"filterAttendeesByFullNameAndEmail",value:function filterAttendeesByFullNameAndEmail(){return e=>{return!this.attendeeFilter||(!!this._attendeeFilterRegex.test(e.fullName)||!!e.email&&(J()(t=e.email).call(t,this.attendeeFilter)||this._attendeeFilterRegex.test(e.email.split("@")[0])));var t}}},{kind:"method",key:"toggleEventAttendee",value:function toggleEventAttendee(e,t){this._provider.toggleEventsAttendeeAsync([e],t,{telemetry:{where:this._cardContextMenu.where,by:G.AH.ContextMenu}})}},{kind:"method",key:"toggleCardIsCompleted",value:function toggleCardIsCompleted(e){this._provider.toggleCardsIsCompletedAsync([e],{applyRecurringActionToHead:this._cardContextMenu.applyRecurringActionToHead,telemetry:{where:this._cardContextMenu.where,by:G.AH.ContextMenu}})}},{kind:"method",key:"copyCardAsTimeRecord",value:function copyCardAsTimeRecord(e){this._licenseSrv.checkPaidFeatureAvailable(G.ZV.TimeTracking,!0)&&this._provider.copyCardAsTimeRecordAsync(e)}},{kind:"method",key:"copyCardUrl",value:function copyCardUrl(e){this._provider.copyCardUrlAsync(e,{telemetry:{where:this._cardContextMenu.where,by:G.AH.ContextMenu}})}},{kind:"method",key:"deleteCard",value:function deleteCard(e){this._provider.deleteCardsAsync([e],{telemetry:{where:this._cardContextMenu.where,by:G.AH.ContextMenu}})}},{kind:"method",key:"_getContextMenuScope",value:function _getContextMenuScope(e){var t;let r=_()(t=this._$element).call(t,`md-menu[data-menu='${e}']`);if(0!==r.length)return r.scope()}}]}}));var ce=r(23513),ue=r.n(ce),he=r(84705),pe=r.n(he),ve=r(35820),fe=r.n(ve),Ce=r(40405),me=r.n(Ce),ye=r(88078),ke=r(41092),_e=r(46930);function CardEditorController_ownKeys(e,t){var r=S()(e);if(b()){var n=b()(e);t&&(n=M()(n).call(n,(function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}function CardEditorController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?s()(r=CardEditorController_ownKeys(Object(i),!0)).call(r,(function(t){(0,R.Z)(e,t,i[t])})):P()?$()(e,P()(i)):s()(n=CardEditorController_ownKeys(Object(i))).call(n,(function(t){c()(e,t,T()(i,t))}))}return e}function CardEditorController_getDecoratorsApi(){CardEditorController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CardEditorController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardEditorController_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardEditorController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardEditorController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardEditorController_createElementDescriptor(e){var t,r=CardEditorController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CardEditorController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardEditorController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardEditorController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardEditorController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardEditorController_toPropertyKey(e){var t=function CardEditorController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ge="complete",we="openInSource",Ee="copyUrl",De="deleteCard",Se={[ne.eT.OutlookEvent]:[ge,we,Ee,De]};let Ae=function CardEditorController_decorate(e,t,r,n){var i,a=CardEditorController_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CardEditorController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CardEditorController_isDataDescriptor(i.descriptor)||CardEditorController_isDataDescriptor(n.descriptor)){if(CardEditorController_hasDecorators(i)||CardEditorController_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CardEditorController_hasDecorators(i)){if(CardEditorController_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CardEditorController_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CardEditorController_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["$element","$rootScope","$scope","$log","$window","$timeout","$translate","appCommonSrv","calendarCardsSrv","dialogSrv","notificationSrv","outlookIntegrationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class CardEditorController{constructor(t,r,n,i,a,o,l,s,d,c,u,h,p,v,f,C){e(this),this._$element=t,this._$rootScope=r,this._$scope=n,this._$log=i,this._$window=a,this._$timeout=o,this._$translate=l,this._appCommonSrv=s,this._calendarCardsSrv=d,this._dialogSrv=c,this._notificationSrv=u,this._outlookIntegrationSrv=h,this._planywayIntegrationSrv=p,this._platformSrv=v,this._settingsSrv=f,this._telemetrySrv=C;const m=te()("body");let y;this._selectedCalendars=null,this._isDescriptionEditing=!1,this._isNewCardValid=!0,this._$scope.$on(G.FK.OutlookCalendarSelectionChanged,(()=>this._selectedCalendars=null)),this._$scope.$on(G.FK.CardTypeChanged,(()=>this._providerWhitelist=null)),this._$timeout((()=>{this._renderDelayed=!0,this._$scope.$broadcast("md-resize-textarea")}),150),this._$scope.$on(G.FK.CardDialogKeyDown,((e,t)=>{let{keyboardEvent:r}=t;te()(r.target).is("input, textarea")?this._onInputKeyDown(r):this._onEditorKeyDown(r)})),this._$element.on("mousedown",(e=>{y=!(!te()(e.target).is("input, textarea")&&!_()(m).call(m,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0])})),this._$element.on("click",(()=>{var e;y||(null===(e=this.clickRequester)||void 0===e||e.click(),this.clickRequester=null)})),this._$element.on("click",".pw-js-dialog-edit-card-description-render",(e=>{this.isBusy||this.isReadOnly||te()(e.target).closest("a")[0]||this._$window.getSelection().toString()||(this.isDescriptionEditing=!0)})),this._$element.on("focus",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!0})),this._$element.on("blur",".pw-js-dialog-edit-card-description-input",(()=>{this.isDescriptionEditing=!1})),this._$scope.$on("$destroy",(()=>{this._removeServiceListeners(),this.isNewCard&&!this._isSaveCardCalled&&this._clearCardData(),this._keepScrollFocus()})),this._registerEditor(),this.$onInit=()=>{const updateTitle=()=>{this._logCardEvent({event:G.cN.CardEvents.TitleChanged}),this._setCardPropertiesAsync({title:this.title})};this._updateTitle=this.isNewCard?me()(updateTitle,300):updateTitle}}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookEventEditorCtrl"}},{kind:"field",key:"_provider",value:()=>(0,j.VH)(G.lP.Outlook)},{kind:"field",key:"calendarCard",value:void 0},{kind:"field",key:"isDetailed",value:void 0},{kind:"field",key:"isDense",value:void 0},{kind:"field",key:"hasChanges",value:void 0},{kind:"field",key:"_forceDetailedMode",value:void 0},{kind:"field",key:"clickRequester",value:void 0},{kind:"get",key:"calendarAccountId",value:function calendarAccountId(){return void 0===this._calendarAccountId&&(this._calendarAccountId=this.isNewCard?null:this.calendarCard.accountId),this._calendarAccountId}},{kind:"get",key:"setCalendarHandler",value:function setCalendarHandler(){return this._setCalendarHandler||(this._setCalendarHandler=e=>{let t=this._planywayIntegrationSrv.getConnectedAccountById(e.accountId);if(t.accountType===ne.Qm.Outlook)this._moveToOutlookCalendarAsync(e),this._logCardEvent({event:G.cN.CardEvents.OutlookCalendarChanged,data:{accountId:e.accountId,calendarId:e.id}});else{let r=(0,j.fL)(t.accountType);if(!r)return;this._logCardEvent({event:G.cN.CardEvents.CardProviderChanged,data:{providerType:r,accountId:e.accountId,calendarId:e.id}}),this._tmpAccountId=e.accountId,this._tmpCalendarId=e.id,this.calendarCard.providerType=r}}),this._setCalendarHandler}},{kind:"get",key:"providerWhitelist",value:function providerWhitelist(){return this._providerWhitelist||this.isNewCard||(this._providerWhitelist=[G.lP.Outlook]),this._providerWhitelist}},{kind:"method",key:"isCardButtonVisible",value:function isCardButtonVisible(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return W()(t).call(t,(e=>{var t;if(!(null===(t=Se[this.calendarCard.cardType])||void 0===t?void 0:z()(t).call(t,e)))return!1;switch(e){case we:return!this.isNewCard&&this.cardUrl;case Ee:return!this.isNewCard;case De:return!this.isReadOnly;default:return!0}}))}},{kind:"method",key:"cancelDialog",value:function cancelDialog(){this.hideDialog(G.Xs.Cancelled)}},{kind:"get",key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this.isCompleted!==e&&(this._isCompleted=e,this._logCardEvent({event:e?G.cN.CardEvents.MarkedCompleted:G.cN.CardEvents.MarkedIncompleted,data:{by:G.AH.Dialog}}),this._setCardPropertiesAsync({isCompleted:e}))}},{kind:"get",key:"title",value:function title(){return this._title}},{kind:"set",key:"title",value:function title(e){this.title!==e&&(this.isNewCard||e)&&(this._title=e,this._updateTitle())}},{kind:"get",key:"hasDates",value:function hasDates(){return this.calendarCard.hasDates}},{kind:"get",key:"isCardDatesYearShown",value:function isCardDatesYearShown(){return!(0,w.FT)(this.startDate,new Date)||!(0,w.FT)(this.endDate,new Date)}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this.isAllDay!==e&&(this._isAllDay=e,this.isAllDay?(this._startDate=(0,w.$Y)(this.startDate),this._endDate=this.endDate):(this._startDate=(0,w.nT)(this.startDate),this._endDate=(0,w.mH)((0,w.nT)(this.endDate),_e.XM)),this._logCardEvent({event:e?G.cN.CardEvents.IsAllDaySet:G.cN.CardEvents.IsAllDayUnset}),this._setCardPropertiesAsync({isAllDay:e,start:this.startDate,end:this.endDate}))}},{kind:"get",key:"startDate",value:function startDate(){return this._startDate}},{kind:"set",key:"startDate",value:function startDate(e){if(e&&!(0,w.rs)(this.startDate,e))if(this.hasDates){if(this.isAllDay){let t=(0,w.i2)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,w.E4)(this.startDate,t)}else{let t=(0,w.CX)(this.startDate,this.endDate);this._startDate=e,this._endDate=(0,w.mH)(this.startDate,t)}this._logCardEvent({event:G.cN.CardEvents.StartChanged}),this._setCardPropertiesAsync({start:e,end:this.endDate})}else this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:G.cN.CardEvents.Scheduled,data:{by:G.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})}},{kind:"get",key:"endDate",value:function endDate(){return this._endDate}},{kind:"set",key:"endDate",value:function endDate(e){e&&!(0,w.rs)(this.endDate,e)&&(this.hasDates?(this._endDate=e,this._logCardEvent({event:G.cN.CardEvents.EndChanged}),this._setCardPropertiesAsync({end:e})):(this._isAllDay=!0,this._startDate=e,this._endDate=e,this._isNewCardValid=!0,this._logCardEvent({event:G.cN.CardEvents.Scheduled,data:{by:G.AH.SetDates}}),this._setCardPropertiesAsync({isAllDay:this.isAllDay,start:e,end:e})))}},{kind:"get",key:"isRecurringAvailable",value:function isRecurringAvailable(){return!(this.isReadOnly&&!this.recurrenceRule)&&(this.hasDates&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this.recurrenceRule!==e&&(this._recurrenceRule=e,this._logCardEvent({event:G.cN.CardEvents.RecurrenceRuleChanged,data:{recurrenceRule:e}}),this._setCardPropertiesAsync({recurrenceRule:e}))}},{kind:"get",key:"isRecurrentCard",value:function isRecurrentCard(){return!(!this.recurrenceRule&&!this.calendarCard.recurrenceId)}},{kind:"get",key:"calendarColor",value:function calendarColor(){if(this.cardOutlookCalendar)return this._calendarColor||(this._calendarColor={colorName:this.cardOutlookCalendar.colorName,color:this.cardOutlookCalendar.color.light}),this._calendarColor}},{kind:"get",key:"selectedCalendars",value:function selectedCalendars(){var e;null===this._selectedCalendars&&(this._selectedCalendars=U()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{let t=this._provider.getCurrentCollectionSelectedCalendarIds(e);return o()(t).call(t,(t=>this._outlookIntegrationSrv.getOutlookCalendarById(e,t)))})));return this._selectedCalendars}},{kind:"get",key:"cardOutlookCalendar",value:function cardOutlookCalendar(){return this._cardOutlookCalendar}},{kind:"method",key:"setCardOutlookCalendar",value:function setCardOutlookCalendar(e,t){this._cardOutlookCalendar=this._outlookIntegrationSrv.getOutlookCalendarById(e,t)}},{kind:"get",key:"outlookCalendars",value:function outlookCalendars(){return this._outlookCalendars||(this._outlookCalendars=this._outlookIntegrationSrv.getOutlookCalendars(this.calendarCard.accountId),this.setCardOutlookCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.outlookCalendarId)),this._outlookCalendars}},{kind:"get",key:"availableShowAsStatuses",value:function availableShowAsStatuses(){return this._availableShowAsStatuses||(this._availableShowAsStatuses=[{title:this._$translate.instant("MENU.OUTLOOK_EVENT_FREE"),value:G.X3.Free},{title:this._$translate.instant("MENU.OUTLOOK_EVENT_ELSEWHERE"),value:G.X3.WorkingElsewhere},{title:this._$translate.instant("MENU.OUTLOOK_EVENT_TENTATIVE"),value:G.X3.Tentative},{title:this._$translate.instant("MENU.OUTLOOK_EVENT_BUSY"),value:G.X3.Busy},{title:this._$translate.instant("MENU.OUTLOOK_EVENT_OOF"),value:G.X3.Oof}]),this._availableShowAsStatuses}},{kind:"get",key:"eventShowAs",value:function eventShowAs(){return this._eventShowAs}},{kind:"set",key:"eventShowAs",value:function eventShowAs(e){this._eventShowAs!==e&&(this._eventShowAs=e,this._logCardEvent({event:G.cN.CardEvents.AvailabilityChanged,data:{showAs:this.eventShowAs.value}}),this._setCardPropertiesAsync({outlookShowAs:this.eventShowAs.value}))}},{kind:"get",key:"eventAttendees",value:function eventAttendees(){if(this.delayRender)return[];if(!this.cardOutlookCalendar)return[];if(!this._eventAttendees){var e,t,r,n;let a=new(ue())(o()(e=this._outlookIntegrationSrv.getOutlookRooms(this.calendarCard.accountId)).call(e,(e=>{let{email:t}=e;return t})));var i;if(this._eventAttendees=Q()(t=o()(r=M()(n=this.calendarCard.providerCard.outlookAttendees).call(n,(e=>!a.has(e.emailAddress.address)))).call(r,(e=>{var t,r,n;let i=this._outlookIntegrationSrv.getOutlookContactByEmail(this.calendarCard.accountId,e.emailAddress.address);i||(i=this._outlookIntegrationSrv.getFakeContact(e.emailAddress.address));let a=!1;return i.email===(null===(t=this.calendarCard.providerCard.outlookOrganizer)||void 0===t?void 0:t.email)&&(a=!0),CardEditorController_objectSpread(CardEditorController_objectSpread({},i),{},{accountId:this.calendarCard.accountId,status:a?_()(r=this.availableInviteStatuses).call(r,(e=>e.value===G.Lz.Yes)):_()(n=this.availableInviteStatuses).call(n,(t=>t.value===e.status.response))})}))).call(t,w.GI),this.calendarCard.providerCard.outlookInviteStatus)this._inviteStatus=_()(i=this.availableInviteStatuses).call(i,(e=>e.value===this.calendarCard.providerCard.outlookInviteStatus))}return this._eventAttendees}},{kind:"get",key:"availableAttendees",value:function availableAttendees(){if(this.delayRender)return[];if(!this.cardOutlookCalendar)return[];if(!this._availableAttendees){var e,t,r,n;let a=new(ue())(o()(e=this._outlookIntegrationSrv.getOutlookRooms(this.calendarCard.accountId)).call(e,(e=>{let{email:t}=e;return t})));this._availableAttendees=o()(t=M()(r=this._outlookIntegrationSrv.getOutlookContacts(this.calendarCard.accountId)).call(r,(e=>!a.has(e.email)))).call(t,(e=>{var t;return CardEditorController_objectSpread(CardEditorController_objectSpread({},e),{},{accountId:this.calendarCard.accountId,memberType:G.wO.Outlook,isSelected:W()(t=this.eventAttendees).call(t,(t=>t.email===e.email))})}));for(let e of this.calendarCard.providerCard.outlookAttendees){var i;W()(i=this._availableAttendees).call(i,(t=>t.email===e.emailAddress.address))||(a.has(e.emailAddress.address)||this._availableAttendees.push(CardEditorController_objectSpread(CardEditorController_objectSpread({},this._outlookIntegrationSrv.getFakeContact(e.emailAddress.address)),{},{accountId:this.calendarCard.accountId,memberType:G.wO.Outlook,isSelected:!0})))}this._newContactEmail&&this._availableAttendees.push(CardEditorController_objectSpread(CardEditorController_objectSpread({},this._outlookIntegrationSrv.getFakeContact(this._newContactEmail)),{},{accountId:this.calendarCard.accountId,memberType:G.wO.Outlook,isSelected:!1,isFakeFromSearch:!0})),Q()(n=this._availableAttendees).call(n,w.GI)}return this._availableAttendees}},{kind:"get",key:"attendeeFilter",value:function attendeeFilter(){return this._attendeeFilter}},{kind:"set",key:"attendeeFilter",value:function attendeeFilter(e){this._attendeeFilter=e;let t=null;if(e){var r;this._attendeeFilterRegex=(0,w.n0)(e);let n=e.toLowerCase();(0,re.G)(e)&&!W()(r=this._availableAttendees).call(r,(e=>e.email.toLowerCase()===n))&&(t=e)}this._$scope.$evalAsync((()=>{this._newContactEmail=t,this._availableAttendees=null}))}},{kind:"method",key:"filterAttendeesByFullNameAndEmail",value:function filterAttendeesByFullNameAndEmail(){return e=>{return!this.attendeeFilter||(!!this._attendeeFilterRegex.test(e.fullName)||!!e.email&&(J()(t=e.email).call(t,this.attendeeFilter)||this._attendeeFilterRegex.test(e.email.split("@")[0])));var t}}},{kind:"method",key:"toggleAttendee",value:function toggleAttendee(e){var t;let r=e.email===this._currentUserEmail,n=W()(t=this.calendarCard.providerCard.outlookAttendees).call(t,(t=>t.emailAddress.address===e.email));(!n||this.isNewCard||this.eventCanModify&&this.isCurrentMemberOrganizer)&&(this._availableAttendees=null,this._logCardEvent({event:n?r?G.cN.CardEvents.MemberUnassignedSelf:G.cN.CardEvents.MemberUnassigned:r?G.cN.CardEvents.MemberAssignedSelf:G.cN.CardEvents.MemberAssigned}),!n&&e.isFakeFromSearch&&(this.attendeeFilter=null),this._setCardPropertiesAsync({outlookAttendees:(0,ye.G0)(this.calendarCard,e,this._currentUserEmail)}))}},{kind:"get",key:"isLocationsAvailable",value:function isLocationsAvailable(){return this._outlookIntegrationSrv.getOutlookRooms(this.calendarCard.accountId).length>0}},{kind:"get",key:"eventLocations",value:function eventLocations(){if(this.delayRender)return[];if(!this.cardOutlookCalendar)return[];var e;this._eventLocations||(this._eventLocations=o()(e=this.calendarCard.providerCard.outlookLocations).call(e,(e=>CardEditorController_objectSpread(CardEditorController_objectSpread({},this._outlookIntegrationSrv.getOutlookRoomByEmail(this.calendarCard.accountId,e.uniqueId)),{},{id:e.uniqueId,email:e.uniqueId,displayName:e.displayName,accountId:this.calendarCard.accountId,memberType:G.wO.Outlook}))));return this._eventLocations}},{kind:"get",key:"availableLocations",value:function availableLocations(){if(this.delayRender)return[];if(!this.cardOutlookCalendar)return[];if(!this._availableLocations){var e,t;this._availableLocations=o()(e=this._outlookIntegrationSrv.getOutlookRooms(this.calendarCard.accountId)).call(e,(e=>{var t;return CardEditorController_objectSpread(CardEditorController_objectSpread({},e),{},{accountId:this.calendarCard.accountId,memberType:G.wO.Outlook,isSelected:W()(t=this.eventLocations).call(t,(t=>t.email===e.email))})}));for(let e of this.calendarCard.providerCard.outlookLocations){var r;W()(r=this._availableLocations).call(r,(t=>t.email===e.uniqueId))||this._availableLocations.push(CardEditorController_objectSpread(CardEditorController_objectSpread({},this._outlookIntegrationSrv.getFakeContact(e.uniqueId)),{},{accountId:this.calendarCard.accountId,memberType:G.wO.Outlook,isSelected:!0}))}Q()(t=this._availableLocations).call(t,w.GI)}return this._availableLocations}},{kind:"get",key:"locationFilter",value:function locationFilter(){return this._locationFilter}},{kind:"set",key:"locationFilter",value:function locationFilter(e){this._locationFilter=e,e&&(this._locationFilterRegex=new RegExp((0,w.hr)(e),"i")),this._$scope.$evalAsync((()=>{this._availableLocations=null}))}},{kind:"method",key:"filterLocationsByDisplayNameAndEmail",value:function filterLocationsByDisplayNameAndEmail(){return e=>!this.locationFilter||(this._locationFilterRegex.test(e.displayName)||this._locationFilterRegex.test(e.email))}},{kind:"method",key:"toggleLocation",value:function toggleLocation(e){var t;let r=W()(t=this.calendarCard.providerCard.outlookLocations).call(t,(t=>t.uniqueId===e.email));(!r||this.isNewCard||this.eventCanModify)&&(this._availableLocations=null,this._logCardEvent({event:G.cN.CardEvents.LocationChanged}),!r&&e.isFakeFromSearch&&(this.locationFilter=null),this._setCardPropertiesAsync({outlookLocations:(0,ye.vP)(this.calendarCard,e)}))}},{kind:"get",key:"isDescriptionAvailable",value:function isDescriptionAvailable(){return!this.isReadOnly||this.description}},{kind:"get",key:"isDescriptionEditing",value:function isDescriptionEditing(){return this._isDescriptionEditing}},{kind:"set",key:"isDescriptionEditing",value:function isDescriptionEditing(e){this.isDescriptionEditing!==e&&(this._$scope.$evalAsync((()=>this._isDescriptionEditing=e)),e&&this._$timeout((()=>{te()(".pw-js-dialog-edit-card-description-input").trigger("focus"),this._$scope.$broadcast(G.FK.AutosizeControlsResizeRequested)}),0,!1))}},{kind:"get",key:"description",value:function description(){return this._description}},{kind:"set",key:"description",value:function description(e){this.description!==e&&(this._description=null==e?void 0:pe()(e).call(e),this._logCardEvent({event:G.cN.CardEvents.DescriptionChanged}),this._setCardPropertiesAsync({description:this.description}))}},{kind:"get",key:"isInviteResponseAvailable",value:function isInviteResponseAvailable(){return!this.calendarCard.providerCard.outlookOrganizer.self}},{kind:"get",key:"availableInviteStatuses",value:function availableInviteStatuses(){return this._availableInviteStatuses||(this._availableInviteStatuses=[{title:this._$translate.instant("BUTTONS.YES"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_ACCEPTED"),icon:"icons-12:checked",value:G.Lz.Yes,showAsOption:!0},{title:this._$translate.instant("BUTTONS.NO"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_DECLINED"),icon:"icons-12:close",value:G.Lz.No,showAsOption:!0},{title:this._$translate.instant("BUTTONS.MAYBE"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_TENTATIVE"),icon:"icons-12:help",value:G.Lz.MayBe,showAsOption:!0},{title:this._$translate.instant("BUTTONS.YES"),tooltip:this._$translate.instant("MISC.INVITE_STATUS_ACCEPTED"),icon:"icons-12:checked",value:G.Lz.Organizer,showAsOption:!1},{tooltip:this._$translate.instant("MISC.INVITE_STATUS_NEED_ACTION"),value:G.Lz.Undefined,showAsOption:!1}]),this._availableInviteStatuses}},{kind:"get",key:"inviteStatus",value:function inviteStatus(){return this._inviteStatus}},{kind:"set",key:"inviteStatus",value:function inviteStatus(e){this.inviteStatus!==e&&(this._inviteStatus=e,this._logCardEvent({event:G.cN.CardEvents.InviteStatusChanged,data:{status:this.inviteStatus.value}}),this._setCardPropertiesAsync({outlookInviteStatus:this.inviteStatus.value}))}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this.calendarCard.cardUrl}},{kind:"get",key:"cardUrlTarget",value:function cardUrlTarget(){return"_blank"}},{kind:"method",key:"openCardInSource",value:function openCardInSource(e){this._logCardEvent({event:G.cN.CardEvents.CardOpenClicked,data:{by:G.AH.DialogPanel}}),e.which===G.Jm.Left&&this.hideDialog()}},{kind:"method",key:"switchDetailedModeAsync",value:async function switchDetailedModeAsync(){await new(fe())((e=>this._$scope.$emit(G.FK.CardDialogSwitchDetailedModeRequested,{resolve:e}))),this._logCardEvent({event:G.cN.CardEvents.EditDialogModeChanged,data:{by:G.AH.Dialog,isDetailed:!this.isDetailed}})}},{kind:"method",key:"hideDialog",value:function hideDialog(e){this._$scope.$emit(G.FK.CardDialogHideRequested,{dialogResult:e})}},{kind:"method",key:"initialize",value:function initialize(){var e,t;if(this.calendarCard.cardType!==ne.eT.OutlookEvent){var r;const e=this._tmpAccountId||this.calendarCard.accountId;this._calendarCardsSrv.changeCalendarCardType(this.calendarCard,ne.eT.OutlookEvent,e);const{title:t,isAllDay:n,start:i,end:a}=this.calendarCard;this.calendarCard.providerCard=this._provider.getCalendarCardClass().fromSourceCard(this.calendarCard.id,e,ne.eT.OutlookEvent),this.calendarCard.providerCard.outlookCalendarId=null!==(r=this._tmpCalendarId)&&void 0!==r?r:this.calendarCard.providerCard.outlookCalendarId,this.calendarCard.title=t,this.calendarCard.isAllDay=n,this.calendarCard.start=i,this.calendarCard.end=a,this._tmpAccountId=null,this._tmpCalendarId=null}this.setCardOutlookCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.outlookCalendarId),this._isCompleted=this.calendarCard.providerCard.isCompleted,this._title=this.calendarCard.title,this._isAllDay=this.calendarCard.isAllDay,this._startDate=this.calendarCard.start,this._endDate=this.calendarCard.end,this._recurrenceRule=this.calendarCard.recurrenceRule,this._description=null===(e=this.calendarCard.description)||void 0===e?void 0:pe()(e).call(e);let n=this.calendarCard.providerCard.outlookShowAs||G.X3.Busy;this._eventShowAs=_()(t=this.availableShowAsStatuses).call(t,(e=>e.value===n)),this._addServiceListeners()}},{kind:"get",key:"isBusy",value:function isBusy(){return this._isBusy}},{kind:"set",key:"isBusy",value:function isBusy(e){this._$scope.$evalAsync((()=>this._isBusy=e))}},{kind:"get",key:"isNewCard",value:function isNewCard(){return this.calendarCard.isTempCard}},{kind:"get",key:"isNewCardValid",value:function isNewCardValid(){return this._isNewCardValid}},{kind:"method",key:"isCardFieldValid",value:function isCardFieldValid(e){switch(e){case"startDate":case"endDate":return this.hasDates;default:return!1}}},{kind:"get",key:"isCardReadOnly",value:function isCardReadOnly(){return this.calendarCard.isReadOnly}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){var e;return this.calendarCard.isReadOnly||this.calendarCard.providerCard.outlookCalendarId&&!W()(e=this.selectedCalendars).call(e,(e=>e.id===this.calendarCard.providerCard.outlookCalendarId))}},{kind:"get",key:"eventCanInviteOthers",value:function eventCanInviteOthers(){return this.calendarCard.providerCard.canInviteOthers}},{kind:"get",key:"eventCanModify",value:function eventCanModify(){return this.calendarCard.providerCard.canModify}},{kind:"get",key:"eventCanSeeOtherGuests",value:function eventCanSeeOtherGuests(){return this.calendarCard.providerCard.canSeeOtherGuests}},{kind:"get",key:"isCurrentMemberOrganizer",value:function isCurrentMemberOrganizer(){var e;return null===(e=this.calendarCard.providerCard.outlookOrganizer)||void 0===e?void 0:e.self}},{kind:"get",key:"delayRender",value:function delayRender(){return!this._renderDelayed}},{kind:"get",key:"showWeekNumbers",value:function showWeekNumbers(){return this._collectionSettings.global.settings.showWeekNumbers}},{kind:"get",key:"isMacOS",value:function isMacOS(){return this._platformSrv.isMacOS()}},{kind:"method",key:"saveCalendarCardAsync",value:async function saveCalendarCardAsync(){if(!this._isSaveCardCalled){if(this._isSaveCardCalled=!0,this.title&&this.isNewCard&&this._setCardPropertiesAsync({title:this.title}),!this.isNewCard)return this._isSaveCardCalled=!1,void this.hideDialog(G.Xs.CardEdited);try{if(await this._$timeout((()=>this._isNewCardValid=!0)),await this._$timeout((()=>this._isNewCardValid=this.isCardFieldValid("startDate")&&this.isCardFieldValid("endDate"))),!this.isNewCardValid)return;this._appCommonSrv.setSchedulerBusy(!0),this._updateCardPromise&&await this._updateCardPromise,this._hasChanges=!1,this.hideDialog(G.Xs.CardCreated),this._collectionSettings.local.settings.lastUsedCalendarData={accountType:ne.Qm.Outlook,accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId},this._collectionSettings.local.save();let e=await this._calendarCardsSrv.createCalendarCardAsync(this.calendarCard);this._$rootScope.$broadcast(G.FK.CardCreated,{calendarCard:e})}catch(e){this._$log.error("Planyway card creating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.CREATE_OUTLOOK_EVENT_ERROR"),G.k$.Error),this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}finally{this._appCommonSrv.setSchedulerBusy(!1),this._isSaveCardCalled=!1}}}},{kind:"method",key:"copyCardUrlAsync",value:function copyCardUrlAsync(){return this._provider.copyCardUrlAsync(this.calendarCard,{telemetry:{by:G.AH.DialogPanel}})}},{kind:"method",key:"deleteCardAsync",value:function deleteCardAsync(){return this._deleteCardAsync({event:G.cN.CardEvents.Deleted,data:{by:G.AH.DialogPanel}})}},{kind:"method",key:"confirmCloseAsync",value:async function confirmCloseAsync(){if(this.isNewCard){if(this._isSaveCardCalled)return!0;if(!this.hasChanges&&this._forceDetailedMode)return!0;if(!this._isDeleting)return await this.saveCalendarCardAsync(),!1}return!0}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_parentDialogController",value:function _parentDialogController(){return this._parentDialogControllerInternal||(this._parentDialogControllerInternal=(0,w.sO)(this._$scope,ke.Z)),this._parentDialogControllerInternal}},{kind:"method",key:"_registerEditor",value:function _registerEditor(){var e;null===(e=this._parentDialogController)||void 0===e||e.registerCardEditorControllerAsync(this)}},{kind:"get",key:"_tmpAccountId",value:function _tmpAccountId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpAccountId}},{kind:"set",key:"_tmpAccountId",value:function _tmpAccountId(e){this._parentDialogController&&(this._parentDialogController._tmpAccountId=e)}},{kind:"get",key:"_tmpCalendarId",value:function _tmpCalendarId(){var e;return null===(e=this._parentDialogController)||void 0===e?void 0:e._tmpCalendarId}},{kind:"set",key:"_tmpCalendarId",value:function _tmpCalendarId(e){this._parentDialogController&&(this._parentDialogController._tmpCalendarId=e)}},{kind:"method",key:"_onInputKeyDown",value:function _onInputKeyDown(e){e.stopPropagation()}},{kind:"method",key:"_onEditorKeyDown",value:function _onEditorKeyDown(e){var t;let r=e.which;if(!G.gD.has(r))return;if(e.preventDefault(),e.stopPropagation(),!(null===(t=G.Vj[ne.eT.OutlookEvent])||void 0===t?void 0:z()(t).call(t,r)))return;if(this.isCardReadOnly)return;let n=!1;r===G.VD.E||r===G.VD.Space||r===G.VD.M?n=!0:r!==G.VD.Delete&&r!==G.VD.Backspace||(e.shiftKey||e.metaKey)&&(n=!0),n&&this._updateCardByHotkey(e.keyCode,{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey})}},{kind:"method",key:"_updateCardByHotkey",value:function _updateCardByHotkey(e,t){var r;switch(e){case G.VD.E:this._isCompleted=!this.isCompleted,this._logCardEvent({event:this.isCompleted?G.cN.CardEvents.MarkedCompleted:G.cN.CardEvents.MarkedIncompleted,data:{by:G.AH.DialogHotkey}}),this._setCardPropertiesAsync({isCompleted:this.isCompleted});break;case G.VD.M:te()(".pw-js-dialog-edit-event-attendees-menu-btn").trigger("click");break;case G.VD.Space:if(!this._currentUserEmail)break;let e=W()(r=this.calendarCard.providerCard.outlookAttendees).call(r,(e=>e.email===this._currentUserEmail));if(e&&!this.isNewCard&&(!this.eventCanModify||!this.isCurrentMemberOrganizer))break;this._availableAttendees=null,this._logCardEvent({event:e?G.cN.CardEvents.MemberUnassignedSelf:G.cN.CardEvents.MemberAssignedSelf,data:{by:G.AH.DialogHotkey}}),this._setCardPropertiesAsync({outlookAttendees:(0,ye.G0)(this.calendarCard,{email:this._currentUserEmail},this._currentUserEmail)});break;case G.VD.Delete:case G.VD.Backspace:if(t.shiftKey||t.metaKey){if(this.isNewCard)break;this._deleteCardAsync({event:G.cN.CardEvents.Deleted,data:{by:G.AH.DialogHotkey}})}}}},{kind:"get",key:"_currentUserEmail",value:function _currentUserEmail(){var e;return null===(e=this._outlookIntegrationSrv.getOutlookUser(this.calendarCard.accountId))||void 0===e?void 0:e.email}},{kind:"set",key:"_hasChanges",value:function _hasChanges(e){this._$scope.$emit(G.FK.CardDialogSetHasChangesRequested,{hasChanges:e})}},{kind:"method",key:"_setCardPropertiesAsync",value:async function _setCardPropertiesAsync(e){this._$timeout((()=>this._keepScrollFocus()),0,!1),this._hasChanges=!0;try{if(this.isNewCard){this._updateCardPromise&&await this._updateCardPromise;let e=null;this._updateCardPromise=new(fe())((t=>e=t)),this._updateCardPromise.resolve=e}else this.calendarCard.recurrenceRule&&(void 0!==e.isAllDay&&e.isAllDay!==this.calendarCard.isAllDay||e.start&&!(0,w.rs)(e.start,this.calendarCard.start)||void 0!==e.recurrenceRule&&e.isAllDay!==this.calendarCard.recurrenceRule)&&(e.exceptionDates=[],this.calendarCard.deleteExceptionDates(),(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(this.calendarCard.cardType,this.calendarCard)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this._setCardPropertiesAsync.name})}})());await this._calendarCardsSrv.updateCalendarCardPropertiesAsync(this.calendarCard,e)}catch(e){this._$log.error("Planyway card updating error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),G.k$.Error)}}},{kind:"method",key:"_addServiceListeners",value:function _addServiceListeners(){this._serviceEventsListenersAdded||(this._serviceEventsListenersAdded=!0,this._onAddOrUpdateCard=(e,t)=>{e.id===this.calendarCard.id&&this._addOrUpdateCard(e,t)},this._onDeleteCard=(e,t)=>{e.id===this.calendarCard.id&&(t.replacedWith?this._addOrUpdateCard(t.replacedWith,t):this._deleteCard())},this._calendarCardsSrv.addCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.addCalendarCardEventListener("deleted",this._onDeleteCard),this._onOutlookCalendarChanged=()=>{this._selectedCalendars=null,this._outlookCalendars=null},this._outlookIntegrationSrv.addOutlookCalendarEventListener("added",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.addOutlookCalendarEventListener("updated",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.addOutlookCalendarEventListener("deleted",this._onOutlookCalendarChanged))}},{kind:"method",key:"_removeServiceListeners",value:function _removeServiceListeners(){this._serviceEventsListenersAdded&&(this._serviceEventsListenersAdded=!1,this._calendarCardsSrv.removeCalendarCardEventListener("added",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("updated",this._onAddOrUpdateCard),this._calendarCardsSrv.removeCalendarCardEventListener("deleted",this._onDeleteCard),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("added",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("updated",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("deleted",this._onOutlookCalendarChanged))}},{kind:"method",key:"_addOrUpdateCard",value:function _addOrUpdateCard(e,t){this.calendarCard=e.isTempCard?e:e.clone(),this._$scope.$evalAsync((()=>{var r,n,i;(this._isCompleted=e.providerCard.isCompleted,this._isAllDay=e.isAllDay,this._startDate=e.start,this._endDate=e.end,this._recurrenceRule=e.recurrenceRule,t.hasExternalChanges)&&(this._title=e.title,this._description=null===(i=e.description)||void 0===i?void 0:pe()(i).call(i));let a=this.calendarCard.providerCard.outlookShowAs||G.X3.Busy;this._eventShowAs=_()(r=this.availableShowAsStatuses).call(r,(e=>e.value===a)),this._inviteStatus=_()(n=this.availableInviteStatuses).call(n,(t=>t.value===e.providerCard.outlookInviteStatus)),this._availableAttendees=null,this._eventAttendees=null,this._availableLocations=null,this._eventLocations=null,this.setCardOutlookCalendar(this.calendarCard.accountId,this.calendarCard.providerCard.outlookCalendarId),e.isTempCard&&(this._hasChanges=!0),this._updateCardPromise&&(this._updateCardPromise.resolve(),this._updateCardPromise=null)}))}},{kind:"method",key:"_moveToOutlookCalendarAsync",value:async function _moveToOutlookCalendarAsync(e){if(this.calendarCard.providerCard.outlookCalendarId!==e.id)try{this.isBusy=!0,this.setCardOutlookCalendar(e.accountId,e.id),await this._setCardPropertiesAsync({accountId:e.accountId,outlookCalendarId:e.id})}finally{this.isBusy=!1,this._calendarColor=null}}},{kind:"method",key:"_deleteCard",value:function _deleteCard(){this._hasChanges=!1,this.hideDialog(G.Xs.CardDeleted)}},{kind:"method",key:"_clearCardData",value:function _clearCardData(){this.calendarCard.providerCard.outlookCalendarId=null,this.calendarCard.recurrenceRule=void 0,this.calendarCard.exceptionDates=void 0}},{kind:"method",key:"_deleteCardAsync",value:async function _deleteCardAsync(e){let t=this.isNewCard?{title:"DIALOGS.CANCEL_CREATE_OUTLOOK_EVENT_TITLE",confirm:"DIALOGS.CANCEL_CREATE_OUTLOOK_EVENT_CONFIRM",error:"NOTIFICATIONS.DELETE_OUTLOOK_EVENT_ERROR"}:{title:"DIALOGS.DELETE_OUTLOOK_EVENT_TITLE",confirm:"DIALOGS.DELETE_OUTLOOK_EVENT_CONFIRM",error:"NOTIFICATIONS.DELETE_OUTLOOK_EVENT_ERROR"};if(!this.isNewCard||this.hasChanges){if(!await this._dialogSrv.showConfirmAsync(this._$translate.instant(t.title),this._$translate.instant(t.confirm),{buttons:[{text:this._$translate.instant("BUTTONS.DELETE_EVENT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]}))return}this._logCardEvent(e),this._isDeleting=!0;try{this._appCommonSrv.setSchedulerBusy(!0),!this.isNewCard&&this.calendarCard.recurrenceRule&&(async()=>{try{await this._calendarCardsSrv.deleteRecurrenceExceptionsAsync(this.calendarCard.cardType,this.calendarCard)}catch(e){this._$log.error("Planyway delete card exceptions error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway delete card exceptions error",e,{class:this.constructor.name,method:this._deleteCardAsync.name})}})(),await this._calendarCardsSrv.deleteCalendarCardAsync(this.calendarCard)}catch(e){this._$log.error("Planyway delete card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant(t.error),G.k$.Error),this._telemetrySrv.logError("Planyway delete card error",e,{class:this.constructor.name,method:this._deleteCardAsync.name})}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_logCardEvent",value:function _logCardEvent(e){e.data=CardEditorController_objectSpread({accountId:this.calendarCard.accountId,calendarId:this.calendarCard.calendarId,isAllDay:this.isAllDay,start:this.startDate,end:this.endDate},e.data),this._$scope.$emit(G.FK.CardDialogLogCardEventRequested,e)}},{kind:"method",key:"_keepScrollFocus",value:function _keepScrollFocus(){this._$scope.$emit(G.FK.CardDialogKeepScrollFocusRequested)}}]}}));function CardTooltipController_getDecoratorsApi(){CardTooltipController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CardTooltipController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardTooltipController_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardTooltipController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardTooltipController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardTooltipController_createElementDescriptor(e){var t,r=CardTooltipController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CardTooltipController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardTooltipController_hasDecorators(e){return e.decorators&&e.decorators.length}function CardTooltipController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardTooltipController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardTooltipController_toPropertyKey(e){var t=function CardTooltipController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let be=function CardTooltipController_decorate(e,t,r,n){var i,a=CardTooltipController_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CardTooltipController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CardTooltipController_isDataDescriptor(i.descriptor)||CardTooltipController_isDataDescriptor(n.descriptor)){if(CardTooltipController_hasDecorators(i)||CardTooltipController_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CardTooltipController_hasDecorators(i)){if(CardTooltipController_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CardTooltipController_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CardTooltipController_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["appCommonSrv","outlookIntegrationSrv","calendarCard"])],(function(e){return{F:class CardTooltipController{constructor(t,r,n){e(this),this._appCommonSrv=t,this._outlookIntegrationSrv=r,this._calendarCard=n,this._outlookCalendar=this._outlookIntegrationSrv.getOutlookCalendarById(this._calendarCard.accountId,this._calendarCard.providerCard.outlookCalendarId)}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookEventTooltipCtrl"}},{kind:"field",key:"_provider",value:()=>(0,j.VH)(G.lP.Outlook)},{kind:"get",key:"cardTitle",value:function cardTitle(){return this._calendarCard.title}},{kind:"get",key:"hasDates",value:function hasDates(){return this._calendarCard.hasDates}},{kind:"get",key:"cardTimesText",value:function cardTimesText(){if(!this._calendarCard.hasDates)return;let e=this._calendarCard.realStart||this._calendarCard.start,t=this._calendarCard.realEnd||this._calendarCard.end,r=(0,w.KA)(e,t,!this.isAllDay);this._calendarCard.isAllDay&&(t=(0,w.E4)(t,1));let n=(0,w.bt)(e,t,this._appCommonSrv.getSchedulerWorkWeek()).minutes,i=(0,w.gG)(n);return i?`${r} (${i})`:r}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._calendarCard.isAllDay}},{kind:"get",key:"isRecurring",value:function isRecurring(){return this._calendarCard.isRecurring?this._calendarCard.isRecurring():!!this._calendarCard.recurrenceRule||!!this._calendarCard.recurrenceId}},{kind:"get",key:"isException",value:function isException(){return this._calendarCard.isException?this._calendarCard.isException():!!this._calendarCard.recurrenceId}},{kind:"get",key:"cardAccountId",value:function cardAccountId(){return this._calendarCard.accountId}},{kind:"get",key:"cardAccountName",value:function cardAccountName(){var e;return null===(e=this._provider.getAccountUser(this.cardAccountId))||void 0===e?void 0:e.fullName}},{kind:"get",key:"cardCalendarId",value:function cardCalendarId(){return this._calendarCard.providerCard.outlookCalendarId}},{kind:"get",key:"cardCalendarName",value:function cardCalendarName(){var e;return null===(e=this._outlookCalendar)||void 0===e?void 0:e.name}}]}}));function SidebarPanelController_ownKeys(e,t){var r=S()(e);if(b()){var n=b()(e);t&&(n=M()(n).call(n,(function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}function SidebarPanelController_objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?s()(r=SidebarPanelController_ownKeys(Object(i),!0)).call(r,(function(t){(0,R.Z)(e,t,i[t])})):P()?$()(e,P()(i)):s()(n=SidebarPanelController_ownKeys(Object(i))).call(n,(function(t){c()(e,t,T()(i,t))}))}return e}function SidebarPanelController_getDecoratorsApi(){SidebarPanelController_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!SidebarPanelController_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=SidebarPanelController_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:SidebarPanelController_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=SidebarPanelController_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function SidebarPanelController_createElementDescriptor(e){var t,r=SidebarPanelController_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function SidebarPanelController_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function SidebarPanelController_hasDecorators(e){return e.decorators&&e.decorators.length}function SidebarPanelController_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function SidebarPanelController_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function SidebarPanelController_toPropertyKey(e){var t=function SidebarPanelController_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Ie=function SidebarPanelController_decorate(e,t,r,n){var i,a=SidebarPanelController_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function SidebarPanelController_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(SidebarPanelController_isDataDescriptor(i.descriptor)||SidebarPanelController_isDataDescriptor(n.descriptor)){if(SidebarPanelController_hasDecorators(i)||SidebarPanelController_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(SidebarPanelController_hasDecorators(i)){if(SidebarPanelController_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}SidebarPanelController_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,SidebarPanelController_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}([(0,w.SG)(["$rootScope","$scope","$translate","appCommonSrv","dialogSrv","licenseSrv","outlookIntegrationSrv","planywayIntegrationSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class SidebarPanelController{constructor(t,r,n,i,a,o,l,s,d,c){var u=this;e(this),this._$rootScope=t,this._$scope=r,this._$translate=n,this._appCommonSrv=i,this._dialogSrv=a,this._licenseSrv=o,this._outlookIntegrationSrv=l,this._planywayIntegrationSrv=s,this._telemetrySrv=d,this._collectionSrv=c,this._onOutlookCalendarChanged=()=>this._$scope.$evalAsync((()=>this._outlookCalendars=null)),this._outlookIntegrationSrv.addOutlookCalendarEventListener("added",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.addOutlookCalendarEventListener("updated",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.addOutlookCalendarEventListener("deleted",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.addOutlookCalendarEventListener("cleared",this._onOutlookCalendarChanged);const onSourceChanged=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.accountType&&t.accountType!==ne.Qm.Outlook||u._$scope.$evalAsync((()=>{if(u._accounts=null,u._outlookCalendars=null,u._notifyOutlookCalendarsSelectionChanged(),e.name===G.FK.AccountAdded)u.addCalendarToCollectionAsync(void 0,t)}))};this._$scope.$on(G.FK.AccountAdded,onSourceChanged),this._$scope.$on(G.FK.AccountDeleted,onSourceChanged),this._$scope.$on(G.FK.CalendarsChanged,onSourceChanged),this._$scope.$on(G.FK.CollectionChanged,onSourceChanged),this._$scope.$on(G.FK.SingleCalendarSelectionRequested,((e,t)=>{let{accountType:r,accountId:n,calendarId:i}=t;if(r!==ne.Qm.Outlook)for(let e of this._provider.getCurrentCollectionConnectedAccountIds())this._changeCalendarsSelection(e,!1);else{for(let e of this.outlookCalendars)e.isSelected=e.accountId===n&&e.id===i;this._saveCalendarsSelection(n)}})),this._$scope.$on("$destroy",(()=>{this._outlookIntegrationSrv.removeOutlookCalendarEventListener("added",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("updated",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("deleted",this._onOutlookCalendarChanged),this._outlookIntegrationSrv.removeOutlookCalendarEventListener("cleared",this._onOutlookCalendarChanged)}))}},d:[{kind:"get",static:!0,key:"controllerName",value:function controllerName(){return"outlookSidebarPanelCtrl"}},{kind:"field",key:"_provider",value:()=>(0,j.VH)(G.lP.Outlook)},{kind:"get",key:"accounts",value:function accounts(){var e;this._accounts||(this._accounts=o()(e=this._provider.getCurrentCollectionConnectedAccounts()).call(e,(e=>{let t=SidebarPanelController_objectSpread({},e);return c()(t,"isInvalid",{get:()=>this._provider.invalidAccountIds.has(e.accountId)}),t})));return this._accounts}},{kind:"method",key:"reconnectAccountAsync",value:function reconnectAccountAsync(e){this._outlookIntegrationSrv.reconnectAccountAsync(e)}},{kind:"method",key:"disconnectAccountAsync",value:async function disconnectAccountAsync(e){if(await this._dialogSrv.showConfirmAsync(this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_TITLE"),this._$translate.instant("DIALOGS.SIGN_OUT_OF_ACCOUNT_CONFIRM",{accountName:e.accountName}),{buttons:[{text:this._$translate.instant("BUTTONS.SIGN_OUT"),isPrimary:!0,isDangerous:!0,dialogResult:!0}]})){if(!await this._planywayIntegrationSrv.disconnectAccountAsync(e))return;this._telemetrySrv.logSessionEvent(G.cN.GeneralEvents.AccountDisconnected,{accountType:ne.Qm.Outlook}),await this._provider.removeAccountFromAllCollectionsAsync(e)}}},{kind:"method",key:"isAccountCollapsed",value:function isAccountCollapsed(e){return this._provider.isAccountCollapsed(e.accountId)}},{kind:"method",key:"toggleAccountCollapsed",value:function toggleAccountCollapsed(e){this._provider.toggleAccountCollapsed(e.accountId)}},{kind:"get",key:"isIntegrationBusy",value:function isIntegrationBusy(){return this._outlookIntegrationSrv.isIntegrationBusy()}},{kind:"get",key:"canAddCalendarToCollection",value:function canAddCalendarToCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"addCalendarToCollectionAsync",value:async function addCalendarToCollectionAsync(e,t){this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionAddCalendarDialogOpened,{accountType:ne.Qm.Outlook,where:G.Zz.Sidebar});let r=await this._dialogSrv.showManageAccountCalendarsDialogAsync(t,e);r?(this._$rootScope.$broadcast(G.FK.CalendarsChanging,t),r.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarAdded,{accountType:ne.Qm.Outlook,count:r.connectedCalendarIds.length}),r.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ne.Qm.Outlook,count:r.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:ne.Qm.Outlook,where:G.Zz.Sidebar})}},{kind:"method",key:"canSelectAllCalendars",value:function canSelectAllCalendars(e){var t;return W()(t=this.outlookCalendars).call(t,(t=>t.accountId===e.accountId&&!t.isSelected))}},{kind:"method",key:"selectAllCalendars",value:function selectAllCalendars(e){this.canSelectAllCalendars(e)&&(e.isPrimary||this._licenseSrv.checkPaidFeatureAvailable(G.ZV.OutlookConnect,!0))&&(this._changeCalendarsSelection(e.accountId,!0),this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarSelectedAll,{accountType:ne.Qm.Outlook,count:this.outlookCalendars.length}))}},{kind:"method",key:"canSelectNoneCalendars",value:function canSelectNoneCalendars(e){var t;return W()(t=this.outlookCalendars).call(t,(t=>t.accountId===e.accountId&&t.isSelected))}},{kind:"method",key:"selectNoneCalendars",value:function selectNoneCalendars(e){this.canSelectNoneCalendars(e)&&(this._changeCalendarsSelection(e.accountId,!1),this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarSelectedNone,{accountType:ne.Qm.Outlook,count:0}))}},{kind:"get",key:"canRemoveAccountFromCollection",value:function canRemoveAccountFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeAccountFromCollection",value:function removeAccountFromCollection(e){this._provider.removeAccountFromCurrentCollectionAsync(e),this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionAccountRemoved,{accountType:e.accountType})}},{kind:"get",key:"outlookCalendars",value:function outlookCalendars(){var e;this._outlookCalendars||(this._outlookCalendars=U()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{var t;return o()(t=this._provider.getCurrentCollectionConnectedCalendars(e)).call(t,(t=>SidebarPanelController_objectSpread(SidebarPanelController_objectSpread({},this._outlookIntegrationSrv.getOutlookCalendarById(e,t.calendarId)),t)))})));return this._outlookCalendars}},{kind:"method",key:"isOutlookCalendarBusy",value:function isOutlookCalendarBusy(e){return e.isSelected&&this._outlookIntegrationSrv.isConnectedOutlookCalendarBusy(e.accountId,e.id)}},{kind:"method",key:"setCalendarSelection",value:function setCalendarSelection(e,t){if(e.isSelected!==t){if(t){if(!this._planywayIntegrationSrv.getConnectedAccountById(e.accountId).isPrimary&&!this._licenseSrv.checkPaidFeatureAvailable(G.ZV.OutlookConnect,!0))return}e.isSelected=t,this._telemetrySrv.logSessionEvent(t?G.cN.CollectionEvents.CollectionCalendarSelected:G.cN.CollectionEvents.CollectionCalendarDeselected,{accountType:ne.Qm.Outlook,count:1}),this._saveCalendarsSelection(e.accountId)}}},{kind:"method",key:"canShowOnlyThisCalendar",value:function canShowOnlyThisCalendar(e){return this.canSelectAllCalendars(e)||this.canSelectNoneCalendars(e)}},{kind:"method",key:"showOnlyThisCalendar",value:function showOnlyThisCalendar(e,t){this.canShowOnlyThisCalendar(e)&&(this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis,{accountType:ne.Qm.Outlook,count:1}),this._$rootScope.$broadcast(G.FK.SingleCalendarSelectionRequested,{accountType:ne.Qm.Outlook,accountId:e.accountId,calendarId:t.id}))}},{kind:"get",key:"canRemoveCalendarFromCollection",value:function canRemoveCalendarFromCollection(){return!this._collectionSrv.isCurrentCollectionReadOnly}},{kind:"method",key:"removeCalendarFromCollection",value:function removeCalendarFromCollection(e,t){let r=this._provider.getCurrentCollectionConnectedCalendar(e.accountId,t.id);r.isConnected=!1,this._provider.setCurrentCollectionConnectedCalendars(e.accountId,[r]),this._$rootScope.$broadcast(G.FK.CalendarsChanging,e),this._telemetrySrv.logSessionEvent(G.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:ne.Qm.Outlook,count:1})}},{kind:"method",key:"_changeCalendarsSelection",value:function _changeCalendarsSelection(e,t){for(let n of M()(r=this.outlookCalendars).call(r,(t=>t.accountId===e))){var r;n.isSelected=t}this._saveCalendarsSelection(e)}},{kind:"method",key:"_saveCalendarsSelection",value:function _saveCalendarsSelection(e){var t,r;let n=o()(t=M()(r=this.outlookCalendars).call(r,(t=>t.accountId===e))).call(t,(e=>SidebarPanelController_objectSpread(SidebarPanelController_objectSpread({},this._provider.getCurrentCollectionConnectedCalendar(e.accountId,e.calendarId)),{},{isSelected:e.isSelected})));this._provider.setCurrentCollectionConnectedCalendars(e,n),this._notifyOutlookCalendarsSelectionChanged()}},{kind:"method",key:"_notifyOutlookCalendarsSelectionChanged",value:function _notifyOutlookCalendarsSelectionChanged(){this._$rootScope.$broadcast(G.FK.CardsReloaded),this._$rootScope.$broadcast(G.FK.OutlookCalendarSelectionChanged),this._$rootScope.$broadcast(G.FK.ChangeSchedulerViewRequested),this._$rootScope.$broadcast(G.FK.WorkPanelReloaded),this._$rootScope.$broadcast(G.FK.TimelineResourcesReloaded,{resourcesType:G.y.Calendars})}}]}}));var Te=r(75905),Oe=r.n(Te);function CalendarIconDirective_getDecoratorsApi(){CalendarIconDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CalendarIconDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarIconDirective_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarIconDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarIconDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarIconDirective_createElementDescriptor(e){var t,r=CalendarIconDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CalendarIconDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarIconDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarIconDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarIconDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarIconDirective_toPropertyKey(e){var t=function CalendarIconDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Pe=function CalendarIconDirective_decorate(e,t,r,n){var i,a=CalendarIconDirective_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CalendarIconDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CalendarIconDirective_isDataDescriptor(i.descriptor)||CalendarIconDirective_isDataDescriptor(n.descriptor)){if(CalendarIconDirective_hasDecorators(i)||CalendarIconDirective_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CalendarIconDirective_hasDecorators(i)){if(CalendarIconDirective_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CalendarIconDirective_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CalendarIconDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}(null,(function(e){class CalendarIconDirective{constructor(){e(this),this.templateUrl=Oe(),this.restrict="E",this.controller=E.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarId:"@",accountId:"@",_iconSize:"@?iconSize"}}}return{F:CalendarIconDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwOutlookCalendarIcon"}},{kind:"method",decorators:[(0,w.SG)([])],static:!0,key:"create",value:function create(){return new CalendarIconDirective}}]}}));var xe=r(79653),$e=r.n(xe);function CalendarPickerDirective_getDecoratorsApi(){CalendarPickerDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CalendarPickerDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CalendarPickerDirective_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CalendarPickerDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CalendarPickerDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CalendarPickerDirective_createElementDescriptor(e){var t,r=CalendarPickerDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CalendarPickerDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CalendarPickerDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CalendarPickerDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CalendarPickerDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CalendarPickerDirective_toPropertyKey(e){var t=function CalendarPickerDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Re=function CalendarPickerDirective_decorate(e,t,r,n){var i,a=CalendarPickerDirective_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CalendarPickerDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CalendarPickerDirective_isDataDescriptor(i.descriptor)||CalendarPickerDirective_isDataDescriptor(n.descriptor)){if(CalendarPickerDirective_hasDecorators(i)||CalendarPickerDirective_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CalendarPickerDirective_hasDecorators(i)){if(CalendarPickerDirective_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CalendarPickerDirective_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CalendarPickerDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}(null,(function(e){class CalendarPickerDirective{constructor(){e(this),this.templateUrl=$e(),this.restrict="E",this.controller=q.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={account:"<",calendars:"=",filterText:"<"}}}return{F:CalendarPickerDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwOutlookCalendarsPicker"}},{kind:"method",decorators:[(0,w.SG)([])],static:!0,key:"create",value:function create(){return new CalendarPickerDirective}}]}}));var Ne=r(88991),Me=r.n(Ne);function CardContextMenuDirective_getDecoratorsApi(){CardContextMenuDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!CardContextMenuDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=CardContextMenuDirective_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:CardContextMenuDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=CardContextMenuDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function CardContextMenuDirective_createElementDescriptor(e){var t,r=CardContextMenuDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function CardContextMenuDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function CardContextMenuDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function CardContextMenuDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function CardContextMenuDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function CardContextMenuDirective_toPropertyKey(e){var t=function CardContextMenuDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Fe=function CardContextMenuDirective_decorate(e,t,r,n){var i,a=CardContextMenuDirective_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function CardContextMenuDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(CardContextMenuDirective_isDataDescriptor(i.descriptor)||CardContextMenuDirective_isDataDescriptor(n.descriptor)){if(CardContextMenuDirective_hasDecorators(i)||CardContextMenuDirective_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(CardContextMenuDirective_hasDecorators(i)){if(CardContextMenuDirective_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}CardContextMenuDirective_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,CardContextMenuDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}(null,(function(e){class CardContextMenuDirective{constructor(){e(this),this.templateUrl=Me(),this.restrict="E",this.controller=de.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={onSetContextMenu:"<",_source:"<source"}}}return{F:CardContextMenuDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwOutlookCardContextMenu"}},{kind:"method",decorators:[(0,w.SG)([])],static:!0,key:"create",value:function create(){return new CardContextMenuDirective}}]}}));var ze=r(38264),Le=r.n(ze);class CardEditorDirective{static get directiveName(){return"pwOutlookEventEditor"}static create(){return new CardEditorDirective}constructor(){this.templateUrl=Le(),this.restrict="E",this.controller=Ae.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={calendarCard:"<",isDetailed:"<?",isDense:"<?",hasChanges:"<?",_forceDetailedMode:"<forceDetailedMode"}}link(e){e.$ctrl.initialize()}}var Ue=r(45343),Be=r.n(Ue);function SidebarPanelDirective_getDecoratorsApi(){SidebarPanelDirective_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;s()(r=["method","field"]).call(r,(function(r){s()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}c()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),s()(e).call(e,(function(e){if(!SidebarPanelDirective_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==h()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];v()(o).call(o,h()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,C(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return o()(t=(0,g.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=SidebarPanelDirective_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:y()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:SidebarPanelDirective_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:o()(e).call(e,this.fromElementDescriptor,this)};return c()(t,C(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=SidebarPanelDirective_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function SidebarPanelDirective_createElementDescriptor(e){var t,r=SidebarPanelDirective_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function SidebarPanelDirective_coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function SidebarPanelDirective_hasDecorators(e){return e.decorators&&e.decorators.length}function SidebarPanelDirective_isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function SidebarPanelDirective_optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function SidebarPanelDirective_toPropertyKey(e){var t=function SidebarPanelDirective_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Ke=function SidebarPanelDirective_decorate(e,t,r,n){var i,a=SidebarPanelDirective_getDecoratorsApi();if(n)for(var l=0;l<n.length;l++)a=n[l](a);var s=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),r),d=a.decorateClass(function SidebarPanelDirective_coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=_()(t).call(t,isSameElement)))if(SidebarPanelDirective_isDataDescriptor(i.descriptor)||SidebarPanelDirective_isDataDescriptor(n.descriptor)){if(SidebarPanelDirective_hasDecorators(i)||SidebarPanelDirective_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(SidebarPanelDirective_hasDecorators(i)){if(SidebarPanelDirective_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}SidebarPanelDirective_coalesceGetterSetter(i,n)}else t.push(i)}return t}(o()(i=s.d).call(i,SidebarPanelDirective_createElementDescriptor)),e);return a.initializeClassElements(s.F,d.elements),a.runClassFinishers(s.F,d.finishers)}(null,(function(e){class SidebarPanelDirective{constructor(){e(this),this.templateUrl=Be(),this.restrict="E",this.controller=Ie.controllerName,this.controllerAs="$ctrl",this.scope={},this.bindToController={}}}return{F:SidebarPanelDirective,d:[{kind:"get",static:!0,key:"directiveName",value:function directiveName(){return"pwOutlookSidebarPanel"}},{kind:"method",decorators:[(0,w.SG)([])],static:!0,key:"create",value:function create(){return new SidebarPanelDirective}}]}}));const je={services:[],controllers:[E,q,de,Ae,be,Ie],directives:[Pe,Re,Fe,CardEditorDirective,Ke]}},88078:(e,t,r)=>{r.d(t,{G0:()=>toggleAttendee,fb:()=>Y,h7:()=>getOutlookCardId,vP:()=>toggleLocation});var n=r(40024),i=r.n(n),a=r(99595),o=r.n(a),l=r(57445),s=r.n(l),d=r(51791),c=r.n(d),u=r(90143),h=r.n(u),p=r(56626),v=r.n(p),f=r(67552),C=r.n(f),m=r(86981),y=r.n(m),k=r(62079),_=r.n(k),g=r(52020),w=r.n(g),E=r(88546),D=r.n(E),S=r(66775),A=r.n(S),b=r(2201),I=r.n(b),T=r(26171),O=r(26881),P=r(88946),x=r.n(P),$=r(23513),R=r.n($),N=r(73324),M=r.n(N),F=r(45181),z=r.n(F),L=(r(58218),r(27525)),U=r.n(L),B=r(98235),K=r.n(B),j=r(99560),G=r.n(j),V=r(82617),H=r(14587),q=r(20115),Z=r(29704),W=r(8937);function ownKeys(e,t){var r=_()(e);if(w()){var n=w()(e);t&&(n=M()(n).call(n,(function(t){return D()(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?o()(r=ownKeys(Object(i),!0)).call(r,(function(t){(0,T.Z)(e,t,i[t])})):A()?I()(e,A()(i)):o()(n=ownKeys(Object(i))).call(n,(function(t){s()(e,t,D()(i,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;o()(r=["method","field"]).call(r,(function(r){o()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}s()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(o()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),o()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==c()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];h()(o).call(o,c()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),s=this.toElementFinisherExtras((0,i[a])(l)||l);e=s.element,this.addElementPlacement(e,t),s.finisher&&n.push(s.finisher);var d=s.extras;if(d){for(var u=0;u<d.length;u++)this.addElementPlacement(d[u],t);r.push.apply(r,d)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return s()(t,v(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return x()(t=(0,O.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:C()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:x()(e).call(e,this.fromElementDescriptor,this)};return s()(t,v(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let Y=function _decorate(e,t,r,n){var i,a=_getDecoratorsApi();if(n)for(var o=0;o<n.length;o++)a=n[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,s.elements)}),r),s=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=y()(t).call(t,isSameElement)))if(_isDataDescriptor(i.descriptor)||_isDataDescriptor(n.descriptor)){if(_hasDecorators(i)||_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(_hasDecorators(i)){if(_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}_coalesceGetterSetter(i,n)}else t.push(i)}return t}(x()(i=l.d).call(i,_createElementDescriptor)),e);return a.initializeClassElements(l.F,s.elements),a.runClassFinishers(l.F,s.finishers)}(null,(function(e){class CalendarCard{constructor(t,r,n){e(this),this._id=t,this._accountId=r,this._cardType=n,this._timeZones={},this._outlookAttendees=[],this._outlookLocations=[];const i=this;this._customExpand=function(e,t){if(i._expandRecurrenceRule)try{var r,n,a;let o=x()(r=i._expandRecurrenceRule.between((0,Z._q)(e),(0,Z._q)(t))).call(r,(e=>(0,Z.Pb)(e,"local"))),l=new(R())(x()(n=i.exceptionDates).call(n,(e=>e.getTime()))),s=i.end-i.start;return x()(a=M()(o).call(o,(e=>!l.has(e.getTime())))).call(a,(e=>this.toOccurrence({start:e,end:new Date(e.getTime()+s)})))}catch{}}}}return{F:CalendarCard,d:[{kind:"get",key:"id",value:function id(){return this._id}},{kind:"get",key:"accountId",value:function accountId(){return this._accountId}},{kind:"set",key:"accountId",value:function accountId(e){this._accountId=e}},{kind:"get",key:"calendarId",value:function calendarId(){return this.outlookCalendarId}},{kind:"get",key:"cardType",value:function cardType(){return this._cardType}},{kind:"set",key:"cardType",value:function cardType(e){this._cardType=e}},{kind:"get",key:"cardRole",value:function cardRole(){return V.D.Card}},{kind:"set",key:"cardRole",value:function cardRole(e){}},{kind:"get",key:"title",value:function title(){return this._title||""}},{kind:"set",key:"title",value:function title(e){this._title=e}},{kind:"get",key:"description",value:function description(){return this._description||""}},{kind:"set",key:"description",value:function description(e){this._description=e}},{kind:"get",key:"isAllDay",value:function isAllDay(){return this._isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this._isAllDay=e}},{kind:"get",key:"start",value:function start(){return this._start}},{kind:"set",key:"start",value:function start(e){this._start=e?new Date(e):void 0,this._previousStart=this._start}},{kind:"get",key:"previousStart",value:function previousStart(){return this._previousStart}},{kind:"get",key:"end",value:function end(){return this._end}},{kind:"set",key:"end",value:function end(e){this._end=e?new Date(e):void 0,this._previousEnd=this._end}},{kind:"get",key:"previousEnd",value:function previousEnd(){return this._previousEnd}},{kind:"get",key:"hasDates",value:function hasDates(){return(0,Z.qb)(this.start)&&(0,Z.qb)(this.end)}},{kind:"get",key:"recurrenceRule",value:function recurrenceRule(){return this._recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this._recurrenceRule=e}},{kind:"get",key:"recurrenceException",value:function recurrenceException(){return this._recurrenceException}},{kind:"set",key:"recurrenceException",value:function recurrenceException(e){this._recurrenceException=e}},{kind:"get",key:"exceptionDates",value:function exceptionDates(){return this._exceptionDates||[]}},{kind:"set",key:"exceptionDates",value:function exceptionDates(e){var t;this._exceptionDates=e||[],this._recurrenceException=this._exceptionDates.length>0?x()(t=this._exceptionDates).call(t,Z.wd).join():void 0}},{kind:"get",key:"recurrenceId",value:function recurrenceId(){return this._recurrenceId}},{kind:"set",key:"recurrenceId",value:function recurrenceId(e){this._recurrenceId=e}},{kind:"get",key:"exceptionDate",value:function exceptionDate(){return(0,Z.HE)(this.originalStart)}},{kind:"get",key:"originalStart",value:function originalStart(){return this._originalStart}},{kind:"set",key:"originalStart",value:function originalStart(e){this._originalStart=e}},{kind:"get",key:"isTempCard",value:function isTempCard(){var e;return z()(e=this.id).call(e,q.$d)}},{kind:"get",key:"isReadOnly",value:function isReadOnly(){return this._isReadOnly}},{kind:"get",key:"isSingleDate",value:function isSingleDate(){return!1}},{kind:"get",key:"customExpand",value:function customExpand(){return this._customExpand}},{kind:"get",key:"cardUrl",value:function cardUrl(){return this._outlookEventUrl}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookCalendarId",value:function outlookCalendarId(){return this._outlookCalendarId}},{kind:"set",key:"outlookCalendarId",value:function outlookCalendarId(e){this._outlookCalendarId=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookEventId",value:function outlookEventId(){return this._outlookEventId}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookShowAs",value:function outlookShowAs(){return this._outlookShowAs}},{kind:"set",key:"outlookShowAs",value:function outlookShowAs(e){this._outlookShowAs=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookOrganizer",value:function outlookOrganizer(){return this._outlookOrganizer}},{kind:"set",key:"outlookOrganizer",value:function outlookOrganizer(e){this._outlookOrganizer=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookInviteStatus",value:function outlookInviteStatus(){return this._outlookInviteStatus}},{kind:"set",key:"outlookInviteStatus",value:function outlookInviteStatus(e){this._outlookInviteStatus=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"canModify",value:function canModify(){var e;return this.isTempCard||(null===(e=this.outlookOrganizer)||void 0===e?void 0:e.self)||this._outlookGuestsCanModify}},{kind:"get",decorators:[(0,Z.lv)()],key:"canInviteOthers",value:function canInviteOthers(){var e;return this.isTempCard||(null===(e=this.outlookOrganizer)||void 0===e?void 0:e.self)||this._outlookGuestsCanInviteOthers}},{kind:"get",decorators:[(0,Z.lv)()],key:"canSeeOtherGuests",value:function canSeeOtherGuests(){var e;return this.isTempCard||(null===(e=this.outlookOrganizer)||void 0===e?void 0:e.self)||this._outlookGuestsCanSeeOtherGuests}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookAttendees",value:function outlookAttendees(){var e;return null!==(e=this._outlookAttendees)&&void 0!==e?e:[]}},{kind:"set",key:"outlookAttendees",value:function outlookAttendees(e){this._outlookAttendees=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"outlookLocations",value:function outlookLocations(){var e;return null!==(e=this._outlookLocations)&&void 0!==e?e:[]}},{kind:"set",key:"outlookLocations",value:function outlookLocations(e){this._outlookLocations=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"isCompleted",value:function isCompleted(){return this._isCompleted}},{kind:"set",key:"isCompleted",value:function isCompleted(e){this._isCompleted=e}},{kind:"get",decorators:[(0,Z.lv)()],key:"isResponseRequested",value:function isResponseRequested(){return this._isResponseRequested}},{kind:"get",key:"lastChangeId",value:function lastChangeId(){return this._lastChangeId}},{kind:"set",key:"lastChangeId",value:function lastChangeId(e){return this._lastChangeId=e}},{kind:"method",static:!0,key:"fromSourceCard",value:function fromSourceCard(e,t,r,n){var i,a,o,l;let s=new CalendarCard(e,t,r);if(!n)return s;const{outlookEvent:d,outlookCalendar:c}=n;if(s._isReadOnly=c.isReadOnly,s._outlookEventId=d.id,s._outlookCalendarId=c.id,s._outlookEventUrl=d.webLink,s.outlookShowAs=d.showAs||W.X3.Busy,s._outlookOrganizer={email:null===(i=d.organizer)||void 0===i?void 0:i.emailAddress.address,self:null!==(a=d.isOrganizer)&&void 0!==a&&a},s.outlookInviteStatus=d.responseStatus.response,s._outlookGuestsCanModify=false,s._outlookGuestsCanInviteOthers=false,s._outlookGuestsCanSeeOtherGuests=null===(o=d.hideAttendees)||void 0===o||o,s._outlookAttendees=d.attendees,s._outlookLocations=d.locations,s.title=d.subject?d.subject.replace(/^✓\s?/,""):"",s.description=d.body.content,s.isCompleted=!!d.subject&&z()(l=d.subject).call(l,"✓"),s._isResponseRequested=d.responseRequested,s.isAllDay=d.isAllDay,d.isAllDay?(s.start=(0,Z.HE)(d.start.dateTime),s.end=(0,Z.E4)((0,Z.HE)(d.end.dateTime),-1)):(s.start=(0,Z.ZR)(d.start.dateTime,d.start.timeZone),s.end=(0,Z.ZR)(d.end.dateTime,d.end.timeZone)),s._timeZones={start:d.start.timeZone,end:d.end.timeZone},d.recurrence){let e=function fromOutlookRecurrence(e){let{pattern:t,range:r}=e;const fromIndex=e=>{if(e)switch(e){case"last":return-1;case"first":default:return 1;case"second":return 2;case"third":return 3;case"fourth":return 4}},fromDaysOfWeek=(e,t)=>{if(!e)return;K()(e)||(e=[e]);const r={monday:H.Ci.MO,tuesday:H.Ci.TU,wednesday:H.Ci.WE,thursday:H.Ci.TH,friday:H.Ci.FR,saturday:H.Ci.SA,sunday:H.Ci.SU};return x()(e).call(e,(e=>{let n=r[e];return n&&t&&(n=n.nth(fromIndex(t))),n}))};let n={interval:t.interval};t.month&&(n.bymonth=t.month);t.daysOfWeek&&(n.byweekday=fromDaysOfWeek(t.daysOfWeek));t.dayOfMonth&&(n.bymonthday=t.dayOfMonth);switch(r.type){case"endDate":n.until=(0,Z.h3)(r.endDate);break;case"numbered":n.count=r.numberOfOccurrences}switch(t.type){case"daily":n.freq=H.Ci.DAILY;break;case"weekly":n.freq=H.Ci.WEEKLY;break;case"absoluteMonthly":n.freq=H.Ci.MONTHLY;break;case"relativeMonthly":n.freq=H.Ci.MONTHLY,t.index&&(n.byweekday=fromDaysOfWeek(t.daysOfWeek,t.index));break;case"absoluteYearly":n.freq=H.Ci.YEARLY;break;case"relativeYearly":n.freq=H.Ci.YEARLY,t.index&&(n.byweekday=fromDaysOfWeek(t.daysOfWeek,t.index))}return n}(d.recurrence),t=new H.Ci(e);if(s._recurrenceRule=t.toString().replace("RRULE:",""),!s.isAllDay)try{let t=(0,Z.z7)(d.recurrence.range.recurrenceTimeZone);s._expandRecurrenceRule=new H.Ci(_objectSpread(_objectSpread({},e),{},{dtstart:(0,Z.c6)(s.start,t),until:e.until&&(0,Z._q)(e.until),tzid:t}))}catch{}}else d.seriesMasterId&&(s._recurrenceId=getOutlookCardId(d.seriesMasterId,c.shortId),s._outlookRecurringEventId=d.seriesMasterId,s.originalStart=d.originalStart);return s.lastChangeId=new Date(d.lastModifiedDateTime).getTime(),s}},{kind:"method",key:"toSourceCard",value:function toSourceCard(e){const{includeFields:t=[]}=e;let r={},n={subject:()=>r.subject=this.isCompleted?`✓ ${this.title}`:this.title,description:()=>r.body={contentType:"TEXT",content:this.description},start:()=>{this.isAllDay?r.start={dateTime:(0,Z.tC)(this.start)}:r.start={dateTime:this.start.toISOString()},r.start.timeZone=this._timeZones.start||(0,Z.iT)()},end:()=>{this.isAllDay?r.end={dateTime:(0,Z.tC)((0,Z.E4)(this.end,1))}:r.end={dateTime:this.end.toISOString()},r.end.timeZone=this._timeZones.end||(0,Z.iT)()},isAllDay:()=>r.isAllDay=this.isAllDay,recurrence:()=>r.recurrence=function toOutlookRecurrence(e,t){if(!e)return;const toOutlookType=(e,t)=>{let{byweekday:r,bymonthday:n}=t;switch(e){case H.Ci.DAILY:return"daily";case H.Ci.WEEKLY:return"weekly";case H.Ci.MONTHLY:return r?"relativeMonthly":n?"absoluteMonthly":void 0;case H.Ci.YEARLY:if(r)return"relativeYearly";if(n)return"absoluteYearly"}},toDaysOfWeek=e=>{if(e)return x()(e).call(e,(e=>{switch(e.weekday){case H.Ci.MO.weekday:return"monday";case H.Ci.TU.weekday:return"tuesday";case H.Ci.WE.weekday:return"wednesday";case H.Ci.TH.weekday:return"thursday";case H.Ci.FR.weekday:return"friday";case H.Ci.SA.weekday:return"saturday";case H.Ci.SU.weekday:return"sunday"}}))},toIndex=e=>{if(e)return x()(e).call(e,(e=>{switch(e.n){case-1:return"last";case 1:return"first";case 2:return"second";case 3:return"third";case 4:return"fourth";default:return"first"}})).toString()},toRangeType=e=>{let{until:t,count:r}=e;return t?"endDate":r?"numbered":"noEnd"};let r=H.Ci.fromString(e),{freq:n,interval:i}=r.options,{byweekday:a,bymonthday:o,bymonth:l,until:s,count:d}=r.origOptions;return{pattern:{type:toOutlookType(n,{byweekday:a,bymonthday:o}),daysOfWeek:toDaysOfWeek(a),dayOfMonth:o||0,index:toIndex(a),month:l||0,interval:i},range:{type:toRangeType({until:s,count:d}),startDate:(0,Z.tC)(t),endDate:(0,Z.tC)((0,Z.wD)(s)),recurrenceTimeZone:(0,Z.iT)(),numberOfOccurrences:d}}}(this.recurrenceRule,this.start),originalStart:()=>r.originalStart=this.originalStart,showAs:()=>r.showAs=this.outlookShowAs,isOrganiser:()=>r.isOrganiser=this.outlookOrganizer.self,organizer:()=>r.organizer={emailAddress:{address:this.outlookOrganizer.email}},attendees:()=>r.attendees=this.outlookAttendees,locations:()=>r.locations=this.outlookLocations};for(let e of t){let t=n[e];t&&t()}return r}},{kind:"method",key:"clone",value:function clone(){let e=new CalendarCard(this.id,this.accountId,this.cardType);return this.hasDates&&(e.isAllDay=this.isAllDay,e.start=this.start,e.end=this.end),e.title=this.title,e.description=this.description,e.isCompleted=this.isCompleted,e.recurrenceRule=this.recurrenceRule,e.exceptionDates=[...this.exceptionDates],e.recurrenceId=this.recurrenceId,e.originalStart=this.originalStart,e._isReadOnly=this._isReadOnly,e._outlookCalendarId=this.outlookCalendarId,e._outlookEventId=this.outlookEventId,e._outlookRecurringEventId=this._outlookRecurringEventId,e._outlookEventUrl=this._outlookEventUrl,e._outlookShowAs=this.outlookShowAs,e._outlookOrganizer=this.outlookOrganizer,e._outlookGuestsCanModify=this._outlookGuestsCanModify,e._outlookGuestsCanInviteOthers=this._outlookGuestsCanInviteOthers,e._outlookGuestsCanSeeOtherGuests=this._outlookGuestsCanSeeOtherGuests,e._outlookInviteStatus=this.outlookInviteStatus,e._outlookAttendees=[...this.outlookAttendees],e._outlookLocations=[...this.outlookLocations],e._timeZones=_objectSpread({},this._timeZones),e.lastChangeId=this.lastChangeId,e}},{kind:"method",key:"equals",value:function equals(e){if(!e)return!1;function toCardObject(e){return{id:e.id,cardType:e.cardType,title:e.title,description:e.description,isCompleted:e.isCompleted,isAllDay:e.isAllDay,start:e.start,end:e.end,recurrenceRule:e.recurrenceRule,exceptionDates:e.exceptionDates,outlookCalendarId:e.outlookCalendarId,outlookShowAs:e.outlookShowAs,outlookInviteStatus:e.outlookInviteStatus,outlookAttendees:e.outlookAttendees,outlookLocations:e.outlookLocations}}let t=toCardObject(this),r=toCardObject(e),n=(0,Z.h0)(t,r);return n}},{kind:"method",key:"getCompareId",value:function getCompareId(){return this.lastChangeId}}]}}));function getOutlookCardId(e,t){return`${G()(e)}-${G()(t)}`}function toggleAttendee(e,t,r){var n;let i,{providerCard:a}=e,o=U()(n=a.outlookAttendees).call(n,(e=>e.emailAddress.address===t.email)),l=t.email===r;if(o){var s;i=M()(s=a.outlookAttendees).call(s,(e=>e.emailAddress.address!==t.email))}else{let e=[{emailAddress:{address:t.email},status:{response:l?W.Lz.Yes:void 0}}];i=[...a.outlookAttendees,...e]}return i}function toggleLocation(e,t){var r;let n,{providerCard:i}=e;if(U()(r=i.outlookLocations).call(r,(e=>e.uniqueId===t.email))){var a;n=M()(a=i.outlookLocations).call(a,(e=>e.uniqueId!==t.email))}else{let e=[{uniqueId:t.email,locationUri:t.email,displayName:t.displayName,locationType:W.V9.ConferenceRoom}];n=[...i.outlookLocations,...e]}return n}},18347:(e,t,r)=>{r.d(t,{R:()=>ee});var n=r(40024),i=r.n(n),a=r(57445),o=r.n(a),l=r(51791),s=r.n(l),d=r(90143),c=r.n(d),u=r(56626),h=r.n(u),p=r(67552),v=r.n(p),f=r(26881),C=r(99595),m=r.n(C),y=r(54847),k=r.n(y),_=r(23513),g=r.n(_),w=r(89221),E=r.n(w),D=r(35820),S=r.n(D),A=r(88946),b=r.n(A),I=r(29898),T=r.n(I),O=r(91829),P=r.n(O),x=r(73324),$=r.n(x),R=r(86981),N=r.n(R),M=r(27525),F=r.n(M),z=r(39290),L=r.n(z),U=r(10349),B=r.n(U),K=r(82617),j=r(56777),G=(r(3884),r(88078)),V=r(46930),H=r(8937),q=r(20115),Z=r(54840),W=r(29704);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;m()(r=["method","field"]).call(r,(function(r){m()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;m()(r=["method","field"]).call(r,(function(r){m()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(m()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),m()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==s()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];c()(o).call(o,s()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),d=this.toElementFinisherExtras((0,i[a])(l)||l);e=d.element,this.addElementPlacement(e,t),d.finisher&&n.push(d.finisher);var u=d.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return b()(t=(0,f.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:v()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:b()(e).call(e,this.fromElementDescriptor,this)};return o()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Y=["id","subject","body","isAllDay","start","end","recurrence","type","seriesMasterId","originalStart","body","webLink","organizer","showAs","isOrganizer","responseRequested","responseStatus","attendees","locations","lastModifiedDateTime"].join(),Q=["id","subject","body","isAllDay","start","end","recurrence","type","seriesMasterId","originalStart","body","webLink","organizer","showAs","isOrganizer","responseRequested","responseStatus","attendees","locations","lastModifiedDateTime","cancelledOccurrences","exceptionOccurrences"].join(),X=["id","originalStart"].join(),J=["outlookCalendarId"];let ee=function _decorate(e,t,r,n){var i,a=_getDecoratorsApi();if(n)for(var o=0;o<n.length;o++)a=n[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,s.elements)}),r),s=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=N()(t).call(t,isSameElement)))if(_isDataDescriptor(i.descriptor)||_isDataDescriptor(n.descriptor)){if(_hasDecorators(i)||_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(_hasDecorators(i)){if(_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}_coalesceGetterSetter(i,n)}else t.push(i)}return t}(b()(i=l.d).call(i,_createElementDescriptor)),e);return a.initializeClassElements(l.F,s.elements),a.runClassFinishers(l.F,s.finishers)}([(0,W.SG)(["$log","$rootScope","$timeout","$translate","appCommonSrv","collectionSrv","notificationSrv","outlookIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class OutlookCardsService{constructor(t,r,n,i,a,o,l,s,d,c,u){e(this),this._$log=t,this._$rootScope=r,this._$timeout=n,this._$translate=i,this._appCommonSrv=a,this._collectionSrv=o,this._notificationSrv=l,this._outlookIntegrationSrv=s,this._platformSrv=d,this._settingsSrv=c,this._telemetrySrv=u,this._outlookIntegrationSrv.addOutlookCalendarEventListener("updated",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(H.FK.CardsReloaded)}})),this._outlookIntegrationSrv.addOutlookCalendarEventListener("deleted",(e=>{const t=this._cache.get(e.accountId);if(t.loadedCalendarIds.has(e.id)){if(t.loadedCalendarIds.delete(e.id),t.loadCalendarCardsPromise)return;this._requestReloadCalendarCards(e.accountId),this._$rootScope.$broadcast(H.FK.CardsReloaded)}})),this._$rootScope.$on(H.FK.FiltersChanged,(()=>{var e;m()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{this._cache.get(e).ignoreFiltersCardIds.clear()}))}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"outlookCardsSrv"}},{kind:"field",key:"provider",value:()=>(0,j.VH)(H.lP.Outlook)},{kind:"field",key:"_cache",value:()=>new(k())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_calendarCardsListeners",value:()=>({added:new(g()),updated:new(g()),deleted:new(g()),cleared:new(g())})},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){var t,r;this._initializedCollectionId=null;for(let e of E()(n=this._cache).call(n)){var n;e.destroy()}this._cache.clear(),m()(t=this.provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>this._resetAccountCache(e))),await S().all(b()(r=this.provider.getCurrentCollectionConnectedAccountIds()).call(r,(async t=>{this.reloadCalendars(t),await this.loadCalendarCardsAsync(t,e)}))),this._initializedCollectionId=this._currentCollectionId}},{kind:"method",key:"addOutlookAccountAsync",value:async function addOutlookAccountAsync(e){this._resetAccountCache(e),this.reloadCalendars(e),await this.loadCalendarCardsAsync(e),this._initializedCollectionId=this._currentCollectionId}},{kind:"method",key:"removeOutlookAccount",value:function removeOutlookAccount(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy(),this._cache.delete(e)}},{kind:"method",key:"reloadCalendars",value:function reloadCalendars(e){const t=this._cache.get(e);let r=this.provider.getCurrentCollectionSelectedCalendarIds(e);for(let e of T()(n=t.loadedCalendarIds).call(n)){var n;P()(r).call(r,e)||t.hiddenCalendarIds.add(e)}for(let e of r)t.loadedCalendarIds.has(e)?t.hiddenCalendarIds.delete(e):t.loadedCalendarIds.set(e,!0);this._requestReloadCalendarCards(e)}},{kind:"method",key:"isOutlookCalendarBusy",value:function isOutlookCalendarBusy(e,t){var r;return null!==(r=this._cache.get(e).busyCalendarIds.get(t))&&void 0!==r&&r}},{kind:"method",key:"needReloadCalendarCards",value:function needReloadCalendarCards(){var e;m()(e=this.provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{const t=this._cache.get(e);for(let e of T()(r=t.loadedCalendarIds).call(r)){var r;t.loadedCalendarIds.set(e,!0)}this._requestReloadCalendarCards(e)}))}},{kind:"method",key:"loadCalendarCardsAsync",value:async function loadCalendarCardsAsync(e,t){const r=this._cache.get(e);if(r.reloadCalendarCardsRequested){r.reloadCalendarCardsRequested=!1,t=t||this._appCommonSrv.getCancellationToken(`getCalendarCards_${e}`);try{r.loadCalendarCardsPromise=this._loadCalendarCardsAsync(e,t),await r.loadCalendarCardsPromise}catch(e){this._$log.error("Planyway get Outlook cards error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get Outlook calendar cards error",e,{class:this.constructor.name,method:this.loadCalendarCardsAsync.name})}finally{r.loadCalendarCardsPromise=null}}}},{kind:"method",key:"getCalendarCards",value:function getCalendarCards(e){var t,r;const n=this._cache.get(e);return $()(t=E()(r=n.calendarCards).call(r)).call(t,(e=>!n.hiddenCalendarIds.has(e.providerCard.outlookCalendarId)))}},{kind:"method",key:"getCalendarCardByIdAsync",value:function getCalendarCardByIdAsync(e,t){return this._cache.get(e).calendarCards.get(t)}},{kind:"method",key:"getCalendarCardById",value:function getCalendarCardById(e,t){return this._cache.get(e).calendarCards.get(t)}},{kind:"method",key:"createCalendarCardAsync",value:async function createCalendarCardAsync(e){const t=e.accountId,r=this._cache.get(t);let n;if(e.title||(e.title=this._$translate.instant("MISC.NO_TITLE")),e.recurrenceId){var i;let r=this.getCalendarCardById(t,e.recurrenceId),a=await this._outlookIntegrationSrv.restAsync(t,H.Tu.Get,`me/events/${r.providerCard.outlookEventId}/instances`,"Get Outlook recurring instance",{$select:X,startDateTime:(0,W.tC)((0,K.E4)(e.exceptionDate,-1)),endDateTime:(0,W.tC)((0,K.E4)(e.exceptionDate,1))}),o=N()(i=a.value).call(i,(t=>(0,W.rs)(t.originalStart,e.exceptionDate)));if(!o)return;let l=e.toSourceCard({includeFields:["subject","description","isAllDay","start","end","recurrence","originalStart","showAs","attendees","locations"]});l.seriesMasterId=r.providerCard.outlookEventId,l.type=H.hC.Exception,l.recurrence=null,n=await this._outlookIntegrationSrv.restAsync(t,H.Tu.Patch,`me/calendars/${e.providerCard.outlookCalendarId}/events/${o.id}`,"Create Outlook event recurring instance",l),n.originalStart=l.originalStart}else{let r=e.toSourceCard({includeFields:["subject","description","isAllDay","start","end","recurrence","showAs","attendees","locations"]});n=await this._outlookIntegrationSrv.restAsync(t,H.Tu.Post,`me/calendars/${e.providerCard.outlookCalendarId}/events`,"Create Outlook event",r)}let a=this._outlookIntegrationSrv.getOutlookCalendarById(t,e.providerCard.outlookCalendarId),o=V.fb.createCard(t,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:n,outlookCalendar:a});return r.loadedCalendarIds.has(o.providerCard.outlookCalendarId)?(r.calendarCards.delete(e),r.calendarCards.add(o),r.ignoreFiltersCardIds.add(o.id)):r.calendarCards.delete(e),o}},{kind:"method",key:"createTempCalendarCard",value:function createTempCalendarCard(e,t,r){const n=this._cache.get(e),{cardType:i}=r;let a=new V.fb(q.$d,e,H.lP.Outlook,i);return t.cardRole&&(a.cardRole=t.cardRole),a.providerCard.outlookCalendarId=t.providerCard.outlookCalendarId,a.title=t.title||"",a.description=t.description||"",a.providerCard.isCompleted=t.providerCard.isCompleted,a.isAllDay=t.isAllDay,a.start=t.start,a.end=t.end,t.recurrenceRule?a.recurrenceRule=t.recurrenceRule:t.recurrenceId&&(a.recurrenceId=t.recurrenceId,a.originalStart=t.originalStart),t.providerCard.outlookAttendees&&(a.providerCard.outlookAttendees=[...t.providerCard.outlookAttendees]),a.providerCard.outlookShowAs=t.providerCard.outlookShowAs,a.providerCard.outlookOrganizer=t.providerCard.outlookOrganizer,a.providerCard.outlookInviteStatus=t.providerCard.outlookInviteStatus,n.calendarCards.add(a),a}},{kind:"method",key:"changeCalendarCardType",value:function changeCalendarCardType(e,t,r,n,i){t===K.eT.OutlookEvent?this._cache.get(n).calendarCards.delete(e):r===K.eT.OutlookEvent&&(e.cardType=r,e.accountId=i,this._cache.get(i).calendarCards.add(e))}},{kind:"method",key:"updateCalendarCardAsync",value:async function updateCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.accountId,n=this._cache.get(r),{waitForUpdate:i,includeOutlookFields:a=[],movedFromCalendarId:o}=t;if(0===a.length&&!o)return void(n.loadedCalendarIds.has(e.providerCard.calendarId)?n.calendarCards.update(e):n.calendarCards.delete(e));let l=this._outlookIntegrationSrv.getOutlookCalendarById(r,e.providerCard.outlookCalendarId);try{let t=e.clone();if(o&&!e.isTempCard)return;if(e.isTempCard)return void(n.loadedCalendarIds.has(e.providerCard.outlookCalendarId)&&n.calendarCards.update(e));if(F()(a).call(a,(e=>"responseStatus"===e))){let t=H.f6[e.providerCard.outlookInviteStatus];if(await this._outlookIntegrationSrv.restAsync(r,H.Tu.Post,`me/calendars/${e.providerCard.outlookCalendarId}/events/${e.providerCard.outlookEventId}/${t}`,"Update Outlook invite response",{sendResponse:e.providerCard.isResponseRequested}),e.providerCard.outlookInviteStatus===H.Lz.No)return void n.calendarCards.delete(e)}let s=e.toSourceCard({includeFields:["start","end",...a]});i||(n.loadedCalendarIds.has(e.providerCard.outlookCalendarId)?n.calendarCards.update(e):n.calendarCards.delete(e));let d=await this._outlookIntegrationSrv.restAsync(r,H.Tu.Patch,`me/calendars/${e.providerCard.outlookCalendarId}/events/${e.providerCard.outlookEventId}`,"Update Outlook event",s);e.recurrenceId&&(d.originalStart=e.originalStart);let c=V.fb.createCard(r,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:d,outlookCalendar:l});if(c.exceptionDates=e.exceptionDates,!n.calendarCards.get(e.id))return;i||!t.equals(c)?n.loadedCalendarIds.has(c.providerCard.outlookCalendarId)?n.calendarCards.update(c):n.calendarCards.delete(c):e.providerCard.lastChangeId=new Date(d.lastModifiedDateTime).getTime()}catch(e){if(this._telemetrySrv.logError("Outlook update card error",e,{class:this.constructor.name,method:this.updateCalendarCardAsync.name}),i)throw e;this._$log.error("Outlook update card error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_CARD_ERROR"),H.k$.Error)}finally{o&&this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"updateCalendarCardPropertiesAsync",value:function updateCalendarCardPropertiesAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.accountId,i=this._cache.get(n);let{immediateUpdate:a=!1}=r;F()(J).call(J,(e=>e in t))&&(a=!0);let o=i.cardsUpdateBuffers.get(e.id);o||(o={changes:{}},a||i.cardsUpdateBuffers.set(e.id,o)),o.changes||(o.changes={});for(let[e,r]of L()(t))void 0!==r&&(o.changes[e]=r);return o.processUpdatePromise||(o.processUpdatePromise=this._processCardUpdateBufferAsync(n,e.id,o,{immediateUpdate:a})),o.processUpdatePromise}},{kind:"method",key:"deleteCalendarCardAsync",value:async function deleteCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.accountId,n=this._cache.get(r),{waitForDelete:i}=t;try{var a,o;if(e.isTempCard)return void n.calendarCards.delete(e);let t=$()(a=E()(o=n.calendarCards).call(o)).call(a,(t=>t.recurrenceId===e.id));if(!i){n.calendarCards.delete(e);for(let e of t)n.calendarCards.delete(e)}if(await this._outlookIntegrationSrv.restAsync(r,H.Tu.Delete,`me/calendars/${e.providerCard.outlookCalendarId}/events/${e.providerCard.outlookEventId}`,"Delete Outlook event"),i){n.calendarCards.delete(e);for(let e of t)n.calendarCards.delete(e)}}catch(e){if(this._telemetrySrv.logError("Outlook delete event error",e,{class:this.constructor.name,method:this.deleteCalendarCardAsync.name}),i)throw e;this._$log.error("Outlook delete event error:"),this._$log.error(e),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.DELETE_OUTLOOK_EVENT_ERROR"),H.k$.Error)}}},{kind:"method",key:"createRecurrenceGapAsync",value:async function createRecurrenceGapAsync(e,t){var r;let n=await this._outlookIntegrationSrv.restAsync(e,H.Tu.Get,`me/events/${t.providerCard.outlookEventId}/instances`,"Get Outlook recurring instance",{$select:X,startDateTime:(0,W.tC)((0,K.E4)(t.exceptionDate,-1)),endDateTime:(0,W.tC)((0,K.E4)(t.exceptionDate,1))}),i=N()(r=n.value).call(r,(e=>(0,W.rs)(e.originalStart,t.exceptionDate)));i&&await this._outlookIntegrationSrv.restAsync(e,H.Tu.Delete,`me/calendars/${t.providerCard.outlookCalendarId}/events/${i.id}`,"Delete Outlook event recurring instance")}},{kind:"method",key:"addExceptionToRecurrentAsync",value:function addExceptionToRecurrentAsync(e,t){let r=this.getCalendarCardById(e,t.recurrenceId);if(r)return r.addExceptionDate(t.exceptionDate),this.updateCalendarCardPropertiesAsync(r,{exceptionDates:r.exceptionDates})}},{kind:"method",key:"removeExceptionsFromRecurrentAsync",value:function removeExceptionsFromRecurrentAsync(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{fromDate:n}=r,i=this.getCalendarCardById(e,t.id);if(i)return i.deleteExceptionDates(n),this.updateCalendarCardPropertiesAsync(i,{recurrenceRule:i.recurrenceRule,exceptionDates:i.exceptionDates})}},{kind:"method",key:"deleteRecurrenceExceptionsAsync",value:function deleteRecurrenceExceptionsAsync(e){var t,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=e.accountId,a=this._cache.get(i),{fromDate:o}=n;let l=$()(t=E()(r=a.calendarCards).call(r)).call(t,(t=>t.recurrenceId===e.id&&!(o&&t.exceptionDate<o)));for(let e of l)a.calendarCards.delete(e)}},{kind:"method",key:"addCalendarCardEventListener",value:function addCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeCalendarCardEventListener",value:function removeCalendarCardEventListener(e,t){let r=this._calendarCardsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"method",key:"isCalendarCardLoaded",value:function isCalendarCardLoaded(e){const t=e.accountId,r=this._cache.get(t);return r.loadedCalendarIds.has(e.providerCard.outlookCalendarId)&&!r.hiddenCalendarIds.has(e.providerCard.outlookCalendarId)}},{kind:"method",key:"isCalendarCardVisible",value:function isCalendarCardVisible(e){const t=this._cache.get(e.accountId);if(e.isTempCard)return!0;if(!this.isCalendarCardLoaded(e))return!1;if(t.ignoreFiltersCardIds.has(e.id))return!0;let r=this._appCommonSrv.getFiltersCardSearchString();var n;if(r)return P()(n=e.title.toLowerCase()).call(n,r);switch(this._collectionSettings.global.settings.filters.cardsVisibility){case H.Vh.Completed:if(!e.providerCard.isCompleted)return!1;break;case H.Vh.Incompleted:if(e.providerCard.isCompleted)return!1}return!0}},{kind:"method",key:"setCalendarCardIgnoreFilters",value:function setCalendarCardIgnoreFilters(e){this._cache.get(e.accountId).ignoreFiltersCardIds.add(e.id)}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"method",key:"_resetAccountCache",value:function _resetAccountCache(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy();const r={loadedCalendarIds:new(k()),hiddenCalendarIds:new(g()),busyCalendarIds:new(k()),calendarCards:new Z.v("id",V.fb),reloadCalendarCardsRequested:!1,ignoreFiltersCardIds:new(g()),cardsUpdateBuffers:new(k()),destroy:()=>{r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout),r.calendarCards.clear({accountId:e});for(let e in this._calendarCardsListeners)r.calendarCards.removeEventListener(e,this._handleCalendarCardEvent)}};this._cache.set(e,r);for(let e in this._calendarCardsListeners)r.calendarCards.addEventListener(e,this._handleCalendarCardEvent)}},{kind:"field",key:"_handleCalendarCardEvent",value(){var e=this;return function(t){var r,n,i;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:o,silent:l}=a;if(!l)switch(o){case"added":if(!t.isTempCard&&!e.isCalendarCardLoaded(t))break;m()(r=e._calendarCardsListeners[o]).call(r,(e=>e(t,a)));break;case"updated":case"deleted":m()(n=e._calendarCardsListeners[o]).call(n,(e=>e(t,a)));break;case"cleared":m()(i=e._calendarCardsListeners[o]).call(i,(e=>e(a)))}}}},{kind:"method",key:"_waitActiveRequestsAsync",value:async function _waitActiveRequestsAsync(e){const t=this._cache.get(e);for(;;){var r,n;let i=[...this._outlookIntegrationSrv.getRestPromises(e),...b()(r=E()(n=t.cardsUpdateBuffers).call(n)).call(r,(e=>e.processUpdatePromise))];if(0===i.length)break;await S().allSettled(i)}}},{kind:"method",key:"_requestReloadCalendarCards",value:function _requestReloadCalendarCards(e){const t=this._cache.get(e);t.reloadCalendarCardsRequested=!0,t.busyCalendarIds.clear()}},{kind:"method",key:"_setOutlookCalendarsBusy",value:function _setOutlookCalendarsBusy(e,t,r){const n=this._cache.get(e);this._$rootScope.$evalAsync((()=>{for(let e of t)n.busyCalendarIds.set(e,r)}))}},{kind:"method",key:"_getOutlookCalendarEventsAsync",value:async function _getOutlookCalendarEventsAsync(e,t,r){let n=[];return t=[...t],await S().all(b()(t).call(t,(async t=>{if(!this.provider.invalidAccountIds.has(e))try{let i=await this._outlookIntegrationSrv.listAsync(e,`me/calendars/${t}/events`,"Outlook get all events in calendar",{$select:Y,$top:q.gR,$filter:`start/dateTime ge '${(0,W.Bc)(new Date,-1).toISOString()}' and end/dateTime le '${(0,W.Bc)(new Date,1).toISOString()}'`});if(r.isCanceled())return;n.push({calendarId:t,accountId:e,outlookEvents:i})}catch(t){this._platformSrv.isOffline()||this.provider.invalidAccountIds.add(e),this._$log.error("Planyway get Outlook calendar events error:"),this._$log.error(t)}}))),n}},{kind:"method",key:"_loadCalendarCardsAsync",value:async function _loadCalendarCardsAsync(e,t){await this._platformSrv.waitOnlineAsync();const r=this._cache.get(e);let n=[];for(let e of T()(i=r.loadedCalendarIds).call(i)){var i;r.loadedCalendarIds.get(e)&&n.push(e)}const a=$()(n).call(n,(e=>!r.busyCalendarIds.has(e)));try{this._setOutlookCalendarsBusy(e,a,!0);let i=await this._getOutlookCalendarEventsAsync(e,n,t);if(t.isCanceled())return;for(let e of E()(o=r.calendarCards).call(o)){var o,l;e.isTempCard||(null===(l=r.loadedCalendarIds.get(e.providerCard.outlookCalendarId))||void 0===l||l)&&r.calendarCards.delete(e.id)}for(let{calendarId:t,outlookEvents:n}of i){let i=[],a=this._outlookIntegrationSrv.getOutlookCalendarById(e,t),o=new(k())(await(0,K.qd)($()(n).call(n,(e=>e.type===H.hC.SeriesMaster)),(async t=>{let r=await this._outlookIntegrationSrv.restAsync(e,H.Tu.Get,`me/events/${t.id}`,"Get Outlook occurrences and exceptions",{$select:Q},3,!0);return[t.id,r]}),4));for(let t of n){if(t.isCancelled)continue;let r=V.fb.createCard(e,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:t,outlookCalendar:a});if(o.has(t.id)){let n=o.get(t.id);for(let t of n.exceptionOccurrences){let n=V.fb.createCard(e,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:t,outlookCalendar:a});i.push(n),r.addExceptionDate(n.exceptionDate)}for(let e of n.cancelledOccurrences){let t=e.match(/.+\.(\d{4}-\d{2}-\d{2})/)[1];if(!t)continue;let n=(0,W.q_)((0,W.oy)(t),r.start);r.addExceptionDate(n)}}i.push(r)}for(let e of i)r.calendarCards.add(e);this._$rootScope.$broadcast(H.FK.CollectionCalendarReady,{accountId:e,calendarId:t})}for(let e of n)r.loadedCalendarIds.set(e,!1)}finally{t.isCanceled()||this._setOutlookCalendarsBusy(e,a,!1)}r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout);const pollOutlookEventsAsync=async()=>{if(await this._platformSrv.waitOnlineAsync(),!this.provider.invalidAccountIds.has(e)){await this._waitActiveRequestsAsync(e);try{await this._pollOutlookEventsAsync(e)}catch(e){this._$log.error("Planyway poll Outlook events error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway poll Outlook events error",e,{class:this.constructor.name,method:this._pollOutlookEventsAsync.name})}r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollOutlookEventsAsync()),6e4,!1)}};r.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollOutlookEventsAsync()),6e4,!1)}},{kind:"method",key:"_pollOutlookEventsAsync",value:async function _pollOutlookEventsAsync(e){var t;const r=this._cache.get(e),n=this._appCommonSrv.getCancellationToken(`pollOutlookEvents_${e}`);let i=B()(T()(t=r.loadedCalendarIds).call(t)),a=await this._getOutlookCalendarEventsAsync(e,i,n);if(!n.isCanceled())for(let{calendarId:t,outlookEvents:n}of a){if(!r.loadedCalendarIds.has(t))continue;let i=new(k());for(let e of E()(o=r.calendarCards).call(o)){var o;e.providerCard.outlookCalendarId===t&&i.set(e.id,e)}let a={},l=[],s=[],d=[],c=this._outlookIntegrationSrv.getOutlookCalendarById(e,t),u=new(k())(await(0,K.qd)($()(n).call(n,(e=>e.type===H.hC.SeriesMaster)),(async t=>{let r=await this._outlookIntegrationSrv.restAsync(e,H.Tu.Get,`me/events/${t.id}`,"Get Outlook occurrences and exceptions",{$select:Q},3,!0);return[t.id,r]}),4));for(let t of n){let n=V.fb.createCard(e,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:t,outlookCalendar:c});if(u.has(t.id)){let i=u.get(t.id);for(let t of i.exceptionOccurrences){let i=V.fb.createCard(e,H.lP.Outlook,K.eT.OutlookEvent,{outlookEvent:t,outlookCalendar:c}),a=r.calendarCards.get(i.id);if(a){if(a.equals(i)){n.addExceptionDate(i.exceptionDate);continue}s.push(i)}else d.push(i);n.addExceptionDate(i.exceptionDate)}a[n.id]=[];for(let e of i.cancelledOccurrences){let t=e.match(/.+\.(\d{4}-\d{2}-\d{2})/)[1];if(!t)continue;let r=(0,W.q_)((0,W.oy)(t),n.start);n.addExceptionDate(r),a[n.id].push(r)}}let i=(0,G.h7)(t.id,c.shortId),o=r.calendarCards.get(i);if(o){if(o.equals(n))continue;s.push(n)}else d.push(n)}for(let e of E()(i).call(i))if(!e.isTempCard)if(e.recurrenceId)if(F()(l).call(l,(t=>t.id===e.recurrenceId)))l.push(e);else{let t=a[e.recurrenceId];t&&!F()(t).call(t,(t=>(0,W.rs)(t,e.exceptionDate)))||l.push(e)}else{if(!N()(n).call(n,(t=>t.id===e.providerCard.outlookEventId))){l.push(e);for(let t of E()(i).call(i))t.recurrenceId===e.id&&l.push(t)}}for(let e of l)r.calendarCards.delete(e);for(let e of s)r.calendarCards.update(e);for(let e of d)r.calendarCards.add(e)}}},{kind:"method",key:"_processCardUpdateBufferAsync",value:async function _processCardUpdateBufferAsync(e,t,r,n){if(r.processUpdatePromise)return r.processUpdatePromise;const i=this._cache.get(e),{immediateUpdate:a}=n;try{for(a||await(0,W.$U)(200);r.changes;){let n=r.changes;r.changes=null;let i=this.getCalendarCardById(e,t);if(!i)return;let a={title:"subject",description:"description",isCompleted:"subject",isAllDay:"isAllDay",start:"start",end:"end",recurrenceRule:"recurrence",outlookShowAs:"showAs",outlookInviteStatus:"responseStatus",outlookAttendees:"attendees",outlookLocations:"locations"},o=[],l=null;for(let e in n){let t=a[e];t&&o.push(t),"outlookCalendarId"===e&&(l=i.providerCard.outlookCalendarId),e in i?i[e]=n[e]:e in i.providerCard&&(i.providerCard[e]=n[e])}(n.start||n.end)&&i.correctRecurrenceDates(),await this.updateCalendarCardAsync(i,{waitForUpdate:!1,includeOutlookFields:o,movedFromCalendarId:l})}}finally{i.cardsUpdateBuffers.delete(t)}}}]}}))},21226:(e,t,r)=>{r.d(t,{$:()=>ve});var n=r(40024),i=r.n(n),a=r(57445),o=r.n(a),l=r(51791),s=r.n(l),d=r(90143),c=r.n(d),u=r(56626),h=r.n(u),p=r(67552),v=r.n(p),f=r(62079),C=r.n(f),m=r(52020),y=r.n(m),k=r(88546),_=r.n(k),g=r(66775),w=r.n(g),E=r(2201),D=r.n(E),S=r(26171),A=r(26881),b=r(23513),I=r.n(b),T=r(54847),O=r.n(T),P=r(10349),x=r.n(P),$=r(31082),R=r.n($),N=r(89221),M=r.n(N),F=r(99595),z=r.n(F),L=r(35820),U=r.n(L),B=r(88946),K=r.n(B),j=r(8244),G=r.n(j),V=r(53706),H=r.n(V),q=r(86981),Z=r.n(q),W=r(73324),Y=r.n(W),Q=r(76555),X=r.n(Q),J=r(45181),ee=r.n(J),te=r(6767),re=r.n(te),ne=r(99560),ie=r.n(ne),ae=r(82617),oe=r(56777),le=(r(3884),r(8937)),se=r(20115),de=r(54840),ce=r(29704);function ownKeys(e,t){var r=C()(e);if(y()){var n=y()(e);t&&(n=Y()(n).call(n,(function(t){return _()(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?z()(r=ownKeys(Object(i),!0)).call(r,(function(t){(0,S.Z)(e,t,i[t])})):w()?D()(e,w()(i)):z()(n=ownKeys(Object(i))).call(n,(function(t){o()(e,t,_()(i,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var r;z()(r=["method","field"]).call(r,(function(r){z()(t).call(t,(function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r,n=e.prototype;z()(r=["method","field"]).call(r,(function(r){z()(t).call(t,(function(t){var i=t.placement;if(t.kind===r&&("static"===i||"prototype"===i)){var a="static"===i?e:n;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}o()(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(z()(e).call(e,(function(e){this.addElementPlacement(e,i)}),this),z()(e).call(e,(function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var a=this.decorateConstructor(r,t);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==s()(n).call(n,e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,a=i.length-1;a>=0;a--){var o=t[e.placement];c()(o).call(o,s()(o).call(o,e.key),1);var l=this.fromElementDescriptor(e),d=this.toElementFinisherExtras((0,i[a])(l)||l);e=d.element,this.addElementPlacement(e,t),d.finisher&&n.push(d.finisher);var u=d.extras;if(u){for(var h=0;h<u.length;h++)this.addElementPlacement(u[h],t);r.push.apply(r,u)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){e=a.elements;for(var o=0;o<e.length-1;o++)for(var l=o+1;l<e.length;l++)if(e[o].key===e[l].key&&e[o].placement===e[l].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return o()(t,h(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return K()(t=(0,A.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:r,placement:n,descriptor:v()({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:K()(e).call(e,this.fromElementDescriptor,this)};return o()(t,h(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[i()];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ue=["id","mail","displayName","userType"].join(),he="fakeContact/",pe={[le.FK.AccountAdding]:le.FK.AccountAdded,[le.FK.AccountDeleting]:le.FK.AccountDeleted,[le.FK.CalendarsChanging]:le.FK.CalendarsChanged};let ve=function _decorate(e,t,r,n){var i,a=_getDecoratorsApi();if(n)for(var o=0;o<n.length;o++)a=n[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,s.elements)}),r),s=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var n,i=e[r];if("method"===i.kind&&(n=Z()(t).call(t,isSameElement)))if(_isDataDescriptor(i.descriptor)||_isDataDescriptor(n.descriptor)){if(_hasDecorators(i)||_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");n.descriptor=i.descriptor}else{if(_hasDecorators(i)){if(_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");n.decorators=i.decorators}_coalesceGetterSetter(i,n)}else t.push(i)}return t}(K()(i=l.d).call(i,_createElementDescriptor)),e);return a.initializeClassElements(l.F,s.elements),a.runClassFinishers(l.F,s.finishers)}([(0,ce.SG)(["$injector","$rootScope","$log","$timeout","$window","$translate","appCommonSrv","dialogSrv","notificationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv","collectionSrv"])],(function(e){return{F:class OutlookIntegrationService{constructor(t,r,n,i,a,o,l,s,d,c,u,h,p,v){e(this),this._$injector=t,this._$rootScope=r,this._$log=n,this._$timeout=i,this._$window=a,this._$translate=o,this._appCommonSrv=l,this._dialogSrv=s,this._notificationSrv=d,this._planywayIntegrationSrv=c,this._platformSrv=u,this._settingsSrv=h,this._telemetrySrv=p,this._collectionSrv=v,this._initializedAccounts=new(I());const onSourceChanged=async(e,t)=>{if(t&&t.accountType!==ae.Qm.Outlook)return;switch(e.name){case le.FK.AccountAdding:await this._addOutlookAccountAsync(t.accountId);break;case le.FK.AccountDeleting:this._removeOutlookAccount(t.accountId)}let r=pe[e.name];r&&this._$rootScope.$broadcast(r,t)};this._$rootScope.$on(le.FK.AccountAdding,onSourceChanged),this._$rootScope.$on(le.FK.AccountDeleting,onSourceChanged),this._$rootScope.$on(le.FK.CalendarsChanging,onSourceChanged)}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"outlookIntegrationSrv"}},{kind:"field",key:"_provider",value:()=>(0,oe.VH)(le.lP.Outlook)},{kind:"field",key:"_cache",value:()=>new(O())},{kind:"field",key:"_initializedCollectionId",value:()=>null},{kind:"field",key:"_isIntegrationBusy",value:()=>!1},{kind:"field",key:"_outlookCalendarsListeners",value:()=>({added:new(I()),updated:new(I()),deleted:new(I()),cleared:new(I())})},{kind:"get",key:"_outlookCardsSrv",value:function _outlookCardsSrv(){return this._outlookCardsSrvLazy||(this._outlookCardsSrvLazy=this._$injector.get("outlookCardsSrv")),this._outlookCardsSrvLazy}},{kind:"method",key:"isIntegrationBusy",value:function isIntegrationBusy(){return this._isIntegrationBusy}},{kind:"method",key:"reconnectAccountAsync",value:async function reconnectAccountAsync(e){this._telemetrySrv.logSessionEvent(le.cN.CollectionEvents.CollectionAddAccountDialogOpened,{where:le.Zz.SidebarReconnectAccount});let t=await this._dialogSrv.showAddAccountDialogAsync({account:e});t?t.accountId===e.accountId?this._telemetrySrv.logSessionEvent(le.cN.GeneralEvents.AccountReconnected,{accountType:t.accountType}):this._telemetrySrv.logSessionEvent(le.cN.GeneralEvents.AccountConnected,{accountType:t.accountType}):this._telemetrySrv.logSessionEvent(le.cN.CollectionEvents.CollectionAddAccountDialogClosed,{where:le.Zz.SidebarReconnectAccount})}},{kind:"method",key:"refreshAccessTokenAsync",value:async function refreshAccessTokenAsync(e){let t=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!t)return;let r=await this._planywayIntegrationSrv.refreshAccountAsync({accountId:e,accountType:ae.Qm.Outlook,outlookScopes:x()(R()(le.mV))});if(r)return r.accountName=t.accountName,r.accountEmail=t.accountEmail,this._provider.invalidAccountIds.has(e)&&this._$rootScope.$evalAsync((()=>this._provider.invalidAccountIds.delete(e))),r;this._platformSrv.isOffline()||this._$rootScope.$evalAsync((()=>this._provider.invalidAccountIds.add(e)))}},{kind:"method",key:"getRestPromises",value:function getRestPromises(e){if(!this._initializedAccounts.has(e))return new(I());return this._cache.get(e).restPromises}},{kind:"method",key:"restAsync",value:async function restAsync(e,t,r,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6]?se.jK:se.Yj,l={token:await this._getAccessTokenAsync(e),headers:{Prefer:"outlook.body-content-type=text"},maxRetryCount:a};try{switch(t){case le.Tu.Get:case le.Tu.Delete:l.query=i;break;default:l.body=i}return await this._restAsync(e,t,`${o}/${r}`,n,l)}catch(i){if(401===i.status||!i.status){let i=await this.refreshAccessTokenAsync(e);if(i)return l.token=i.outlookCredentials.accessToken,this._restAsync(e,t,`${o}/${r}`,n,l)}throw i}}},{kind:"method",key:"listAsync",value:async function listAsync(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.useBeta?se.jK:se.Yj;i=_objectSpread(_objectSpread({},i),{},{token:await this._getAccessTokenAsync(e),headers:{Prefer:"outlook.body-content-type=text"}});try{return await this._listAsync(e,`${a}/${t}`,r,n,i)}catch(o){if(401===o.status||!o.status){let o=await this.refreshAccessTokenAsync(e);if(o)return i.token=o.outlookCredentials.accessToken,this._listAsync(e,`${a}/${t}`,r,n,i)}throw o}}},{kind:"get",key:"isCurrentCollectionInitialized",value:function isCurrentCollectionInitialized(){return this._initializedCollectionId===this._currentCollectionId}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){try{var t,r;this._appCommonSrv.setSchedulerBusy(!0),this._initializedCollectionId=null,this._initializedAccounts.clear();for(let e of M()(n=this._cache).call(n)){var n;e.destroy()}this._cache.clear(),z()(t=this._provider.getCurrentCollectionConnectedAccountIds()).call(t,(e=>this._resetAccountCache(e))),await U().all(K()(r=this._provider.getCurrentCollectionConnectedAccountIds()).call(r,(async t=>{await this._initOutlookConnectAsync(t,e)}))),this._initializedCollectionId=this._currentCollectionId,this._outlookCardsSrv.initCurrentCollectionAsync(e)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"isCurrentCollectionAccountReady",value:function isCurrentCollectionAccountReady(e){var t;return!!this._initializedAccounts.has(e)&&G()(t=this._provider.getCurrentCollectionSelectedCalendarIds(e)).call(t,(t=>this.getOutlookCalendarById(e,t)))}},{kind:"method",key:"getOutlookUserAsync",value:async function getOutlookUserAsync(e){let t=await this._getOutlookUserDataAsync(e);return this._fromOutlookUser(e,t)}},{kind:"method",key:"getOutlookUser",value:function getOutlookUser(e){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).user}},{kind:"method",key:"getOutlookContacts",value:function getOutlookContacts(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return x()(M()(t=r.contacts).call(t))}},{kind:"method",key:"getOutlookContactByEmail",value:function getOutlookContactByEmail(e,t){if(!this._initializedAccounts.has(e))return;const r=this._cache.get(e);return r.user.email===t?r.user:r.contacts.get(t)}},{kind:"method",key:"getFakeContact",value:function getFakeContact(e){return this._fromOutlookUser(void 0,{email:e,fullName:`${he}${e}`})}},{kind:"method",key:"getOutlookRooms",value:function getOutlookRooms(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return x()(M()(t=r.rooms).call(t))}},{kind:"method",key:"getOutlookRoomByEmail",value:function getOutlookRoomByEmail(e,t){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).rooms.get(t)}},{kind:"method",key:"getOutlookCalendars",value:function getOutlookCalendars(e){var t;if(!this._initializedAccounts.has(e))return[];const r=this._cache.get(e);return M()(t=r.calendars).call(t)}},{kind:"method",key:"getOutlookCalendarById",value:function getOutlookCalendarById(e,t){if(!this._initializedAccounts.has(e))return;return this._cache.get(e).calendars.get(t)}},{kind:"method",key:"isConnectedOutlookCalendarBusy",value:function isConnectedOutlookCalendarBusy(e,t){return this._outlookCardsSrv.isOutlookCalendarBusy(e,t)}},{kind:"method",key:"addOutlookCalendarEventListener",value:function addOutlookCalendarEventListener(e,t){let r=this._outlookCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.add(t)}},{kind:"method",key:"removeOutlookCalendarEventListener",value:function removeOutlookCalendarEventListener(e,t){let r=this._outlookCalendarsListeners[e];if(!r)throw new Error(`Unsupported event type: ${e}`);r.delete(t)}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"field",key:"_handleCalendarEvent",value(){var e=this;return function(t){var r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{event:i,silent:a}=n;if(a)return;if(z()(r=e._outlookCalendarsListeners[i]).call(r,(e=>e(t,n))),"cleared"===i)return void e._$rootScope.$broadcast(le.FK.TimelineResourcesReloaded,{resourcesType:le.y.Calendars});const o=t.accountId;if(e._provider.getCurrentCollectionConnectedCalendar(o,t.id).isSelected){switch(i){case"added":case"updated":case"deleted":e.isCurrentCollectionAccountReady(o)&&e._$rootScope.$broadcast(le.FK.CollectionAccountReady,{accountId:o})}switch(i){case"updated":t.name!==n.oldValue.name&&e._$rootScope.$broadcast(le.FK.TimelineResourcesReloaded,{resourcesType:le.y.Calendars});break;case"deleted":e._$rootScope.$broadcast(le.FK.TimelineResourcesReloaded,{resourcesType:le.y.Calendars})}}}}},{kind:"method",key:"_getOutlookUserDataAsync",value:async function _getOutlookUserDataAsync(e){let t=await this.restAsync(e,le.Tu.Get,"me","Get Outlook me",{$select:ue});return{id:t.id,email:t.mail||t.userPrincipalName,fullName:t.displayName||t.userPrincipalName,userType:t.userType}}},{kind:"method",key:"_getUsersAsync",value:async function _getUsersAsync(e){try{let t=await this.listAsync(e,"users","Get Outlook Users");return H()(t).call(t,((t,r)=>{let n=this._fromOutlookUser(e,{id:r.id,email:r.mail,fullName:r.displayName});return n.email&&t.push(n),t}),[])}catch(e){if("Parser is unable to parse the response"===e.message)return[];if(403===e.status)return[];throw e}}},{kind:"method",key:"_getContactsAsync",value:async function _getContactsAsync(e){try{let t=await this.listAsync(e,"me/contacts","Get Outlook User Contacts");return H()(t).call(t,((t,r)=>{var n,i;let a=this._fromOutlookUser(e,{id:r.id,email:null===(n=Z()(i=r.emailAddresses).call(i,(e=>e.address)))||void 0===n?void 0:n.address,fullName:r.displayName});return a.email&&t.push(a),t}),[])}catch(e){if("Parser is unable to parse the response"===e.message)return[];if(403===e.status)return[];throw e}}},{kind:"method",key:"_getRoomsAsync",value:async function _getRoomsAsync(e){try{let t=await this.listAsync(e,"me/findRooms","Get Outlook Rooms",null,{useBeta:!0});return H()(t).call(t,((t,r)=>{let n=this._fromOutlookRoom(e,r);return n.email&&t.push(n),t}),[])}catch(e){if("Parser is unable to parse the response"===e.message)return[];if(403===e.status)return[];throw e}}},{kind:"method",key:"_setIntegrationBusy",value:function _setIntegrationBusy(e){this._$rootScope.$evalAsync((()=>this._isIntegrationBusy=e))}},{kind:"method",key:"_resetAccountCache",value:function _resetAccountCache(e){var t;null===(t=this._cache.get(e))||void 0===t||t.destroy();const r={restPromises:new(I()),calendars:new de.v("id"),styleElements:new(O()),destroy:()=>{r.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(r.calendarsUpdatesPollingTimeout),r.calendars.clear();for(let e in this._outlookCalendarsListeners)r.calendars.removeEventListener(e,this._handleCalendarEvent)}};this._cache.set(e,r);for(let e in this._outlookCalendarsListeners)r.calendars.addEventListener(e,this._handleCalendarEvent)}},{kind:"method",key:"_addOutlookAccountAsync",value:async function _addOutlookAccountAsync(e){try{this._appCommonSrv.setSchedulerBusy(!0),this._initializedCollectionId=null,this._initializedAccounts.delete(e),this._provider.invalidAccountIds.delete(e),this._resetAccountCache(e),await this._initOutlookConnectAsync(e),this._initializedCollectionId=this._currentCollectionId,this._outlookCardsSrv.addOutlookAccountAsync(e)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"_removeOutlookAccount",value:function _removeOutlookAccount(e){var t;this._initializedAccounts.delete(e),null===(t=this._cache.get(e))||void 0===t||t.destroy(),this._cache.delete(e),this._outlookCardsSrv.removeOutlookAccount(e)}},{kind:"method",key:"_initOutlookConnectAsync",value:async function _initOutlookConnectAsync(e,t){if(t=t||this._appCommonSrv.getCancellationToken(`initOutlookConnect_${e}`),!this._currentCollectionId)return;if(this._initializedAccounts.has(e))return;await this._platformSrv.waitOnlineAsync();const r=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!r)return;const n=this._cache.get(e);try{var i;this._setIntegrationBusy(!0);let a=await this._getAccessTokenAsync(e);if(t.isCanceled())return;if(!a)return this._initializedAccounts.add(e),void this._setIntegrationBusy(!1);let[o,l,s]=await U().all([this._getOutlookUserDataAsync(e),this._getUsersAsync(e),this._getContactsAsync(e)]);if(n.user=this._fromOutlookUser(e,o),r.accountName=n.user.fullName,r.accountEmail=n.user.email,o.userType){let t=await this._getRoomsAsync(e);n.rooms=new(O())(K()(t).call(t,(e=>[e.email,e])))}else n.rooms=new(O());n.contacts=new(O())(K()(i=[...Y()(l).call(l,(e=>!n.rooms.has(e.email))),...s]).call(i,(e=>[e.email,e])));let d=await this._getOutlookCalendarsAsync(e);if(t.isCanceled())return;this._initializedAccounts.add(e),this._setIntegrationBusy(!1);for(let t of d)t.isDeleted||(n.calendars.add(t),this._setupOutlookCalendarStyle(e,t));n.calendarsUpdatesPollingTimeout&&this._$timeout.cancel(n.calendarsUpdatesPollingTimeout);const pollOutlookCalendarsAsync=async()=>{await this._platformSrv.waitOnlineAsync();try{await this._pollOutlookCalendarsAsync(e)}catch(e){this._$log.error("Planyway poll Outlook calendars error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway poll Outlook calendars error",e,{class:this.constructor.name,method:this._pollOutlookCalendarsAsync.name})}n.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollOutlookCalendarsAsync()),6e4,!1)};n.calendarsUpdatesPollingTimeout=this._$timeout((()=>pollOutlookCalendarsAsync()),6e4,0,!1)}catch(t){this._initializedAccounts.add(e),this._setIntegrationBusy(!1),this._$log.error("Outlook load data error:"),this._$log.error(t),this._telemetrySrv.logError("Outlook load data error",t,{class:this.constructor.name,method:this._initOutlookConnectAsync.name}),this._planywayIntegrationSrv.getPrimaryAccount().accountId===e?await this._planywayIntegrationSrv.signOutAsync():(this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.LOAD_OUTLOOK_DATA_ERROR"),le.k$.Error),this._platformSrv.isOffline()||this._provider.invalidAccountIds.add(e))}}},{kind:"method",key:"_pollOutlookCalendarsAsync",value:async function _pollOutlookCalendarsAsync(e){if(this._provider.invalidAccountIds.has(e))return;const t=this._appCommonSrv.getCancellationToken(`pollOutlookCalendars_${e}`);let r=await this._getOutlookCalendarsAsync(e);if(t.isCanceled())return;if(0===r.length)return;const n=this._cache.get(e);let i=new(O());for(let e of M()(a=n.calendars).call(a)){var a;i.set(e.id,e)}let o=new(O()),l=!1;for(let e of r){if(o.set(e.id,e),e.isDeleted)continue;let t=i.get(e.id);t?t.name===e.name&&(0,ce.h0)(t.color,e.color)&&t.isReadOnly===e.isReadOnly||(n.calendars.update(e),l=!0):(n.calendars.add(e),l=!0)}for(let e of M()(i).call(i)){Z()(r).call(r,(t=>t.id===e.id))||(n.calendars.delete(e),l=!0)}l&&this._$rootScope.$broadcast(le.FK.TimelineResourcesReloaded,{resourcesType:le.y.Calendars})}},{kind:"method",key:"_getOutlookCalendarsAsync",value:async function _getOutlookCalendarsAsync(e){try{var t;let r=await this.listAsync(e,"me/calendars","Get Outlook Calendars");return X()(t=K()(r).call(r,(t=>({id:t.id,shortId:ie()(t.id),accountId:e,name:t.name,color:getOutlookColor(t.hexColor||"#0078d4"),isPrimary:t.isDefaultCalendar,isReadOnly:!t.canEdit,isDeleted:!t.canEdit})))).call(t,((e,t)=>e.isPrimary?-1:t.isPrimary?1:(0,ce.A5)(e.name,t.name)||(0,ce.A5)(e.id,t.id)))}catch(t){return this._platformSrv.isOffline()||this._provider.invalidAccountIds.add(e),this._$log.error("Planyway get outlook calendars error:"),this._$log.error(t),[]}}},{kind:"method",key:"_getAccessTokenAsync",value:async function _getAccessTokenAsync(e){let t=this._planywayIntegrationSrv.getConnectedAccountById(e);if(!t)return;if(t.outlookCredentials.accessToken&&new Date(t.outlookCredentials.expirationDate)>new Date)return t.outlookCredentials.accessToken;let r=await this.refreshAccessTokenAsync(e);return r?r.outlookCredentials.accessToken:void 0}},{kind:"method",key:"_setupOutlookCalendarStyle",value:function _setupOutlookCalendarStyle(e,t){const r=this._cache.get(e);let n=r.calendars.get(t.shortId);n||(n=this._$window.document.createElement("style"),n.setAttribute("type","text/css"),this._$window.document.head.appendChild(n),r.styleElements.set(t.shortId,n)),n.innerHTML=this._provider.getCalendarExtraCardStyle(t)}},{kind:"method",key:"_fromOutlookUser",value:function _fromOutlookUser(e,t){var r,n,i;const{id:a,email:o}=t;let l=null!==(r=t.fullName)&&void 0!==r&&ee()(r).call(r,he)?"":t.fullName,s=null==l?void 0:l.split(" ");return{id:null!=a?a:o,accountId:e,email:o,fullName:null!=l?l:o,initials:l?(0,ce.Oo)(`${(null===(n=s[0])||void 0===n?void 0:n.substring(0,1))||""}${(null===(i=s[1])||void 0===i?void 0:i.substring(0,1))||""}`):(0,ce.Oo)((null==o?void 0:o.substring(0,1))||"")}}},{kind:"method",key:"_fromOutlookRoom",value:function _fromOutlookRoom(e,t){var r,n;const{name:i,address:a}=t;let o=null==i?void 0:i.split(" ");return{id:a,accountId:e,displayName:i,email:a,initials:i?(0,ce.Oo)(`${(null===(r=o[0])||void 0===r?void 0:r.substring(0,1))||""}${(null===(n=o[1])||void 0===n?void 0:n.substring(0,1))||""}`):(0,ce.Oo)((null==a?void 0:a.substring(0,1))||"")}}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=this._cache.get(e);let o,l,s=this._telemetrySrv.logRequest(n,t,r,_objectSpread(_objectSpread({},i.query),i.body)),d=200;try{return l=this._platformSrv.restAsync(t,r,i),a&&a.restPromises.add(l),await l}catch(e){throw d=e.status,o=e.response,e}finally{this._telemetrySrv.logRequestEnd(s,d,o),a&&a.restPromises.delete(l)}}},{kind:"method",key:"_listAsync",value:async function _listAsync(e,t,r,n){var i;let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{maxRequestCount:o=10}=a,l=[],s=await this._restAsync(e,le.Tu.Get,t,r,_objectSpread(_objectSpread({},a),{},{query:n}));null!==(i=s.value)&&void 0!==i&&i.length&&l.push(...s.value);let d=s["@odata.nextLink"];for(;d&&(-1===o||--o>0);){var c;if(s=await this._restAsync(e,le.Tu.Get,d,r,a),null!==(c=s.value)&&void 0!==c&&c.length&&l.push(...s.value),s["@odata.nextLink"]){if(s["@odata.nextLink"]===d)throw new Error("List Outlook request failed! Duplicated next page link");d=s["@odata.nextLink"]}else d=null}return l}}]}}));function getOutlookColor(e){if(!e)return{};let t=re()(e),r=t.mix(re()("#ffffff"),.9);return{base:t.darken(.2).hex(),light:r.darken(.1).hex(),dark:r.darken(.8).hex(),highlight:r.darken(.2).hex(),controlHover:r.darken(.05).hex()}}}}]);