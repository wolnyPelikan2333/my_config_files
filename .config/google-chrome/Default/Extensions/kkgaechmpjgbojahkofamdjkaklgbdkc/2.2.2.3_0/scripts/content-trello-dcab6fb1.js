"use strict";(self.webpackChunk_planyway_planyway=self.webpackChunk_planyway_planyway||[]).push([[994],{46930:(e,t,i)=>{i.d(t,{I1:()=>isRecurrence,IK:()=>isRecurrenceException,XM:()=>U,e4:()=>isRecurrenceHead,fb:()=>F});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(67552),f=i.n(v),_=i(86981),C=i.n(_),S=i(62079),w=i.n(S),k=i(52020),b=i.n(k),D=i(73324),T=i.n(D),E=i(88546),A=i.n(E),I=i(66775),P=i.n(I),R=i(2201),L=i.n(R),N=i(26171),O=i(26881),M=i(27525),$=i.n(M),x=(i(82617),i(14587)),B=i(56777),H=(i(45911),i(71315),i(33001),i(88078),i(39790),i(8937),i(29704));function ownKeys(e,t){var i=w()(e);if(b()){var r=b()(e);t&&(r=T()(r).call(r,(function(t){return A()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?l()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,N.Z)(e,t,n[t])})):P()?L()(e,P()(n)):l()(r=ownKeys(Object(n))).call(r,(function(t){c()(e,t,A()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,O.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const U=30;let F=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=C()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}(null,(function(e){class CalendarCard{constructor(t,i,r,n,a){e(this),this._providerType=r,this._providerCard=(0,B.VH)(r).getCalendarCardClass().fromSourceCard(t,i,n,a)}}return{F:CalendarCard,d:[{kind:"get",decorators:[(0,H.lv)()],key:"providerType",value:function providerType(){return this._providerType}},{kind:"set",key:"providerType",value:function providerType(e){this._providerType=e}},{kind:"get",decorators:[(0,H.lv)()],key:"providerCard",value:function providerCard(){return this._providerCard}},{kind:"set",key:"providerCard",value:function providerCard(e){this._providerCard=e}},{kind:"get",decorators:[(0,H.lv)()],key:"id",value:function id(){return this.providerCard.id}},{kind:"get",decorators:[(0,H.lv)()],key:"accountId",value:function accountId(){return this.providerCard.accountId}},{kind:"set",key:"accountId",value:function accountId(e){this.providerCard.accountId=e}},{kind:"get",decorators:[(0,H.lv)()],key:"calendarId",value:function calendarId(){return this.providerCard.calendarId}},{kind:"get",decorators:[(0,H.lv)()],key:"cardType",value:function cardType(){return this.providerCard.cardType}},{kind:"set",key:"cardType",value:function cardType(e){this.providerCard.cardType=e}},{kind:"get",decorators:[(0,H.lv)()],key:"cardRole",value:function cardRole(){return this.providerCard.cardRole}},{kind:"set",key:"cardRole",value:function cardRole(e){this.providerCard.cardRole=e}},{kind:"get",decorators:[(0,H.lv)()],key:"title",value:function title(){return this.providerCard.title}},{kind:"set",key:"title",value:function title(e){this.providerCard.title=e}},{kind:"get",decorators:[(0,H.lv)()],key:"description",value:function description(){return this.providerCard.description}},{kind:"set",key:"description",value:function description(e){this.providerCard.description=e}},{kind:"get",decorators:[(0,H.lv)()],key:"isAllDay",value:function isAllDay(){return this.providerCard.isAllDay}},{kind:"set",key:"isAllDay",value:function isAllDay(e){this.providerCard.isAllDay!==e&&(this.providerCard.isAllDay=e,this._updateRecurrenceRule())}},{kind:"get",decorators:[(0,H.lv)()],key:"start",value:function start(){return this.providerCard.start}},{kind:"set",key:"start",value:function start(e){(0,H.rs)(this.providerCard.start,e)||(this.providerCard.start=e,e?this._updateRecurrenceRule():this.recurrenceRule=void 0)}},{kind:"get",decorators:[(0,H.lv)()],key:"previousStart",value:function previousStart(){return this.providerCard.previousStart}},{kind:"get",decorators:[(0,H.lv)()],key:"end",value:function end(){return this.providerCard.end}},{kind:"set",key:"end",value:function end(e){this.providerCard.end=e}},{kind:"get",decorators:[(0,H.lv)()],key:"previousEnd",value:function previousEnd(){return this.providerCard.previousEnd}},{kind:"get",decorators:[(0,H.lv)()],key:"hasDates",value:function hasDates(){return this.providerCard.hasDates}},{kind:"get",decorators:[(0,H.lv)()],key:"recurrenceRule",value:function recurrenceRule(){return this.providerCard.recurrenceRule}},{kind:"set",key:"recurrenceRule",value:function recurrenceRule(e){this.providerCard.recurrenceRule!==e&&(this.providerCard.recurrenceRule=e,this._updateRecurrenceRule())}},{kind:"get",decorators:[(0,H.lv)()],key:"recurrenceException",value:function recurrenceException(){return this.providerCard.recurrenceException}},{kind:"set",key:"recurrenceException",value:function recurrenceException(e){this.providerCard.recurrenceException=e}},{kind:"get",key:"exceptionDates",value:function exceptionDates(){return this.providerCard.exceptionDates}},{kind:"set",key:"exceptionDates",value:function exceptionDates(e){this.providerCard.exceptionDates=e}},{kind:"get",decorators:[(0,H.lv)()],key:"recurrenceId",value:function recurrenceId(){return this.providerCard.recurrenceId}},{kind:"set",key:"recurrenceId",value:function recurrenceId(e){this.providerCard.recurrenceId=e}},{kind:"get",key:"exceptionDate",value:function exceptionDate(){return this.providerCard.exceptionDate}},{kind:"get",decorators:[(0,H.lv)()],key:"originalStart",value:function originalStart(){return this.providerCard.originalStart}},{kind:"set",key:"originalStart",value:function originalStart(e){this.providerCard.originalStart=e}},{kind:"get",decorators:[(0,H.lv)()],key:"isTempCard",value:function isTempCard(){return this.providerCard.isTempCard}},{kind:"get",decorators:[(0,H.lv)()],key:"isReadOnly",value:function isReadOnly(){return this.providerCard.isReadOnly}},{kind:"get",decorators:[(0,H.lv)()],key:"isSingleDate",value:function isSingleDate(){return this.providerCard.isSingleDate}},{kind:"get",decorators:[(0,H.lv)()],key:"cardUrl",value:function cardUrl(){return this.providerCard.cardUrl}},{kind:"get",decorators:[(0,H.lv)()],key:"customExpand",value:function customExpand(){return this.providerCard.customExpand}},{kind:"method",static:!0,key:"createCard",value:function createCard(e,t,i,r){return new CalendarCard((0,B.VH)(t).getCardId(r),e,t,i,r)}},{kind:"method",key:"toSourceCard",value:function toSourceCard(e){return this.providerCard.toSourceCard(e)}},{kind:"method",key:"addExceptionDate",value:function addExceptionDate(e){var t;"string"==typeof e&&(e=(0,H.HE)(e)),$()(t=this.exceptionDates).call(t,(t=>(0,H.rs)(t,e)))||(this.exceptionDates=[...this.exceptionDates,e])}},{kind:"method",key:"deleteExceptionDates",value:function deleteExceptionDates(e){let t=[];if(e){for(let i of this.exceptionDates)i<e&&t.push(i);let i=x.Ci.fromString(this.recurrenceRule);i.origOptions.until=this.isAllDay?(0,H._q)((0,H.$Y)((0,H.E4)(e,-1))):(0,H._q)((0,H.E4)((0,H.h3)((0,H.wD)(e)),-1)),i.origOptions.count=null,this.recurrenceRule=i.toString({onlyDate:this.isAllDay}).replace("RRULE:","")}this.exceptionDates=t}},{kind:"method",key:"correctRecurrenceDates",value:function correctRecurrenceDates(){if(this.recurrenceRule){let e=(0,H._q)(this.start),t=new x.Ci(_objectSpread(_objectSpread({},x.Ci.parseString(this.recurrenceRule)),{},{dtstart:e})).after(e,!0);if(!(0,H.rs)(t,e)){let i=(0,H.i2)(e,t);this.start=(0,H.E4)(this.start,i),this.end=(0,H.E4)(this.end,i)}}}},{kind:"method",key:"clone",value:function clone(){let e=new CalendarCard(this.id,this.accountId,this.providerType,this.cardType);return e.providerCard=this.providerCard.clone(),e}},{kind:"method",key:"equals",value:function equals(e){return!!e&&(this.providerType===e.providerType&&this.providerCard.equals(e.providerCard))}},{kind:"method",key:"compare",value:function compare(e){return e?this.isTempCard?-1:e.isTempCard?1:e.providerCard.getCompareId()-this.providerCard.getCompareId():-1}},{kind:"method",key:"duplicate",value:function duplicate(){let e=new CalendarCard(this.id,this.accountId,this.providerType,this.cardType);return e.providerCard=this.providerCard.duplicate(),e}},{kind:"method",key:"_updateRecurrenceRule",value:function _updateRecurrenceRule(){if(this.hasDates&&this.recurrenceRule){let e=x.Ci.fromString(this.recurrenceRule);e.origOptions.until&&(e.origOptions.until<=(0,H._q)(this.start)?(e.origOptions.until=null,e.origOptions.count=1):(e.origOptions.until=this.isAllDay?(0,H._q)((0,H.$Y)((0,H.wD)(e.origOptions.until))):(0,H._q)((0,H.h3)((0,H.wD)(e.origOptions.until))),e.origOptions.count=null),this.providerCard.recurrenceRule=e.toString({onlyDate:this.isAllDay}).replace("RRULE:",""))}}}]}}));function isRecurrence(e){return e instanceof F?e.recurrenceRule||e.recurrenceId:e.isRecurring()||e.isException()}function isRecurrenceHead(e){return e instanceof F?e.recurrenceRule&&!e.recurrenceId:e.isRecurrenceHead()}function isRecurrenceException(e){return e instanceof F?e.recurrenceId:e.isException()}},8937:(e,t,i)=>{i.d(t,{$5:()=>ne,AG:()=>Y,AH:()=>Rt,B:()=>Re,BF:()=>Z,By:()=>ht,C2:()=>pt,Ch:()=>Tt,DB:()=>ct,EJ:()=>qe,Ek:()=>Se,Ez:()=>F,F6:()=>ge,FK:()=>O,Fb:()=>Bt,Fx:()=>Fe,GC:()=>He,GP:()=>wt,GW:()=>Nt,I:()=>et,IM:()=>Le,JM:()=>xt,Jm:()=>Xe,Jv:()=>Me,Jz:()=>Oe,KN:()=>De,LP:()=>rt,Lo:()=>_e,Lz:()=>Ge,MJ:()=>Wt,NQ:()=>U,Ne:()=>q,Nx:()=>M,PA:()=>_t,PT:()=>Ft,Pr:()=>Ne,SG:()=>Ct,SQ:()=>Lt,Tr:()=>L,Tu:()=>B,U1:()=>J,UR:()=>bt,Uh:()=>ye,Un:()=>H,Us:()=>z,V9:()=>Ve,VD:()=>Ze,VF:()=>St,VI:()=>Ot,Vc:()=>yt,Vh:()=>oe,Vj:()=>it,X3:()=>Ke,XO:()=>Ee,XP:()=>dt,Xh:()=>Qe,Xq:()=>N,Xs:()=>P,Yd:()=>Mt,ZV:()=>j,Zz:()=>Ht,_H:()=>G,a6:()=>At,aO:()=>we,bs:()=>Et,cA:()=>me,cN:()=>ft,cT:()=>de,cs:()=>X,dr:()=>fe,e5:()=>$t,e_:()=>ce,ek:()=>ot,ev:()=>Pt,f:()=>ke,f6:()=>je,gD:()=>tt,gJ:()=>V,gV:()=>Dt,go:()=>at,hC:()=>ze,hP:()=>wrapEnum,hh:()=>W,iz:()=>Pe,jj:()=>$,k$:()=>K,kK:()=>be,lC:()=>x,lP:()=>R,lV:()=>se,lv:()=>ie,mV:()=>Ye,mn:()=>ut,n_:()=>Te,nl:()=>xe,nv:()=>ae,or:()=>ue,ou:()=>It,pk:()=>Ue,qF:()=>Ut,qK:()=>mt,rW:()=>re,s7:()=>pe,sF:()=>Q,sf:()=>st,tS:()=>le,uS:()=>he,ud:()=>ee,vt:()=>Ce,wO:()=>We,wT:()=>gt,wi:()=>vt,xI:()=>nt,xj:()=>Ae,xt:()=>Be,y:()=>ve,yX:()=>$e,y_:()=>Je,yb:()=>Ie,z:()=>kt,z7:()=>lt,zc:()=>te});var r=i(62079),n=i.n(r),a=i(52020),s=i.n(a),o=i(73324),l=i.n(o),d=i(88546),c=i.n(d),h=i(99595),u=i.n(h),p=i(66775),m=i.n(p),g=i(2201),y=i.n(g),v=i(26171),f=i(57445),_=i.n(f),C=i(91829),S=i.n(C),w=i(31082),k=i.n(w),b=i(23513),D=i.n(b),T=i(10349),E=i.n(T),A=i(82617),I=i(20115);function ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=l()(r).call(r,(function(t){return c()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?u()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,v.Z)(e,t,n[t])})):m()?y()(e,m()(n)):u()(r=ownKeys(Object(n))).call(r,(function(t){_()(e,t,c()(n,t))}))}return e}function wrapEnum(e){return _()(e,"hasValue",{value:t=>{var i;return S()(i=k()(e)).call(i,t)},enumerable:!1,writable:!1}),new Proxy(e,{get(e,t){if(!e[t])throw new Error(`Enum member ${t} not found`);return e[t]},set(e,t){throw new Error(`Enum member ${t} set not allowed`)}})}const P=wrapEnum({CardCreated:"cardCreated",CardEdited:"cardEdited",CardDeleted:"cardDeleted",Cancelled:"cancelled"}),R=wrapEnum({GitHub:"github",Google:"google",ICal:"iCal",Outlook:"outlook",Trello:"trello"}),L=wrapEnum({[R.Trello]:10,[R.GitHub]:20,[R.Google]:30,[R.Outlook]:40,[R.ICal]:50}),N={[R.GitHub]:{type:R.GitHub,icon:"icons-24:github-outline",text:"BUTTONS.SIGN_IN_WITH_GITHUB"},[R.Google]:{type:R.Google,icon:"icons-24:google-outline",text:"BUTTONS.SIGN_IN_WITH_GOOGLE"},[R.Outlook]:{type:R.Outlook,icon:"icons-24:microsoft-outline",text:"BUTTONS.SIGN_IN_WITH_OUTLOOK"},[R.Trello]:{type:R.Trello,icon:"icons-24:trello-outline",text:"BUTTONS.SIGN_IN_WITH_TRELLO"}},O=wrapEnum({AppInitialized:"planywayAppInitialized",UserAuthorized:"planywayUserAuthorized",ResizeListenerWindowResized:"planywayResizeListenerWindowResized",ResizeListenerElementResized:"planywayResizeListenerElementResized",AutosizeControlsResizeRequested:"planywayAutosizeControlsResizeRequested",SwitchPlanywayShownRequested:"planywaySwitchPlanywayShownRequested",PlanywayShowing:"planywayPlanywayShowing",PlanywayShown:"planywayPlanywayShown",ScrollSchedulerViewRequested:"planywayScrollSchedulerViewRequested",ChangeSchedulerViewRequested:"planywayChangeSchedulerViewRequested",TaskListsBoardChanged:"planywayTaskListsBoardChanged",TaskListsViewChanged:"planywayTaskListsViewChanged",SettingsChanged:"planywaySettingsChanged",CardKeydown:"planywayCardKeydown",CardDragEnded:"planywayCardDragEnded",CardTypeChanged:"planywayCardTypeChanged",CardCreated:"planywayCardCreated",CardDropped:"planywayCardDropped",CardDialogClosed:"planywayCardDialogClosed",CardDialogOpenRequested:"planywayCardDialogOpenRequested",CardDialogSwitchDetailedModeRequested:"planywayCardDialogSwitchDetailedModeRequested",CardDialogSetHasChangesRequested:"planywayCardDialogSetHasChangesRequested",CardDialogKeepScrollFocusRequested:"planywayCardDialogKeepScrollFocusRequested",CardDialogHideRequested:"planywayCardDialogHideRequested",CardDialogLogCardEventRequested:"planywayCardDialogLogCardEventRequested",CardDialogKeyDown:"planywayCardDialogKeyDown",CardsFieldsSettingsChanged:"planywayCardsFieldsSettingsChanged",CheckListItemDragEnded:"planywayCheckListItemDragEnded",CreateCalendarCardRequested:"planywayCreateCalendarCardRequested",CloseDialogsRequested:"planywayCloseDialogsRequested",CloseContextMenusRequested:"planywayCloseContextMenusRequested",CardsReloaded:"planywayCardsReloaded",TrelloBoardSelectionChanged:"planywayTrelloBoardSelectionChanged",GoogleCalendarSelectionChanged:"planywayGoogleCalendarSelectionChanged",OutlookCalendarSelectionChanged:"planywayOutlookCalendarSelectionChanged",GitHubProjectSelectionChanged:"planywayGitHubProjectSelectionChanged",GitHubTaskListsProjectChanged:"planywayGitHubTaskListsProjectChanged",GitHubPollingCardsFetched:"planywayGitHubPollingCardsFetched",GitHubProjectExternalRepositoriesUpdated:"planywayGitHubProjectExternalRepositoriesUpdated",OpenNestedContextMenuRequested:"planywayOpenNestedContextMenuRequested",TaskListsAddCheckItemRequested:"planywayTaskListsAddCheckItemRequested",WorkPanelReloaded:"planywayWorkPanelReloaded",TimelineResourcesReloaded:"planywayTimelineResourcesReloaded",TimelineResourcesReordered:"planywayTimelineResourcesReordered",TimelineResourceRemoveRequested:"planywayTimelineResourceRemoveRequested",TimelineScrolled:"planywayTimelineScrolled",FilterByCurrentMemberRequested:"planywayFilterByCurrentMemberRequested",FiltersChanged:"planywayFiltersChanged",ToggleSidebarIsShownRequested:"planywayToggleSidebarIsShownRequested",SelectCardsRequested:"planywaySelectCardsRequested",NotificationsRead:"planywayNotificationsRead",NotificationsChanged:"planywayNotificationsChanged",TrialLicenseActivated:"planywayTrialLicenseActivated",HideButtonOnboardingRequested:"planywayHideButtonOnboardingRequested",HideProviderCalloutRequested:"planywayHideProviderCalloutRequested",AccountAdding:"planywayAccountAdding",AccountAdded:"planywayAccountAdded",AccountDeleting:"planywayAccountDeleting",AccountDeleted:"planywayAccountDeleted",CollectionAccountReady:"planywayCollectionAccountReady",OfflineStateChanged:"planywayOfflineStateChanged",CollectionChanging:"planywayCollectionChanging",CollectionChanged:"planywayCollectionChanged",CollectionUpdated:"planywayCollectionUpdated",CollectionCalendarReady:"planywayCollectionCalendarReady",CalendarsChanging:"planywayCalendarsChanging",CalendarsChanged:"planywayCalendarsChanged",SingleCalendarSelectionRequested:"planywaySingleCalendarSelectionRequested",TaskListsBoardSwitched:"planywayTaskListsBoardSwitched",TaskListsGitHubProjectSwitched:"planywayTaskListsGitHubProjectSwitched",TrelloCardChanged:"planywayTrelloCardChanged"}),M=wrapEnum({ExchangeAuthData:"planywayExchangeAuthData",GenericEvent:"planywayGeneric",ClearBackgroundStorage:"planywayClearBackgroundStorage",CloseApp:"planywayCloseApp",ReloadApp:"planywayReloadApp",GetTelemetryData:"planywayGetTelemetryData",SetTelemetryData:"planywaySetTelemetryData",GetAppStorageData:"planywayGetAppStorageData",SetAppStorageData:"planywaySetAppStorageData",StartAppNotificationsPolling:"planywayStartAppNotificationsPolling",SetAppUnreadNotificationsCount:"planywaySetAppUnreadNotificationsCount",CheckSignIn:"checkSignIn",SignIn:"planywaySignIn",OpenStandalone:"openStandalone",Rest:"planywayRest",OnRetry:"planywayOnRetry",OnProgress:"planywayOnProgress",ShowIntercomChat:"planywayShowIntercomChat",UpdateIntercomUser:"planywayUpdateIntercomUser",IntercomChatInitialized:"planywayIntercomChatInitialized",IntercomChatShown:"planywayIntercomChatShown",IntercomChatHidden:"planywayIntercomChatHidden",IntercomPreviewShown:"planywayIntercomPreviewShown",IntercomPreviewHidden:"planywayIntercomPreviewHidden"}),$=wrapEnum({GetAuthData:"get_auth_data",LoadTelemetryData:"load_telemetry_data",SaveTelemetryData:"save_telemetry_data",InjectIntercomScript:"inject_intercom_script",Redirect:"redirect",SubscribeNotifications:"subscribe_notifications",LoadPushNotificationsSubscription:"load_push_notifications_subscription",SavePushNotificationsSubscription:"save_push_notifications_subscription"}),x=wrapEnum({OpenBoard:"openBoard"}),B=wrapEnum({Get:"get",Patch:"patch",Put:"put",PutForm:"putForm",Post:"post",PostForm:"post_form",PostFile:"post_file",Delete:"delete"}),H=wrapEnum(_objectSpread(_objectSpread({},A.Un),{},{AllowAccessBanner:"allowAccessBanner",BrowserButton:"browserButton",Maximized:"maximized",Minimized:"minimized",Fullscreen:"fullscreen",TimeRecordSeeMore:"timeRecordSeeMore",PlanOnTimeline:"planOnTimeline",ViewOnTimeline:"viewOnTimeline",Reports:"reports",PushNotificationMemberAssigned:"pushNotificationMemberAssigned",PushNotificationMemberMentioned:"pushNotificationMemberMentioned",PushNotificationRemindStart:"pushNotificationRemindStart",NewsletterEmail:"newsletterEmail",OnboardingEmail:"onboardingEmail"})),U=wrapEnum(_objectSpread(_objectSpread({},A.NQ),{},{ShowReports:"showReports"})),F=wrapEnum({Disabled:"disabled",Enabled:"enabled",Enabling:"enabling"}),W=wrapEnum({}),z=(wrapEnum({}),wrapEnum({CalendarCreate:"calendarCreate",CalendarEdit:"calendarEdit",CalendarDelete:"calendarDelete",TimelineCreate:"timelineCreate",TimelineEdit:"timelineEdit",TimelineDelete:"timelineDelete",TimeTrackingCreate:"timeTrackingCreate",TimeTrackingEdit:"timeTrackingEdit",TimeTrackingDelete:"timeTrackingDelete",BoardCreate:"boardCreate",BoardEdit:"boardEdit",BoardDelete:"boardDelete"})),G=wrapEnum({DragAndDrop:"dragAndDrop",CardLabels:"cardLabels",VisualizeCheckItems:"visualizeCheckItems",MultiBoard:"multiBoard",GoogleConnect:"googleConnect",ShareCollection:"shareCollection",SuccessScreen:"successScreen"}),j=wrapEnum({AdvancedChecklists:"advancedChecklists",BoardView:"boardView",Dependencies:"dependencies",ExportToFile:"exportToFile",GoogleConnect:"googleConnect",GoogleSync:"googleSync",Milestones:"milestones",MultiBoard:"multiBoard",Notifications:"notifications",OutlookConnect:"outlookConnect",RecurringCards:"recurringCards",Reminders:"reminders",Reports:"reports",TaskEstimation:"taskEstimation",Timeline:"timeline",TimelineMember:"timelineMember",TimeTracking:"timeRecords",TrelloConnect:"trelloConnect"}),V={[A.oj.Free]:new(D()),[A.oj.Trial]:new(D())(k()(j)),[A.oj.Pro]:new(D())([j.AdvancedChecklists,j.BoardView,j.GoogleConnect,j.GoogleSync,j.MultiBoard,j.Notifications,j.OutlookConnect,j.RecurringCards,j.Reminders,j.Timeline,j.TimeTracking,j.TrelloConnect]),[A.oj.Team]:new(D())([j.AdvancedChecklists,j.BoardView,j.Dependencies,j.ExportToFile,j.GoogleConnect,j.GoogleSync,j.Milestones,j.MultiBoard,j.Notifications,j.OutlookConnect,j.RecurringCards,j.Reminders,j.Reports,j.TaskEstimation,j.Timeline,j.TimelineMember,j.TimeTracking,j.TrelloConnect])},K=wrapEnum({Info:"info",Success:"success",Warning:"warning",WarningWithReload:"warningWithReload",Error:"error",ErrorWithReload:"errorWithReload",Progress:"progress"}),Y=wrapEnum({Before:"defaultRemindBefore",BeforeAllDay:"defaultRemindBeforeAllDay"}),q=wrapEnum({ConnectError:"connectError",LocaleChanged:"localeChanged",Notifications:"notifications"}),Z=wrapEnum({Horizontal:"horizontal",HorizontalReverse:"horizontalReverse",Vertical:"vertical",VerticalReverse:"verticalReverse"}),X=wrapEnum({[Z.Horizontal]:Z.HorizontalReverse,[Z.HorizontalReverse]:Z.Horizontal,[Z.Vertical]:Z.VerticalReverse,[Z.VerticalReverse]:Z.Vertical}),Q=wrapEnum({Scheduler:"scheduler",WorkPanel:"workPanel"}),J=wrapEnum({Top:"top",Left:"left",Right:"right",Bottom:"bottom"}),ee=wrapEnum({Calendar:"calendar",Timeline:"timeline",TimeTracking:"timeTracking",Board:"board",Reports:"reports"}),te=wrapEnum({[ee.Board]:10,[ee.Calendar]:20,[ee.Timeline]:30,[ee.TimeTracking]:40,[ee.Reports]:50}),ie={[ee.Timeline]:j.Timeline,[ee.TimeTracking]:j.TimeTracking,[ee.Reports]:j.Reports},re=wrapEnum({Week:"scrollWeek",OneDay:"oneDay",ThreeDay:"threeDay",Month:"month",Timeline:"timeline",Timesheet:"timesheet",Board:"board",Reports:"reports"}),ne=wrapEnum({List:"list",Calendar:"calendar"}),ae=wrapEnum({Timer:"timer",Manual:"manual"}),se=wrapEnum({OpenNotificationCenter:"openNotificationCenter"}),oe=wrapEnum({Completed:"completed",Incompleted:"incompleted",All:"all"}),le=wrapEnum({None:"none",Member:"member",Board:"board",List:"list",Label:"label",GitHubAssignee:"githubAssignee",GitHubLabel:"githubLabel",GitHubStatus:"githubStatus"}),de=wrapEnum({List:"list",Kanban:"kanban"}),ce=wrapEnum({None:"none",Member:"member",Label:"label",List:"list"}),he=wrapEnum({DateCreatedNewest:"dateCreatedNewest",DateCreatedOldest:"dateCreatedOldest",CardName:"cardName",StartDate:"startDate",EndDate:"endDate"}),ue={[ce.Member]:j.BoardView,[ce.Label]:j.BoardView},pe=wrapEnum({[le.Member]:10,[le.GitHubAssignee]:15,[le.Label]:20,[le.GitHubLabel]:25,[le.Board]:30,[le.List]:40,[le.GitHubStatus]:45,[le.None]:50}),me={[le.Board]:j.Timeline,[le.Label]:j.Timeline,[le.List]:j.Timeline,[le.Member]:j.TimelineMember,[le.GitHubAssignee]:j.TimelineMember},ge=wrapEnum({Min:2e7,Max:29e10,Default:675e6,DayDefault:3e8}),ye=wrapEnum({Hour:"hour",Day:"day",Week:"week",Month:"month",Quarter:"quarter",Year:"year"}),ve=wrapEnum({NoResources:"noResources",Members:"members",Calendars:"calendars",Lists:"lists",Labels:"labels",GitHubAssignees:"githubAssignees",GitHubLabels:"githubLabels",GitHubStatuses:"statuses"}),fe=(wrapEnum({BoardView:"boardView",TaskLists:"taskLists"}),wrapEnum({FirstLabel:"firstLabel",Board:"board",NoColor:"noColor"})),_e=wrapEnum({Today:"today",DateSelect:"dateSelect",PreviousHour:"previousHour",NextHour:"nextHour",PreviousDay:"previousDay",NextDay:"nextDay",PreviousWeek:"previousWeek",NextWeek:"nextWeek",PreviousMonth:"previousMonth",NextMonth:"nextMonth",PreviousQuarter:"previousQuarter",NextQuarter:"nextQuarter",PreviousYear:"previousYear",NextYear:"nextYear",Wheel:"wheel",Scrollbar:"scrollbar",Drag:"drag"}),Ce=wrapEnum({Internal:"internal",ClosestVisible:"closestVisible",HourScroll:"hour",DayScroll:"day",WeekScroll:"week",MonthScroll:"month",QuarterScroll:"quarter",YearScroll:"year",DateSelect:"dateSelect",Today:"today"}),Se=wrapEnum({RemoveFromCalendar:"removeFromCalendar"}),we=wrapEnum({Open:"open",Edit:"edit",Remove:"remove",Delete:"delete"}),ke=wrapEnum({OnlyOccurrence:"onlyOccurrence",ThisAndFollowing:"thisAndFollowing",AllSeries:"allSeries"}),be=wrapEnum({GitHubProject:"githubProject",GoogleCalendar:"googleCalendar",ICalCalendar:"iCalCalendar",OutlookCalendar:"outlookCalendar",TrelloBoard:"trelloBoard"}),De=(wrapEnum({User:"user",Repo:"repo",Project:"project",Org:"write:org"}),wrapEnum({Calendar:I.Qe,People:I.vx,User:I.mt})),Te=(wrapEnum({Calendar:"https://www.googleapis.com/auth/calendar",Contacts:"https://www.googleapis.com/auth/contacts.readonly",Email:"https://www.googleapis.com/auth/userinfo.email",OpenId:"openid",Profile:"https://www.googleapis.com/auth/userinfo.profile"}),wrapEnum({Auth:"auth",Contacts:"contacts"}),wrapEnum({Email:"email",Popup:"popup"})),Ee=wrapEnum({Yes:"accepted",No:"declined",MayBe:"tentative",Undefined:"needsAction"}),Ae=wrapEnum({Opaque:"opaque",Transparent:"transparent"}),Ie=wrapEnum({Default:"default",Public:"public",Private:"private",Confidential:"confidential"}),Pe=wrapEnum({All:"all",ExternalOnly:"externalOnly",None:"none"}),Re=wrapEnum({Google:"google",Outlook:"microsoft",Apple:"apple",Other:"other"}),Le=wrapEnum({Admin:"admin",Normal:"normal",Observer:"observer"}),Ne={[Le.Admin]:"MISC.TRELLO_MEMBER_TYPE_ADMIN",[Le.Normal]:"MISC.TRELLO_MEMBER_TYPE_MEMBER",[Le.Observer]:"MISC.TRELLO_MEMBER_TYPE_OBSERVER"},Oe=wrapEnum({Private:"private",Organization:"org",Public:"public"}),Me=wrapEnum({Admins:"admins",Members:"members"}),$e=wrapEnum({Small:"small",Medium:"medium"}),xe=wrapEnum({Blue:"blue",Orange:"orange",Green:"green",Red:"red",Purple:"purple",Pink:"pink",Lime:"lime",Sky:"sky",Grey:"grey"}),Be=[{color:"blue",value:"#0079bf"},{color:"orange",value:"#d29034"},{color:"green",value:"#519839"},{color:"red",value:"#b04632"},{color:"purple",value:"#89609e"},{color:"pink",value:"#cd5a91"},{color:"lime",value:"#40a35b"},{color:"sky",value:"#05aecc"},{color:"grey",value:"#70777b"}],He=wrapEnum({AdvancedChecklists:"advancedChecklists",Observers:"observers",SuperAdmins:"superAdmins"}),Ue=wrapEnum({OnlyMyCards:"onlyMyCards"}),Fe=(wrapEnum({Read:"read",Write:"write",account:"account"}),wrapEnum({Blue:"blue",Orange:"orange",Yellow:"yellow",Lime:"lime",Red:"red",Pink:"pink",Green:"green",Sky:"sky",Purple:"purple",Black:"black"})),We=wrapEnum({GitHub:"GitHub",Google:"Google",Outlook:"Outlook",Trello:"Trello"}),ze=wrapEnum({SingleInstance:"singleInstance",Occurrence:"occurrence",Exception:"exception",SeriesMaster:"seriesMaster"}),Ge=wrapEnum({Yes:"accepted",No:"declined",MayBe:"tentativelyAccepted",Undefined:"notResponded",Organizer:"organizer"}),je={[Ge.Yes]:"accept",[Ge.No]:"decline",[Ge.MayBe]:"tentativelyAccept"},Ve=wrapEnum({Default:"default",ConferenceRoom:"conferenceRoom"}),Ke=wrapEnum({Free:"free",Tentative:"tentative",Busy:"busy",Oof:"oof",WorkingElsewhere:"workingElsewhere",Unknown:"unknown"}),Ye=wrapEnum({CalendarsRead:"Calendars.Read",CalendarsReadWrite:"Calendars.ReadWrite",ContactsRead:"Contacts.Read",PeopleRead:"People.Read",UserRead:"User.Read",UserReadBasicAll:"User.ReadBasic.All"}),qe=new(D())([A.eT.TrelloCard,A.eT.TrelloCustomField,A.eT.TrelloCheckItem,A.eT.TrelloTimeRecord]),Ze=wrapEnum({Escape:27,Enter:13,Enter2:10,Left:37,Up:38,Right:39,Down:40,C:67,D:68,E:69,F:70,L:76,M:77,Q:81,S:83,T:84,Space:32,Delete:46,Backspace:8,Key0:48,Key9:57}),Xe=wrapEnum({Left:1,Middle:2,Right:3}),Qe=wrapEnum({GreenLight:"green_light",Green:"green",GreenDark:"green_dark",YellowLight:"yellow_light",Yellow:"yellow",YellowDark:"yellow_dark",OrangeLight:"orange_light",Orange:"orange",OrangeDark:"orange_dark",RedLight:"red_light",Red:"red",RedDark:"red_dark",PurpleLight:"purple_light",Purple:"purple",PurpleDark:"purple_dark",BlueLight:"blue_light",Blue:"blue",BlueDark:"blue_dark",SkyLight:"sky_light",Sky:"sky",SkyDark:"sky_dark",LimeLight:"lime_light",Lime:"lime",LimeDark:"lime_dark",PinkLight:"pink_light",Pink:"pink",PinkDark:"pink_dark",BlackLight:"black_light",Black:"black",BlackDark:"black_dark"}),Je=wrapEnum({[Qe.Green]:"MISC.LABEL_COLOR_GREEN",[Qe.GreenLight]:"MISC.LABEL_COLOR_GREEN_LIGHT",[Qe.GreenDark]:"MISC.LABEL_COLOR_GREEN_DARK",[Qe.Yellow]:"MISC.LABEL_COLOR_YELLOW",[Qe.YellowLight]:"MISC.LABEL_COLOR_YELLOW_LIGHT",[Qe.YellowDark]:"MISC.LABEL_COLOR_YELLOW_DARK",[Qe.Orange]:"MISC.LABEL_COLOR_ORANGE",[Qe.OrangeLight]:"MISC.LABEL_COLOR_ORANGE_LIGHT",[Qe.OrangeDark]:"MISC.LABEL_COLOR_ORANGE_DARK",[Qe.Red]:"MISC.LABEL_COLOR_RED",[Qe.RedLight]:"MISC.LABEL_COLOR_RED_LIGHT",[Qe.RedDark]:"MISC.LABEL_COLOR_RED_DARK",[Qe.Purple]:"MISC.LABEL_COLOR_PURPLE",[Qe.PurpleLight]:"MISC.LABEL_COLOR_PURPLE_LIGHT",[Qe.PurpleDark]:"MISC.LABEL_COLOR_PURPLE_DARK",[Qe.Blue]:"MISC.LABEL_COLOR_BLUE",[Qe.BlueLight]:"MISC.LABEL_COLOR_BLUE_LIGHT",[Qe.BlueDark]:"MISC.LABEL_COLOR_BLUE_DARK",[Qe.Sky]:"MISC.LABEL_COLOR_SKY",[Qe.SkyLight]:"MISC.LABEL_COLOR_SKY_LIGHT",[Qe.SkyDark]:"MISC.LABEL_COLOR_SKY_DARK",[Qe.Lime]:"MISC.LABEL_COLOR_LIME",[Qe.LimeLight]:"MISC.LABEL_COLOR_LIME_LIGHT",[Qe.LimeDark]:"MISC.LABEL_COLOR_LIME_DARK",[Qe.Pink]:"MISC.LABEL_COLOR_PINK",[Qe.PinkLight]:"MISC.LABEL_COLOR_PINK_LIGHT",[Qe.PinkDark]:"MISC.LABEL_COLOR_PINK_DARK",[Qe.Black]:"MISC.LABEL_COLOR_BLACK",[Qe.BlackLight]:"MISC.LABEL_COLOR_BLACK_LIGHT",[Qe.BlackDark]:"MISC.LABEL_COLOR_BLACK_DARK"}),et=wrapEnum({48:Qe.Black,49:Qe.Green,50:Qe.Yellow,51:Qe.Orange,52:Qe.Red,53:Qe.Purple,54:Qe.Blue,55:Qe.Sky,56:Qe.Lime,57:Qe.Pink}),tt=new(D())([Ze.C,Ze.D,Ze.E,Ze.L,...E()(new Array(Ze.Key9-Ze.Key0+1),((e,t)=>Ze.Key0+t)),Ze.M,Ze.Space,Ze.S,Ze.Delete,Ze.Backspace]),it={[A.eT.TrelloCard]:[Ze.C,Ze.D,Ze.E,Ze.L,...E()(new Array(Ze.Key9-Ze.Key0+1),((e,t)=>Ze.Key0+t)),Ze.M,Ze.Space,Ze.S,Ze.Delete,Ze.Backspace],[A.eT.TrelloCustomField]:[Ze.E,Ze.L,...E()(new Array(Ze.Key9-Ze.Key0+1),((e,t)=>Ze.Key0+t)),Ze.M,Ze.Space,Ze.S,Ze.Delete,Ze.Backspace],[A.eT.TrelloCheckItem]:[Ze.E,Ze.L,...E()(new Array(Ze.Key9-Ze.Key0+1),((e,t)=>Ze.Key0+t)),Ze.M,Ze.Space,Ze.Delete,Ze.Backspace],[A.eT.TrelloTimeRecord]:[Ze.D,Ze.L,...E()(new Array(Ze.Key9-Ze.Key0+1),((e,t)=>Ze.Key0+t)),Ze.M,Ze.Space,Ze.Delete,Ze.Backspace],[A.eT.GoogleEvent]:[Ze.E,Ze.M,Ze.Space,Ze.Delete,Ze.Backspace],[A.eT.OutlookEvent]:[Ze.E,Ze.M,Ze.Space,Ze.Delete,Ze.Backspace]},rt=wrapEnum({Scheduler:"scheduler",TaskLists:"taskLists"}),nt=wrapEnum({Scheduler:"scheduler",TaskLists:"taskLists"}),at=(wrapEnum({Archive:"archive",Delete:"delete",Duplicate:"duplicate",Remove:"remove",ShowLabelsMenu:"showLabelsMenu",ShowMembersMenu:"showMembersMenu",Subscribe:"subscribe",ToggleLabel:"toggleLabel",ToggleMember:"toggleMember"}),wrapEnum({CustomField:"customField"})),st=wrapEnum({File:"file",Link:"link"}),ot=new(D())(["bmp","gif","ico","jpeg","jpg","png","svg","webp"]),lt=wrapEnum({Blocks:"blocks",IsBlockedBy:"isBlockedBy"}),dt={[lt.Blocks]:lt.IsBlockedBy,[lt.IsBlockedBy]:lt.Blocks},ct=wrapEnum({NoCard:"noCard",NoLink:"noLink",LinksDisabled:"linksDisabled"}),ht=wrapEnum({Skipped:"skipped",ResourcePlanning:"resourcePlanning",MonthlyCalendar:"monthlyCalendar",TimeTracking:"timeTracking",WeeklySchedule:"weeklySchedule"}),ut={[ht.ResourcePlanning]:{provider:{[R.Trello]:{taskLists:{view:de.Kanban},timelineView:le.Member}},schedulerMode:ee.Timeline},[ht.MonthlyCalendar]:{provider:{[R.Trello]:{taskLists:{view:de.Kanban}}},schedulerMode:ee.Calendar,schedulerView:re.Month},[ht.WeeklySchedule]:{provider:{[R.Trello]:{taskLists:{view:de.Kanban}}},schedulerMode:ee.Calendar,schedulerView:re.Week},[ht.TimeTracking]:{provider:{[R.Trello]:{taskLists:{view:de.Kanban}}},schedulerMode:ee.TimeTracking,timeTrackingView:ne.List}},pt=wrapEnum({AllCards:"allCards",BoardCards:"boardCards",Scheduler:"scheduler",TimeRecords:"timeRecords",TrackedTime:"trackedTime",TrackedVsEstimated:"trackedVsEstimated"}),mt=wrapEnum({Csv:"csv",Excel:"excel",Pdf:"pdf"}),gt=wrapEnum({Medium:"medium",Large:"large"}),yt={[A.R9.Year]:{discount:.25}},vt=new Date("2023-01-10"),ft=(wrapEnum({Soon:"Soon",Released:"Released"}),wrapEnum({GeneralEvents:wrapEnum({Installed:"Installed",BrowserPopupOpened:"Browser Popup Opened",ShortcutsOpened:"Shortcuts Opened",QuickStartClicked:"Quick Start Clicked",HelpClicked:"Help Clicked",UpgradeClicked:"Upgrade Clicked",BillingClicked:"Billing Clicked",UsersClicked:"Users Clicked",UpgradeOffered:"Upgrade Offered",UpgradeOfferLearnClicked:"Upgrade Offer Learn More Clicked",UpgradeOfferUpgradeClicked:"Upgrade Offer Upgrade Now Clicked",TrialStarted:"Trial Started",AuthRequested:"Auth Requested",AuthConfirmed:"Auth Confirmed",AuthRejected:"Auth Rejected",AccountConnected:"Account Connected",AccountReconnected:"Account Reconnected",AccountDisconnected:"Account Disconnected",NewsShown:"News Shown",NewsHidden:"News Hidden",NewsLearnMoreClicked:"News Learn More Clicked",NewsBlogClicked:"News Blog Clicked",NewsHelpClicked:"News Help Clicked",NewsClicked:"What's New Clicked",TimeZoneChanged:"Time Zone Changed",SystemMessageShown:"System Message Shown",LogOutClicked:"Log Out Clicked",TrialExpiredShown:"Trial Expired Dialog Shown",TrialExpiredStayFreeClicked:"Trial Expired Stay Free Clicked",TrialExpiredSeePlansClicked:"Trial Expired See Plans Clicked",ImportICalHowToLinkClicked:"Import iCal Help Link Clicked",ExportICalLearnMoreClicked:"Export iCal Learn More Clicked",ExportUrlCopied:"Export URL Copied",ExportUrlsReset:"Export URLs Reset",WindowMaximized:"Window Maximized",WindowMinimized:"Window Minimized",OpenedByLink:"Opened By Link",StandaloneOpenedByLink:"Standalone Opened By Link",PaymentFailedDialogShown:"Payment Failed Dialog Shown",PaymentFailedDialogUpdateClicked:"Payment Failed Dialog Update Clicked",PaymentFailedDialogClosed:"Payment Failed Dialog Closed",AccountUserAdded:"Account User Added",ReportDialogOpened:"Report Dialog Opened",ReportBuilt:"Report Built"}),CollectionEvents:wrapEnum({CollectionAccountAdded:"Collection Account Added",CollectionAccountRemoved:"Collection Account Removed",CollectionAddAccountDialogOpened:"Collection Add Account Dialog Opened",CollectionAddAccountDialogClosed:"Collection Add Account Dialog Closed",CollectionAddBoardDialogClosed:"Collection Add Board Dialog Closed",CollectionAddBoardDialogOpened:"Collection Add Board Dialog Opened",CollectionAddBoardDialogShown:"Collection Add Board Dialog Shown",CollectionAddCalendarDialogClosed:"Collection Add Calendar Dialog Closed",CollectionAddCalendarDialogOpened:"Collection Add Calendar Dialog Opened",CollectionAddCalendarDialogShown:"Collection Add Calendar Dialog Shown",CollectionBoardAdded:"Collection Board Added",CollectionBoardDeselected:"Collection Board Deselected",CollectionBoardFilterChanged:"Collection Board Filter Changed",CollectionBoardRemoved:"Collection Board Removed",CollectionBoardSelected:"Collection Board Selected",CollectionBoardSelectedAll:"Collection Board Selected All",CollectionBoardSelectedNone:"Collection Board Selected None",CollectionBoardSelectedOnlyThis:"Collection Board Selected Only This",CollectionCalendarAdded:"Collection Calendar Added",CollectionCalendarDeselected:"Collection Calendar Deselected",CollectionCalendarFilterChanged:"Collection Calendar Filter Changed",CollectionCalendarRemoved:"Collection Calendar Removed",CollectionCalendarSelected:"Collection Calendar Selected",CollectionCalendarSelectedAll:"Collection Calendar Selected All",CollectionCalendarSelectedNone:"Collection Calendar Selected None",CollectionCalendarSelectedOnlyThis:"Collection Calendar Selected Only This",CollectionChanged:"Collection Changed",CollectionCreated:"Collection Created",CollectionCreateDialogClosed:"Collection Create Dialog Closed",CollectionCreateDialogOpened:"Collection Create Dialog Opened",CollectionLeaved:"Collection Leaved",CollectionDeleted:"Collection Deleted",CollectionDuplicated:"Collection Duplicated",CollectionEditDialogOpened:"Collection Edit Dialog Opened",CollectionEditDialogClosed:"Collection Edit Dialog Closed",CollectionEdited:"Collection Edited",CollectionOpened:"Collection Opened",CollectionPositionChanged:"Collection Position Changed",CollectionShareDialogOpened:"Collection Share Dialog Opened",CollectionShareLinkCopied:"Collection Share Link Copied",CollectionUserAdded:"Collection User Added",CollectionUserRemoved:"Collection User Removed",CollectionUserTypeChanged:"Collection User Type Changed"}),GoogleSyncEvents:wrapEnum({SyncWithGoogleOpened:"Sync With Google Opened",SyncWithGoogleEnableGoogleSyncClicked:"Sync With Google Enable Google Sync Clicked",SyncStarted:"Sync Started",SyncStopped:"Sync Stopped"}),TrelloEvents:wrapEnum({BoardSwitched:"Trello Board Switched",PlanywayPowerUpClicked:"Planyway PowerUp Clicked",PopupControlsHidden:"Trello Popup Controls Hidden",PopupControlsShown:"Trello Popup Controls Shown"}),CalendarEvents:wrapEnum({Shown:"Calendar Shown",Hidden:"Calendar Hidden",Opened:"Opened",ModeMenuOpened:"Toolbar View Menu Opened",ViewModeMenuOpened:"Toolbar View Mode Menu Opened",ResourcesMenuOpened:"Timeline Resources Menu Opened",BoardOpened:"Board Opened",CalendarOpened:"Calendar Opened",TimelineOpened:"Timeline Opened",TimeTrackingOpened:"Time Tracking Opened",ReportsOpened:"Reports Opened",OrientationChanged:"Orientation Changed",OrientationFlipped:"Orientation Flipped",LayoutPanelExpanded:"Layout Panel Expanded",LayoutPanelCollapsed:"Layout Panel Collapsed",ViewModeChanged:"View Mode Changed",CalendarNavigated:"Calendar Navigated",TimelineNavigated:"Timeline Navigated",TimelineResourcePanelResized:"Timeline Resource Panel Resized",TimelineScaleChanged:"Timeline Scale Changed",Refreshed:"Cards Refreshed",Multiselected:"Cards Multiselected",AddCalendarsDialogOpened:"Add Calendars Dialog Opened",ICalEditOpened:"iCal Edit Opened",ICalColorChanged:"iCal Color Changed",TimelineMilestoneLaneChanged:"Timeline Milestone Lane Changed",TimelineMembersChanged:"Timeline Members Changed",TimelineMembersSelectedAll:"Timeline Members Selected All",TimelineMembersSelectedNone:"Timeline Members Selected None",TimelineMembersReordered:"Timeline Members Reordered",TimelineCalendarsChanged:"Timeline Boards Changed",TimelineCalendarsSelectedAll:"Timeline Boards Selected All",TimelineCalendarsSelectedNone:"Timeline Boards Selected None",TimelineCalendarsReordered:"Timeline Boards Reordered",TimelineAddBoardsClicked:"Timeline Add Boards Clicked",TimelineListsChanged:"Timeline Lists Changed",TimelineListsSelectedAll:"Timeline Lists Selected All",TimelineListsSelectedNone:"Timeline Lists Selected None",TimelineListsReordered:"Timeline Lists Reordered",TimelineLabelsChanged:"Timeline Labels Changed",TimelineLabelsSelectedAll:"Timeline Labels Selected All",TimelineLabelsSelectedNone:"Timeline Labels Selected None",TimelineLabelsReordered:"Timeline Labels Reordered",SidebarOpened:"Sidebar Opened",SidebarClosed:"Sidebar Closed",TaskListsBoardSwitched:"Task List Board Switched",TaskListsGitHubProjectSwitched:"Task List GitHub Project Switched",TaskListsFiltersChanged:"Task List Filters Changed",TaskListsViewModeMenuOpened:"Task List View Mode Menu Opened",TaskListsViewModeChanged:"Task List View Mode Changed",CreateBoardDialogOpened:"Create Board Dialog Opened",CreateBoardDialogClosed:"Create Board Dialog Closed",CreateGitHubProjectDialogOpened:"Create GitHub Project Dialog Opened",CreateGitHubProjectDialogClosed:"Create GitHub Project Dialog Closed",EditBoardDialogOpened:"Edit Board Dialog Opened",EditBoardDialogClosed:"Edit Board Dialog Closed",EditGitHubProjectDialogOpened:"Edit GitHub Project Dialog Opened",EditGitHubProjectDialogClosed:"Edit GitHub Project Dialog Closed",BoardCreated:"Board Created",BoardEdited:"Board Edited",BoardRemoved:"Board Removed",GitHubProjectClosed:"GitHub Project Closed",GitHubProjectCreated:"GitHub Project Created",GitHubProjectEdited:"GitHub Project Edited",GitHubProjectDeleted:"GitHub Project Deleted",MembersDialogOpened:"Members Dialog Opened",MemberAdded:"Member Added",MemberRemoved:"Member Removed",MemberLeaved:"Member Leaved",MemberTypeChanged:"Member Type Changed",LabelEditDialogOpened:"Edit Labels Dialog Opened",LabelEditDialogAddMenuOpened:"Edit Labels Dialog Add Menu Opened",LabelCreated:"Label Created",LabelDeleted:"Label Deleted",LabelEdited:"Label Edited",ReportsViewModeChanged:"Reports View Mode Changed",ReportsGroupingChanged:"Reports Grouping Changed",ReportsSelectedBoardsChanged:"Reports Selected Boards Changed",ReportsSelectedMembersChanged:"Reports Selected Members Changed",ReportsSelectedDatesChanged:"Reports Selected Dates Changed"}),SettingsEvents:wrapEnum({UserSettingsDialogOpened:"User Settings Dialog Opened",WorkHoursChanged:"Work Hours Changed",FirstWeekDayChanged:"First Week Day Changed",WorkDaysChanged:"Work Days Changed",LocaleChanged:"Locale Changed",CardDatesMigrationRequested:"Card Dates Migration Requested",CardDatesMigrationConfirmed:"Card Dates Migration Confirmed",CardDatesMigrationRejected:"Card Dates Migration Rejected",BoardColorChanged:"Board Color Changed",DatesSyncTypeChanged:"Dates Sync Type Changed",DueLinkAllDayChanged:"Due Link Date Changed",DueLinkChanged:"Due Link Time Changed",DefaultDurationChanged:"Default Duration Changed",DefaultListChanged:"Default List Changed",DefaultCardPositionChanged:"Default Card Position Changed",DefaultLimitArchivedCardsChanged:"Default Limit Archived Cards Changed",ShowDatesChanged:"Show Dates Changed",ShowCalendarChanged:"Show Calendar Changed",CardColorByChanged:"Card Color By Changed",ShowGitHubStatusChanged:"Show GitHub Status Changed",ShowTrelloListChanged:"Show Trello List Changed",ShowCardNumberChanged:"Show Card Number Changed",ShowEstimatedHoursChanged:"Show Estimated Hours Changed",ShowTrackedHoursChanged:"Show Tracked Hours Changed",ShowCheckItemCountChanged:"Show Check Item Count Changed",CustomFieldsSettingsDialogOpened:"Custom Fields Settings Dialog Opened",CustomFieldsAsCardsChanged:"Show Custom Field Cards Changed",HighlightTodayChanged:"Highlight Today Changed",ShowWeekNumbersChanged:"Show Week Numbers Changed",ShowOnlyWorkDaysChanged:"Show Weekends Changed",ShowOnlyWorkHoursChanged:"Show Non-working Hours Changed",ShowArchivedCardsChanged:"Show Archived Cards Changed",ShowCheckItemCardsChanged:"Show Check Item Cards Changed",ShowMilestonesChanged:"Show Milestones Changed",ShowTimeRecordCardsChanged:"Show Time Entry Cards Changed"}),FiltersEvents:wrapEnum({SearchedByCardName:"Filters Searched By Card Name",AddCustomFilterClicked:"Filters Add Filter Clicked",CustomFilterAdded:"Filters Custom Filter Added",CustomFilterRemoved:"Filters Custom Filter Removed",FilterByCurrentMemberToggled:"Filter By Current Member Toggled",Cleared:"Filters Cleared",CardsVisibilityChanged:"Cards Visibility Changed",MembersChanged:"Filters Members Changed",LabelsChanged:"Filters Labels Changed",ListsChanged:"Filters Lists Changed",CustomFieldsChanged:"Filters Custom Fields Changed",CustomFiltersChanged:"Filters Custom Filters Changed"}),CardEvents:wrapEnum({OpenedByUrl:"Card Opened By URL",CreateDialogOpened:"Card Create Dialog Opened",CreateDialogClosed:"Card Create Dialog Closed",EditDialogOpened:"Card Edit Dialog Opened",EditDialogClosed:"Card Edit Dialog Closed",EditDialogModeChanged:"Card Edit Dialog Mode Changed",Added:"Card Added",Scheduled:"Card Scheduled",CardProviderChanged:"Card Source Changed",MilestoneScheduled:"Milestone Scheduled",EventScheduled:"Event Scheduled",ContextMenuOpened:"Card Context Menu Opened",MarkedCompleted:"Card Marked Completed",MarkedIncompleted:"Card Marked Incompleted",Archived:"Card Archived",Unarchived:"Card Unarchived",Duplicated:"Card Duplicated",Subscribed:"Card Subscribed",Unsubscribed:"Card Unsubscribed",Deleted:"Card Deleted",UrlCopied:"Card URL Copied",TitleChanged:"Card Name Changed",TypeChanged:"Card Type Changed",DatesRemoved:"Card Dates Removed",IsAllDaySet:"Card Is All Day Set",IsAllDayUnset:"Card Is All Day Unset",StartChanged:"Card Start Changed",EndChanged:"Card End Changed",TimeAdded:"Card Time Added",TimeRemoved:"Card Time Removed",DurationChanged:"Card Duration Changed",EstimationClicked:"Card Add Estimation Clicked",EstimationAdded:"Card Estimation Added",EstimationChanged:"Card Estimation Changed",EstimationDeleted:"Card Estimation Deleted",Moved:"Card Moved",Resized:"Card Resized",Reordered:"Card Reordered",LaneChanged:"Card Lane Changed",RecurrenceRuleChanged:"Card Recurrence Rule Changed",PriorityChanged:"Card Priority Changed",BoardChanged:"Card Board Changed",GitHubProjectChanged:"Card GitHub Project Changed",GoogleCalendarChanged:"Card Google Calendar Changed",OutlookCalendarChanged:"Card Outlook Calendar Changed",ListChanged:"Card List Changed",RepositoryChanged:"Card Repository Changed",StatusChanged:"Card Status Changed",AvailabilityChanged:"Card Availability Changed",InviteSent:"Card Invite Sent",InviteStatusChanged:"Card Invite Responded",LocationChanged:"Card Location Changed",ParentCardChanged:"Card Parent Changed",ParentCardOpened:"Card Parent Opened",PositionChanged:"Card Position Changed",MemberAssigned:"Card Member Assigned",MemberAssignedSelf:"Card Assigned To Me",MemberUnassigned:"Card Member Unassigned",MemberUnassignedSelf:"Card Unassigned From Me",MemberChanged:"Card Member Changed",LabelAdded:"Card Label Added",LabelRemoved:"Card Label Removed",LabelChanged:"Card Label Changed",DescriptionChanged:"Card Description Changed",CustomFieldChanged:"Card Custom Field Changed",ReminderAdded:"Card Reminder Added",ReminderChanged:"Card Reminder Changed",ReminderDeleted:"Card Reminder Deleted",CardLinkAdded:"Card Dependency Added",CardLinkCardChanged:"Card Dependency Card Changed",CardLinkTypeChanged:"Card Dependency Type Changed",CardLinkLinkedCardOpened:"Card Dependency Dependent Card Opened",CardLinkRemoved:"Card Dependency Removed",ChecklistAdded:"Card Checklist Added",ChecklistNameChanged:"Card Checklist Name Changed",ChecklistOrderChanged:"Card Checklist Order Changed",ChecklistCollapsed:"Card Checklist Collapsed",ChecklistExpanded:"Card Checklist Expanded",ChecklistCompletedHidden:"Card Checklist Completed Items Hidden",ChecklistCompletedShown:"Card Checklist Completed Items Shown",ChecklistDeleted:"Card Checklist Deleted",CheckItemAdded:"Card Check Item Added",CheckItemScheduled:"Check Item Scheduled",CheckItemNameChanged:"Card Check Item Name Changed",CheckItemOrderChanged:"Card Check Item Order Changed",CheckItemChecklistChanged:"Card Check Item Checklist Changed",CheckItemMarkedCompleted:"Card Check Item Marked Completed",CheckItemMarkedIncompleted:"Card Check Item Marked Incompleted",CheckItemConverted:"Card Check Item Converted",CheckItemDeleted:"Card Check Item Deleted",CheckItemDatesRemoved:"Card Check Item Dates Removed",CheckItemIsAllDaySet:"Card Check Item Is All Day Set",CheckItemIsAllDayUnset:"Card Check Item Is All Day Unset",CheckItemStartChanged:"Card Check Item Start Changed",CheckItemEndChanged:"Card Check Item End Changed",CheckItemMemberAssigned:"Card Check Item Member Assigned",CheckItemMemberUnassigned:"Card Check Item Member Unassigned",CheckItemContextMenuOpened:"Card Check Item Context Menu Opened",TimeRecordScheduled:"Card Time Entry Added",TimeRecordCommentChanged:"Card Time Entry Note Changed",TimeRecordDeleted:"Card Time Entry Deleted",TimeRecordFromChanged:"Card Time Entry Start Changed",TimeRecordToChanged:"Card Time Entry End Changed",TimeRecordDurationChanged:"Card Time Entry Duration Changed",TimeRecordTimeAdded:"Card Time Entry Time Added",TimeRecordTimeRemoved:"Card Time Entry Time Removed",TimeRecordMemberChanged:"Card Time Entry Member Changed",TimeRecordSeeMoreClicked:"Card Time Entry See More Clicked",AttachmentAdded:"Card Attachment Added",AttachmentClicked:"Card Attachment Clicked",AttachmentLinkChanged:"Card Attachment Link Changed",AttachmentNameChanged:"Card Attachment Name Changed",AttachmentDeleted:"Card Attachment Deleted",CommentAdded:"Card Comment Added",CommentEdited:"Card Comment Edited",CommentDeleted:"Card Comment Deleted",CommentMentionAdded:"Card Comment Mention Added",CommentReplyClicked:"Card Comment Reply Clicked",CommentSourceOpened:"Card Comment Source Opened",CardOpenClicked:"Card Open Clicked",PlanOnTimelineClicked:"Card Plan On Timeline Clicked",ViewOnTimelineClicked:"Card View On Timeline Clicked"}),TaskListEvents:wrapEnum({Archived:"List Archived",ContextMenuOpened:"List Context Menu Opened",Created:"List Created",NameChanged:"List Name Changed",PositionChanged:"List Position Changed",Sorted:"List Sorted"}),TimeTrackingEvents:wrapEnum({ToolbarModeChanged:"Time Tracking Toolbar Mode Changed",TimerStartClicked:"Timer Start Clicked",TimerStarted:"Timer Started",TimerStopped:"Timer Stopped",OnlyMeChanged:"Time Tracking Only Me Changed",NoteAdded:"Time Tracking Note Added",NoteChanged:"Time Tracking Note Changed",ParentCardClicked:"Time Tracking Parent Card Clicked",ParentCardAdded:"Time Tracking Parent Card Added",ParentCardChanged:"Time Tracking Parent Card Changed",AddManuallyClicked:"Time Tracking Add Manually Clicked"}),OnboardingEvents:wrapEnum({DragAndDropStepShown:"Onboarding Drag And Drop Step Shown",CardLabelsStepShown:"Onboarding Card Labels Step Shown",VisualizeCheckItemsStepShown:"Onboarding Check Items Step Shown",MultiBoardStepShown:"Onboarding Multi Board Step Shown",GoogleConnectStepShown:"Onboarding Google Connect Step Shown",ShareCollectionStepShown:"Onboarding Share Collection Step Shown",SuccessScreenShown:"Onboarding Success Screen Shown",SignInStepShown:"Sign In Onboarding Step Shown",OpenBoardStepShown:"Open Board Onboarding Step Shown",ShowButtonShown:"Show Button Onboarding Shown",ShowButtonPassed:"Show Button Onboarding Passed",ShowButtonSkipped:"Show Button Onboarding Skipped",AllowAccessBannerClicked:"Onboarding Allow Access Banner Clicked",LoginDialogOpened:"Onboarding Login Dialog Opened",LoginDialogClosed:"Onboarding Login Dialog Closed",SurveyShown:"Onboarding Survey Shown",SurveyPassed:"Onboarding Survey Passed",TourClicked:"Onboarding Tour Clicked",TourMinimized:"Onboarding Tour Minimized",TourMaximized:"Onboarding Tour Maximized",TourClosed:"Onboarding Tour Closed",TourDoneClicked:"Onboarding Tour Done Clicked",OnboardingVideoPreviewShown:"Onboarding Video Preview Shown",OnboardingVideoPreviewClosed:"Onboarding Video Preview Closed",OnboardingVideoOpened:"Onboarding Video Opened",OnboardingVideoClosed:"Onboarding Video Closed",NotificationsBannerShown:"Onboarding Notifications Banner Shown",NotificationsBannerClosed:"Onboarding Notifications Banner Closed"}),FeedbackEvents:wrapEnum({FeedbackOpened:"Feedback Opened",FeedbackSent:"Feedback Sent",ProductSatisfactionShown:"Feedback Product Satisfaction Shown",ProductSatisfactionSent:"Feedback Product Satisfaction Sent",ProductSatisfactionClosed:"Feedback Product Satisfaction Closed"}),NotificationEvents:wrapEnum({EnableRequested:"Notifications Enable Requested",EnableRejected:"Notifications Enable Rejected",EnableConfirmed:"Notifications Enable Confirmed",EnableDenied:"Notifications Enable Denied",Enabled:"Notifications Enabled",Initialized:"Notifications Initialized",DefaultReminderAdded:"Notifications Default Reminder Added",DefaultReminderChanged:"Notifications Default Reminder Changed",DefaultReminderDeleted:"Notifications Default Reminder Deleted",SettingsChanged:"Notification Settings Changed",OverdueEmailSettingsChanged:"Notifications Overdue Email Settings Changed",CenterOpened:"Notification Center Opened"})})),_t={[ht.Skipped]:"Skipped",[ht.ResourcePlanning]:"Resource Planning",[ht.TimeTracking]:"Time Tracking",[ht.MonthlyCalendar]:"Monthly Calendar",[ht.WeeklySchedule]:"Weekly Schedule"},Ct=wrapEnum({PaidFeatureOfferDialog:"Upgrade Offer Dialog",Onboarding:"Onboarding",Reset:"Reset"}),St=wrapEnum({PaidFeatureOfferDialog:"Upgrade Offer Dialog",OnboardingDialog:"Onboarding"}),wt=wrapEnum({CollectionsPanelMenu:"Side Panel Menu",TeamsConfigurationPage:"Teams Configuration Page"}),kt=wrapEnum({LoginDialog:"Login Dialog",Scheduler:"Scheduler",Sidebar:"Sidebar",CollectionsPanelMenu:"Side Panel Menu"}),bt=wrapEnum({Hotkey:"Hotkey",OrientationMenu:"Orientation Menu",ToolbarButton:"Toolbar Button"}),Dt=wrapEnum({SchedulerToolbar:"Scheduler Toolbar",TaskListToolbar:"Task List Toolbar",Toolbar:"Toolbar"}),Tt=wrapEnum({AllowAccessBanner:"Allow Access Banner",Close:"Close Button",PlanOnTimeline:"Plan On Timeline",ViewOnTimeline:"View On Timeline",Powerup:"PowerUp Button",Trello:"Trello Button",TimeRecordSeeMore:"Time Entry See More Button"}),Et=wrapEnum({Sidebar:"Sidebar",TaskLists:"Tasks Lists",Toolbar:"Toolbar",AddBoardsDialog:"Add Boards Dialog",AddGitHubProjectsDialog:"Add GitHub Projects Dialog"}),At=wrapEnum({Scheduler:"Scheduler",TaskLists:"Task List",Trello:"Trello"}),It=wrapEnum({Toolbar:"Toolbar",CollectionsPanel:"Side Panel",CollectionsPanelMenu:"Side Panel Menu",Sidebar:"Sidebar"}),Pt=wrapEnum({Upgrade:"Upgrade",SeePlans:"See Plans"}),Rt=wrapEnum({Drop:"Drop",Click:"Click",Hint:"Hint",Stretching:"Stretching",SetDates:"Set Dates",Dialog:"Dialog",DialogHotkey:"Dialog Hotkey",DialogPanel:"Dialog Panel",DialogTimer:"Dialog Timer",EditLabelsDialog:"Edit Labels Dialog",Hotkey:"Hotkey",ContextMenu:"Context Menu",TrelloPopup:"Trello Popup",PowerUpButton:"Power-Up Button",Mouse:"Mouse",RightClick:"Right Click",Manually:"Manually",MenuButton:"Menu Button",Paste:"Paste",TaskLists:"Task Lists",Timer:"Timer",Timesheet:"Timesheet",CopyAsTimeRecord:"Copy As Time Entry",BoardView:"Kanban",HotAction:"Hot Action",AddButton:"Add Button",NotificationCenter:"Notification Center",PushNotification:"Push Notification",ShareCard:"Share Card"}),Lt=wrapEnum({AllDay:"All Day",NonAllDay:"Non-All Day",Milestone:"Milestone",NoLane:"No Lane",MemberLane:"Member Lane",MemberLaneSelf:"My Lane",BoardLane:"Board Lane",ListLane:"List Lane",LabelLane:"Label Lane",GitHubProjectLane:"GitHub Project Lane",GitHubAssigneeLane:"GitHub Assignee Lane",GitHubAssigneeLaneSelf:"GitHub Assignee Self Lane",GitHubLabelLane:"GitHub Label Lane",GitHubStatusLane:"GitHub Status Lane"}),Nt=wrapEnum({ContextMenu:"Context Menu",Mouse:"Mouse",MenuButton:"Menu Button"}),Ot=wrapEnum({Settings:"Settings",Banner:"Banner"}),Mt=wrapEnum({ToolbarButton:"Toolbar Button",BrowserButton:"Browser Button",HomeScreen:"Home Screen",OverdueEmail:"Overdue Email"}),$t=wrapEnum({Name:"Name",Email:"Email"}),xt=wrapEnum({Sidebar:"Sidebar",TaskLists:"Tasks Lists",Toolbar:"Toolbar",ResourcesMenu:"Resources Menu"}),Bt=wrapEnum({Toolbar:"Toolbar",Dialog:"Dialog",Trello:"Trello"}),Ht=wrapEnum({Sidebar:"Sidebar",SidebarAddAccount:"Sidebar Add Account",SidebarReconnectAccount:"Sidebar Reconnect Account",TaskLists:"Task Lists",Toolbar:"Toolbar",CollectionMenu:"Collection Menu"}),Ut=wrapEnum({RequestAccept:"Collection Request Accept",RequestEmail:"Collection Request Email",Invite:"Invite Button"}),Ft=wrapEnum({VideoPreview:"Video Preview",HelpMenu:"Help Menu"}),Wt=wrapEnum({BoardMenu:"Board Menu",Sidebar:"Sidebar",SyncWithGoogleDialog:"Sync With Google Dialog"})},20115:(e,t,i)=>{i.d(t,{$:()=>s,$d:()=>ee,Ao:()=>w,Ch:()=>ue,D2:()=>x,FX:()=>de,Hz:()=>A,J4:()=>ae,L2:()=>K,LA:()=>le,LI:()=>ie,M6:()=>J,NA:()=>g,Ot:()=>n,Qe:()=>o,Ql:()=>O,Rv:()=>E,Sk:()=>P,T:()=>ge,Tc:()=>ye,U0:()=>V,U4:()=>L,UW:()=>oe,VW:()=>a,Vg:()=>q,WA:()=>F,X6:()=>j,Xt:()=>f,Yj:()=>c,ZC:()=>T,cT:()=>Q,dl:()=>X,f7:()=>z,gO:()=>B,gR:()=>u,gd:()=>he,hO:()=>$,iD:()=>_,iF:()=>re,j3:()=>me,jI:()=>k,jK:()=>h,kM:()=>ce,lQ:()=>M,mt:()=>l,n1:()=>m,nS:()=>D,nq:()=>pe,o5:()=>W,ow:()=>G,pN:()=>se,tl:()=>te,v8:()=>Z,vK:()=>b,vx:()=>d,w:()=>N,xd:()=>R,xp:()=>ne,yr:()=>v,yx:()=>S,zU:()=>Y});var r=i(78490);const n="Planyway",a="c05e9168828198b995a2175af18e5686",s="https://trello-logos.s3.amazonaws.com",o="https://www.googleapis.com/calendar/v3",l="https://www.googleapis.com/oauth2/v3",d="https://people.googleapis.com/v1",c="https://graph.microsoft.com/v1.0",h="https://graph.microsoft.com/beta",u=999;let p;p="7b125b529ffb0de07329e198d3b3cbde";const m=p,g="https://api.amplitude.com";let y;y="637eb45a-8b43-4867-8d28-0611bdcca7fd";const v=y,f=y&&`Microsoft.ApplicationInsights.${i.n(r)()(v).call(v,"-","")}`,_="https://dc.services.visualstudio.com/v2/track",C="https://planyway.com",S=`${C}/api/b`,w=`${C}/api/e`,k=`${C}/api/n`,b=`${C}/api/r`,D=`${C}/api/s`,T=`${C}/api/t`,E="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn9KMm0FMa+yf5J5b/bIW\n5ktSpmJTduVDYOxxU39HUGFUDBFbSApBjL/dStEjtm3I8emeVvrC7G5go5ca2xd0\nbFUyOUygRCHvZU/g3vPby4r+paPouul0P37T+IWkNAoa91Zk0XswRtge/+3cSU+i\n+vH6JCKkdKK0IqqivYQ979ObDomc4re6kzWJd9Ee4rU0J0naME1+Ffj1RbJO43Kg\n4PkZZTAVhmbgAzkcTmHs/GMDBrXtHACCkYLctY1N8QtfExI5Lr1RFQN9cuDFZaV6\nT/hgkp08WpnkGjqstR8sgazHs5zZvlHF5Qe6MeuR3dHirGCSbnkZmdjvCF8T+xeq\n1QIDAQAB\n-----END PUBLIC KEY-----",A="BMtojXzd4NIHuVPeQRNc5KxFfi1ald8vaPAeX14AUpu6-b0JpZCVyA-TxquggLgPR1afbrJSSn6y8G3LdaHzino",I="https://planyway.com",P=`${I}/profile?tab=billing`,R=`${P}&action=changePlan`,L=`${I}/profile?tab=users`,N=`${I}/pricing`,O=`${I}/blog`,M=`${I}/legal/terms-of-use`,$=`${I}/legal/privacy-policy`,x=`${I}/app-changelog/app-changelog.json`,B=`${I}/help`;let H,U;H="https://help.planyway.com/en/articles/8166367-getting-started-guide",U=B;const F=H,W=U,z="planywayCachedAuth",G="planywayCachedConnectedAccounts",j="planywayCachedLicense",V="planywayCachedUserSettings",K="en",Y="pwOnboarding",q=/^[0-9a-f]{8}-[0-9a-f]{4}-1[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/,Z="pw_ignored_rejection",X="pwDraggableCard",Q="pwDraggableTaskList",J="pwDraggableCollection",ee="000000000000000000000000",te="pwGuestBoards",ie="pwStarredBoards",re="pwMilestones",ne="pwDummyResource",ae=150,se="customField_",oe=/^Planyway Data$/i,le=16384,de="aae61b93-6bb0-4886-85b4-ce4a4353f4cb",ce="ByLWMxlH-zc",he="1e13b21a424ebd8faf3a14e15ce02d63Tz03NTc1MCxFPTE3Mjc2OTYzNjUwMDAsUz1wcm8sTE09c3Vic2NyaXB0aW9uLEtWPTI=",ue="yzpc1nmz",pe="https://api-iam.intercom.io",me="function(intercomSettings){window.intercomSettings = intercomSettings;(function(){var w=window;var ic=w.Intercom;if(typeof ic===\"function\"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/yzpc1nmz';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();}",ge="fc4d782664aac8bb42bebfaa8e444dfe",ye="(function(i,s,o,g,r,a,m){i[o]=i[o]||function(){(i[o].q=i[o].q||[]).push(arguments)};a=s.createElement(g);m=s.getElementsByTagName(g)[0];a.async=1;a.src=r+'?auth='+s.getElementById(o+'-js').getAttribute('data-pw-auth');m.parentNode.insertBefore(a,m);})(window,document,'profitwell','script','https://public.profitwell.com/js/profitwell.js');profitwell('start', { 'user_email': 'USER_EMAIL_HERE' });"},16853:(e,t,i)=>{i.d(t,{N:()=>CustomCalendar});var r=i(62079),n=i.n(r),a=i(52020),s=i.n(a),o=i(73324),l=i.n(o),d=i(88546),c=i.n(d),h=i(99595),u=i.n(h),p=i(66775),m=i.n(p),g=i(2201),y=i.n(g),v=i(57445),f=i.n(v),_=i(26171),C=i(84705),S=i.n(C),w=i(86981),k=i.n(w),b=i(19755),D=i.n(b);function ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=l()(r).call(r,(function(t){return c()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?u()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,_.Z)(e,t,n[t])})):m()?y()(e,m()(n)):u()(r=ownKeys(Object(n))).call(r,(function(t){f()(e,t,c()(n,t))}))}return e}const T=S()('\n<div class="k-header k-calendar-header">\n    <a class="k-button k-title pw-link"></a>\n    <span class="k-calendar-nav">\n        <a class="k-button k-button-icon k-prev-view"><span class="mdi mdi-chevron-left"></span></a>\n        <a class="k-button k-button-icon k-next-view"><span class="mdi mdi-chevron-right"></span></a>\n        <a class="k-button k-button-icon k-close"><span class="mdi mdi-close"></span></a>\n    </span>\n</div>\n').call('\n<div class="k-header k-calendar-header">\n    <a class="k-button k-title pw-link"></a>\n    <span class="k-calendar-nav">\n        <a class="k-button k-button-icon k-prev-view"><span class="mdi mdi-chevron-left"></span></a>\n        <a class="k-button k-button-icon k-next-view"><span class="mdi mdi-chevron-right"></span></a>\n        <a class="k-button k-button-icon k-close"><span class="mdi mdi-close"></span></a>\n    </span>\n</div>\n'),E={month:0,year:1,decade:2,century:3};class CustomCalendar extends kendo.ui.Calendar{constructor(e,t){const i=D()(e).scope();if(void 0===(t=_objectSpread(_objectSpread({},t),{},{month:{weekNumber:"<span>#= data.weekNumber #</span>"},disableDates:()=>i.$ctrl.isDisabled})).footer){let e=CustomCalendar.$injector.get("$translate");t.footer=e.instant("BUTTONS.TODAY")}super(e,t),this._pwOnBlur=e=>{if(!this._active)return;let t=e.target;for(;t;){if(t===this._table[0])return;t=t.parentNode}this._removeClassProxy()},document.addEventListener("mousedown",this._pwOnBlur,!0),document.addEventListener("pwMouseDown",this._pwOnBlur,!0),i.$on("$destroy",(()=>this.destroy()))}destroy(){document.removeEventListener("mousedown",this._pwOnBlur,!0),document.removeEventListener("pwMouseDown",this._pwOnBlur,!0),super.destroy()}_todayClick(e){e.preventDefault();let t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(this.options.disableDates(i))return;let r=E[this.options.depth];0===this._view.compare(this._current,i)&&this._index===r&&(this._changeView=!1),this.options.max&&t>this.options.max&&(t=new Date(this.options.max)),this._value=t,this.navigate(i,r),this.trigger("change")}_header(){let e=D()(T);this._title=k()(e).call(e,".k-title"),this._title.on("click",(()=>{this._active=!1!==this.options.focusOnNav,this.navigateUp()})),this._prevArrow=k()(e).call(e,".k-prev-view"),this._prevArrow.on("click",(()=>{this._active=!1!==this.options.focusOnNav,this.navigateToPast()})),this._nextArrow=k()(e).call(e,".k-next-view"),this._nextArrow.on("click",(()=>{this._active=!1!==this.options.focusOnNav,this.navigateToFuture()})),this._closeBtn=k()(e).call(e,".k-close"),this._closeBtn.on("click",(()=>{this.options.close()})),this.element.append(e)}}},68772:(e,t,i)=>{i.d(t,{C:()=>CustomCalendarRange});var r=i(86981),n=i.n(r),a=i(84705),s=i.n(a),o=i(19755),l=i.n(o);class CustomCalendarRange extends kendo.ui.MultiViewCalendar{constructor(e,t){super(e,t)}get _$translate(){return this._$translateLazy||(this._$translateLazy=CustomCalendarRange.$injector.get("$translate")),this._$translateLazy}todayClick(e){this._todayClick(e)}_todayClick(e){let t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=this.options.disableDates,n=!1;e.preventDefault(),r(i)||(this._value=i,"multiple"===this.options.selectable&&(this._selectDates=[i]),"range"===this.options.selectable&&(this.rangeSelectable.clear(!0),this._range={start:i,end:i}),"month"===this._currentView.name&&this._dateInViews(i)||(n=!0),this.navigate(i,this.options.depth),"single"===this.options.selectable&&(this.selectable._lastActive=null),n&&this.trigger("navigate"),this.trigger("change"))}_header(){let e=l()(this._headerTemplate);this._todayBtn=n()(e).call(e,".k-today"),this._todayBtn.on("click",(e=>{this.todayClick(e)})),this.element.prepend(e),super._header()}_updateHeader(){var e;this._navContainer||(this._navContainer=l()(this._navContainerTemplate).appendTo(this.header),this._todayBtn=n()(e=this._navContainer).call(e,".k-today"),this._todayBtn.on("click",(e=>{this.todayClick(e)})));super._updateHeader()}get _headerTemplate(){var e;return s()(e=`\n        <div class="k-calendar-header">\n            <a class="k-button k-title pw-link"></a>\n            ${this._navContainerTemplate}\n        </div>\n        `).call(e)}get _navContainerTemplate(){var e;return s()(e=`\n        <span class="k-calendar-nav">\n            <a class="k-button k-today">${this._$translate.instant("BUTTONS.TODAY")}</a>\n            <a class="k-button k-button-icon k-prev-view"><span class="mdi mdi-chevron-left"></span></a>\n            <a class="k-button k-button-icon k-next-view"><span class="mdi mdi-chevron-right"></span></a>\n        </span>\n        `).call(e)}}},86542:(e,t,i)=>{i.d(t,{g:()=>m,l:()=>CustomDraggable});var r=i(48216),n=i.n(r),a=i(86981),s=i.n(a),o=i(9938),l=i.n(o),d=i(19755),c=i.n(d),h=i(26422),u=i.n(h);let p=!1;const m="pw--dragging-item";class CustomDraggable extends kendo.ui.Draggable{constructor(){super(...arguments),n()(this).call(this,"dragstart",(e=>e.target.dispatchEvent(new CustomEvent("pwDragStart"))))}static get isDragging(){return p}destroy(){this._cancelAutoScroll(),super.destroy()}static get autoScrollSettings(){return CustomDraggable._autoScrollSettings}static set autoScrollSettings(e){CustomDraggable._autoScrollSettings=e}_start(e){if(this.options.autoScroll){var t;let i=e.target;this._currentAutoScrollSettings=s()(t=CustomDraggable.autoScrollSettings).call(t,(e=>e.chooseWhen(i)))}p=!0,super._start(e)}_updateHint(e){let t;switch(this.options.cursorOffset?t={left:e.x.location+this.options.cursorOffset.left,top:e.y.location+this.options.cursorOffset.top}:(this.hintOffset.left+=e.x.delta,this.hintOffset.top+=e.y.delta,Math.abs(this.hintOffset.top-e.y.location)>this.hint.height()/2&&(this.hintOffset.top=e.y.location-Math.ceil(this.hint.height()/2)),this.hintOffset.left+this.hint.width()<=e.x.location&&(this.hintOffset.left=e.x.location-Math.ceil(this.hint.width()/2)),t=c().extend({},this.hintOffset)),this.boundaries&&(t.top=Math.min(Math.max(t.top,this.boundaries.y.min),this.boundaries.y.max),t.left=Math.min(Math.max(t.left,this.boundaries.x.min),this.boundaries.x.max)),this.options.axis){case"x":delete t.top;break;case"y":delete t.left}this.hint.css(t)}_cancel(e){this._cancelAutoScroll(),p=!1,super._cancel(e)}_drag(e){e.preventDefault();let t=this._elementUnderCursor(e),i=e.x.location,r=e.y.location;this.options.autoScroll&&(this._setupAutoScrollStep(i,r),this._cursorElement=t),this._lastEvent=e,this._processMovement(e,t),this.options.autoScroll&&(this._scrollableParent[0]?(this._scrollCompenstation=c().extend({},this.hintOffset),this._scrollTimeout||(this._scrollTimeout=l()((()=>{this._scrollInterval=u()(25,(()=>{this._autoScroll()}))}),200))):this._cancelAutoScroll()),this.hint&&this._updateHint(e)}_rawAutoScrollVelocity(e,t,i,r){let n={x:0,y:0},a=r.scrollArea,s=kendo.ui.Draggable.utils.scrollableViewPort(i),o=i.scrollLeft(),l=i.scrollTop();if(r.getOverflowLeftTopFix){let e=r.getOverflowLeftTopFix();o+=e.left,l+=e.top}let d=i.prop("scrollWidth")-i.innerWidth()-o,c=i.prop("scrollHeight")-i.innerHeight()-l;return(r.workBeyondScrollable||e>s.left&&e<s.right&&t>s.top&&t<s.bottom)&&(e-s.left<a&&o>1?n.x=-(a-(e-s.left)):s.right-e<a&&d>1&&(n.x=a-(s.right-e)),t-s.top<a&&l>1?n.y=-(a-(t-s.top)):s.bottom-t<a&&c>1&&(n.y=a-(s.bottom-t))),n}_adjustScrollVelocity(e,t){e.x=this._limitScrollVelocity(e.x,t),e.y=this._limitScrollVelocity(e.y,t)}_autoScroll(){let e=this._scrollableParent[0];if(!e)return;let t=this._scrollVelocity,i=this._scrollCompenstation,r=this._elementUnderCursor(this._lastEvent);this._processMovement(this._lastEvent,r);let n,a,s=e===(kendo.support.browser.edge||kendo.support.browser.safari?document.body:document.documentElement);s?(n=document.body.scrollHeight>$window.height(),a=document.body.scrollWidth>$window.width()):(n=e.offsetHeight<=e.scrollHeight,a=e.offsetWidth<=e.scrollWidth),n&&(e.scrollTop+=t.y),a&&(e.scrollLeft+=t.x),this.hint&&s&&(a||n)&&(n&&(i.top+=t.y),a&&(i.left+=t.x),this.hint.css(i))}_cancelAutoScroll(){this._scrollTimeout&&(clearTimeout(this._scrollTimeout),this._scrollTimeout=null),this._scrollInterval&&(u().clear(this._scrollInterval),this._scrollInterval=null)}_limitScrollVelocity(e,t){if(e){let i=Math.exp(Math.log(t.maxVelocity)*Math.abs(e)/t.scrollArea);return i>t.maxVelocity&&(i=t.maxVelocity),e<0&&(i*=-1),i}return e}_setupAutoScrollStep(e,t){let i=this._currentAutoScrollSettings;for(;i;){let r=i.getScrollable();if(r[0]){let n=this._rawAutoScrollVelocity(e,t,r,i);if(n.x||n.y)return this._adjustScrollVelocity(n,i),this._scrollVelocity=n,void(this._scrollableParent=r)}i=i.nextSettings}this._scrollableParent=c()()}}},73180:(e,t,i)=>{i.d(t,{K:()=>CustomScheduler,a:()=>getKendoSortOrder});var r=i(62079),n=i.n(r),a=i(52020),s=i.n(a),o=i(88546),l=i.n(o),d=i(99595),c=i.n(d),h=i(66775),u=i.n(h),p=i(2201),m=i.n(p),g=i(57445),y=i.n(g),v=i(41266),f=i(26171),_=i(23513),C=i.n(_),S=i(98235),w=i.n(S),k=i(27525),b=i.n(k),D=i(8571),T=i.n(D),E=i(76555),A=i.n(E),I=i(73324),P=i.n(I),R=i(88946),L=i.n(R),N=i(35820),O=i.n(N),M=i(48216),$=i.n(M),x=i(87994),B=i.n(x),H=i(19755),U=i.n(H),F=i(56777),W=i(46930),z=i(86981),G=i.n(z),j=i(31082),V=i.n(j),K=i(22574),Y=i.n(K),q=i(82617),Z=i(8937),X=i(29704);function ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=P()(r).call(r,(function(t){return l()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?c()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,f.Z)(e,t,n[t])})):u()?m()(e,u()(n)):c()(r=ownKeys(Object(n))).call(r,(function(t){y()(e,t,l()(n,t))}))}return e}class CardDragHelper{constructor(e){this._isDragging=!1,this._checkDrag=e.checkDrag,this._processDragAsync=e.processDragAsync,this._getSortOrderField=e.getSortOrderField}get _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=CustomScheduler.$injector.get("appCommonSrv")),this._appCommonSrvLazy}get _trelloIntegrationSrv(){return this._trelloIntegrationSrvLazy||(this._trelloIntegrationSrvLazy=CustomScheduler.$injector.get("trelloIntegrationSrv")),this._trelloIntegrationSrvLazy}get _googleIntegrationSrv(){return this._googleIntegrationSrvLazy||(this._googleIntegrationSrvLazy=CustomScheduler.$injector.get("googleIntegrationSrv")),this._googleIntegrationSrvLazy}get _outlookIntegrationSrv(){return this._outlookIntegrationSrvLazy||(this._outlookIntegrationSrvLazy=CustomScheduler.$injector.get("outlookIntegrationSrv")),this._outlookIntegrationSrvLazy}startDragging(e,t,i,r,n){this._originCard=e,this._workWeek=i,this._startSlotTime=r.time,this._startSlotIsDaySlot=r.isDaySlot,this._startSlotResourceId=r.resourceId,this._targetSlotTime=r.time,this._targetSlotIsDaySlot=r.isDaySlot,this._targetSlotResourceId=r.resourceId,this._lastTypeSlotTime=r.time,this._lastTypeSlotIsDaySlot=r.isDaySlot,this._originCards=n,this._sortOrderField=this._getSortOrderField(),this._cards={};for(let r of t)this._cards[r.uid]=(0,F.VH)(r.providerType).getDraggingCard(r,e,i,this._sortOrderField);this._isDragging=!0,this._cardTypesByResourceId={}}drag(e){if(this._isDragging&&(!(0,X.rs)(e.time,this._targetSlotTime)||e.isDaySlot!==this._targetSlotIsDaySlot||e.resourceId!==this._targetSlotResourceId)){this._targetSlotTime=e.time,this._targetSlotIsDaySlot=e.isDaySlot,this._canDrag(e.resourceId)&&(this._targetSlotResourceId=e.resourceId);for(let e in this._cards){let t=this._cards[e];if(!(0,F.VH)(t.providerType).canStartMoveInScheduler(t))return}if(e.isDaySlot!==this._lastTypeSlotIsDaySlot)if(e.isDaySlot!==this._startSlotIsDaySlot){this._lastTypeSlotTime=e.time,this._lastTypeSlotIsDaySlot=e.isDaySlot;let t=(0,X.bt)((0,X.$Y)(this._originCard.start),(0,X.$Y)(e.time),this._workWeek);for(let i in this._cards){let r=this._cards[i],n=this._getWorkTimeStart(r.originStart),a=!1;if(e.isDaySlot)r.canBeMultiDay&&r.isMultiDay()!==e.isDaySlot?(a=!0,r.isAllDay=!0,r.newStart=this._addWorkDays((0,X.$Y)(n),t.days,!0)):r.newStart=this._addWorkDays(n,t.days,!0),r.newEnd=r.canBeMultiDay?this._addWorkDays(r.newStart,r.durations.days,!0):(0,X.mH)(r.newStart,r.durations.minutes);else if(r.isMultiDay()!==e.isDaySlot){a=!0,r.isAllDay=e.isDaySlot,r.newStart=this._addWorkDays((0,X.q_)(n,e.time),t.days,!0);let i=r.durations.minutes;(i<0||i>=1440||r.originIsAllDay)&&(i=r.isSingleDate?0:r.defaultDuration),r.newEnd=r.canBeMultiDay?this._addWorkMinutes(r.newStart,i):(0,X.mH)(r.newStart,i)}else r.newStart=this._addWorkDays(n,t.days,!0),r.newEnd=r.canBeMultiDay?this._addWorkDays(r.newStart,r.durations.days):(0,X.mH)(r.newStart,r.durations.minutes);r.start=r.newStart,r.end=r.newEnd,a&&(r.durations=(0,X.bt)(r.start,r.end,this._workWeek))}}else{this._targetSlotTime=this._startSlotTime,this._targetSlotIsDaySlot=this._startSlotIsDaySlot,this._lastTypeSlotTime=this._startSlotTime,this._lastTypeSlotIsDaySlot=this._startSlotIsDaySlot;for(let e in this._cards){let t=this._cards[e];t.start=t.originStart,t.newStart=t.start,t.end=t.originEnd,t.newEnd=t.end,t.isAllDay=t.originIsAllDay,t.durations=t.originDurations}this.drag(e)}else{let t=(0,X.bt)(this._lastTypeSlotTime,e.time,this._workWeek);for(let i in this._cards){let r=this._cards[i],n=this._getWorkTimeStart(r.start);if(e.isDaySlot)t.days?r.isAllDay?(r.newStart=this._addWorkDays(n,t.days,!0),r.newEnd=this._addWorkDays(r.newStart,r.durations.days,!0)):(r.newStart=this._addWorkDays(n,t.days,!0),r.newEnd=r.canBeMultiDay?this._addWorkMinutes(r.newStart,r.durations.minutes):(0,X.mH)(r.newStart,r.durations.minutes)):(r.newStart=r.start,r.newEnd=r.end);else if(r.isAllDay)t.days?(r.newStart=this._addWorkDays(n,t.days,!0),r.newEnd=this._addWorkDays(r.newStart,r.durations.days,!0)):(r.newStart=r.start,r.newEnd=r.end);else if(t.minutes){let e;e=r.cardRole===q.D.Milestone&&this._targetSlotResourceId!==this._startSlotResourceId?r.defaultDuration:r.durations.minutes,r.newStart=this._addWorkMinutes(n,t.minutes,!0),r.newEnd=r.canBeMultiDay?this._addWorkMinutes(r.newStart,e):(0,X.mH)(r.newStart,e)}else r.newStart=r.start,r.newEnd=r.end}}}}getDraggedCard(e){var t;if(!this._isDragging)return null;let i=this._cards[e],r=this._targetSlotResourceId!==this._startSlotResourceId?this._targetSlotResourceId:void 0,n=null===(t=this._cardTypesByResourceId[r])||void 0===t?void 0:t.has(i.cardType);return(0,F.VH)(i.providerType).getDraggedCardUpdateData(i,r,n)}async stopDraggingAsync(e,t){if(!this._isDragging)return[];let i=[];if(this._appCommonSrv.getSchedulerView()===Z.rW.Timeline){for(let t in this._cards)i.push(_objectSpread(_objectSpread({},this.getDraggedCard(t)),{},{uid:t,providerCard:{[this._sortOrderField]:e[t]}}));for(let e of t){var r;let t=G()(r=this._originCards).call(r,(t=>t.uid===e.uid));t&&(this._sortOrderField&&e.providerCard[this._sortOrderField]===t.providerCard[this._sortOrderField]||e.isRecurring&&e.isRecurring()&&!e.isException()||i.push({uid:e.uid,start:e.realStart,end:e.realEnd,isAllDay:e.isAllDay,providerCard:{[this._sortOrderField]:e.providerCard[this._sortOrderField]}}))}}else{if((0,X.rs)(this._startSlotTime,this._targetSlotTime)&&this._startSlotIsDaySlot===this._targetSlotIsDaySlot&&this._startSlotResourceId===this._targetSlotResourceId)return[];for(let e in this._cards)i.push(_objectSpread(_objectSpread({},this.getDraggedCard(e)),{},{uid:e}))}this._isDragging=!1;let n=new(O())(((e,t)=>{this._checkDrag(i,e,t)&&t()}));try{let e=await n;return this._processDragAsync(e),L()(e).call(e,(e=>e.event))}catch{return[]}}cancelDragging(){this._isDragging=!1}_canDrag(e){if(!e)return!0;let t=V()(this._cards),i=new(C()),r=!0;for(let[a,s]of(0,X.vM)(t,"providerType")){var n;let t=(0,F.VH)(a).getDragInfo(s,e);r=r&&t.canDrag,c()(n=t.allowedCardTypes).call(n,(e=>i.add(e)))}return this._cardTypesByResourceId[e]=i,r}_addWorkDays(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._workWeek)return(0,X.E4)(e,t);let r=e.getDay(),n=(0,X.ET)(r,this._workWeek);i=i||!(0,X.Xi)(e);let a=0;for(;t>0||!n&&i;)a++,n&&t--,r===this._workWeek.end&&(n=!1),r++,7===r&&(r=0),r===this._workWeek.start&&(n=!0);for(;t<0;)a--,r===this._workWeek.start&&(n=!1),r--,-1===r&&(r=6),r===this._workWeek.end&&(n=!0),n&&t++;return(0,X.E4)(e,a)}_addWorkMinutes(e,t,i){let r=Y()(t/1440),n=t%1440,a=(0,X.mH)(this._addWorkDays(e,r,i||!!n),n);return this._findNearestWorkDay(a,t>0)}_getWorkTimeStart(e){return(0,X.ET)(e.getDay(),this._workWeek)?e:this._findNearestWorkDay((0,X.$Y)(e),!0)}_findNearestWorkDay(e,t){let i=e.getDay();if((0,X.ET)(i,this._workWeek))return e;if(t&&(0,X.Xi)(e)){let t=i>0?i-1:6;if((0,X.ET)(t,this._workWeek))return e}let r=0;if(t)for(;i!==this._workWeek.start;)r++,i++,7===i&&(i=0);else for(;i!==this._workWeek.end;)r--,i--,-1===i&&(i=6);return(0,X.E4)(e,r)}}const Q=["event"];function CustomScheduler_ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=P()(r).call(r,(function(t){return l()(e,t).enumerable}))),i.push.apply(i,r)}return i}function CustomScheduler_objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?c()(i=CustomScheduler_ownKeys(Object(n),!0)).call(i,(function(t){(0,f.Z)(e,t,n[t])})):u()?m()(e,u()(n)):c()(r=CustomScheduler_ownKeys(Object(n))).call(r,(function(t){y()(e,t,l()(n,t))}))}return e}kendo.ui.Scheduler.fn.events.push("selectionStart");class CustomScheduler extends kendo.ui.Scheduler{constructor(e,t){const i=U()(e).scope(),r=CustomScheduler.$injector.get("$translate");kendo.data.ObservableObject.prototype.init=function(e){kendo.Observable.fn.init.call(this),this._handlers={};for(let t in e)"_"!==t.charAt(0)&&(this[t]=e[t]);void 0!==e.cardType&&(e.id?this.uid=e.id:e.recurrenceId&&(this.uid=`${e.recurrenceId}-${e.start-e.previousStart}`),this.noTitle=r.instant("MISC.NO_TITLE")),this.uid||(this.uid=kendo.guid())},kendo.data.ObservableObject.prototype.toJSON=function(){let e={};for(let t in this)if(this.shouldSerialize(t)){let i=this[t];i instanceof kendo.data.ObservableObject||i instanceof kendo.data.ObservableArray?i=i.toJSON():i instanceof C()?i=new(C())(i):w()(i)&&(i=[...i]),e[t]=i}return e},kendo.data.ObservableArray.prototype.includes=function(e){return b()(this).call(this,(t=>t===e))},kendo.data.Model.prototype.init=function(e){if((!e||!(e instanceof W.fb)&&U().isEmptyObject(e))&&(e=U().extend({},this.defaults,e),this._initializers))for(let t=0;t<this._initializers.length;t++){let i=this._initializers[t];e[i]=this.defaults[i]()}kendo.data.ObservableObject.prototype.init.call(this,e),this.dirty=!1,this.idField&&(this.id=this.get(this.idField),void 0===this.id&&(this.id=this._defaultId))};const n=kendo.data.Model.prototype.accept;kendo.data.Model.prototype.accept=function(e){n.call(this,e),void 0!==e.cardType&&(e.id?this.uid=e.id:e.recurrenceId&&(this.uid=`${e.recurrenceId}-${e.start-e.previousStart}`),this.noTitle=r.instant("MISC.NO_TITLE"),this.providerCard=e.providerCard)},kendo.data.SchedulerEvent.prototype.clone=function(e,t){let i=CustomScheduler_objectSpread(CustomScheduler_objectSpread({__proto__:this.__proto__},this),e);return t?i.id?i.uid=i.id:i.recurrenceId&&(i.uid=`${i.recurrenceId}-${i.start-i.previousStart}`):i.uid=this.uid,i.noTitle=r.instant("MISC.NO_TITLE"),i},kendo.data.SchedulerEvent.prototype.deepClone=function(){let e=this.clone();for(let t in e){let i=e[t];i instanceof C()?e[t]=new(C())(i):w()(i)&&(e[t]=[...i])}return e},kendo.data.SchedulerDataSource.prototype.pushUpdate=function(e){w()(e)||(e=[e]);let t=[];for(let i of e){if(!(i instanceof W.fb))continue;let e=this._createNewModel(i),r=this.get(e.id);r?(r._startTime&&(r._startTime=kendo.date.toUtcTime(i.start)),r._endTime&&(r._endTime=kendo.date.toUtcTime(i.end)),t.push(r),r.accept(i),r.trigger("change"),this._updatePristineForModel(r,i)):this.pushCreate(i)}t.length>0&&this.trigger("push",{type:"update",items:t})},kendo.data.SchedulerDataSource.prototype._addExceptionDate=function(){},kendo.data.SchedulerDataSource.prototype._removeExceptionDate=function(){},kendo.data.SchedulerDataSource.prototype._removeExceptions=function(){},kendo.data.SchedulerDataSource.prototype.expand=function(e,t){var i,r;let n=this.view();if(!e||!t)return n;let a=t.getTimezoneOffset();(t=new Date(t.getTime()+kendo.date.MS_PER_DAY-1)).getTimezoneOffset()!==a&&(t=kendo.timezone.apply(t,a));let s={logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:e},{field:"end",operator:"gte",value:e},{field:"start",operator:"lte",value:t}]},{logic:"and",filters:[{field:"start",operator:"lte",value:new Date(e.getTime()+kendo.date.MS_PER_DAY-1)},{field:"end",operator:"gte",value:e}]}]},o=new Array(n.length),l=!1,d=new Date(e.getTime()-1);for(let i=0;i<n.length;i++){let r=n[i];if(r.recurrenceRule){var c,h;o[i]=null!==(c=null===(h=r.customExpand)||void 0===h?void 0:h.call(r,e,t))&&void 0!==c?c:r.expand(d,t,this.reader.timezone);for(let e of o[i])e.recurrenceHeadRule=r.recurrenceRule;l=!0}else o[i]=r}var u;l&&(o=T()(u=[]).call(u,...o));for(let e of o)e.realStart=e.start,e.realEnd=e.end,e.realIsAllDay=e.isAllDay;return A()(i=P()(r=new kendo.data.Query(o)).call(r,s)).call(i,getKendoSortOrder()).toArray()},kendo.ui.SchedulerView.prototype._shouldInverseResourceColor=function(){return!1},kendo.support.isRtl=function(){return!1},kendo.ui.SchedulerView.prototype.current=function(e){if(void 0===e)return this._current;this._current=e},super(e,t),this.wrapper.off("mousedown.kendoScheduler selectstart.kendoScheduler").on("mousedown.kendoScheduler",".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",(e=>{this._isTouch(e)||this._mouseDownSelection(e)})),this._cardDragHelper=new CardDragHelper({checkDrag:(e,t,i)=>this.trigger("moveEnd",{success:t,failure:i,eventsToMove:L()(e).call(e,(e=>{let t={event:this.occurrenceByUid(e.uid).deepClone(),isOriginCard:e.isOriginCard,cardType:e.cardType,isAllDay:e.isAllDay,start:e.start,end:e.end,providerCard:{}};e.cardRole&&(t.cardRole=e.cardRole),e.resourceId&&(t.resourceId=e.resourceId);let i=this._getCardSortOrderField();return i&&(t.providerCard[i]=e.providerCard[i]),t}))}),processDragAsync:e=>O().all(L()(e).call(e,(e=>{let{event:t}=e,i=(0,v.Z)(e,Q);return this._updateEvent(null,t,i)}))),getSortOrderField:()=>this._getCardSortOrderField()});const onDocumentMouseDown=e=>{if(this.isEventsSelected()){let t=U()(e.target);0!==e.button||e.shiftKey||e.ctrlKey||t.closest(".window, .pop-over, md-dialog, md-menu-content, .pw-dialog-edit-card, .k-event, .timeline-item, .k-popup, .pw-selectable-items-container")[0]||this.select(null)}};document.addEventListener("mousedown",onDocumentMouseDown,!0),document.addEventListener("pointerdown",onDocumentMouseDown),i.$on("$destroy",(()=>{document.removeEventListener("mousedown",onDocumentMouseDown,!0),document.removeEventListener("pointerdown",onDocumentMouseDown)}))}view(e){let t,i,r=super.view();if(!e)return r;if(r.name===e){let e=U()(".k-scheduler-content",this.element);t=e.scrollTop(),i=e.scrollLeft()}super.view(e);let n=U()(".k-scheduler-content",this.element);t&&n.scrollTop(t),i&&n.scrollLeft(i)}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.view();t&&("itemchange"===e.action&&this._preventRefresh||this.trigger("dataBinding",{action:e.action||"rebind",index:e.index,items:e.items})||(this._data=this.dataSource.expand(t.startDate(),t.visibleEndDate()),t.render(this._data),this.trigger("dataBound")))}removeEvent(e){let t="string"==typeof e?this.occurrenceByUid(e):e;t&&this.options.remove({event:t})}isEventsSelected(){return this._selection&&this._selection.events.length>0}getSelectedEvents(){var e,t;return this.isEventsSelected()?P()(e=L()(t=this._selection.events).call(t,(e=>this.occurrenceByUid(e)))).call(e,(e=>e)):[]}slotByElement(e){var t;let i=null===(t=U()(e)[0])||void 0===t?void 0:t.getBoundingClientRect();if(i)return this.slotByPosition(i.left+i.width/2,i.top+i.height/2)}_initModel(){var e;this._model=kendo.observable({selectedDate:new Date(this.options.date),formattedDate:"",formattedShortDate:""}),$()(e=this._model).call(e,"change",(e=>{"selectedDate"===e.field&&this.view().name!==Z.rW.Timeline&&this.view(this._selectedViewName)}))}_progress(){}_toolbar(){this.toolbar=U()()}_initializeView(e){let t=this.views[e],i=U().extend(!0,{},this.options,t,{resources:this.resources,date:this.date(),showWorkHours:this._workDayMode});return delete i.name,delete i.prefix,delete i.remove,delete i.edit,delete i.add,delete i.navigate,t.type(this.wrapper,i)}_resources(){let e=this.options.resources;for(let t=0;t<e.length;t++){let i=e[t],r=i.field;if(!r||!i.dataSource)throw new Error('The "field" and "dataSource" options of the scheduler resource are mandatory.');let n=kendo.data.DataSource.create(i.dataSource);this.resources.push({field:r,defaultFieldValue:i.defaultFieldValue,name:i.name||r,title:i.title||r,dataTextField:i.dataTextField||"text",dataValueField:i.dataValueField||"value",dataColorField:i.dataColorField||"color",valuePrimitive:null===i.valuePrimitive||i.valuePrimitive,multiple:i.multiple||!1,dataSource:n}),n.fetch()}}_selectView(e){if(e&&this.views[e]){var t,i,r,n;this._selectedView&&this._unbindView(this._selectedView);let a=this._selectedView;this._selectedView=this._renderView(e),null===(t=(i=this._selectedView).setCardDragHelper)||void 0===t||t.call(i,this._cardDragHelper),null===(r=(n=this._selectedView).applyPreviousViewOptions)||void 0===r||r.call(n,a),this._selectedViewName=e}}get _selection(){let e=this.view();if(e)return e.name===Z.rW.Timeline?{events:e.getSelection()}:this._kendoSelection}set _selection(e){this._kendoSelection=e}_mouseDownSelection(e){0===e.button&&(this._ctrlKey=e.ctrlKey,this._shiftKey=e.shiftKey,this._commandKey=e.metaKey,this._createSelection(e.currentTarget)),this._selection||this._userTouched||this._selectFirstSlot(),this._select()}_createSelection(e){this._ctrlKey=this._ctrlKey||this._shiftKey||this._commandKey;let t=U()(e).data("uid");if(t){let e=this.occurrenceByUid(t);if(!e||e.isRecurring()&&!e.isException())return void(this._ctrlKey||this.select(null))}super._createSelection(e),this.trigger("selectionStart",{isMultiselect:this._ctrlKey,selectedCount:this._selection.events.length})}_updateSelection(e,t,i){super._updateSelection(e,t,i);let r=this.view();r.name===Z.rW.Timeline&&r.select({events:t})}_adjustSelectedDate(){}_keydown(){}_tabIndex(){}_movable(){var e,t,i,r;const n=U()("body");let a,s=[];this._moveDraggable=new kendo.ui.Draggable(this.element,{distance:0,filter:".k-event",ignore:".k-resize-handle",holdToDrag:!1,autoScroll:!0}),$()(e=this._moveDraggable).call(e,"dragstart",(e=>{if(a=this.view(),a.name===Z.rW.Timeline)return;let t=this.occurrenceByUid(e.currentTarget.data("uid"));if(!t)return;let i=t.deepClone(),r=a.showWorkDays?{start:this.options.workWeekStart,end:this.options.workWeekEnd}:void 0;var o;this.isEventsSelected()?s=L()(o=this._selection.events).call(o,(e=>this.occurrenceByUid(e).clone())):s=[i];let l=a._slotByPosition(e.x.startLocation,e.y.startLocation),d=l.startOffset(e.x.startLocation,e.y.startLocation,this.options.snap);l&&!this.trigger("moveStart",{event:t})?(this._cardDragHelper.startDragging(t,s,r,{time:kendo.timezone.toLocalDate(d),isDaySlot:l.isDaySlot}),n.addClass("pw--moving-calendar-card")):e.preventDefault()})),$()(t=this._moveDraggable).call(t,"drag",(e=>{if(a.name===Z.rW.Timeline)return;let t=a._slotByPosition(e.x.location,e.y.location);if(!t)return;let i=t.startOffset(e.x.location,e.y.location,this.options.snap);this._cardDragHelper.drag({time:kendo.timezone.toLocalDate(i),isDaySlot:t.isDaySlot});for(let e of s){var r,n;let t,i=this._cardDragHelper.getDraggedCard(e.uid);e.start=i.start,e.end=i.end,e.isAllDay=i.isAllDay;let s=L()(r=P()(n=a.groups).call(n,(t=>{var i;return b()(i=t._continuousEvents).call(i,(t=>e.uid===t.uid))}))).call(r,(e=>e._index));s.length>0&&(t=s),a._updateMoveHint(e,t)}})),$()(i=this._moveDraggable).call(i,"dragend",(async()=>{a.name!==Z.rW.Timeline&&(n.removeClass("pw--moving-calendar-card"),a._removeMoveHint(),await this._cardDragHelper.stopDraggingAsync(),s=[])})),$()(r=this._moveDraggable).call(r,"dragcancel",(()=>{a.name!==Z.rW.Timeline&&(n.removeClass("pw--moving-calendar-card"),this.view()._removeMoveHint(),this._cardDragHelper.cancelDragging(),s=[])}))}_updateEvent(e,t,i){e&&(i=this.view().adjustUpdateEventData(e,t,i)),void 0===i.isAllDay&&(i.isAllDay=t.isAllDay),i.providerCard||(i.providerCard={});if((()=>!(!i.cardRole||t.cardRole===i.cardRole)||(t.isAllDay!==i.isAllDay||(!(0,X.rs)(t.start,i.start)||!(0,X.rs)(t.end,i.end)||(0,F.VH)(t.providerType).isEventDataUpdated(t,i,this._getCardSortOrderField()))))())return this.options.update({event:t,updateData:i,isResize:!!e})}_getCardSortOrderField(){var e;return null===(e=this.view().groupedResources[0])||void 0===e?void 0:e.cardSortOrderField}}function getKendoSortOrder(e){function getProviderTypeSortOrder(e){let t=e.providerType;return t||(t=e.data.providerType,t)?Z.Tr[t]:Number.POSITIVE_INFINITY}let t=[{field:"realStart",dir:"asc",priority:10},{field:"realEnd",dir:"desc",priority:20},{field:"providerType",dir:"asc",compare:(e,t)=>getProviderTypeSortOrder(e)-getProviderTypeSortOrder(t),priority:30},{field:"title",dir:"asc",priority:40},{field:"id",dir:"asc",priority:50},{field:"recurrenceId",dir:"asc",priority:60}];if(t.push(...B()(F.yI).call(F.yI,(e=>(0,F.IB)(e).sortOrder))),t=A()(t).call(t,((e,t)=>e.priority-t.priority)),e)for(let i of t)i.field=`${e}.${i.field}`;return t}},15672:(e,t,i)=>{i.d(t,{s:()=>CustomSortable});var r=i(19755),n=i.n(r),a=i(86542);kendo.ui.Sortable.fn.events.push("moveHint");class CustomSortable extends kendo.ui.Sortable{constructor(e,t){super(e,t)}indexOf(e){let t=this._items();return this.placeholder&&e[0]===this.placeholder[0]?this._isSourceList?t.not(this.draggedElement).index(e):t.index(e):t.not(this.placeholder).index(e)}_createDraggable(){let e=super._createDraggable();return e.setOptions({group:this.options.group}),e}_dragstart(e){super._dragstart(e),e.isDefaultPrevented()||n()("body").addClass(a.g),this._isSourceList=!0}_drag(e){let t=this.trigger("moveHint",{event:e,elementUnderCursor:this._findElementUnderCursor(e)});this.options.disableSorting||t||super._drag(e)}_dragend(e){if(n()("body").removeClass(a.g),n()(this._findElementUnderCursor(e)).closest(".pw-js-kendo-sortable-outside-target")[0])return e.sender.hint.remove(),void super._dragcancel();super._dragend(e),this._isSourceList=!1}_dragcancel(){n()("body").removeClass(a.g),super._dragcancel(),this._isSourceList=!1}_isCursorAfterLast(e,t){let i=e.items(),r=i.last();r.is(":hidden")&&i.length>=2&&(r=n()(i[i.length-2]));let a,s=kendo.getOffset(r);return s.top+=kendo._outerHeight(r),s.left+=kendo._outerWidth(r),a=this._isFloating(r)?s.left-t.x.location:s.top-t.y.location,a<0}_movePlaceholder(e,t,i){var r,n;if(null!==(r=(n=this.options).restrictedSorting)&&void 0!==r&&r.call(n)){let r=this.options.getRestrictedSortingTarget(i,e);return e.element=r.element,t=r.direction,i.direction=r.direction,void super._movePlaceholder(e,t,i)}i.direction=t,super._movePlaceholder(e,t,i)}_isFloating(e){let t=super._isFloating(e);if(!t){let i=e.parent();t=i&&/flex/.test(i.css("display"))&&/row/.test(i.css("flex-direction"))}return t}}},15618:(e,t,i)=>{i.d(t,{R:()=>CustomTimePicker});var r=i(26171),n=i(84705),a=i.n(n),s=i(9938),o=i.n(s),l=i(22574),d=i.n(l),c=i(86981),h=i.n(c),u=i(29898),p=i.n(u),m=i(73324),g=i.n(m),y=i(88946),v=i.n(y),f=i(61539),_=i.n(f),C=i(35293),S=i.n(C),w=i(19755),k=i.n(w),b=i(29704);const D=a()('\n<li\n    data-time="#= data.time #"\n    class="k-item"\n    tabindex="-1"\n    unselectable="on"\n>\n    <md-menu-item class="pw-menu-item">\n        <md-button\n            class="pw-menu-item-btn k-timepicker-item-btn"\n            # if (data.isDisabled) { #\n            disabled\n            # } #\n        >\n            <div class="pw-menu-item-btn__text">\n                #= data.text #\n            </div>\n        </md-button>\n    </md-menu-item>\n</li>\n').call('\n<li\n    data-time="#= data.time #"\n    class="k-item"\n    tabindex="-1"\n    unselectable="on"\n>\n    <md-menu-item class="pw-menu-item">\n        <md-button\n            class="pw-menu-item-btn k-timepicker-item-btn"\n            # if (data.isDisabled) { #\n            disabled\n            # } #\n        >\n            <div class="pw-menu-item-btn__text">\n                #= data.text #\n            </div>\n        </md-button>\n    </md-menu-item>\n</li>\n'),T="pw-menu-item--selected";class CustomTimePicker extends kendo.ui.TimePicker{constructor(e,t){!t.min&&t.max&&(t.min=(0,b.$Y)(t.max)),!t.max&&t.min&&(t.max=(0,b.h3)(t.min)),super(e,t),this.element.css({width:""}),this.options.readonly&&this.element.prop("readonly",!0),k()(".md-dialog-container").on("mousedown",(()=>this.timeView.close()));const i=k()(e).scope(),r=CustomTimePicker.$injector.get("$compile");this._$scope=i,this.timeView.template=kendo.template(D,{useWithBlock:!1});const n=this.timeView.open;this.timeView.open=function(){i.$emit("$kendoMenuOpen",k()(e)),o()((()=>{n.call(this),this.list.parent(".k-animation-container").css({width:""})}),50)};const a=this.timeView.close;this.timeView.close=function(){a.call(this),i.$emit("$kendoMenuClose")},this.timeView.refresh=function(){var e;let t=new Date(this.options.min),n=(0,b.rs)(t,this.options.max)?(0,b.E4)(this.options.max,1):new Date(this.options.max),a=n.getTimezoneOffset()-t.getTimezoneOffset(),s=a<0,o=kendo.TimeView.getMilliseconds(t),l=kendo.TimeView.getMilliseconds(n),c=new Date(2100,0,1);c.setMinutes(-this.options.interval);let u,p=kendo.TimeView.getMilliseconds(c),m=this.options.interval*kendo.date.MS_PER_MINUTE;o!==l||p===l?(s&&(l+=a*kendo.date.MS_PER_MINUTE),o>l&&(l+=kendo.date.MS_PER_DAY),u=(l-o)/m+1):u=s?(kendo.date.MS_PER_DAY+a*kendo.date.MS_PER_MINUTE)/m:kendo.date.MS_PER_DAY/m,this._dates=[],this._times={};let g="",y=new Date(t),v=d()(u);for(let e=0;e<u;e++){if(e>0&&kendo.date.setTime(y,m,s),l&&e===v){let e=kendo.TimeView.getMilliseconds(y);y>t&&(e+=kendo.date.MS_PER_DAY),e>l&&(y=new Date(n))}this._dates.push(kendo.TimeView.getMilliseconds(y));let i={time:kendo.toString(y,this.options.format,this.options.culture),isDisabled:this.options.disable};this._times[i.time]=new Date(y);let r=e*m;if((0,b.rs)(y,n)?r-=kendo.date.MS_PER_MINUTE:r===kendo.date.MS_PER_DAY&&(r-=1),this.options.isOnlyDuration)i.text=(0,b.LU)(r+o)||"0m";else{let e=this.options.showDuration&&(0,b.LU)(r);i.text=e?`${i.time} (${e})`:i.time}g+=this.template(i)}this._html(g),r(this.ul)(i),this.list.addClass("k-timepicker-list pw-menu-content pw-menu-content--selection_single"),this.ul.css({overflow:""}),this.options.padding=8,this.options.height=7*h()(e=this.ul).call(e,"md-menu-item").height()-2*this.options.padding},this.timeView.select=function(e){if(this.options.disable)return;let t,i,r=!1;var n;("string"==typeof e?t=this._parse(e):e instanceof Date?t=e:(i=e,r=!0),t)&&(this._current&&(0,b.rs)(this._times[this._current.data("time")],t)?(i=this._current,r=!0):h()(n=this.ul).call(n,"> li").each(((e,n)=>{let a=this._times[n.getAttribute("data-time")];if(a<=t&&(i=[n],(0,b.rs)(a,t)))return r=!0,!1})));this.current(this._distinctSelection(i),r)},this.timeView.current=function(e,t){if(void 0===e)return this._current;var i;this._current&&h()(i=this._current).call(i,"> .pw-menu-item").removeClass(T);e&&(e=k()(e),t&&h()(e).call(e,"> .pw-menu-item").addClass(T),this.scroll(e[0])),this._current=e},this.timeView.scroll=function(e){e&&void 0!==this.options.padding&&this.list.scrollTop(e.offsetTop-this.options.height/2+this.options.padding)},this.timeView.move=function(e){switch(e.keyCode){case p()(kendo).UP:case p()(kendo).DOWN:if(e.altKey)return void this.toggle(p()(kendo).DOWN);let t;e.preventDefault(),t=e.keyCode===p()(kendo).DOWN?this._current?this._current[0].nextSibling:this.ul[0].firstChild:this._current?this._current[0].previousSibling:this.ul[0].lastChild,t&&this.select(t),this.options.isOnlyDuration?this.options.change(formatDateAsDuration(this._times[this._current.data("time")])):this.options.change(this._current.data("time"));break;case p()(kendo).ENTER:case p()(kendo).TAB:case p()(kendo).ESC:e.preventDefault(),this._current&&this.options.change(this._times[this._current.data("time")],!0),this.close()}},this.timeView._click=function(e){let t=k()(e.currentTarget).closest("li");e.isDefaultPrevented()||(this.select(t),this.options.change(this._times[t.data("time")],!0),this.close())},this.timeView.ul.on("click","button",(e=>this.timeView._click(e))),this.timeView._adjustListWidth=function(){this.list.css("min-width",this.options.anchor[0].offsetWidth)},this.timeView._parse=function(e){var t,i;if(e instanceof Date)return e;if(!e)return;let r;if(this.options.isOnlyDuration){var n;let a;switch(!0){case/^([0-1]?[0-9]|2[0-3])h [0-5]?[0-9]m$/.test(e):a=g()(t=v()(i=e.split(" ")).call(i,(e=>_()(e).call(e,"h")?kendo.parseDate(e,"H"):_()(e).call(e,"m")?kendo.parseDate(e,"mm"):void 0))).call(t,(e=>e));break;case/^([0-1]?[0-9]|2[0-3])h$/.test(e):a=[kendo.parseDate(e,"H")];break;case/^[0-5]?[0-9]m$/.test(e):a=[kendo.parseDate(e,"mm")];break;case/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(e):a=e.split(":"),a=[kendo.parseDate(a[0],"H"),kendo.parseDate(a[1],"mm")];break;default:let r=kendo.parseFloat(e);S()(r)||(a=[r<24?(0,b.mH)(this.options.min,Math.ceil(60*r)):(0,b.h3)(this.options.min)])}switch(null===(n=a)||void 0===n?void 0:n.length){case 2:r=(0,b.mH)(a[0],a[1].getMinutes());break;case 1:r=a[0]}}else r=kendo.parseDate(e,this.options.parseFormats,this.options.culture);return r&&(r=(0,b.q_)(this.options.min,r),r<this.options.min&&(r=(0,b.E4)(r,1))),r},this._$scope.$on("$destroy",(()=>this.destroy()))}get _$timeout(){return this._$timeoutLazy||(this._$timeoutLazy=CustomTimePicker.$injector.get("$timeout")),this._$timeoutLazy}_editable(e){super._editable(e),e.readonly||e.disable||(this.options.isOnlyInput?this.element.on("focus",(()=>{this.element[0].selectionEnd-this.element[0].selectionStart==0&&this.element.trigger("select")})):(this.options.focusOnCreate&&this.element.trigger("focus"),this.options.openAfterCreate&&!this.options.readonly&&this._$timeout((()=>this.timeView.open()),0,!1),this.element.on("click",(()=>{this.options.readonly||this.timeView.open()})),this.element.on("focus",(()=>{this.element[0].selectionEnd-this.element[0].selectionStart==0&&this.element.trigger("select"),this.options.readonly||this.timeView.open()}))),this.element.on("keypress",(e=>{if(e.keyCode===p()(kendo).ENTER){let t=this.element.val();t!==this._oldText&&this._change(t),e.stopPropagation()}}))),this.wrapper.on("click",(e=>{e.preventDefault(),e.stopPropagation()}))}_keydown(e){e.keyCode===p()(kendo).ESC&&this.timeView.popup.visible()&&e.stopPropagation(),this._keyboardSelection=e.keyCode===p()(kendo).UP||e.keyCode===p()(kendo).DOWN||e.keyCode===p()(kendo).ESC,this._keyboardSelection&&(this.timeView.popup.visible()||e.altKey)?this.timeView.move(e):e.keyCode!==p()(kendo).ENTER&&(this._typing=!0)}_change(e){if(e){if("string"==typeof e){if(this.options.readonly||this.options.disable)return;e=a()(e).call(e)}}else e=this._old;let t=this._update(e);t?(0,b.rs)(t,this._old)||(this._old=t,this._oldText=this.element.val(),this._typing||this.element.trigger("change"),this.trigger("change")):this._update(this._old),this._typing=!1}_update(e){let t=this.timeView._parse(e);if((0,b.rs)(this.options.min,this.options.max)||(0,b.mh)(t,this.options.min,this.options.max)||(t=null),this._value=t,this._dateInput&&t)this._dateInput.value(t||e);else{let i=this.element.val(),r=kendo.toString(t||e,this.options.format,this.options.culture);this.options.isOnlyDuration&&(r=t?formatDateAsDuration(t):e||"0h"),this.element.val(r),i!==r&&this.element.trigger("change")}return this.timeView.value(t),t}}function formatDateAsDuration(e){if(e){let t=e.getHours(),i=e.getMinutes();return t||i?t&&i?`${t}h ${i}m`:t?`${t}h`:`0h ${i}m`:"0m"}}(0,r.Z)(CustomTimePicker,"$injector",void 0)},54840:(e,t,i)=>{i.d(t,{v:()=>ObservableMap});var r=i(62079),n=i.n(r),a=i(52020),s=i.n(a),o=i(73324),l=i.n(o),d=i(88546),c=i.n(d),h=i(66775),u=i.n(h),p=i(2201),m=i.n(p),g=i(57445),y=i.n(g),v=i(26171),f=i(54847),_=i.n(f),C=i(23513),S=i.n(C),w=i(58218),k=i.n(w),b=i(99595),D=i.n(b),T=i(86981),E=i.n(T),A=i(27525),I=i.n(A),P=i(10349),R=i.n(P),L=i(29898),N=i.n(L),O=i(89221),M=i.n(O);function ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=l()(r).call(r,(function(t){return c()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?D()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,v.Z)(e,t,n[t])})):u()?m()(e,u()(n)):D()(r=ownKeys(Object(n))).call(r,(function(t){y()(e,t,c()(n,t))}))}return e}class ObservableMap{constructor(e,t){this._keyName=e,this._type=t,this._innerMap=new(_()),this._cardsListeners={added:new(S()),updated:new(S()),deleted:new(S()),cleared:new(S())}}addEventListener(e,t){let i=this._cardsListeners[e];if(!i)throw new Error(`Unsupported event type: ${e}`);i.add(t)}removeEventListener(e,t){let i=this._cardsListeners[e];if(!i)throw new Error(`Unsupported event type: ${e}`);i.delete(t)}add(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e[this._keyName];if(!r)throw new Error(`Cannot find key "${this._keyName}" on object:\n${k()(e,null,4)}`);if(this._type&&!(e instanceof this._type))throw new TypeError(`${k()(e,null,4)} is not an instance of ${this._type.name}`);this._innerMap.set(r,e),i.event="added",D()(t=this._cardsListeners.added).call(t,(t=>t(e,i)))}update(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e[this._keyName];if(!r)throw new Error(`Cannot find key "${this._keyName}" on object:\n${k()(e,null,4)}`);if(this._type&&!(e instanceof this._type))throw new TypeError(`${k()(e,null,4)} is not an instance of ${this._type.name}`);let n=this._innerMap.get(r);n&&n.clone&&(n=n.clone()),this._innerMap.set(r,e),i.event="updated",D()(t=this._cardsListeners.updated).call(t,(t=>t(e,_objectSpread(_objectSpread({},i),{},{oldValue:n}))))}delete(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e[this._keyName];r||(r=e);let n=this._innerMap.get(r);this._innerMap.delete(r)&&(i.event="deleted",D()(t=this._cardsListeners.deleted).call(t,(e=>e(n,i))))}clear(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._innerMap.clear(),t.event="cleared",D()(e=this._cardsListeners.cleared).call(e,(e=>e(null,t)))}get(e){return this._innerMap.get(e)}has(e){return this._innerMap.has(e)}find(e){var t;return E()(t=this._innerMap).call(t,(t=>e(t)))}some(e){var t;return I()(t=this._innerMap).call(t,(t=>e(t)))}keys(){var e;return R()(N()(e=this._innerMap).call(e))}values(){var e;return R()(M()(e=this._innerMap).call(e))}size(){return this._innerMap.size}}},48550:(e,t,i)=>{i.d(t,{b:()=>SchedulerBoardView});var r=i(84705),n=i.n(r),a=i(86981),s=i.n(a),o=i(19755),l=i.n(o),d=i(29704),c=i(73180);const h=n()('\n<pw-work-panel\n    class="pw-work-panel"\n    pw-resize-listener\n></pw-work-panel>\n').call('\n<pw-work-panel\n    class="pw-work-panel"\n    pw-resize-listener\n></pw-work-panel>\n');class SchedulerBoardView extends kendo.ui.SchedulerView{constructor(e,t){super(e,t),this.name=this.options.viewName,this._initBoard(),this.content=s()(e).call(e,".pw-task-lists")}scrollTo(){}render(){}dateForTitle(){}shortDateForTitle(){}mobileDateForTitle(){}startDate(){return(0,d.$Y)(new Date)}endDate(){return(0,d.E4)(this.startDate(),7)}removeRangeHighlight(){}clearSelection(){}select(){}destroy(){this._boardElement.remove(),this._kanbanScope.$destroy(),super.destroy()}get _htmlHelperSrv(){return this._htmlHelperSrvLazy||(this._htmlHelperSrvLazy=c.K.$injector.get("htmlHelperSrv")),this._htmlHelperSrvLazy}_initBoard(){this._boardElement=l()(h),this.element.append(this._boardElement),this._kanbanScope=this._htmlHelperSrv.compileElement(this._boardElement,this.options.$scope)}}},65067:(e,t,i)=>{i.d(t,{$G:()=>l,$R:()=>w,$s:()=>y,C4:()=>v,O0:()=>f,UM:()=>s,V5:()=>C,cC:()=>u,fb:()=>o,hO:()=>d,hd:()=>p,jj:()=>c,p8:()=>a,ur:()=>g,w9:()=>m,wl:()=>h});var r=i(84705),n=i.n(r);const a=22,s=42,o=22,l=2,d=3,c=16,h=2,u=3,p=13,m=2,g=3,y=5,v=2,f=120,_=cleanKendoTemplate('\n<div\n    data-uid="#= data.uid #"\n    data-card-tooltip-id="#= data.uid #"\n    data-card-tooltip-account-id="#= data.accountId #"\n    data-card-tooltip-type="#= data.cardType #"\n    class="k-event pw-card pw-card--hour-slot #= data.$ctrl.getCardExtraClasses(data) #"\n>\n    #= data.$ctrl.getCardProvider(data).getCardTemplates().hourSlot(data) #\n\n    # if (data.tail || data.middle) { #\n    <span class="k-icon k-i-arrow-n"></span>\n    # } #\n\n    # if (data.head || data.middle) { #\n    <span class="k-icon k-i-arrow-s"></span>\n    # } #\n\n    # if (data.$ctrl.getCardProvider(data).isCardResizeAvailable(data)) { #\n    # if (!data.tail && !data.middle) { #\n    <span class="k-resize-handle k-resize-n"></span>\n    # } #\n\n    # if (!data.head && !data.middle) { #\n    <span class="k-resize-handle k-resize-s"></span>\n    # } #\n    # } #\n\n    # if (data.$ctrl.getCardProvider(data).isCardContextMenuAvailable(data)) { #\n    <div class="pw-card__edit-button mdi mdi-dots-horizontal pw-js-card-edit-button"></div>\n    # } #\n\n    <div class="pw-card__border"></div>\n</div>\n'),C=kendo.template(_,{useWithBlock:!1}),S=cleanKendoTemplate('\n<div\n    data-uid="#= data.uid #"\n    data-card-tooltip-id="#= data.uid #"\n    data-card-tooltip-account-id="#= data.accountId #"\n    data-card-tooltip-type="#= data.cardType #"\n    class="k-event pw-card pw-card--day-slot #= data.$ctrl.getCardExtraClasses(data) #"\n>\n    #= data.$ctrl.getCardProvider(data).getCardTemplates().daySlot(data) #\n\n    # if (data.$ctrl.getCardProvider(data).isCardResizeAvailable(data)) { #\n    # if (!data.singleDay && !data.tail && !data.middle) { #\n    <span class="k-resize-handle k-resize-w"></span>\n    # } #\n\n    # if (!data.singleDay && !data.head && !data.middle) { #\n    <span class="k-resize-handle k-resize-e"></span>\n    # } #\n    # } #\n\n    # if (data.$ctrl.getCardProvider(data).isCardContextMenuAvailable(data)) { #\n    <div class="pw-card__edit-button mdi mdi-dots-horizontal pw-js-card-edit-button"></div>\n    # } #\n\n    <div class="pw-card__border"></div>\n</div>\n'),w=kendo.template(S,{useWithBlock:!1});function cleanKendoTemplate(e){return n()(e).call(e).replace(/(\n\s*#)|(#\n\s*)/g,"#").replace(/<!--[\s\S]*?-->/g,"")}},85065:(e,t,i)=>{i.d(t,{k:()=>SchedulerMonthView});var r=i(62079),n=i.n(r),a=i(52020),s=i.n(a),o=i(73324),l=i.n(o),d=i(88546),c=i.n(d),h=i(99595),u=i.n(h),p=i(66775),m=i.n(p),g=i(2201),y=i.n(g),v=i(57445),f=i.n(v),_=i(26171),C=i(84705),S=i.n(C),w=i(86981),k=i.n(w),b=i(34652),D=i.n(b),T=i(34300),E=i.n(T),A=i(8571),I=i.n(A),P=i(35704),R=i.n(P),L=i(88946),N=i.n(L),O=i(98235),M=i.n(O),$=i(19755),x=i.n($),B=i(56777),H=i(8937),U=i(73180),F=i(65067),W=i(29704);function ownKeys(e,t){var i=n()(e);if(s()){var r=s()(e);t&&(r=l()(r).call(r,(function(t){return c()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?u()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,_.Z)(e,t,n[t])})):m()?y()(e,m()(n)):u()(r=ownKeys(Object(n))).call(r,(function(t){f()(e,t,c()(n,t))}))}return e}const z=S()('\n<div class="k-link k-nav-day">\n    <span>#= kendo.toString(data.date,"Dd") #</span>\n    <span>#= data.date.getDate() === 1 ? kendo.toString(data.date, "MMM") : "" #</span>\n    <div class="pw-scheduler__create-card-hint pw-js-create-card-hint"><svg width="16" height="16"><path d=\'M9 3H7V7H3V9H7V13H9V9H13V7H9V3Z\' /></svg></div>\n</div>\n').call('\n<div class="k-link k-nav-day">\n    <span>#= kendo.toString(data.date,"Dd") #</span>\n    <span>#= data.date.getDate() === 1 ? kendo.toString(data.date, "MMM") : "" #</span>\n    <div class="pw-scheduler__create-card-hint pw-js-create-card-hint"><svg width="16" height="16"><path d=\'M9 3H7V7H3V9H7V13H9V9H13V7H9V3Z\' /></svg></div>\n</div>\n'),G="pw-scheduler-range-highlight";class SchedulerMonthView extends kendo.ui.MonthView{constructor(e,t){var i;const r=t.showCalendar||t.showList||t.showDates||t.showEstimatedHours||t.showTrackedHours||t.showCheckItems;t.dayTemplate=kendo.template(z,{useWithBlock:!1}),t.eventHeight=r?F.UM:F.p8,t.currentTimeMarker={updateInterval:6e4},super(e,t),k()(i=this.element).call(i,".k-scheduler-layout").addClass("pw-js-kendo-sortable-outside-target"),this._isDetailedView=r,this.name=this.options.viewName,this._eventHeight=this.options.eventHeight,this._cellTopPadding=28,this._cellBottomPadding=F.fb,this._currentTimeUpdateTimer=D()((()=>this._updateCurrentTimeMarker(new Date)),this.options.currentTimeMarker.updateInterval)}get _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=U.K.$injector.get("appCommonSrv")),this._appCommonSrvLazy}get isTimeAvailable(){return!1}get isHideWeekendsAvailable(){return!1}get isScaleAvailable(){return!1}get selectedDate(){var e;return(null===(e=this._schedulerWidget)||void 0===e?void 0:e.date())||this.options.date}isVisibleDate(e){return(0,W.mh)(e,this.startDate(),this.endDate())}get navigationActions(){return this._navigationActions||(this._navigationActions={leftActions:[{type:H.Lo.PreviousMonth,icon:"mdi-chevron-double-left",tooltip:"TOOLTIPS.MONTH_BACKWARD",isSecondary:!0},{type:H.Lo.PreviousWeek,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.WEEK_BACKWARD"}],rightActions:[{type:H.Lo.NextWeek,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.WEEK_FORWARD"},{type:H.Lo.NextMonth,icon:"mdi-chevron-double-right",tooltip:"TOOLTIPS.MONTH_FORWARD",isSecondary:!0}]}),this._navigationActions}get showWorkDays(){return!1}createLayout(e){this.name="month",super.createLayout(e)}render(e){var t,i,r;let n=[];for(let e of this.groups)for(let t of e._daySlotCollections)for(let e of t._slots)n.push(_objectSpread(_objectSpread({},e),{},{eventCount:0,eventStart:e.startDate(),eventEnd:e.endDate()}));for(let t of e){let e=t.start,i=t.end;(t.isAllDay||(0,W.rs)(e,i))&&(i=(0,W.h3)(i));let r=!1;for(let t of n)if(e<t.eventEnd&&i>t.eventStart)r=!0,t.eventCount+=1;else if(r)break}let a=[];for(let e of n)a[e.collectionIndex]=Math.max(a[e.collectionIndex]||0,e.eventCount);let s=k()(t=this.times).call(t,"th"),o=k()(i=this.content).call(i,"tr");for(let e=0;e<a.length;e++){let t=this._eventHeight*a[e]+(F.C4+F.w9)*(a[e]-1),i=`${this._cellTopPadding+Math.max(t,97)+this._cellBottomPadding}px`;s[e]&&(s[e].style.height=i),o[e].style.height=i}this._groups(),this.refreshLayout(),k()(r=this.element).call(r,".k-event").detach(),this._renderEvents(e,0),this.trigger("activate")}getDateToNavigate(e){switch(e){case H.Lo.Today:return new Date;case H.Lo.PreviousWeek:return(0,W.E4)(this.selectedDate,-7);case H.Lo.NextWeek:return(0,W.E4)(this.selectedDate,7);case H.Lo.PreviousMonth:let e=super.previousDate();return new Date(e.getFullYear(),e.getMonth(),1);case H.Lo.NextMonth:return super.nextDate()}throw new Error(`Navigation action ${e} unsupported by view ${this.options.viewName}`)}resize(e){e.widthChanged?this._schedulerWidget.resize():this.refreshLayout()}scrollTo(e){if(!this._schedulerWidget)return;let{date:t,time:i,navigationMode:r}=e,n=x()(".k-scheduler-content",this.element).scrollTop();if(t){if(r===H.vt.ClosestVisible&&this.isVisibleDate(t)){let e,i=x()(".k-scheduler-content",this.element),r=x()("table.k-scheduler-table > tbody > tr > td",i);for(let i=0;i<r.length;i++){var a;let n=null===(a=this._schedulerWidget.slotByElement(r[i]))||void 0===a?void 0:a.startDate;if(!n||n>t)break;e=r[i]}return void(e&&this._scrollTo(e,i[0]))}(0,W.KC)(t,this.selectedDate)||this._schedulerWidget.date(t)}i?x()(".k-scheduler-content",this.element).scrollTop(0):x()(".k-scheduler-content",this.element).scrollTop(n)}getCardCreateDefaultSlots(e){return{firstSlot:e,lastSlot:e}}getClosestVisibleSlot(e){let t;return e=(0,W.$Y)(e),t=(0,W.mh)(e,this.startDate(),this.endDate())?(0,W.$Y)(e):this.endDate()<e?new Date(this.endDate()):new Date(this.startDate()),{start:t,end:new Date(t)}}adjustUpdateEventData(e,t,i){if(e){let e=(0,W.$Y)(i.start);return{start:e,end:(0,W.E4)(e,(0,W.i2)(i.start,i.end)),isAllDay:!0}}return i}updateRangeHighlight(e,t){let i,r;if(e.startDate<t.startDate?(i=e,r=t):(i=t,r=e),this._selectedRange||(this._selectedRange={}),this._selectedRange.firstSlot&&this._isSlotsEqual(i,this._selectedRange.firstSlot)&&this._selectedRange.lastSlot&&this._isSlotsEqual(r,this._selectedRange.lastSlot))return;let insertSlotsToSelection=(e,t)=>{let i=this._slotsInRange(e,t);for(let e of i)(!this._selectedRange.firstSlot||!this._selectedRange.lastSlot||e.startDate<this._selectedRange.firstSlot.startDate||e.startDate>this._selectedRange.lastSlot.startDate)&&x()(e.element).addClass(G)},removeSlotsFromSelection=(e,t)=>{for(let i of this._slotsInRange(e,t))(i.startDate>=this._selectedRange.firstSlot.startDate||i.startDate<=this._selectedRange.lastSlot.startDate)&&x()(i.element).removeClass(G)};if(this._selectedRange.firstSlot&&this._selectedRange.firstSlot.startDate<i.startDate){let e=(0,W.E4)(i.startDate,-1);removeSlotsFromSelection(this._selectedRange.firstSlot.startDate,e)}if(this._selectedRange.lastSlot&&this._selectedRange.lastSlot.startDate>r.startDate){removeSlotsFromSelection((0,W.E4)(r.startDate,1),this._selectedRange.lastSlot.startDate)}if(this._selectedRange.firstSlot&&this._selectedRange.lastSlot){let e=this._selectedRange.firstSlot.startDate,t=this._selectedRange.lastSlot.startDate;if(i.startDate<e){let t=e<r.startDate?e:r.startDate;insertSlotsToSelection(i.startDate,t)}if(r.startDate>t){insertSlotsToSelection(t>i.startDate?t:i.startDate,r.startDate)}}else insertSlotsToSelection(i.startDate,r.startDate);this._selectedRange.firstSlot=i,this._selectedRange.lastSlot=r}removeRangeHighlight(){if(!this._selectedRange)return;let e=this._slotsInRange(this._selectedRange.firstSlot.startDate,this._selectedRange.lastSlot.startDate);for(let t of e)x()(t.element).removeClass(G);this._selectedRange=null}updateCreateCardPreview(e,t,i){let r,n,{accountId:a,providerType:s,calendarId:o,cardType:l,cardRole:d}=i;this.removeCreateCardPreview(),e.startDate<t.startDate?(r=e,n=t):(r=t,n=e);let c=r.startDate,h=n.startDate,u=this.options.$ctrl.getPreviewCard({accountId:a,providerType:s,calendarId:o,cardType:l,cardRole:d,isAllDay:!0,start:c,end:h}),p=this.options.dataSource._createNewModel(u);this._pwNewCardHint=this._insertHint(p,0)}removeCreateCardPreview(){var e;null===(e=this._pwNewCardHint)||void 0===e||e.remove()}getSlotByEvent(e){return this._schedulerWidget.slotByElement(e.dropTarget||x()(e.target))}refreshLayout(){var e;let t=this.element.innerHeight(),i=0;if(this.datesHeader&&(i=this.datesHeader.outerHeight()),this.timesHeader&&this.timesHeader.outerHeight()>i&&(i=this.timesHeader.outerHeight()),this.datesHeader&&this.timesHeader){var r,n;let e=k()(r=this.datesHeader).call(r,"table:first tr");k()(n=this.timesHeader).call(n,"tr").height((function(t){x()(this).height(e.eq(t).height())}))}i&&(t-=i),this.times.height(t),t>2*this._scrollbar?this.content.height(t):this.content.height(2*this._scrollbar+1);let a=k()(e=this.times).call(e,"table");var s;a.length&&a.height(k()(s=this.content).call(s,"table")[0].clientHeight);let o=this.content[0];o.offsetWidth-o.clientWidth>0?this.datesHeader.css("padding-right",this._scrollbar-E()(this.datesHeader.children().css("border-right-width"),10)):this.datesHeader.css("padding-right",""),this._schedulerWidget&&(this._schedulerWidget._size=this._schedulerWidget.getSize()),this.table.addClass("k-scrollbar-v")}destroy(){this._currentTimeUpdateTimer&&clearInterval(this._currentTimeUpdateTimer),super.destroy()}get _schedulerWidget(){return this._appCommonSrv.getSchedulerWidget()}_templates(){super._templates(),this.eventTemplate=F.$R}_renderLayout(e){this._firstDayOfMonth=kendo.date.firstDayOfMonth(e),this._lastDayOfMonth=kendo.date.lastDayOfMonth(e),this._startDate=(0,W.tE)(e,this.calendarInfo().firstDay),this.createLayout(this._layout()),this._content(),this.refreshLayout()}_layout(){var e;let t=this.calendarInfo(),i=t.days.namesAbbr;if(i=I()(e=R()(i).call(i,t.firstDay)).call(e,R()(i).call(i,0,t.firstDay)),this.options.showWeekNumbers){let e=[],t=this.startDate();for(let i=0;i<6;i++)e.push(kendo.date.weekInYear(t,kendo.culture().calendar.firstDay)),t=this._groupedView._adjustStartDate(t);return{columns:N()(i).call(i,(e=>({text:`<span>${e}</span>`}))),rows:N()(e).call(e,(e=>({text:`<span>${e}</span>`})))}}return{columns:N()(i).call(i,(e=>({text:`<span>${e}</span>`})))}}_topSection(e,t,i){let r=super._topSection(e,t,i);return this.timesHeader.empty(),r}_bottomSection(e,t,i){var r;let n=super._bottomSection(e,t,i);return this.content.addClass("k-scheduler-content--scrollable"),this.content.before('<span class="k-scheduler-content-border-top"></span>'),k()(r=this.content).call(r,".k-scheduler-table").addClass("pw-selectable-items-container"),n}_slotByDate(e){let t=kendo.date.toUtcTime(e),i=this.groups[0].daySlotRanges(t,t,!0);if(0===i.length)return;let r=i[0].collection.slotByStartDate(t);return this._schedulerWidget.slotByElement(r.element)}_slotsInRange(e,t){let i=[],r=e;for(;r<=t;){let e=this._slotByDate(r);e&&i.push(e),r=(0,W.E4)(r,1)}return i}_isSlotsEqual(e,t){return!(!e||!t)&&(0,W.rs)(e.startDate,t.startDate)}_updateCurrentTimeMarker(e){let t=e.getDay();if(void 0===this._lastDay)this._lastDay=t;else if(this._lastDay!==t){var i;this._lastDay=t,null===(i=this._schedulerWidget)||void 0===i||i.view(this.options.viewName)}}_createEventElement(e){e.$ctrl=this.options.$ctrl,e.timeShortText=null,e.timeDurationText=(0,B.VH)(e.providerType).getCardTimeDurationText(e),e.timeText=null;let t=e.tail?e.previousStart:e.start,i=e.head?e.previousEnd:e.end;return this._isDetailedView?e.isAllDay?e.timeDateText=(0,W.KA)(t,i):(e.timeDateText=(0,W.KA)(t,i,!0),e.timeText=(0,W.Sr)(t,i)):e.isAllDay||(e.timeShortText=(0,W.AH)(t)),super._createEventElement(e)}_inverseEventColor(){}_positionEvent(e,t,i){let r=e.startSlot(),n=e.endSlot(),a=r.index,s=n.index,o=kendo.ui.SchedulerView.collidingEvents(e.events(),a,s);o.push({element:t,start:a,end:s});let l=kendo.ui.SchedulerView.createRows(o);for(let e=0;e<l.length;e++){let t=r.offsetTop+this._cellTopPadding+(this._eventHeight+F.C4)*e,i=l[e].events;for(let e=0;e<i.length;e++)i[e].element[0].style.top=`${t}px`}let d=n.offsetLeft-r.offsetLeft+n.offsetWidth-F.$s-F.ur-1;t[0].style.left=`${r.offsetLeft+F.ur}px`,t[0].style.width=`${d}px`,t[0].style.height=`${this._eventHeight}px`,e.addEvent({element:t,start:a,end:s,groupIndex:r.groupIndex}),i._continuousEvents.push({element:t,uid:t.attr(kendo.attr("uid")),start:r,end:n}),this._isDetailedView||t.addClass("pw-card--small"),d<F.O0&&t.addClass("pw-card--narrow"),t.appendTo(this.content)}_updateMoveHint(e,t){if(!(0,B.VH)(e.providerType).canStartMoveInScheduler(e))return;this._removeMoveHint(e.uid);let i=this._insertHint(e,t);i&&(this._moveHint=this._moveHint.add(i))}_updateResizeHint(e,t,i,r){const correctDate=e=>{let t=new Date(e);return(0,W.mH)(t,t.getTimezoneOffset())};let n=this.options.$ctrl.getPreviewCard({accountId:e.accountId,providerType:e.providerType,cardType:e.cardType,isAllDay:e.isAllDay,start:correctDate(i),end:correctDate(r),providerCard:e.providerCard}),a=e.clone({start:n.start,end:n.end,providerCard:n.providerCard});this._removeResizeHint(),this._resizeHint=this._insertHint(a,t)}_updateEventForResize(e){let t=(0,W.$Y)(e.start),i=(0,W.E4)(t,(0,W.i2)(e.start,e.end));e.start=t,e.end=i,e.isAllDay=!0}_insertHint(e,t){let i=M()(t)?t[0]:t,r=x()(),n=this.groups[i].ranges(e.start,e.end,!0,e.isAllDay);for(let t of n){let i=t.startSlot(),n=t.endSlot(),a=this._createEventElement(e.clone({start:e.start,previousStart:e.start,end:e.end,previousEnd:e.end,head:t.head,tail:t.tail})),s=n.offsetLeft-i.offsetLeft+n.offsetWidth-F.$s-F.ur-1;a.css({left:i.offsetLeft+F.ur,top:i.offsetTop+this._cellTopPadding,height:this._eventHeight,width:s}),a.addClass("k-state-selected k-event-drag-hint"),this._isDetailedView||a.addClass("pw-card--small"),s<F.O0&&a.addClass("pw-card--narrow"),e.isTempCard&&a.addClass("pw-card--temp"),r=r.add(a)}return r.appendTo(this.content),r}}},6506:(e,t,i)=>{i.d(t,{h:()=>SchedulerReportsView});var r=i(86981),n=i.n(r),a=i(19755),s=i.n(a),o=i(29704),l=i(73180);class SchedulerReportsView extends kendo.ui.SchedulerView{constructor(e,t){super(e,t),this.name=this.options.viewName,this._initReports(),this.content=n()(e).call(e,".pw-scheduler-reports")}scrollTo(){}render(){}dateForTitle(){}shortDateForTitle(){}mobileDateForTitle(){}startDate(){return(0,o.$Y)(new Date)}endDate(){return(0,o.E4)(this.startDate(),7)}removeRangeHighlight(){}clearSelection(){}select(){}destroy(){this._reportsElement.remove(),this._reportsScope.$destroy(),super.destroy()}get _htmlHelperSrv(){return this._htmlHelperSrvLazy||(this._htmlHelperSrvLazy=l.K.$injector.get("htmlHelperSrv")),this._htmlHelperSrvLazy}_initReports(){this._reportsElement=s()('<pw-scheduler-reports class="pw-scheduler__reports" pw-resize-listener></pw-scheduler-reports>'),this.element.append(this._reportsElement),this._reportsScope=this._htmlHelperSrv.compileElement(this._reportsElement,this.options.$scope)}}},66059:(e,t,i)=>{i.d(t,{EL:()=>SchedulerTimelineView,S2:()=>roundDateToScaleUnit,VT:()=>timelineScaleToScaleUnit});var r=i(52020),n=i.n(r),a=i(88546),s=i.n(a),o=i(66775),l=i.n(o),d=i(2201),c=i.n(d),h=i(57445),u=i.n(h),p=i(26171),m=i(27525),g=i.n(m),y=i(13464),v=i.n(y),f=i(90143),_=i.n(f),C=i(84705),S=i.n(C),w=i(58218),k=i.n(w),b=i(67552),D=i.n(b),T=i(98235),E=i.n(T),A=i(8571),I=i.n(A),P=i(99595),R=i.n(P),L=i(54847),N=i.n(L),O=i(23513),M=i.n(O),$=i(88946),x=i.n($),B=i(73324),H=i.n(B),U=i(62079),F=i.n(U),W=i(53706),z=i.n(W),G=i(31082),j=i.n(G),V=i(91829),K=i.n(V),Y=i(9938),q=i.n(Y),Z=i(22574),X=i.n(Z),Q=i(10899),J=i.n(Q),ee=i(48216),te=i.n(ee),ie=i(76555),re=i.n(ie),ne=i(87994),ae=i.n(ne),se=i(10349),oe=i.n(se),le=i(89221),de=i.n(le),ce=i(34300),he=i.n(ce),ue=i(86981),pe=i.n(ue),me=i(8244),ge=i.n(me),ye=i(19755),ve=i.n(ye),fe=i(40405),_e=i.n(fe),Ce=i(99738),Se=i(82617),we=i(56777),ke=i(20115),be=i(8937),De=i(73180),Te=i(65067);const Ee="http://www.w3.org/2000/svg",Ae="#ff0000";class LinkPlotter{constructor(e){(0,p.Z)(this,"_links",new(N())),(0,p.Z)(this,"_arrows",new(N())),(0,p.Z)(this,"_redrawCount",0),this._targetElement=document.createElementNS(Ee,"svg"),this._targetElement.classList.add(e)}get targetElement(){return this._targetElement}addLink(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t)return;let r=`${e.id}|${t.id}`,n=this._links.get(r);if(!n){n={id:r,element:document.createElementNS(Ee,"path"),isInvalid:!1,isVisible:!1,isTempLink:i},this._links.set(r,n)}n.isTempLink&&(this._tempLink=n),n.left=e,n.right=t,n.isDeleted=!1;let a=t.id,s=this._arrows.get(a);if(!s){s={id:a,element:document.createElementNS(Ee,"path"),isInvalid:!1,oldIsInvalid:!1,isCard:!0},this._arrows.set(a,s)}if(s.isDeleted=!1,i){let e=`${t.id}|freeEnd`,i=this._arrows.get(e);if(!i){let t=document.createElementNS(Ee,"circle");t.setAttributeNS(null,"r","6"),t.setAttributeNS(null,"fill","#ffffff"),t.setAttributeNS(null,"stroke","#757575"),t.setAttributeNS(null,"stroke-width","2"),i={id:e,element:t,isInvalid:!1,oldIsInvalid:!1,isCard:!1},this._arrows.set(e,i)}i.isDeleted=!1}}clear(){for(let t of de()(e=this._links).call(e)){var e;t.isTempLink||(t.isDeleted=!0)}for(let e of de()(t=this._arrows).call(t)){var t;e.isDeleted=!0}}deleteTempLink(){this._tempLink&&(this._tempLink.isDeleted=!0)}redraw(e,t,i){this._redrawCount++;let r=this._targetElement.clientWidth,n=this._targetElement.clientHeight;this._targetElement.setAttribute("viewBox",`0 0 ${r} ${n}`);let a={},s=new(M());const getArrowId=e=>e.isCard?e.id:`${e.id}|freeEnd`;let o=(i?Te.UM:Te.p8)/2+10,l=i?60:30;for(let e of de()(d=this._arrows).call(d)){var d;e.isInvalid=!1}for(let i of de()(c=this._links).call(c)){var c;if(i.left.refresh(this._redrawCount),i.right.refresh(this._redrawCount),i.isDeleted)this._hideFragment(i),this._links.delete(i.id);else if((i.left.isInRange||i.right.isInRange)&&i.left.isVisible&&i.right.isVisible){let d,c=i.left.left+i.left.width,h=i.left.top+i.left.height/2+1,u=i.right.left,p=i.right.top+i.right.height/2+1;if(!i.left.isInRange||c<0){if(a[i.right.id]||(a[i.right.id]={}),i.left.start>t){if(a[i.right.id].rightFuture){this._hideFragment(i);continue}a[i.right.id].rightFuture=!0;let e=p+o<n?o:-o,t=getCubicProtrusionOffset(r-u,l);d=`M${u},${p}c${-t},0 ${-t},${e} ${r-u},${e}`}else{if(!(i.left.end<e||c<0)){this._hideFragment(i);continue}if(a[i.right.id].rightPast){this._hideFragment(i);continue}a[i.right.id].rightPast=!0,d=`M${u},${p}H0`}s.add(getArrowId(i.right))}else if(!i.right.isInRange||i.right.left+i.right.width<0)if(a[i.left.id]||(a[i.left.id]={}),i.right.end<e||i.right.left+i.right.width<0){if(a[i.left.id].leftPast){this._hideFragment(i);continue}a[i.left.id].leftPast=!0;let e=h+o<n?o:-o,t=getCubicProtrusionOffset(c,l);d=`M${c},${h}c${t},0 ${t},${e} ${-c},${e}`}else{if(!(i.right.start>t)){this._hideFragment(i);continue}if(a[i.left.id].leftFuture){this._hideFragment(i);continue}a[i.left.id].leftFuture=!0,d=`M${c},${h}H${r}`}else if(c>u&&Math.abs(h-p)<20){let e=h+o>n?-o:o,t=(c-u)/2,r=getCubicProtrusionOffset(t,l);d=`M${c},${h}c${r},0 ${r},${e} ${-t},${e}S${u-r},${p} ${u},${p}`,s.add(getArrowId(i.right))}else if(h===p)d=`M${c},${h}H${u}`,s.add(getArrowId(i.right));else{let e=(u-c)/3;e<0?e=getQuadraticProtrusionOffset((c-u)/2,l):e<35&&(e=35),d=`M${c},${h}q${e},0 ${(u-c)/2},${(p-h)/2}T${u},${p}`,s.add(getArrowId(i.right))}i.element.setAttributeNS(null,"d",d);let m=this._arrows.get(getArrowId(i.right));m.baseX=u,m.baseY=p,i.left.end>i.right.start?(i.isInvalid||(i.element.setAttributeNS(null,"stroke",Ae),i.isInvalid=!0),m.isInvalid=!0):i.isInvalid&&(i.element.removeAttributeNS(null,"stroke"),i.isInvalid=!1),i.isVisible||(this._targetElement.appendChild(i.element),i.isVisible=!0)}else this._hideFragment(i)}for(let e of de()(h=this._arrows).call(h)){var h;e.isDeleted?(this._hideFragment(e),this._arrows.delete(e.id)):s.has(e.id)?(e.isCard?(e.element.setAttributeNS(null,"d",`M${e.baseX-5} ${e.baseY-5} l5 5 l-5 5`),e.isInvalid!==e.oldIsInvalid&&(e.oldIsInvalid=e.isInvalid,e.isInvalid?e.element.setAttributeNS(null,"stroke",Ae):e.element.removeAttributeNS(null,"stroke"))):(e.element.setAttributeNS(null,"cx",e.baseX.toString()),e.element.setAttributeNS(null,"cy",e.baseY.toString())),e.isVisible||(this._targetElement.appendChild(e.element),e.isVisible=!0)):this._hideFragment(e)}}_hideFragment(e){e.isVisible&&(this._targetElement.removeChild(e.element),e.isVisible=!1)}}function getQuadraticProtrusionOffset(e,t){return Math.round(t+Math.sqrt((t+e)*t))}function getCubicProtrusionOffset(e,t){let i=Math.sqrt((t+e)*t),r=2*t+e,n=Math.sqrt(2/Math.sqrt(3)-1);return Math.round((i-r/(3*(n+r/i+1/n)))*n+.992315*t-.004256*e)}var Ie,Pe,Re,Le,Ne,Oe,Me=i(29704);function ownKeys(e,t){var i=F()(e);if(n()){var r=n()(e);t&&(r=H()(r).call(r,(function(t){return s()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?R()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,p.Z)(e,t,n[t])})):l()?c()(e,l()(n)):R()(r=ownKeys(Object(n))).call(r,(function(t){u()(e,t,s()(n,t))}))}return e}const $e=window.PointerEvent?"pointerdown":"mousedown",xe=window.PointerEvent?"pointerup":"mouseup",Be=window.PointerEvent?"pointermove":"mousemove",He="dependencyCreateControl";class RangeItemLinkPlotterHandle{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,p.Z)(this,"isCard",!0),this._item=e,this.id=t?He:this._item.id}refresh(e){if(e===this._lastRefreshId)return;this._lastRefreshId=e,this.start=this._item.data.realStart,this.end=this._item.data.realIsAllDay&&this._item.data.cardRole!==Se.D.Milestone?(0,Me.E4)(this._item.data.realEnd,1):this._item.data.realEnd;let t=this._item.pwRawLeft;this._item.data.cardRole!==Se.D.Milestone&&(t+=Te.ur),this.left=t||0,this._item.parent&&(this.top=this._item.top+this._item.parent.top+this._item.parent.props.pwYOffset+Te.C4);let i=this._item.pwRawWidth-Te.$s;this._item.data.cardRole!==Se.D.Milestone&&(i-=Te.ur),this.width=i,this.height=this._item.height,this.isInRange=this._item.displayed,this.isVisible=!!this._item.parent&&this._item.pwIsVisibleByDuration()}}class DependencyCreateControl{constructor(e){(0,p.Z)(this,"_isDragging",!1),(0,p.Z)(this,"_linkPlotterHandle",{id:He,width:0,height:0,isVisible:!0,isCard:!1,refresh:()=>{}}),this._cardsContainer=e.cardsContainer,this._linkPlotter=e.linkPlotter,this._xToDate=e.xToDate,this._startAutoScroll=e.startAutoScroll,this._getLinkPlotterParams=e.getLinkPlotterParams,this._onCreateLink=e.onCreateLink,this._container=document.createElement("div"),this._container.classList.add("pw-dependency-create");let t=document.createElement("div");t.classList.add("pw-dependency-create__stick"),this._container.appendChild(t);let i=document.createElement("div");i.classList.add("pw-dependency-create__circle"),this._container.appendChild(i),this._container.addEventListener("mouseleave",(()=>{var e;let t=null===(e=ve()(".timeline-range:hover")[0])||void 0===e?void 0:e["timeline-item"];t&&t.id===this._activeCardHandle.id||this.remove()})),i.addEventListener($e,(e=>this._startDrag(e)))}redraw(e){let t=e["timeline-item"];if(!t.data.providerCard.canHaveLinks||t.data.providerCard.isArchived||!e.parentElement)return;if(this._isDragging)return void(this._deferredTarget=e);this._activeCardHandle=new RangeItemLinkPlotterHandle(t),this._accountId=t.data.accountId,this._activeCardType=t.data.cardType,this._activeCardId=t.data.id;let i=e.getBoundingClientRect(),r=e.parentElement.getBoundingClientRect();this._container.style.left=`${Math.round(i.right-r.left)}px`,this._container.style.top=e.style.top,this._container.style.height=e.style.height,this._container.parentElement!==e.parentElement&&e.parentElement.appendChild(this._container)}remove(){var e;this._deferredTarget=null,null===(e=this._container.parentElement)||void 0===e||e.removeChild(this._container)}_startDrag(e){this._isDragging=!0,this._targetCardId=null,this._autoScrollData=this._startAutoScroll();const onMouseUp=()=>this._stopDrag(),onMouseMove=e=>this._drag(e),onEscape=e=>{e.which===be.VD.Escape&&this._cancelDrag()};window.addEventListener(xe,onMouseUp),window.addEventListener(Be,onMouseMove),window.addEventListener("keydown",onEscape),this._unsubscribeDrag=()=>{window.removeEventListener(xe,onMouseUp),window.removeEventListener(Be,onMouseMove),window.removeEventListener("keydown",onEscape)},this._removeTargetHighlight=null,onMouseMove(e),this.remove()}_drag(e){var t;let i,{start:r,end:n,isDetailed:a}=this._getLinkPlotterParams(),s=this._cardsContainer.getBoundingClientRect(),o=Math.round(e.clientX-s.left),l=Math.round(e.clientY-s.top),d=this._xToDate(o),c=ve()(e.target).closest(".timeline-range"),h=null===(t=c[0])||void 0===t?void 0:t["timeline-item"];var u;if(h&&this._canCreateLink(h)){if(h.data.id!==this._targetCardId){var p;c.addClass("pw-card-link-target"),null===(p=this._removeTargetHighlight)||void 0===p||p.call(this),this._removeTargetHighlight=()=>c.removeClass("pw-card-link-target"),i=new RangeItemLinkPlotterHandle(h,!0),this._targetCardId=h.data.id}}else null===(u=this._removeTargetHighlight)||void 0===u||u.call(this),this._removeTargetHighlight=null,i=this._linkPlotterHandle,this._targetCardId=null,i.start=d,i.end=d,i.left=o,i.top=l,i.isInRange=d>=r&&d<=n;i&&(this._autoScrollData.updateTarget(d,l),this._linkPlotter.addLink(this._activeCardHandle,i,!0),this._linkPlotter.redraw(r,n,a))}_stopDrag(){this._targetCardId&&this._onCreateLink(this._accountId,this._activeCardType,this._activeCardId,this._targetCardId),this._cancelDrag()}_cancelDrag(){var e;this._isDragging=!1,this._autoScrollData.stop();let{start:t,end:i,isDetailed:r}=this._getLinkPlotterParams();this._linkPlotter.deleteTempLink(),this._linkPlotter.redraw(t,i,r),this._deferredTarget&&(this.redraw(this._deferredTarget),this._deferredTarget=null),null===(e=this._removeTargetHighlight)||void 0===e||e.call(this),this._unsubscribeDrag()}_canCreateLink(e){var t;return e.data.id!==this._activeCardId&&(!(!e.data.providerCard.canHaveLinks||e.data.providerCard.isArchived)&&!g()(t=e.data.providerCard.links).call(t,(e=>e.cardId===this._activeCardId)))}}const Ue={mousedown:Ce.Hammer.INPUT_START,mousemove:Ce.Hammer.INPUT_MOVE,mouseup:Ce.Hammer.INPUT_END},Fe={pointerdown:Ce.Hammer.INPUT_START,pointermove:Ce.Hammer.INPUT_MOVE,pointerup:Ce.Hammer.INPUT_END,pointercancel:Ce.Hammer.INPUT_CANCEL,pointerout:Ce.Hammer.INPUT_CANCEL};Ce.Hammer.inherit(Ce.Hammer.MouseInput,Ce.Hammer.Input,{handler(e){let t=Ue[e.type];t===Ce.Hammer.INPUT_START&&(!1===this.pressed&&(this.button=e.button),this.pressed=!0),t===Ce.Hammer.INPUT_MOVE&&0===e.which&&(t=Ce.Hammer.INPUT_END),this.pressed&&this.allow&&(t===Ce.Hammer.INPUT_END&&(this.pressed=!1,this.button=!1),this.callback(this.manager,t,{button:this.button,pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}}),Ce.Hammer.inherit(Ce.Hammer.PointerEventInput,Ce.Hammer.Input,{handler(e){let t=this.store,i=!1,r=Fe[e.type.toLowerCase().replace("ms","")],n=v()(t).call(t,(t=>t.pointerId===e.pointerId));r===Ce.Hammer.INPUT_START?(this.button=e.button,-1===n&&(n=t.length,t.push(e))):r!==Ce.Hammer.INPUT_END&&r!==Ce.Hammer.INPUT_CANCEL||(this.button=null,i=!0),-1!==n&&(t[n]=e,this.callback(this.manager,r,{button:this.button,pointers:t,changedPointers:[e],pointerType:e.pointerType,srcEvent:e}),i&&_()(t).call(t,n,1))}});const We=S()('\n<div\n    class="mdi mdi-close pw-timeline-resource__hide-btn pw-js-remove-resource"\n    style="display: none;"\n    ng-if="isAdditionalElementsShown"\n>\n    <md-tooltip\n        ng-if="isAdditionalElementsShown"\n        md-autohide\n        md-direction="right"\n    >\n        {pw{::\'TOOLTIPS.HIDE\' | translate}pw}\n    </md-tooltip>\n</div>\n').call('\n<div\n    class="mdi mdi-close pw-timeline-resource__hide-btn pw-js-remove-resource"\n    style="display: none;"\n    ng-if="isAdditionalElementsShown"\n>\n    <md-tooltip\n        ng-if="isAdditionalElementsShown"\n        md-autohide\n        md-direction="right"\n    >\n        {pw{::\'TOOLTIPS.HIDE\' | translate}pw}\n    </md-tooltip>\n</div>\n'),ze=S()(Ie=`\n<div class="pw-timeline-resource pw-timeline-resource--accept-wide">\n    <div class="pw-timeline-resource__milestone">\n        <md-icon\n            class="pw-timeline-resource__milestone-icon"\n            md-svg-icon="icons-16:milestones"\n        ></md-icon>\n    </div>\n    <div class="pw-timeline-resource__name">\n        #: data.name #\n    </div>\n    ${We}\n</div>\n`).call(Ie),Ge=S()(Pe=`\n<div class="pw-timeline-resource pw-timeline-resource--accept-wide">\n    # if (data.id !== '${ke.$d}') { #\n    <div class="pw-timeline-resource__member">\n        # if (data.resourceData.avatarUrl) { #\n        <div class="pw-member-avatar">\n        # } else { #\n        <div class="pw-member-avatar pw-member-avatar_#= data.resourceData.memberColorHash #">\n        # } #\n            # if (data.resourceData.avatarUrl) { #\n            <img\n                class="pw-member-avatar__image"\n                src="#= data.resourceData.avatarUrl #"\n            >\n            # } else { #\n            <svg\n                class="pw-member-avatar__initials"\n                viewBox="0 0 26 26"\n            >\n                <text\n                    x="13"\n                    y="18"\n                    text-anchor="middle"\n                >\n                    #: data.resourceData.initials #\n                </text>\n            </svg>\n            # } #\n        </div>\n    </div>\n    # } else { #\n    <div class="pw-timeline-resource__member pw-timeline-resource__member--unassigned">\n        <md-icon\n            class="pw-timeline-resource__member-icon"\n            md-svg-icon="icons-16:member-outline"\n        ></md-icon>\n    </div>\n    # } #\n    <div class="pw-timeline-resource__name">\n        #: data.name #\n    </div>\n    ${We}\n</div>\n`).call(Pe),je=S()(Re=`\n<div class="pw-timeline-resource pw-timeline-resource--accept-wide">\n    <div class="pw-timeline-resource__calendar">\n        #= data.getProvider().getTimelineResourceTemplates().resourceIcon(data) #\n    </div>\n    <div class="pw-timeline-resource__name">\n        #: data.name #\n    </div>\n    ${We}\n</div>\n`).call(Re),Ve=S()(Le=`\n<div class="pw-timeline-resource pw-timeline-resource__list">\n    <div class="pw-timeline-resource__list-back">\n        # if (data.resourceData.boardImageUrl) { #\n        <img\n            class="pw-calendar-icon__image"\n            src="#= data.resourceData.boardImageUrl #"\n        >\n        # } else { #\n        <div class="pw-calendar-icon pw-calendar-icon--trello-board pw-calendar-icon--trello-board_#= data.resourceData.boardColor #"></div>\n        # } #\n\n        <div class="pw-timeline-resource__name pw-timeline-resource__list-name">\n            #: data.name #\n        </div>\n    </div>\n    ${We}\n</div>\n`).call(Le),Ke=S()(Ne=`\n<div class="pw-timeline-resource pw-timeline-resource__status">\n    <div class="pw-timeline-resource__name pw-timeline-resource__status-name">\n        #: data.name #\n    </div>\n    ${We}\n</div>\n`).call(Ne),Ye=S()(Oe=`\n<div class="pw-timeline-resource pw-timeline-resource__label">\n    #= data.getProvider().getTimelineResourceTemplates().labelIcon(data) #\n    ${We}\n</div>\n`).call(Oe),qe=Te.p8,Ze=Te.UM,Xe=66,Qe=1e3,Je=9e4,et=1728e3,tt=4*et,it=3*tt,rt=12*tt,nt=be.F6.Min/Qe,at=be.F6.Max/Qe,st=5184e6,ot="pwCreateCardHint",lt="pwDateRangeHighlight",dt={milestones:{labelHeight:66,labelHeightWide:46,minHeight:Xe},[be.y.NoResources]:{labelHeight:0,labelHeightWide:0,minHeight:Xe},[be.y.Members]:{labelHeight:66,labelHeightWide:46,minHeight:Xe},[be.y.Calendars]:{labelHeight:66,labelHeightWide:46,minHeight:Xe},[be.y.Lists]:{labelHeight:40,labelHeightWide:40,minHeight:Xe},[be.y.Labels]:{labelHeight:30,labelHeightWide:30,minHeight:Xe},[be.y.GitHubAssignees]:{labelHeight:66,labelHeightWide:46,minHeight:Xe},[be.y.GitHubLabels]:{labelHeight:30,labelHeightWide:30,minHeight:Xe},[be.y.GitHubStatuses]:{labelHeight:40,labelHeightWide:40,minHeight:Xe}};Ce.util.getScrollBarWidth=()=>{let e=document.createElement("p");e.style.width="100%",e.style.height="200px";let t=document.createElement("div");t.classList.add("timeline-panel","timeline-right"),t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);let i=e.offsetWidth;t.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=t.clientWidth),document.body.removeChild(t),i-r},Ce.DataSet.prototype._addItem=function(e){let t=e[this._fieldId];return this._data[t]=e,this.length++,t},Ce.DataSet.prototype._getItem=function(e){return this._data[e]},Ce.DataSet.prototype._updateItem=function(e){let t=e[this._fieldId];if(void 0===t)throw new Error(`Cannot update item: item has no id (item: ${k()(e)})`);if(!this._data[t])throw new Error(`Cannot update item: no item with id ${t} found`);return this._data[t]=e,t},Ce.DataSet.prototype.update=function(e,t){let i=[],r=[],n=[],a=[],s=this._fieldId;const addOrUpdate=e=>{var t;let o=e[s];if(e.isReadOnly||!e.isRecurring||e.isRecurring()&&!e.isException()||(e.selectable=!0),null!==(t=e.providerCard)&&void 0!==t&&t.clone&&"function"==typeof e.providerCard.clone&&(e.providerCard=e.providerCard.clone()),this._data[o]){let t="function"==typeof this._data[o].clone?this._data[o].clone():D()({},this._data[o]);o=this._updateItem(e),r.push(o),a.push(e),n.push(t)}else o=this._addItem(e),i.push(o)};if(E()(e))for(let t of e)t&&"object"==typeof t&&addOrUpdate(t);else{if(!e||"object"!=typeof e)throw new Error("Unknown dataType");addOrUpdate(e)}if(i.length&&this._trigger("add",{items:i},t),r.length){let e={items:r,oldData:n,data:a};this._trigger("update",e,t)}return I()(i).call(i,r)},Ce.timeline.DateUtil.stepOverHiddenDates=function(e,t,i){let r,n=!1,a=t.current.valueOf();for(let e=0;e<t.hiddenDates.length;e++){const i=t.hiddenDates[e].start;if(r=t.hiddenDates[e].end,a>=i&&a<r){n=!0;break}}if(n&&a<t._end.valueOf()&&a!==i){let n=e(i),a=e(r);n.year()!==a.year()?t.switchedYear=!0:n.quarter()!==a.quarter()?t.switchedQuarter=!0:n.month()!==a.month()?t.switchedMonth=!0:n.dayOfYear()!==a.dayOfYear()&&(t.switchedDay=!0),t.current=a}},Ce.timeline.components.ItemSet.prototype.redraw=function(){const e="__background__";let t=this.options.margin,i=this.body.range,r=Ce.util.option.asSize,n=this.options,a=n.orientation.item,s=!1,o=this.dom.frame;this.props.top=this.body.domProps.top.height+this.body.domProps.border.top,this.options.rtl?this.props.right=this.body.domProps.right.width+this.body.domProps.border.right:this.props.left=this.body.domProps.left.width+this.body.domProps.border.left,o.className="timeline-itemset",s=this._orderGroups()||s;let l=i.end-i.start,d=l!==this.lastVisibleInterval||this.props.width!==this.props.lastWidth,c=i.start!==this.lastRangeStart,h=n.stack!==this.lastStack,u=n.stackSubgroups!==this.lastStackSubgroups,p=this.pwIsItemsHeightDirty||d||c||h||u;this.lastVisibleInterval=l,this.lastRangeStart=i.start,this.lastStack=n.stack,this.lastStackSubgroups=n.stackSubgroups,this.pwIsItemsHeightDirty=!1,this.props.lastWidth=this.props.width;let m=this._firstGroup(),g={item:t.item,axis:t.axis},y={item:t.item,axis:-1},v=0,f=t.axis+t.item.vertical;this.groups[e].redraw(i,g,p);let _={},C=0;if(R()(Ce.util).call(Ce.util,this.groups,((t,r)=>{if(r===e)return;let n=t===m?g:y;_[r]=t.redraw(i,n,p,!0),C=_[r].length})),C>0){let t={};for(let e=0;e<C;e++)R()(Ce.util).call(Ce.util,_,((i,r)=>{t[r]=i[e]()}));R()(Ce.util).call(Ce.util,this.groups,((i,r)=>{if(r===e)return;let n=t[r];s=n||s,v+=Math.max(i.height,i.props.pwHeightToBottom)}))}return v=Math.max(v,f),this.props.width=o.offsetWidth,this.props.height=v,o.style.height=r(v),this.dom.axis.style.top=r("top"===a?this.body.domProps.top.height+this.body.domProps.border.top:this.body.domProps.top.height+this.body.domProps.centerContainer.height),this.options.rtl?this.dom.axis.style.right="0":this.dom.axis.style.left="0",this.initialItemSetDrawn=!0,s=this._isResized()||s,s};const ct=Ce.timeline.components.ItemSet.prototype._onGroupDragStart;Ce.timeline.components.ItemSet.prototype._onGroupDragStart=e=>e.stopPropagation();const ht=Ce.timeline.components.ItemSet.prototype._onGroupDrag;Ce.timeline.components.ItemSet.prototype._onGroupDrag=e=>e.stopPropagation();const ut=Ce.timeline.components.ItemSet.prototype._onGroupDragEnd;Ce.timeline.components.ItemSet.prototype._onGroupDragEnd=e=>e.stopPropagation();const pt=Ce.timeline.components.ItemSet.prototype._create;Ce.timeline.components.ItemSet.prototype._create=function(){this.body.itemSet=this,pt.call(this),this.pwLinkPlotter=new LinkPlotter("pw-timeline-links-container"),this.dom.frame.appendChild(this.pwLinkPlotter.targetElement);let e,t=new DependencyCreateControl({cardsContainer:this.dom.foreground,linkPlotter:this.pwLinkPlotter,xToDate:e=>this.body.util.toTime(e),startAutoScroll:()=>this.body.range.pwStartAutoScroll(),getLinkPlotterParams:()=>({start:this.body.range.start,end:this.body.range.end,isDetailed:this.pwOptions.isDetailedView}),onCreateLink:(e,t,i,r)=>this.body.emitter.emit("pwCreateLink",{accountId:e,leftCardType:t,leftCardId:i,rightCardId:r})});this.pwRetargetDependencyCreateControl=i=>{i?t.redraw(i):t.remove(),e=i},this.pwRefreshDependencyCreateControl=i=>{if(e)if(i){if(i["timeline-item"].id===e["timeline-item"].id){let e=ve()(i).is(":hover")||ve()(".pw-dependency-create:hover")[0];this.pwRetargetDependencyCreateControl(e?i:null)}}else t.redraw(e)},this.hammer.get("pan").set({direction:Ce.Hammer.DIRECTION_ALL});const dragHandler=e=>{e.stopPropagation();let t=this.groupFromTarget(e);t&&canDragGroup(t.groupId)&&ht.call(this,e)},dragStopHandler=e=>{e.stopPropagation(),this.groupTouchParams.group&&canDragGroup(this.groupTouchParams.group.groupId)&&(this.body.emitter.emit("pwGroupDragEnded"),this._pwGroupDragRegisterers.stopDragging()),ut.call(this,e)};this.dom.labelSet.addEventListener($e,(e=>{e.target.classList.contains("pw-js-remove-resource")||(e.stopPropagation(),ct.call(this,e),this.groupTouchParams.group&&(canDragGroup(this.groupTouchParams.group.groupId)?(this.body.emitter.emit("pwGroupDragStarted"),this._pwGroupDragRegisterers.startDragging()):(this.toggleGroupDragClassName(this.groupTouchParams.group),this.groupTouchParams.isDragging=!1,this.groupTouchParams.group=null)))})),this._pwGroupDragRegisterers={startDragging:()=>{window.addEventListener(Be,dragHandler,!0),window.addEventListener(xe,dragStopHandler,!0)},stopDragging:()=>{window.removeEventListener(Be,dragHandler,!0),window.removeEventListener(xe,dragStopHandler,!0)}}},Ce.timeline.components.ItemSet.prototype._cloneItemData=e=>e.clone();const mt=Ce.timeline.components.ItemSet.prototype._addItem;Ce.timeline.components.ItemSet.prototype._addItem=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];mt.call(this,e,...i),e.pwRefreshDuration()};const gt=Ce.timeline.components.ItemSet.prototype._updateItem;Ce.timeline.components.ItemSet.prototype._updateItem=function(e,t){this.pwIsItemDragged(e)?(this._pwDraggedItemsToUpdate||(this._pwDraggedItemsToUpdate=new(N())),this._pwDraggedItemsToUpdate.set(e,t)):gt.call(this,e,t)};const yt=Ce.timeline.components.ItemSet.prototype._removeItem;Ce.timeline.components.ItemSet.prototype._removeItem=function(e){this.pwIsItemDragged(e)?(this._pwDraggedItemsToUpdate&&this._pwDraggedItemsToUpdate.delete(e),this._pwDraggedItemsToRemove?this._pwDraggedItemsToRemove.push(e):this._pwDraggedItemsToRemove=[e]):yt.call(this,e)};const vt=Ce.timeline.components.ItemSet.prototype.setSelection;Ce.timeline.components.ItemSet.prototype.setSelection=function(e,t){vt.call(this,e),t||(this.pwSelectedUids=new(M())(x()(e).call(e,(e=>this.items[e].data.uid)))),this.body.emitter.emit("pwSelect",{uids:this.pwSelectedUids?[...this.pwSelectedUids]:[]})},Ce.timeline.components.ItemSet.prototype._onSelectItem=function(e){if(!this.options.selectable)return;let t=this.itemFromTarget(e);if(t&&!t.data.selectable)return;let i=this.getSelection(),r=[];if(e.srcEvent&&(isCtrlPressed(e.srcEvent)||e.srcEvent.shiftKey)){if(!t)return;let e=t.data.uid;this.pwSelectedUids||(this.pwSelectedUids=new(M())(x()(i).call(i,(e=>this.items[e].data.uid)))),this.pwSelectedUids.has(e)?this.pwSelectedUids.delete(e):this.pwSelectedUids.add(e),r=[];for(let e in this.items)this.pwSelectedUids.has(this.items[e].data.uid)&&r.push(e)}else if(t){let e=t.data.uid;this.pwSelectedUids=new(M())([e]);for(let t in this.items)this.items[t].data.uid===e&&r.push(t)}this.setSelection(r,!0);let n=this.getSelection();(n.length>0||i.length>0)&&this.body.emitter.emit("select",{items:n,event:e})},Ce.timeline.components.ItemSet.prototype._onMultiSelectItem=()=>{};const ft=Ce.timeline.components.ItemSet.prototype._onDragStart;Ce.timeline.components.ItemSet.prototype._onDragStart=function(e){if(0!==e.button)return;if(this.touchParams.itemIsDragging)return void e.stopPropagation();const t=ve()("body");let i,r=!1,n=this.touchParams.item;if(n){if(!(0,we.VH)(n.data.providerType).canStartMoveInScheduler(n.data))return void e.stopPropagation();r=this.touchParams.dragLeftItem||this.touchParams.dragRightItem,n.selected&&!r||(this.pwSelectedUids=new(M())([n.data.uid]),this.pwUpdateSelection())}let a=this.pwOptions.sortOrderField;if(n){let a=e.center.x-e.deltaX,s=this.body.dom.center.getBoundingClientRect();n.data.originalGroup=n.data.group,this.touchParams.pwOriginalGroup=n.data.group,this.touchParams.pwLastGroup=this.touchParams.pwOriginalGroup,this.touchParams.pwOffsetX=this.options.rtl?s.right:s.left;let o=this.body.util.toTime(a-this.touchParams.pwOffsetX);!this.pwOptions.isHourScale||n.data.isAllDay&&!r?this.touchParams.pwDragStartTime=(0,Me.$Y)(o):this.touchParams.dragLeftItem?this.touchParams.pwDragStartTime=n.data.realStart:this.touchParams.dragRightItem?this.touchParams.pwDragStartTime=n.data.isAllDay?(0,Me.E4)(n.data.realEnd,1):n.data.realEnd:this.touchParams.pwDragStartTime=(0,Me.GG)(o,"halfHour"),!r||this.pwOptions.isHourScale?this.touchParams.pwResizeShift=0:this.touchParams.dragLeftItem?this.touchParams.pwResizeShift=this.pwOptions.getDateDistance((0,Me.$Y)(o),(0,Me.$Y)(n.data.start)):this.touchParams.dragRightItem&&(this.touchParams.pwResizeShift=this.pwOptions.getDateDistance((0,Me.$Y)(o),(0,Me.$Y)(n.data.end))),this.touchParams.pwDragStartTime=this.pwOptions.getShiftedDate(this.touchParams.pwDragStartTime,this.touchParams.pwResizeShift),this._pwDragStopHandler=e=>{var n;if(e&&e.which!==be.VD.Escape)return;t.removeClass("pw--moving-calendar-card"),null===(n=this.touchParams.autoScrollData)||void 0===n||n.stop(),this._pwDraggedItemUids=null;let a=this.touchParams.itemProps;if(e){this.hammer.stop(!0);for(let e of a)this._moveToGroup(e.item,e.data.group),e.item.setData(e.data);this.touchParams.itemProps=[],this.setSelection([]),this.body.emitter.emit("_change")}if(this._pwDraggedItemsToUpdate){for(let[e,t]of this._pwDraggedItemsToUpdate)gt.call(this,e,t);this._pwDraggedItemsToUpdate=null}if(this._pwDraggedItemsToRemove){for(let e of this._pwDraggedItemsToRemove)yt.call(this,e);this._pwDraggedItemsToRemove=null}(async(t,n)=>{let a,s=this.touchParams.itemProps,o=x()(t=H()(n=F()(this.items)).call(n,(e=>!i.has(this.items[e].data.uid)))).call(t,(e=>this.items[e].data));if(r)return;e?(a=[],this.pwCardDragHelper.cancelDragging()):a=await this.pwCardDragHelper.stopDraggingAsync(z()(s).call(s,((e,t)=>(e[t.item.data.uid]=t.item.data.providerCard[this.pwOptions.sortOrderField],e)),{}),o);let l=new(M())(x()(a).call(a,(e=>e.uid))),d=!1;for(let e of s)l.has(e.data.uid)||(d=!0,this._moveToGroup(e.item,e.data.group),e.item.setData(e.data));d&&this.body.emitter.emit("_change")})();for(let e of a)this.pwSelectedUids.has(e.data.uid)&&e.data.isRecurring()&&!e.data.isException()&&this.pwSelectedUids.delete(e.data.uid);this.pwUpdateSelection(),document.removeEventListener("keydown",this._pwDragStopHandler,!0),this._pwDragStopHandler=null},document.addEventListener("keydown",this._pwDragStopHandler,!0)}if(ft.call(this,e),!this.touchParams.itemProps)return;t.addClass("pw--dragging-calendar-card"),i=new(M())([n.data.uid]);let s=[];this._pwDraggedItemUids=new(M());for(let e of this.touchParams.itemProps)e.data.providerCard=e.item.data.providerCard.clone(),this._pwDraggedItemUids.add(e.item.data.uid),e.item.data.isResize=e.dragLeft||e.dragRight,e.item.data.isResize||i.has(e.data.uid)&&e.item.id!==(null==n?void 0:n.id)||(i.add(e.data.uid),s.push(e.data),e.pwIsFirstByUid=!0);if(s.length>0){var o;let e=x()(o=j()(this.items)).call(o,(e=>({id:e.data.id,uid:e.data.uid,title:e.data.title,recurrenceId:e.data.recurrenceId,providerCard:{[a]:e.data.providerCard[a]}})));this.pwCardDragHelper.startDragging(n.data,s,this.pwWorkWeek,{time:this.touchParams.pwDragStartTime,isDaySlot:!1,resourceId:this.touchParams.pwOriginalGroup},e),t.addClass("pw--moving-calendar-card")}this.touchParams.autoScrollData=this.body.range.pwStartAutoScroll(),this.body.emitter.emit("pwCardDragStarted")},Ce.timeline.components.ItemSet.prototype._onDrag=function(e){var t,i;if(!this.touchParams.itemProps||!(0,we.VH)(this.touchParams.item.data.providerType).canStartMoveInScheduler(this.touchParams.item.data))return;if(e.stopPropagation(),this.hammer.session.stopped)return;let r,n,a,s=this.touchParams.selectedItem;if(this.options.editable.overrideItems||!s.editable?(r=this.options.editable.updateGroup,n=this.options.editable.updateTime):(r=s.editable.updateGroup,n=s.editable.updateTime),r&&s&&s.data.group){let t=this.groupFromTarget(e);t&&(a=t.groupId,a!==this.touchParams.pwLastGroup&&(this.touchParams.pwLastGroup=a))}let o=!this.pwOptions.isHourScale||this.touchParams.item.data.isAllDay,l=this.pwOptions.getShiftedDate(this.body.util.toTime(e.center.x-this.touchParams.pwOffsetX),this.touchParams.pwResizeShift),d=o?(0,Me.$Y)(l):(0,Me.GG)(l,"halfHour"),c=this.pwOptions.isHourScale?(0,Me.GG)(l,"halfHour"):(0,Me.$Y)(l),h=this.touchParams.pwDragStartTime;null===(t=this.touchParams.autoScrollData)||void 0===t||t.updateTarget(l,e.center.y-this.body.dom.top.getBoundingClientRect().bottom),this.touchParams.pwDragCurrentTime=d,this.pwCardDragHelper.drag({time:d,isDaySlot:!1,resourceId:a||this.touchParams.pwLastGroup}),R()(i=this.touchParams.itemProps).call(i,(t=>{let i=this._cloneItemData(t.item.data);if(t.item.editable&&!t.item.editable.updateTime&&!t.item.editable.updateGroup&&!this.options.editable.overrideItems)return;if(n)if(t.dragLeft){let e=this.pwOptions.isHourScale&&t.data.isAllDay?(0,Me.E4)(i.realEnd,1):i.realEnd;(0,Me.rs)(c,h)?(i.start=t.data.start,i.resizeStart=null,i.isAllDay=t.data.isAllDay):(0,Me.CX)(c,e)>=30&&(i.start=c,i.resizeStart=i.start,i.isAllDay=!this.pwOptions.isHourScale)}else if(t.dragRight){let e=this.pwOptions.isHourScale?(0,Me.mH)(c,30):c;(0,Me.rs)(e,h)?(i.start=t.data.start,i.resizeStart=null,i.end=t.data.end,i.resizeEnd=null,i.isAllDay=t.data.isAllDay):i.realStart<=c&&(i.end=e,i.resizeEnd=i.end,i.isAllDay=!this.pwOptions.isHourScale,i.isAllDay&&(i.start=(0,Me.$Y)(i.start),i.resizeStart=i.start))}let a=this.pwCardDragHelper.getDraggedCard(i.uid);!a||t.dragLeft||t.dragRight||(i.start=a.start,i.end=a.end,i.realStart=a.start,i.realEnd=a.end,i.cardType=a.cardType,i.cardRole=a.cardRole||t.data.cardRole),!r||t.dragLeft||t.dragRight||(a.resourceId?i.group=t.pwIsFirstByUid?a.resourceId:null:a.cardRole&&a.cardRole===Se.D.Milestone?i.group=t.pwIsFirstByUid?ke.iF:null:i.group=t.data.group);let s=this.touchParams.selectedItem.parent,o=this.body.dom.center.offsetTop,l=e.center.y-this.body.dom.top.getBoundingClientRect().bottom-s.top-o;l<0?i.positionY=0:l>s.height?i.positionY=Number.POSITIVE_INFINITY:i.positionY=l,this.options.onMoving(i,(e=>{e&&t.item.setData(e)}))})),this.body.emitter.emit("_change")};const _t=Ce.timeline.components.ItemSet.prototype._onDragEnd;Ce.timeline.components.ItemSet.prototype._onDragEnd=function(e){this._pwDragStopHandler&&this._pwDragStopHandler(),ve()("body").removeClass("pw--dragging-calendar-card"),_t.call(this,e)},Ce.timeline.components.ItemSet.prototype._moveToGroup=function(e,t){let i=t&&this.groups[t];if(!i||i.groupId!==e.data.group){let t=e.parent;t&&(e.pwOldParent=t,t.remove(e),t.order()),i?(e.data.group=i.groupId,i.add(e),i.order(),e.pwOldParent&&e.pwOldParent.groupId===ke.iF!=(i.groupId===ke.iF)&&(e.dirty=!0,e.pwForceRedraw=!0)):e.data.group=null}},Ce.timeline.components.ItemSet.prototype.pwUpdateSelection=function(){if(this.pwSelectedUids){let e=[];for(let t in this.items)this.pwSelectedUids.has(this.items[t].data.uid)&&e.push(t);this.setSelection(e,!0)}},Ce.timeline.components.ItemSet.prototype.pwIsItemDragged=function(e){var t;return(null===(t=this._pwDraggedItemUids)||void 0===t?void 0:t.has(e.data.uid))||!1},Ce.timeline.components.ItemSet.prototype.pwIsDragging=function(){return this._pwDraggedItemUids&&this._pwDraggedItemUids.size>0||!1};const Ct=Ce.timeline.components.items.Item.prototype.setData;Ce.timeline.components.items.Item.prototype.setData=function(e){if(e.id!==lt&&e.id!==ot){var t;let i=_objectSpread(_objectSpread({},e),{},{providerCard:(0,Me.mv)(e.providerCard)});this.pwOptions.setEventTimes(i);let r=this.parent||this.pwOldParent;if(r&&void 0!==e.group){r.itemSet._moveToGroup(this,e.group);let t=e.group,n=e.originalGroup;t&&t!==ke.iF&&t!==ke.xp&&n&&n!==t&&(0,we.VH)(e.providerType).updateProviderCardDataByTimelineResource(i,r.pwOptions.resources.dataSource.get(t))}if(this.dom&&(!this.pwLastUpdatedData||null===(t=e.$ctrl)||void 0===t||!t.cardTemplateDataEqual(this.pwLastUpdatedData,i))){this.pwLastUpdatedData=i,this.pwLastUpdatedData.providerCard=(0,Me.mv)(i.providerCard);let t=ve()((0,Te.$R)(i))[0];if(this.dom.content.className=t.className,this.dom.content.innerHTML=t.innerHTML,(0,we.VH)(e.providerType).isCardResizeAvailable(e)){let e=ve()(this.dom.content);this.dom.dragLeft&&this.dom.content.replaceChild(this.dom.dragLeft,e.children(".k-resize-w")[0]),this.dom.dragRight&&this.dom.content.replaceChild(this.dom.dragRight,e.children(".k-resize-e")[0])}}}adjustEventForView(e),this.pwRefreshDuration(e),Ct.call(this,e)},Ce.timeline.components.items.Item.prototype.pwIsVisibleByDuration=()=>!0,Ce.timeline.components.items.Item.prototype.pwRefreshDuration=function(e){e||(e=this.data),this.pwDuration=this.pwOptions.isHourScale?this.pwOptions.getDateDistance(e.start,e.end):this.pwOptions.getDateDistance(e.stretchedStart,e.stretchedEnd)};const St=Ce.timeline.components.items.RangeItem.prototype.hide;Ce.timeline.components.items.RangeItem.prototype.hide=function(){this.displayed&&this.dom.line&&this.dom.line.parentNode&&this.dom.line.parentNode.removeChild(this.dom.line),St.call(this)},Ce.timeline.components.items.RangeItem.prototype.pwCalculateWidth=function(){if(0!==this.pwDuration)switch(this.data.cardRole){case Se.D.Card:this.pwRawWidth=Math.floor(this.pwDuration/this.pwOptions.getCurrentRange());break;case Se.D.Milestone:this.pwRawWidth=this.pwOptions.getMilestoneWidth(this)}else this.pwRawWidth=-1},Ce.timeline.components.items.RangeItem.prototype.pwIsVisibleByDuration=function(){if(this.data.isTempCard)return!0;switch(this.data.cardRole){case Se.D.Card:return this.pwDuration/this.pwOptions.getCurrentRange()>=8+Te.$s;case Se.D.Milestone:return this.pwDuration>0}},Ce.timeline.components.items.RangeItem.prototype.isVisible=function(e){if(this.pwCalculateWidth(),this.cluster)return!1;if(this.pwOptions.isHourScale){if(this.data.start>=e.end||this.data.end<=e.start)return!1}else if(this.data.stretchedStart>=e.end||this.data.stretchedEnd<=e.start)return!1;return this.pwRawWidth>=8+Te.$s},Ce.timeline.components.items.RangeItem.prototype.repositionX=function(){if(this.pwRawWidth<0)this.width=0;else{let e,t=this.parent.width;switch(this.data.cardRole){case Se.D.Card:e=Te.ur;break;case Se.D.Milestone:e=0}let i=Math.max(this.pwRawLeft,0)+e,r=timelineScaleToScaleUnit(this.pwOptions.getCurrentRange()*Qe)!==be.Uh.Day?2:0,n=Math.min(this.pwRawLeft+this.pwRawWidth+r-Te.$s,t);this.left=i,this.width=Math.max(n-i,0),this.dom.box.style.left=`${this.left}px`,this.dom.box.style.height=`${this.height}px`}if(this.dom.box.style.width=`${this.width}px`,this.width>0&&this._updateDomComponentsSizes(this._getDomComponentsSizes()),this.dom.line&&(this.dom.line.style.left=`${this.pwRawLeft}px`,this.dom.line.classList.toggle("pw-milestone-line--hidden",0===this.width)),this.data.cardRole===Se.D.Card)this.dom.content.classList.toggle("pw-card--narrow",this.width<Te.O0)},Ce.timeline.components.items.RangeItem.prototype.repositionY=function(){const e=this.options.orientation.item,t=this.dom.box;if(this.data.id===ot&&(t.style.display=this.top+this.height>this.parent.props.pwContentHeight?"none":""),"top"===e){let e;switch(this.data.cardRole){case Se.D.Card:e=1;break;case Se.D.Milestone:e=0}t.style.top=`${this.top+this.parent.props.pwYOffset+Te.w9+e}px`}else t.style.top=this.parent.height+this.parent.props.pwYOffset+Te.w9-this.top-this.height+"px";this.dom.line&&(this.dom.line.style.top=`${this.top+this.parent.props.pwYOffset+Te.w9}px`)},Ce.timeline.components.items.RangeItem.prototype._repaintDomAdditionals=()=>{},Ce.timeline.components.items.RangeItem.prototype._createDomElement=function(){if(this.dom)return;let e=document.createElement("div");if(e["timeline-item"]=this,this.dom={box:e,frame:e},this.data.cardRole===Se.D.Milestone)this._pwCreateMilestoneLine();this.dirty=!0,e.addEventListener("mouseenter",(()=>this.parent.itemSet.pwRetargetDependencyCreateControl(e))),e.addEventListener("mouseleave",(()=>{ve()(".pw-dependency-create:hover")[0]||this.parent.itemSet.pwRetargetDependencyCreateControl(null)}))};const wt=Ce.timeline.components.items.RangeItem.prototype._appendDomElement;Ce.timeline.components.items.RangeItem.prototype._appendDomElement=function(){if(wt.call(this),this.parent.itemSet.pwRefreshDependencyCreateControl(this.dom.box),this.dom.line&&!this.dom.line.parentNode){let e=this.parent.dom.background;if(!e)throw new Error("Cannot redraw item: parent has no background container element");e.appendChild(this.dom.line)}},Ce.timeline.components.items.RangeItem.prototype._updateDirtyDomComponents=function(){var e,t;if(!this.dirty)return;let i=this.parent.itemSet.pwIsItemDragged(this);if(this.pwForceRedraw||!this.dom.content||!i){this.pwForceRedraw=!1,this._updateContents(this.dom.frame);let e=ve()(this.dom.frame).children(".pw-card");this.dom.content=e[0],this.data.id!==ot&&(0,we.VH)(this.data.providerType).isCardResizeAvailable(this.data)&&(this.dom.dragLeft=e.children(".k-resize-w")[0],this.dom.dragLeft.dragLeftItem=this,this.dom.dragRight=e.children(".k-resize-e")[0],this.dom.dragRight.dragRightItem=this)}this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box);let r=[this.editable.updateTime||this.editable.updateGroup?"timeline-editable":"timeline-readonly"];switch(this.baseClassName&&r.push(this.baseClassName),this.data.className&&r.push(this.data.className),this.selected&&r.push("timeline-selected"),i&&r.push("k-event-drag-hint"),this.dom.box.className=r.join(" "),this.dom.content.classList.toggle("k-event-drag-hint",i),this.dom.content.style.maxWidth="none",this.data.cardRole){case Se.D.Card:null===(e=this.dom.line)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.dom.line),this.dom.line=null;break;case Se.D.Milestone:this._pwCreateMilestoneLine(),this.dom.line.parentNode||this.parent.dom.background.appendChild(this.dom.line),r=["pw-milestone-line"],this.selected&&r.push("pw-milestone-line--selected"),0===this.width&&r.push("pw-milestone-line--hidden"),this.dom.line.className=r.join(" ")}},Ce.timeline.components.items.RangeItem.prototype._getDomComponentsSizes=function(){let e;switch(this.overflow=!1,this.dirty&&(this.pwOptions.isDetailedView?this.dom.content.classList.remove("pw-card--small"):this.dom.content.classList.add("pw-card--small")),this.data.cardRole){case Se.D.Card:e=this.pwOptions.isDetailedView?Te.UM:Te.p8;break;case Se.D.Milestone:this.pwCalculateWidth(),e=this.pwOptions.isDetailedView?Ze:qe}return{content:{width:this.width},box:{height:e}}},Ce.timeline.components.items.RangeItem.prototype._pwCreateMilestoneLine=function(){if(!this.dom.line){let e=document.createElement("div");e.className="pw-milestone-line",this.dom.line=e}},Ce.timeline.components.items.BackgroundItem.prototype.repositionY=function(){this.dom.box.style.top=`${this.parent.top}px`,this.dom.box.style.height=`${Math.max(this.parent.height,this.parent.props.pwHeightToBottom)}px`};const kt=Ce.timeline.TimeStep.prototype.setRange;Ce.timeline.TimeStep.prototype.setRange=function(e,t,i){var r;kt.call(this,e,t,i),this._pwFirstWeekDay=kendo.culture().calendar.firstDay;let n=this._pwFirstWeekDay-1;n<0&&(n+=7),this._pwIsLastWeekDayWeekend=!K()(r=this.pwOptions.workDays).call(r,n)};const bt=Ce.timeline.TimeStep.prototype.roundToMinor;Ce.timeline.TimeStep.prototype.roundToMinor=function(){this.scale===be.Uh.Quarter?(this.current.subtract(this.current.month()%3,"month"),this.current.date(1),this.current.hours(0),this.current.minutes(0),this.current.seconds(0),this.current.milliseconds(0)):(bt.call(this),this.scale===be.Uh.Week&&(this.current.weekday(this._pwFirstWeekDay),this.current>this._start&&this.current.subtract(1,"week")))},Ce.timeline.TimeStep.prototype.next=function(){let e=this.scale;e!==be.Uh.Month&&e!==be.Uh.Quarter&&e!==be.Uh.Year||this.current.date(1);const t=this.current.valueOf();switch(this._pwHidden=!1,this.scale!==be.Uh.Week&&(this._pwWasInterrupt=!1),this.scale){case be.Uh.Hour:this.current.add(this.step,"hour");break;case be.Uh.Day:this.current.add(this.step,"day"),this._pwWasInterrupt=this.pwOptions.isWeekendsHidden&&1===this.current.date();break;case be.Uh.Week:if(this._pwWasInterrupt){this._pwWasInterrupt=!1;let e=this.current.weekday()>=this._pwFirstWeekDay;this.current.weekday(this._pwFirstWeekDay),this.current.add(e?this.step:this.step-1,"week")}else if(!1===this.options.showMajorLabels)this.current.add(this.step,"week");else{const e=this.current.clone();e.add(1,"week"),e.isSame(this.current,"month")?this.current.add(this.step,"week"):(this.current.add(this.step,"week"),1!==this.current.date()&&(this.current.date(1),this._pwWasInterrupt=!0,this._pwHidden=!this.pwOptions.isWeekendsHidden||this.pwOptions.isWorkDay(this.current.toDate())))}break;case be.Uh.Month:this.current.add(this.step,"month");break;case be.Uh.Quarter:this.current.add(3*this.step,"month");break;case be.Uh.Year:this.current.add(this.step,"year")}if(1!==this.step)switch(this.scale){case be.Uh.Hour:this.current.hour()<this.step&&this.current.hour(0);break;case be.Uh.Day:this.current.date()<this.step+1&&this.current.date(1);break;case be.Uh.Week:this.current.week()<this.step&&this.current.week(1);break;case be.Uh.Month:this.current.month()<this.step&&this.current.month(0)}this.current.valueOf()===t&&(this.current=this._end.clone()),this.switchedDay=!1,this.switchedMonth=!1,this.switchedQuarter=!1,this.switchedYear=!1,Ce.timeline.DateUtil.stepOverHiddenDates(this.moment,this,t),e===be.Uh.Week&&(this.switchedMonth||this.switchedYear)&&(this.current.date(1),this._pwHidden=!1)},Ce.timeline.TimeStep.prototype.setMinimumStep=function(e){this._start&&this._end&&(this.scale=timelineScaleToScaleUnit(e*Qe),this.step=1)},Ce.timeline.TimeStep.prototype.isMajor=function(){let e=getMajorScale(this.scale);switch(this.pwNewWeek=!1,this.pwNewMonth=e!==be.Uh.Week,e){case be.Uh.Day:return this.switchedDay||0===this.current.hour();case be.Uh.Week:return(this.switchedMonth||this.switchedYear)&&(this.pwNewWeek=!0,this.pwNewMonth=!0),!this.pwNewWeek&&(this.switchedDay&&this._pwIsLastWeekDayWeekend||this.current.weekday()===kendo.culture().calendar.firstDay)&&(this.pwNewWeek=!0),(!this.pwNewMonth&&1===this.current.date()||this._pwWasInterrupt)&&(this.pwNewMonth=!0),this.pwNewWeek||this.pwNewMonth;case be.Uh.Month:return this.switchedMonth||1===this.current.date()||this._pwWasInterrupt;case be.Uh.Quarter:return this.switchedQuarter||this.current.month()%3==0;case be.Uh.Year:return this.switchedYear||0===this.current.month();default:return!1}},Ce.timeline.TimeStep.prototype.getClassName=function(){var e,t;let i=[],r=!1;this._pwHidden&&(i.push("pw--hidden"),r=!0);let n,a=new Date;switch(this.scale){case be.Uh.Hour:let r=this.current.hour();n=this.current.day(),i.push("pw-timeline-hour-label"),K()(e=this.pwOptions.workDays).call(e,n)?this.pwOptions.workDayStart<this.pwOptions.workDayEnd?(r<this.pwOptions.workDayStart||r+1>this.pwOptions.workDayEnd)&&i.push("pw--non-working"):r<this.pwOptions.workDayStart&&r+1>this.pwOptions.workDayEnd&&i.push("pw--non-working"):i.push("pw--non-working"),this.pwOptions.isWeekendsHidden&&(this.switchedDay||0===r)&&n===this.pwOptions.workWeekStart&&i.push("pw--work-week-start");break;case be.Uh.Day:this.current.isSame(a,"day")&&i.push("timeline-today"),n=this.current.day(),K()(t=this.pwOptions.workDays).call(t,n)||i.push("pw--non-working"),this.pwOptions.isWeekendsHidden&&n===this.pwOptions.workWeekStart&&i.push("pw--work-week-start");break;case be.Uh.Week:this.current.isSame(a,"week")&&i.push("timeline-current-week");break;case be.Uh.Month:this.current.isSame(a,"month")&&i.push("timeline-current-month");break;case be.Uh.Quarter:this.current.isSame(a,"quarter")&&i.push("timeline-current-quarter");break;case be.Uh.Year:this.current.isSame(a,"year")&&i.push("timeline-current-year")}return{className:i.join(" "),expandPreviousLabel:r}},Ce.timeline.TimeStep.prototype.getLabelMajor=function(e){return e||(e=this.current),e instanceof Date&&(e=this.moment(e)),this.format.majorLabels(e,this)},Ce.timeline.Range.prototype.pwScrollByRelativeUnit=function(e,t){let i=new Date(this.start),r=new Date(this.end),n=this.pwOptions.getDateDistance(i,r)*e,a=this.pwOptions.getShiftedDate(i,n),s=this.pwOptions.getShiftedDate(r,n);this._applyRange(a,s),this.body.emitter.emit("rangechange",_objectSpread(_objectSpread({},t),{},{start:new Date(this.start),end:new Date(this.end)}))},Ce.timeline.Range.prototype.setRange=function(e,t,i,r,n){i||(i={}),!0!==i.byUser&&(i.byUser=!1),i.scaleMethod&&(this._pwLastScaleMethod=i.scaleMethod);let a=e?Ce.util.convert(e,"Date").valueOf():null,s=t?Ce.util.convert(t,"Date").valueOf():null;if(this._cancelAnimation(),this.millisecondsPerPixelCache=void 0,i.animation){let o=Ce.util.convert(this.start,"Date"),l=Ce.util.convert(this.end,"Date"),d="object"==typeof i.animation&&"duration"in i.animation?i.animation.duration:500,c="object"==typeof i.animation&&"easingFunction"in i.animation?i.animation.easingFunction:"easeInOutQuad",h=Ce.util.easingFunctions[c];if(!h)throw new Error(`Unknown easing function ${k()(c)}. Choose from: ${F()(Ce.util.easingFunctions).join(", ")}`);let u=null,p=!1,m=e?this.pwOptions.getDateDistance(o,e):null,g=t?this.pwOptions.getDateDistance(l,t):null;const next=e=>{if(null===u&&(u=e),!this.props.touch.dragging){let t=e-u,c=h(t/d),y=t>d,v=y||null===a?a:this.pwOptions.getShiftedDate(o,m*c),f=y||null===s?s:this.pwOptions.getShiftedDate(l,g*c),_=this._applyRange(v,f);Ce.timeline.DateUtil.updateHiddenDates(this.options.moment,this.body,this.options.hiddenDates),p=p||_;let C={start:new Date(this.start),end:new Date(this.end),byUser:i.byUser,byNavigation:i.byNavigation,scaleMethod:i.scaleMethod||this._pwLastScaleMethod,event:i.event};n&&n(c,_,y),_&&this.body.emitter.emit("rangechange",C),y?(this.animationTimer=null,p?(this.body.emitter.emit("rangechanged",C),r&&r()):i.onNotChanged&&i.onNotChanged()):this.animationTimer=requestAnimationFrame(next)}};this.animationTimer=requestAnimationFrame(next)}else{let e=this._applyRange(a,s);if(Ce.timeline.DateUtil.updateHiddenDates(this.options.moment,this.body,this.options.hiddenDates),e){let e={start:new Date(this.start),end:new Date(this.end),byUser:i.byUser,byNavigation:i.byNavigation,scaleMethod:i.scaleMethod||this._pwLastScaleMethod,event:i.event};if(this.body.emitter.emit("rangechange",e),clearTimeout(this.timeoutID),i.sendEventImmediately?this.body.emitter.emit("rangechanged",e):this.timeoutID=q()((()=>{this.body.emitter.emit("rangechanged",e)}),200),r)return r()}else i.onNotChanged&&i.onNotChanged()}},Ce.timeline.Range.prototype.zoom=function(e,t,i,r){null===t&&(t=(this.start+this.end)/2);let n=new Date(this.start),a=new Date(this.end),s=new Date(t),o=this.pwOptions.getDateDistance(n,a),l=this.pwOptions.getDateDistance(s,n),d=this.pwOptions.getShiftedDate(s,l*e),c=this.pwOptions.getShiftedDate(s,(o+l)*e);this.startToFront=i<0,this.endToFront=i>0,this.setRange(d,c,{animation:!1,byUser:!0,scaleMethod:"zoomByWheel",sendEventImmediately:!0,event:r}),this.startToFront=!1,this.endToFront=!0},Ce.timeline.Range.prototype._cancelAnimation=function(){this.animationTimer&&(cancelAnimationFrame(this.animationTimer),this.animationTimer=null)};const Dt=Ce.timeline.Range.prototype._onDragStart;Ce.timeline.Range.prototype._onDragStart=function(e){var t;this.pwIsScrollbarUsed=!1,this._pwIsDragCancelled=1!==e.button&&!(0===e.button&&isCtrlPressed(e.srcEvent)),this._pwIsDragCancelled||(Dt.call(this,e),"move"===(null===(t=this.body.dom.root)||void 0===t?void 0:t.style.cursor)&&this.body.dom.root.classList.add("pw--timeline-grabbing"),this.props.touch.pwVisibleRange=this.pwOptions.getDateDistance(new Date(this.start),new Date(this.end)),ve()(this.body.dom.center).addClass("timeline-content--scrolling"))},Ce.timeline.Range.prototype._onDrag=function(e){if(!e||!this.props.touch.dragging||!this.props.touch.allowDragging)return;let t=this.options.direction;if("horizontal"!==t&&"vertical"!==t)throw new TypeError(`Unknown direction "${t}". Choose "horizontal" or "vertical".`);let i="horizontal"===t?e.deltaX:e.deltaY;i-=this.deltaDifference;let r,n="horizontal"===t?this.body.domProps.center.width:this.body.domProps.center.height,a=this.props.touch.pwVisibleRange;r=this.options.rtl?i/n*a:-i/n*a;let s=this.pwOptions.getShiftedDate(new Date(this.props.touch.start),r),o=this.pwOptions.getShiftedDate(s,a);this.previousDelta=i,this._applyRange(s,o);let l=new Date(this.start),d=new Date(this.end);this.body.emitter.emit("rangechange",{start:l,end:d,byUser:!0,event:e}),this.body.emitter.emit("panmove")};const Tt=Ce.timeline.Range.prototype._onDragEnd;Ce.timeline.Range.prototype._onDragEnd=function(e){this.props.touch.needFinalDrag&&(this.props.touch.needFinalDrag=!1,this._onDrag(e)),ve()(this.body.dom.center).removeClass("timeline-content--scrolling"),Tt.call(this,e),this.body.dom.root&&this.body.dom.root.classList.remove("pw--timeline-grabbing"),this._pwIsDragCancelled||this.body.emitter.emit("pwScroll",{by:this.pwIsScrollbarUsed?"scrollbar":"drag"})};Ce.timeline.Range.prototype.pwStartAutoScroll=function(){let e,t,i,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=null,o=!1,l=ve()(this.body.dom.center),d=null,c=null;const processFrame=h=>{if(o)return void((e||i)&&l.removeClass("timeline-content--scrolling"));if(requestAnimationFrame(processFrame),null===s)return void(s=h);let u=h-s;s=h;let p=new Date(this.start),m=new Date(this.end);if(null!==c){t=e,e=0;let i=this.body.domProps;c<n&&i.scrollTop<0&&(e=(c-n)*a),c+n/2>i.centerContainer.height&&i.scrollTop>i.scrollTopMin&&(e=(c+n/2-i.centerContainer.height)*a)}if(d){let e=this.pwOptions.getDateDistance(p,m);r=i,i=0;let t=this.pwOptions.getDateDistance(p,d)-.05*e;t<0?i=t*a:(t=.05*e-this.pwOptions.getDateDistance(d,m),t>0&&(i=t*a)),d=null}if(e||i){if(t||r||l.addClass("timeline-content--scrolling"),e){let t=X()(e*u/100);this.body.emitter.emit("_pwVerticalScroll",{delta:t})}if(i){let e=X()(i*u/1e3),t=this.pwOptions.getShiftedDate(p,e),r=this.pwOptions.getShiftedDate(m,e);this._applyRange(t,r),this.body.emitter.emit("rangechange",{start:new Date(this.start),end:new Date(this.end),byUser:!0})}}else(t||r)&&l.removeClass("timeline-content--scrolling")};return requestAnimationFrame(processFrame),{stop:()=>{o=!0},updateTarget:(e,t)=>{d=e,c=t}}},Ce.timeline.Range.prototype._applyRange=function(e,t){let i=null!==e?Ce.util.convert(e,"Date").valueOf():this.start,r=null!==t?Ce.util.convert(t,"Date").valueOf():this.end,n=null!==this.options.max?Ce.util.convert(this.options.max,"Date").valueOf():null,a=null!==this.options.min?Ce.util.convert(this.options.min,"Date").valueOf():null;if(isNaN(i)||null===i||isNaN(r)||null===r)return!1;const getDateDistance=(e,t)=>this.pwOptions.getDateDistance(new Date(e),new Date(t)),getShiftedDate=(e,t)=>this.pwOptions.getShiftedDate(new Date(e),t).valueOf();let s=getDateDistance(this.start,this.end),o=getDateDistance(i,r),l=null;if(null!==this.options.zoomMin){let e=J()(this.options.zoomMin);e<0&&(e=0),o<e&&(l=e)}if(null!==this.options.zoomMax){let e=J()(this.options.zoomMax);e<0&&(e=0),o>e&&(l=e,this.body.emitter.emit("pwOutOfScale"))}if(l){let e=(l-o)/(s-o);i=getShiftedDate(i,Math.floor(getDateDistance(i,this.start)*e)),r=getShiftedDate(i,l)}if(r<i&&(r=i),null!==a&&i<a){let e=getDateDistance(i,a);i=getShiftedDate(i,e),r=getShiftedDate(r,e),null!==n&&r>n&&(r=n)}if(null!==n&&r>n){let e=getDateDistance(r,n);i=getShiftedDate(i,e),r=getShiftedDate(r,e),null!==a&&i<a&&(i=a)}let d=this.start!==i||this.end!==r;return i>=this.start&&i<=this.end||r>=this.start&&r<=this.end||this.start>=i&&this.start<=r||this.end>=i&&this.end<=r||this.body.emitter.emit("checkRangedItems"),this.start=i,this.end=r,d};const Et=Ce.timeline.components.Group.prototype._create;Ce.timeline.components.Group.prototype._create=function(){this.checkRangedItems=!0,Et.call(this)};const At=Ce.timeline.components.Group.prototype.add;Ce.timeline.components.Group.prototype.add=function(e,t){let i=this.itemSet.body.range,r=this.pwOptions.isHourScale;i.start>e.data[r?"start":"stretchedStart"]&&i.end<e.data[r?"end":"stretchedEnd"]&&(this.checkRangedItems=!0),At.call(this,e,t)},Ce.timeline.components.Group.prototype.setData=function(e){if(this.itemSet.groupTouchParams.isDragging)return;let t,i;var r;this.itemSet.options&&this.itemSet.options.groupTemplate?(i=te()(r=this.itemSet.options.groupTemplate).call(r,this),t=i(e,this.dom.inner)):t=e&&e.content;if(t instanceof Element){const redrawGroups=()=>{for(;this.dom.inner.firstChild;)this.dom.inner.removeChild(this.dom.inner.firstChild);this.dom.inner.appendChild(t);const toggleHiddenClass=()=>{this.dom.inner.firstChild?Ce.util.removeClassName(this.dom.inner,"timeline-hidden"):Ce.util.addClassName(this.dom.inner,"timeline-hidden")};e.$scope?e.$scope.$evalAsync((()=>toggleHiddenClass())):toggleHiddenClass()};this.dom.inner.firstChild?q()((()=>redrawGroups())):redrawGroups()}else t instanceof Object&&t.isReactComponent||(t instanceof Object?i(e,this.dom.inner):this.dom.inner.innerHTML=null!=t?t:this.groupId||"");if(this.dom.label.title=e&&e.title||"",this.dom.inner.firstChild?Ce.util.removeClassName(this.dom.inner,"timeline-hidden"):Ce.util.addClassName(this.dom.inner,"timeline-hidden"),e&&e.nestedGroups){this.nestedGroups&&this.nestedGroups===e.nestedGroups||(this.nestedGroups=e.nestedGroups),void 0===e.showNested&&void 0!==this.showNested||(!1===e.showNested?this.showNested=!1:this.showNested=!0),Ce.util.addClassName(this.dom.label,"timeline-nesting-group");let t=this.itemSet.options.rtl?"collapsed-rtl":"collapsed";this.showNested?(Ce.util.removeClassName(this.dom.label,t),Ce.util.addClassName(this.dom.label,"expanded")):(Ce.util.removeClassName(this.dom.label,"expanded"),Ce.util.addClassName(this.dom.label,t))}else if(this.nestedGroups){this.nestedGroups=null;let e=this.itemSet.options.rtl?"collapsed-rtl":"collapsed";Ce.util.removeClassName(this.dom.label,e),Ce.util.removeClassName(this.dom.label,"expanded"),Ce.util.removeClassName(this.dom.label,"timeline-nesting-group")}if(e&&(e.treeLevel||e.nestedInGroup)){let t=15*(e.treeLevel||2);e.nestedGroups||(t+=15),Ce.util.addClassName(this.dom.label,"vis-nested-group"),this.itemSet.options&&this.itemSet.options.rtl?this.dom.inner.style.paddingRight=t+"px":this.dom.inner.style.paddingLeft=t+"px"}const n=e&&e.className||null;n!==this.className&&(this.className&&(Ce.util.removeClassName(this.dom.label,this.className),Ce.util.removeClassName(this.dom.foreground,this.className),Ce.util.removeClassName(this.dom.background,this.className),Ce.util.removeClassName(this.dom.axis,this.className)),Ce.util.addClassName(this.dom.label,n),Ce.util.addClassName(this.dom.foreground,n),Ce.util.addClassName(this.dom.background,n),Ce.util.addClassName(this.dom.axis,n),this.className=n),this.style&&(Ce.util.removeCssText(this.dom.label,this.style),this.style=null),e&&e.style&&(Ce.util.addCssText(this.dom.label,e.style),this.style=e.style),this.props.label.width=-1},Ce.timeline.components.Group.prototype._updateItemsInRange=function(e,t,i){var r;let n=[],a={},s=this.pwOptions.isHourScale,o=s?"start":"stretchedStart",l=s?"end":"stretchedEnd",d=i.start,c=this.pwOptions.getShiftedDate(d,200*-this.pwOptions.getCurrentRange()).getTime(),h=i.end;const endSearchFunction=e=>e<d?-1:e>h?1:0;for(let t of e.byStart)(this.itemSet.pwIsItemDragged(t)||t.data.isTempCard)&&(t.pwCalculateWidth(),n.push(t),a[t.id]=!0);if(t.length>0)for(let e of t)this.itemSet.pwIsItemDragged(e)||this._checkIfVisibleWithReference(e,n,a,i);let u=Ce.util.binarySearchCustom(e.byStart,(e=>e<c?-1:e>h?1:0),"data",o);if(this._traceVisible(u,e.byStart,n,a,(e=>e.data[o]<c||e.data[o]>h),i),this.checkRangedItems){this.checkRangedItems=!1;for(let t of e.byEnd)this.itemSet.pwIsItemDragged(t)||this._checkIfVisibleWithReference(t,n,a,i)}else{let t=Ce.util.binarySearchCustom(e.byEnd,endSearchFunction,"data",l);this._traceVisible(t,e.byEnd,n,a,(e=>e.data[l]<d||e.data[l]>h),i)}n=H()(n).call(n,(e=>e.pwIsVisibleByDuration()));let p=this.pwOptions.getCurrentRange(),m=new Date(i.start),g=0;for(let t of e.byStart)a[t.id]&&t.data.id!==lt&&(g+=this.pwOptions.getDateDistance(m,t.data[o]),t.pwRawLeft=Math.floor(g/p),m=t.data[o]);let y=x()(r=H()(n).call(n,(e=>!e.displayed))).call(r,(e=>e.redraw(!0))),v=y[0]?y[0].length:0;if(n.length>0&&v>0)for(let e=0;e<v;e++)R()(Ce.util).call(Ce.util,y,(t=>t[e]()));for(let e of n)e.repositionX();return n},Ce.timeline.components.Group.prototype._traceVisible=function(e,t,i,r,n,a){if(-1===e)return;const shouldAddItem=e=>!r[e.id]&&(e.isVisible(a)||e.data.cardRole===Se.D.Milestone)&&!(e.isCluster&&!e.hasItems())&&!e.cluster;for(let a=e;a>=0;a--){let e=t[a];if(n(e))break;shouldAddItem(e)&&(r[e.id]=!0,i.unshift(e))}for(let a=e+1;a<t.length;a++){let e=t[a];if(n(e))break;shouldAddItem(e)&&(r[e.id]=!0,i.push(e))}},Ce.timeline.components.Group.prototype._calculateHeight=function(e){let t=0,i=this.visibleItems;if(i.length>0){let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;if(R()(Ce.util).call(Ce.util,i,(e=>{r=Math.min(r,e.top),e.data.ignoreCollision||e.data.id!==ot&&(n=Math.max(n,e.top+e.height))})),r>e.axis){let t=r-e.axis;n-=t,R()(Ce.util).call(Ce.util,i,(e=>{e.top-=t}))}t=n+Te.fb}let r=this._pwGetLaneSizes().minHeight;return t=Math.max(t,r),this.props.pwContentHeight=t,Math.max(t+this.props.pwYOffset,0)};const It=Ce.timeline.components.Group.prototype._applyGroupHeight;Ce.timeline.components.Group.prototype._applyGroupHeight=function(e){if(It.call(this,Math.max(e,this.props.pwHeightToBottom)),0===this.height)this.groupId===ke.iF?this.dom.foreground.style.borderWidth="0":(this.dom.foreground.style.display="none",this.dom.background.style.display="none"),this.dom.label.style.borderWidth="0";else{if(this.dom.foreground.style.display="block",this.dom.background.style.display="block",this.groupId===ke.iF&&(this.dom.foreground.style.borderWidth="1px"),this.dom.foreground.classList.toggle("timeline-group--first-visible",this.props.pwIsFirstVisible),this.groupId!==ke.iF||!this.pwOptions.holdMilestones){let e=this._pwGetLaneSizes(),t=this.props.pwIsResourcePanelWide?e.labelHeightWide:e.labelHeight;this.dom.inner.style.marginTop=`${Math.min(this.height-t,0)}px`}this.dom.label.style.borderWidth="1px"}},Ce.timeline.components.Group.prototype._calculateGroupSizeAndPosition=function(){let e=this.itemSet,t=0;for(let i=0;e.groupIds[i]!==this.groupId;i++)t+=e.groups[e.groupIds[i]].height||0;this.top=t,this.right=0,this.width=e.props.width},Ce.timeline.components.Group.prototype._didResize=function(e,t){e=Ce.util.updateProperty(this,"height",t)||e,this._pwOldHeightToBottom!==this.props.pwHeightToBottom&&(e=!0,this._pwOldHeightToBottom=this.props.pwHeightToBottom);let i=this.pwOptions.resourceType!==be.y.NoResources?this.pwOptions.resourceLabelWidth+6:0;Ce.util.updateProperty(this.props.label,"width",i)&&(this.dom.label.style.width=`${this.props.label.width}px`,e=!0);let r=this._pwGetLaneSizes(),n=this.props.pwIsResourcePanelWide?r.labelHeightWide:r.labelHeight;return e=Ce.util.updateProperty(this.props.label,"height",n)||e},Ce.timeline.components.Group.prototype._isGroupVisible=function(){return!0},Ce.timeline.components.Group.prototype.order=function(){let e=Ce.util.toArray(this.items);this.orderedItems={byStart:e,byEnd:H()(e).call(e,(e=>void 0!==e.data.end))}},Ce.timeline.components.Group.prototype._redrawItems=function(e,t,i,r){if(this.pwOptions.isRedraw&&(e||this.stackDirty||this.isVisible&&!t)){var n,a,s,o,l,d;let e=this.pwOptions.isHourScale,t=e?"start":"stretchedStart",c=e?"end":"stretchedEnd",h={byStart:re()(n=H()(a=this.orderedItems.byStart).call(a,(e=>!e.isCluster))).call(n,((e,i)=>e.data[t].getTime()-i.data[t].getTime())),byEnd:re()(s=H()(o=this.orderedItems.byEnd).call(o,(e=>!e.isCluster))).call(s,((e,t)=>e.data[c].getTime()-t.data[c].getTime()))},u=this.pwOptions.sortOrderField;this.visibleItems=this._updateItemsInRange(h,H()(l=this.visibleItems).call(l,(e=>!e.isCluster)),r),this.visibleItems=re()(d=this.visibleItems).call(d,((e,t)=>e.data.providerCard[u]-t.data.providerCard[u]));let p=this._pwCustomSort(this.visibleItems);this._pwSetItemsTopBySortOrder(p,i);for(let e=0;e<this.visibleItems.length;e++)this.visibleItems[e].repositionX();this.itemSet.options.cluster&&R()(Ce.util).call(Ce.util,this.items,(e=>{e.cluster&&e.displayed&&e.hide()})),this.stackDirty=!1}},Ce.timeline.components.Group.prototype._pwSetItemsTopBySortOrder=function(e,t){let i=[];for(let r of e){if(r.data.ignoreCollision){r.top=0;continue}let e=H()(i).call(i,(e=>{return e.data.id!==lt&&(i=e,(t=r).pwRawWidth>=0&&i.pwRawWidth>=0&&t.pwRawLeft<i.pwRawLeft+i.pwRawWidth&&i.pwRawLeft<t.pwRawLeft+t.pwRawWidth);var t,i}));e.length>0?r.top=Math.max(...x()(e).call(e,(e=>e.top+e.height+t.item.vertical))):r.top=0,i.push(r)}},Ce.timeline.components.Group.prototype._pwCustomSort=function(e){var t,i;if(e.length<=1)return e;let r=[],n=[],a=this.pwOptions.sortOrderField;function updateItemsSortOrder(e,t){let i=new(M())(t);function isCollide(e,t){return e.pwRawWidth>=0&&t.pwRawWidth>=0&&e.pwRawLeft<t.pwRawLeft+t.pwRawWidth&&t.pwRawLeft<e.pwRawLeft+e.pwRawWidth}function checkCollision(t,r){if(!i.has(r)&&isCollide(t,r)){i.add(r);for(let t of e)checkCollision(r,t)}}for(let i of t)for(let t of e)checkCollision(i,t);let r=[];for(let t of e){if(i.has(t)){let e=H()(r).call(r,(e=>isCollide(e,t)));if(e.length>0){let i=Math.max(...x()(e).call(e,(e=>e.data.providerCard[a])));t.data.providerCard[a]=i+1}else t.data.providerCard[a]=0}r.push(t)}}function getSortedItems(e){var t;return re()(t=new kendo.data.Query(e)).call(t,(0,De.a)("data")).toArray()}e=H()(e).call(e,(e=>e.data.id===ot?(n.push(e),!1):!(e.data.id!==lt&&!(0,we.VH)(e.data.providerType).canSortInScheduler(e.data))||(e.data.providerCard[a]=Number.POSITIVE_INFINITY,r.push(e),!1)));let s=H()(e).call(e,(e=>e.selected&&e.data.positionY));if(1===s.length){if(this.itemSet.touchParams.dragLeftItem||this.itemSet.touchParams.dragRightItem)s[0].data.providerCard[a]!==Number.POSITIVE_INFINITY&&updateItemsSortOrder(e,s);else{let t=s[0],i=function getItemPosition(e){return Math.max(Math.round(e.data.positionY/(e.height+e.options.margin.item.vertical)),0)}(t);if(t.data.providerCard[a]!==i){let r=v()(e).call(e,(e=>e.id===t.id));_()(e).call(e,r,1),updateItemsSortOrder(e,s);let n=v()(e).call(e,(e=>e.data.providerCard[a]===i));_()(e).call(e,-1!==n?n:e.length,0,t),updateItemsSortOrder(e,s)}}}else if(s.length>1){let t=this.pwDragStartTime&&this.pwDragStartTime!==this.itemSet.touchParams.pwDragCurrentTime.getTime(),i=this.itemSet.touchParams.pwLastGroup!==this.itemSet.touchParams.pwOriginalGroup;var o;if(t||i)updateItemsSortOrder(e=I()(o=H()(e).call(e,(e=>!e.selected||!e.data.positionY))).call(o,s),s);this.pwDragStartTime=this.itemSet.touchParams.pwDragCurrentTime.getTime()}let l=[],d=[];for(let t of e)t.data.providerCard[a]===Number.POSITIVE_INFINITY?d.push(t):l.push(t);return[...ae()(t=oe()(de()(i=N().groupBy(l,(e=>e.data.providerCard[a]))).call(i))).call(t,(e=>getSortedItems(e))),...getSortedItems(d),...getSortedItems(r),...n]},Ce.timeline.components.Group.prototype._pwGetLaneSizes=function(){return this.groupId===ke.iF?dt.milestones:dt[this.pwOptions.resourceType]},Ce.timeline.components.TimeAxis.prototype.redraw=function(){var e,t;this._pwPreviousFloatingLabelWidth||(this._pwPreviousFloatingLabelWidth=0);let i=this.props,r=this.dom.foreground,n=this.dom.background,a="top"===this.options.orientation.axis?this.body.dom.top:this.body.dom.bottom,s=r.parentNode!==a,o=Ce.util.convert(this.body.range.start,"Date"),l=Ce.util.convert(this.body.range.end,"Date");this.step=new Ce.timeline.TimeStep(o,l,this.pwOptions.getCurrentRange(),this.body.hiddenDates,this.options),this.body.emitter.emit("pwUpdateScale",{scale:this.step.scale}),this.options.showMajorLabels=null!==getMajorScale(this.step.scale);let d=this.options.showMinorLabels&&"none"!==this.options.orientation.axis,c=this.options.showMajorLabels&&"none"!==this.options.orientation.axis;i.minorLabelHeight=d?28:0,i.majorLabelHeight=c?21:0,c||this.step.scale===be.Uh.Day?r.classList.remove("timeline-foreground--high-minor-labels"):(i.minorLabelHeight+=21,r.classList.add("timeline-foreground--high-minor-labels"));let h=i.height;i.height=i.minorLabelHeight+i.majorLabelHeight,i.width=r.offsetWidth,i.minorLineHeight=this.body.domProps.left.height,i.minorLineWidth=1,i.majorLineHeight=i.minorLineHeight,i.majorLineWidth=1;let u=r.nextSibling,p=n.nextSibling;if(null===(e=r.parentNode)||void 0===e||e.removeChild(r),null===(t=n.parentNode)||void 0===t||t.removeChild(n),r.style.height=`${this.props.height}px`,this._repaintLabels(),u?a.insertBefore(r,u):a.appendChild(r),p?this.body.dom.backgroundVertical.insertBefore(n,p):this.body.dom.backgroundVertical.appendChild(n),this._pwFloatingLabel){let e=this._pwFloatingLabel.offsetWidth;this._pwIsFloatingLabelChanged=e!==this._pwPreviousFloatingLabelWidth,this._pwPreviousFloatingLabelWidth=e}else this._pwIsFloatingLabelChanged=!1;return this._isResized()||this._pwIsFloatingLabelChanged||s||i.height!==h};Ce.timeline.components.TimeAxis.prototype._repaintLabels=function(){let e=this.options.orientation.axis,t=this.step;t.setMoment(this.options.moment),this.options.format&&t.setFormat(this.options.format),this.options.timeAxis&&t.setScale(this.options.timeAxis);let i,r,n,a=this.dom;a.redundant.lines=a.lines,a.redundant.majorTexts=a.majorTexts,a.redundant.minorTexts=a.minorTexts,a.lines=[],a.majorTexts=[],a.minorTexts=[];let s,o,l=0,d=null,c=0;t.start();let h=t.getCurrent();n=this.body.util.toScreen(h),t.pwIsFloatingLabel=!1;let u=this.pwOptions.isHourScale;for(;t.hasNext()&&c<1e3;){c++;let a=t.isMajor();o=t.getClassName(),i=h,r=n,t.next(),h=t.getCurrent(),n=this.body.util.toScreen(h);let p,m,g=l;if(l=n-r,t.scale===be.Uh.Week)p=!0;else p=l>=.4*g;this.options.showMinorLabels&&p&&(m=this._repaintMinorText(r,t.getLabelMinor(i),e,o),m.style.width=u?"":`${l}px`),a&&this.options.showMajorLabels?(r>0&&(null===d&&t.pwNewMonth&&(d=r),m=this._repaintMajorText(r,t.getLabelMajor(i),e,o),m.style.paddingLeft=u?`${Math.max(8-r,0)}px`:""),s=this._repaintMajorLine(r,l,e,o)):p?s=this._repaintMinorLine(r,l,e,o):s&&(s.style.width=`${he()(s.style.width)+l}px`)}if(this.options.showMajorLabels){t.pwIsFloatingLabel=!0;let i=t.getLabelMajor(this.body.util.toTime(0)),r=0;null!==d&&(r=Math.min(d-this._pwPreviousFloatingLabelWidth,0)),this._pwFloatingLabel=this._repaintMajorText(r,i,e,o),this._pwFloatingLabel.style.paddingLeft=""}R()(Ce.util).call(Ce.util,this.dom.redundant,(e=>{for(;e.length;){var t;let i=e.pop();null==i||null===(t=i.parentNode)||void 0===t||t.removeChild(i)}}))};const Pt=Ce.timeline.components.TimeAxis.prototype._repaintMajorLine;Ce.timeline.components.TimeAxis.prototype._repaintMajorLine=function(e,t,i,r){r.expandPreviousLabel&&this._pwPreviousLabel&&(this._pwPreviousLabel.style.width=`${t+this._pwPreviousWidth}px`);let n=Pt.call(this,e,t,i,r.className);return n.style.top=`${this.props.height}px`,n};const Rt=Ce.timeline.components.TimeAxis.prototype._repaintMajorText;Ce.timeline.components.TimeAxis.prototype._repaintMajorText=function(e,t,i,r){return Rt.call(this,e,t,i,r.className)};const Lt=Ce.timeline.components.TimeAxis.prototype._repaintMinorLine;Ce.timeline.components.TimeAxis.prototype._repaintMinorLine=function(e,t,i,r){this._pwPreviousLabel=this._pwCurrentLabel,this._pwPreviousWidth=t;let n=Lt.call(this,e,t,i,r.className);return n.style.top=`${this.props.height}px`,n};const Nt=Ce.timeline.components.TimeAxis.prototype._repaintMinorText;Ce.timeline.components.TimeAxis.prototype._repaintMinorText=function(e,t,i,r){let n=Nt.call(this,e,t.html,i,r.className);return this._pwCurrentLabel=n,t.tooltip&&(n.title=t.tooltip),n};const Ot=Ce.timeline.Core.prototype._create;Ce.timeline.Core.prototype._create=function(e){Ot.call(this,e),this.dom.pwLeftTop=document.createElement("div"),this.dom.root.appendChild(this.dom.pwLeftTop),this.dom.pwLeftTop.className="timeline-left-top";let t=document.createElement("div");t.className="timeline-left-top-content",this.pwOptions.leftTopContent&&t.appendChild(this.pwOptions.leftTopContent),this.dom.pwLeftTop.appendChild(t),this.dom.pwLeftTopShadow=document.createElement("div"),this.dom.pwLeftTop.appendChild(this.dom.pwLeftTopShadow),this.dom.pwLeftTopShadow.className="timeline-left-top-shadow",this.dom.pwShadowLeft=document.createElement("div"),this.dom.root.appendChild(this.dom.pwShadowLeft),this.dom.pwShadowLeft.className="timeline-shadow-left",this.dom.pwLeftTop.addEventListener($e,(e=>e.stopPropagation()),!0),this.dom.pwBottomScrollRange=document.createElement("div"),this.dom.pwBottomScrollRange.className="timeline-content",this.dom.bottom.appendChild(this.dom.pwBottomScrollRange),this.pwOptions.leftResizer&&this.dom.leftContainer.appendChild(this.pwOptions.leftResizer);let i=!1;const r=_e()((()=>{i=!1,this.body&&this.dom&&ve()(this.body.dom.center).removeClass("timeline-content--scrolling")}),200);this.dom.bottom.addEventListener("scroll",(()=>{if(!this.body||!this.dom)return;i||(i=!0,ve()(this.body.dom.center).addClass("timeline-content--scrolling")),r();const applyRange=(e,t)=>{this.range._applyRange(e.getTime(),t.getTime()),this.body.emitter.emit("rangechange",{start:e,end:t,byUser:!0}),this.range.pwIsScrollbarUsed=!0};let e=this.dom.bottom.scrollLeft-this.props.bottom.pwScrollBase;if(Math.abs(e)<10)return this.dom.bottom.scrollLeft=this.props.bottom.pwScrollBase,void(this._pwScrollStartDates&&applyRange(new Date(this._pwScrollStartDates.start),new Date(this._pwScrollStartDates.end)));e*=this.pwOptions.getCurrentRange(),this._pwScrollStartDates||(this._pwScrollStartDates={start:this.range.start,end:this.range.end}),applyRange(this.pwOptions.getShiftedDate(this._pwScrollStartDates.start,e),this.pwOptions.getShiftedDate(this._pwScrollStartDates.end,e))})),this.dom.bottom.addEventListener("pointerdown",(e=>this.dom.bottom.setPointerCapture(e.pointerId))),this.dom.bottom.addEventListener("pwMouseUp",(()=>{this.dom.bottom.scrollLeft=this.props.bottom.pwScrollBase,this._pwScrollStartDates=null})),this.dom.bottom.addEventListener("wheel",(e=>{e.shiftKey&&e.preventDefault()})),this.dom.pwRightTop=document.createElement("div"),this.dom.root.appendChild(this.dom.pwRightTop),this.dom.pwRightTop.className="timeline-right-top";let n=document.createElement("div");n.className="timeline-right-top-content",this.pwOptions.rightTopContent&&n.appendChild(this.pwOptions.rightTopContent),this.dom.pwRightTop.appendChild(n),this.dom.pwRightTop.addEventListener($e,(e=>e.stopPropagation()),!0),this.on("_pwVerticalScroll",(e=>{this._setScrollTop(this.props.scrollTop-e.delta)}));const a=_e()((()=>this.body.emitter.emit("pwScroll",{by:"wheel"})),200);this.dom.centerContainer.addEventListener("wheel",(e=>{let t;if(e.shiftKey)t=e.deltaY;else{if(Math.abs(e.deltaY)>=Math.abs(e.deltaX))return;t=e.deltaX}0!==t&&(e.stopPropagation(),e.preventDefault(),a(),this.range.pwScrollByRelativeUnit(t/1500,{byUser:!0,event:e}))}),!0),this.dom.leftContainer.addEventListener("wheel",(e=>{let t=new WheelEvent(e.type,e);this.dom.centerContainer.dispatchEvent(t),t.defaultPrevented&&e.preventDefault(),e.stopPropagation()}),!0),this._pwSavedScrollTop=this.pwOptions.scrollTop.load(),this.on("mouseDown",(e=>{(1===e.event.button||0===e.event.button&&isCtrlPressed(e.event))&&(this._pwVerticalScrollOn=!0)})),this.on("pan",(e=>{e.eventType!==Ce.Hammer.INPUT_END&&e.eventType!==Ce.Hammer.INPUT_CANCEL||(this._pwVerticalScrollOn=!1)}))},Ce.timeline.Core.prototype._redraw=function(){var e;this.redrawCount++;let t=!1,i=this.options,r=this.props,n=this.dom;if(!n||!n.container||0===n.root.offsetWidth)return void(this.redrawCount=0);Ce.timeline.DateUtil.updateHiddenDates(this.options.moment,this.body,this.options.hiddenDates),"top"===i.orientation?(Ce.util.addClassName(n.root,"timeline-top"),Ce.util.removeClassName(n.root,"timeline-bottom")):(Ce.util.removeClassName(n.root,"timeline-top"),Ce.util.addClassName(n.root,"timeline-bottom")),n.root.style.maxHeight=Ce.util.option.asSize(i.maxHeight,""),n.root.style.minHeight=Ce.util.option.asSize(i.minHeight,""),n.root.style.width=Ce.util.option.asSize(i.width,""),r.border.left=0,r.border.right=0,r.border.top=0,r.border.bottom=0,r.borderRootHeight=n.root.offsetHeight-n.root.clientHeight,r.borderRootWidth=n.root.offsetWidth-n.root.clientWidth,0===n.centerContainer.clientHeight&&(r.border.left=r.border.top,r.border.right=r.border.left),0===n.root.clientHeight&&(r.borderRootWidth=r.borderRootHeight),r.center.height=n.center.offsetHeight,r.left.height=n.left.offsetHeight,r.right.height=n.right.offsetHeight,r.top.height=n.top.clientHeight||-r.border.top,r.bottom.height=n.bottom.offsetHeight||-r.border.bottom,r.bottom.pwScrollBase=Math.floor((n.bottom.scrollWidth-n.bottom.clientWidth)/2);let a=r.pwContentHeight||Math.max(r.left.height,r.center.height,r.right.height),s=r.top.height+a+r.bottom.height+r.borderRootHeight+r.border.top+r.border.bottom;n.root.style.height=Ce.util.option.asSize(i.height,`${s}px`),r.root.height=n.root.offsetHeight,r.background.height=r.root.height-r.borderRootHeight;let o=r.root.height-r.top.height-r.bottom.height-r.borderRootHeight;r.centerContainer.height=o,r.leftContainer.height=o,r.rightContainer.height=r.leftContainer.height,r.root.width=n.root.offsetWidth,r.background.width=r.root.width-r.borderRootWidth,this.initialDrawDone||(r.scrollbarWidth=Ce.util.getScrollBarWidth()),i.verticalScroll?i.rtl?(r.left.width=n.leftContainer.clientWidth+r.scrollbarWidth||-r.border.left,r.right.width=n.rightContainer.clientWidth||-r.border.right):(r.left.width=n.leftContainer.clientWidth||-r.border.left,r.right.width=r.scrollbarWidth+1||-r.border.right):(r.left.width=n.leftContainer.clientWidth||-r.border.left,r.right.width=n.rightContainer.clientWidth||-r.border.right),this._setDOM();let l=this._updateScrollTop();if("top"!==i.orientation.item&&(l+=Math.max(r.centerContainer.height-r.center.height-r.border.top-r.border.bottom,0)),n.shadowTop.style.visibility="hidden",n.shadowBottom.style.visibility="hidden",n.shadowTopLeft.style.visibility="hidden",n.shadowBottomLeft.style.visibility="hidden",n.shadowTopRight.style.visibility="hidden",n.shadowBottomRight.style.visibility="hidden",n.pwLeftTop.style.width=`${r.left.width}px`,n.pwLeftTop.style.height=`${r.top.height}px`,n.pwLeftTopShadow&&(this.pwOptions.resourceType!==be.y.NoResources?n.pwLeftTopShadow.style.display="none":n.pwLeftTopShadow.style.display=""),n.pwShadowLeft&&(this.pwOptions.resourceType!==be.y.NoResources?(n.pwShadowLeft.style.display="",n.pwShadowLeft.style.width=`${r.left.width+8}px`,n.pwShadowLeft.style.height=`${r.root.height}px`):n.pwShadowLeft.style.display="none"),n.pwRightTop.style.height=`${r.top.height}px`,!this.range.animationTimer){let e=this.pwOptions.getNewRange();e&&(this.range.props.touch.dragging?(this.range.props.touch.pwVisibleRange=e.scale,this.range.props.touch.needFinalDrag=!0):this.range.setRange(e.start,e.end,{animation:!1,byUser:!1}))}let d=r.center.height>r.centerContainer.height;this.hammer.get("pan").set({direction:d?Ce.Hammer.DIRECTION_ALL:Ce.Hammer.DIRECTION_HORIZONTAL});let c=r.leftContainer.width>ke.J4;if(this.itemSet.groupIds.length){r.pwContentHeight=0;let e=this.itemSet.groupIds[this.itemSet.groupIds.length-1],t=-l;for(let i of this.itemSet.groupIds){let n=this.itemSet.groups[i];n.props.pwHeightToBottom=i===e?r.centerContainer.height-r.pwContentHeight-1:0,r.pwContentHeight+=n.props.pwContentHeight,n.props.pwIsResourcePanelWide=c,this.pwOptions.holdMilestones&&i===ke.iF?n.props.pwYOffset=0:(n.props.pwYOffset=-t,n.props.pwContentHeight>t?(n.props.pwIsFirstVisible=t>0,t=0):(n.props.pwIsFirstVisible=!1,t-=n.props.pwContentHeight))}i.verticalScroll&&(n.right.style.height=`${r.pwContentHeight}px`)}if(i.verticalScroll&&(n.rightContainer.className="timeline-panel timeline-right timeline-vertical-scroll",n.leftContainer.className="timeline-panel timeline-left"),(!i.verticalScroll||r.pwContentHeight<=r.centerContainer.height)&&(n.leftContainer.classList.remove("timeline-vertical-scroll"),n.rightContainer.classList.remove("timeline-vertical-scroll")),n.leftContainer.classList.toggle("timeline-left--wide",c),R()(e=this.components).call(e,(e=>{t=e.redraw()||t})),!t&&this._pwSavedScrollTop&&(this._setScrollTop(this._pwSavedScrollTop),this._pwSavedScrollTop=null,t=!0),t&&(n.pwBottomScrollRange.style.width=3*r.bottom.width+"px",this.redrawCount<10))return void this.body.emitter.emit("_change");this._pwScrollStartDates||(n.bottom.scrollLeft=r.bottom.pwScrollBase),this.itemSet.pwRefreshDependencyCreateControl(),this.itemSet.pwLinkPlotter.redraw(this.range.start,this.range.end,this.pwOptions.isDetailedView),this.redrawCount=0,this.pwMinorTicks=[];let h,u=Ce.util.convert(this.body.range.start,"Date"),p=Ce.util.convert(this.body.range.end,"Date"),m=new Ce.timeline.TimeStep(u,p,this.pwOptions.getCurrentRange(),[],{showMajorLabels:!1}),g=!0;for(m.start();g;)g=m.hasNext(),h=m.getCurrent().toDate(),m.scale===be.Uh.Hour&&this.pwMinorTicks.push((0,Me.mH)(h,-30)),this.pwMinorTicks.push(h),m.next();m.scale===be.Uh.Hour&&this.pwMinorTicks.push((0,Me.mH)(h,30)),this.initialRangeChangeDone=!0,this.body.emitter.emit("changed")},Ce.timeline.Core.prototype._updateScrollTop=function(){let e=Math.min(Math.ceil(this.props.centerContainer.height-(this.props.pwContentHeight||0)),0);return e!==this.props.scrollTopMin&&("top"!==this.options.orientation.item&&(this.props.scrollTop+=e-this.props.scrollTopMin),this.props.scrollTopMin=e),this.props.scrollTop>0&&(this.props.scrollTop=0),this.props.scrollTop<e&&(this.props.scrollTop=e),this.dom&&this.options.verticalScroll&&(this.dom.right.parentNode.scrollTop=-this.props.scrollTop),this.pwOptions.scrollTop.save(this.props.scrollTop),this.props.scrollTop},Ce.timeline.Core.prototype._onDrag=function(e){if(!this._pwVerticalScrollOn)return void this.hammer.stop(!0);if(!e||!this.touch.allowDragging)return;const t=this._getScrollTop();this._setScrollTop(this.touch.initialScrollTop+e.deltaY)!==t&&this.emit("verticalDrag")},Ce.timeline.components.CurrentTime.prototype._create=function(){let e=document.createElement("div");e.className="timeline-current-time",this.bar=e;let t=document.createElement("div");t.className="timeline-current-time-bullet",e.appendChild(t),this.pwBullet=t;let i=document.createElement("div");i.className="timeline-current-time-label",t.appendChild(i),this.pwLabel=i},Ce.timeline.components.CurrentTime.prototype.redraw=function(){if(this.options.showCurrentTime){let i=this.body.itemSet.dom.background;var e;if(this.bar.parentNode!==i)null===(e=this.bar.parentNode)||void 0===e||e.removeChild(this.bar),i.appendChild(this.bar),this.start();let r=this.body.dom.backgroundVertical;var t;if(this.pwBullet.parentNode!==r)null===(t=this.pwBullet.parentNode)||void 0===t||t.removeChild(this.pwBullet),r.appendChild(this.pwBullet);let n=this.options.moment((new Date).valueOf()+this.offset);this.pwLabel.textContent=kendo.toString(n.toDate(),"ts2"),this.options.alignCurrentTime&&(n=n.startOf(this.options.alignCurrentTime));let a=Math.round(this.body.util.toScreen(n));this.options.rtl?(this.bar.style.right=`${a+1}px`,this.pwBullet.style.right=a-1+"px"):(this.bar.style.left=a-1+"px",this.pwBullet.style.left=a-1+"px"),this.pwBullet.style.top=this.body.domProps.top.height-1+"px"}else{var i,r;null===(i=this.bar.parentNode)||void 0===i||i.removeChild(this.bar),null===(r=this.pwBullet.parentNode)||void 0===r||r.removeChild(this.pwBullet),this.stop()}return!1},Ce.timeline.components.CurrentTime.prototype.start=function(){const update=()=>{this.stop(),this.redraw(),this.body.emitter.emit("currentTimeTick"),this.currentTimeTimer=q()(update,1e3)};update()},Ce.Timeline.prototype.fit=()=>{};const Mt={autoResize:!1,orientation:"top",align:"left",rtl:!1,clickToUse:!1,showMajorLabels:!0,groupEditable:{order:!0},itemsAlwaysDraggable:{item:!0,range:!0},selectable:!0,multiselect:!0,showTooltips:!1,type:"range",verticalScroll:!0,horizontalScroll:!1,height:"100%",maxHeight:"100%",zoomKey:"ctrlKey",margin:{item:{horizontal:Te.$s,vertical:Te.C4},axis:0}},$t=!1,xt=S()('\n<div class="timeline-label-text">\n    #= data.time #\n</div>\n').call('\n<div class="timeline-label-text">\n    #= data.time #\n</div>\n'),Bt=S()('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__weekday">\n        #= data.weekDay #\n    </div>\n    <div class="timeline-label-text__date">\n        #= data.date #\n    </div>\n</div>\n').call('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__weekday">\n        #= data.weekDay #\n    </div>\n    <div class="timeline-label-text__date">\n        #= data.date #\n    </div>\n</div>\n'),Ht=S()('\n<div class="timeline-label-text timeline-label-text--high">\n    # if (data.weekNumber) { #\n    <div class="timeline-label-text__week-number">\n        #= data.weekNumber #\n    </div>\n    # } #\n    # if (data.month) { #\n    <div class="timeline-label-text__month #= data.monthClass #">\n        #= data.month #\n    </div>\n    # } #\n</div>\n').call('\n<div class="timeline-label-text timeline-label-text--high">\n    # if (data.weekNumber) { #\n    <div class="timeline-label-text__week-number">\n        #= data.weekNumber #\n    </div>\n    # } #\n    # if (data.month) { #\n    <div class="timeline-label-text__month #= data.monthClass #">\n        #= data.month #\n    </div>\n    # } #\n</div>\n'),Ut=S()('\n<div class="timeline-label-text">\n    #= data.week #\n    <div class="timeline-label-text__week">\n        #= data.weekNumber #\n    </div>\n</div>\n').call('\n<div class="timeline-label-text">\n    #= data.week #\n    <div class="timeline-label-text__week">\n        #= data.weekNumber #\n    </div>\n</div>\n'),Ft=S()('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__month">\n        #= data.month #\n    </div>\n</div>\n').call('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__month">\n        #= data.month #\n    </div>\n</div>\n'),Wt=S()('\n<div class="timeline-label-text">\n    #= data.quarter #\n    <div class="timeline-label-text__quarter">\n        #= data.quarterNumber #\n    </div>\n</div>\n').call('\n<div class="timeline-label-text">\n    #= data.quarter #\n    <div class="timeline-label-text__quarter">\n        #= data.quarterNumber #\n    </div>\n</div>\n'),zt=S()('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__year">\n        #= data.year #\n    </div>\n</div>\n').call('\n<div class="timeline-label-text">\n    <div class="timeline-label-text__year">\n        #= data.year #\n    </div>\n</div>\n'),Gt=kendo.template(xt,{useWithBlock:!1}),jt=kendo.template(Bt,{useWithBlock:!1}),Vt=kendo.template(Ht,{useWithBlock:!1}),Kt=kendo.template(Ut,{useWithBlock:!1}),Yt=kendo.template(Ft,{useWithBlock:!1}),qt=kendo.template(Wt,{useWithBlock:!1}),Zt=kendo.template(zt,{useWithBlock:!1}),Xt=kendo.template('\n<div\n    data-uid="#= data.id #"\n    class="k-event pw-card pw-card--day-slot #= data.isMilestoneCreateHint ? \'pw-card--milestone-create-hint\' : \'\' #"\n>\n    <div class="pw-card__content">\n        <div class="pw-card__title">#= data.title #</div>\n    </div>\n\n    <div class="pw-card__border"></div>\n</div>\n',{useWithBlock:!1});class SchedulerTimelineView extends kendo.ui.TimelineView{constructor(e,t){var i,r,n;if(super(e,t),this._isDetailedView=this.options.showCalendar||this.options.showList||this.options.showDates||this.options.showEstimatedHours||this.options.showTrackedHours||this.options.showCheckItems,this.name=this.options.viewName,this._groupsResourceName=this.options.group.resources[0],this._groupsResource=pe()(i=this.options.resources).call(i,(e=>e.name===this._groupsResourceName)),!this._groupsResource)throw new Error(`Cannot find ${this._groupsResourceName} resources description`);let a=null;this._currentTimelineScale=Math.floor(this.getScale()/Qe),this._workWeek=this._appCommonSrv.getSchedulerWorkWeek(),this._isCreateCardHintDisabled=this._settingsSrv.user.global.settings.isCreateCardTipPassed;let s={},o=document.createElement("div");o.style.position="absolute",o.style.left=0,o.style.top=0,o.style.width=0,o.style.height=0,o.style.overflow="hidden";let l=this.options.$scope.$new(),d={leftTopContent:this.options.leftTopContent[this._groupsResourceName],rightTopContent:this.options.rightTopContent[this._groupsResourceName],leftResizer:this._groupsResourceName!==be.y.NoResources?this._htmlHelperSrv.compileHtml('\n<div\n    class="pw-timeline-left-resizer-handle"\n    pw-resizer="horizontal"\n    resizable-content=".timeline-left"\n    content-position="left"\n    resizer-class="pw-timeline-left-resizer"\n    initial-size="initialWidth"\n    size-min="\'90px\'"\n    size-max="\'360px\'"\n    on-resize="onResize(newSize)"\n></div>\n',l,!1):null,resourceLabelWidth:this._collectionSettings.local.settings.resourcePanelWidth-6,holdMilestones:!1,workWeekStart:this.options.workWeekStart,workDays:this._workDays,isWorkDay:te()(r=this._isWorkDay).call(r,this),workDayStart:this.options.workDayStart.getHours(),workDayEnd:this.options.workDayEnd.getHours()+(this.options.workDayEnd.getMinutes()>0?1:0),resourceType:this._groupsResourceName,resources:this._groupsResource,sortOrderField:this._groupsResource.cardSortOrderField,isDetailedView:this._isDetailedView,showWeekNumbers:this.options.showWeekNumbers,isWeekendsHidden:this.options.showWorkDays,setEventTimes:te()(n=this._setEventTimes).call(n,this),getMilestoneWidth:e=>{let t=s[e.data.id];if(!t||t.content!==e.content||t.isDetailedView!==this._isDetailedView){var i;let r=null===(i=t)||void 0===i?void 0:i.element[0];r||(r=document.createElement("div"),r.className="timeline-item timeline-range pw-milestone",r.style.width=0),r.innerHTML=e.content;let n=r.firstElementChild;n&&(n.classList.add("pw-js-size-measurement"),this._isDetailedView?n.classList.remove("pw-card--small"):n.classList.add("pw-card--small")),o.appendChild(r),t={content:e.content,element:ve()(r),isDetailedView:this._isDetailedView},s[e.data.id]=t}if(!t.width){let i,r=t.element.children(".k-event");if(!r[0])return 0;let n="pw-card";if(!r.hasClass(n))return 0;let a=r.children(".pw-card__content"),s=a.children(".pw-card__title")[0],o=a.children(".pw-card__icons")[0];if(this._isDetailedView){let e=a.children(".pw-card__details")[0];if(!e)return 0;i=s.scrollWidth;let t=e.scrollWidth;o&&(t+=o.scrollWidth+6),i=Math.max(i,t)+16}else{let t=r.children(".pw-js-card-time-short")[0];i=s.scrollWidth+16,t&&e.data.timeShortText&&(i+=t.scrollWidth+4),o&&(i+=o.scrollWidth+6)}t.width=Math.max(100,Math.min(200,i))}return t.width},getShiftedDate:(e,t)=>(0,Me.Pe)(e,t,this._workWeek),getDateDistance:(e,t)=>(0,Me.bt)(e,t,this._workWeek).ms,getCurrentRange:()=>this._currentTimelineScale,isHourScale:!1,getNewRange:()=>{let e=this._visTimeline.props.centerContainer.width;return e===a?null:(a=e,this._visTimeline.range.options.zoomMin=this._transformScale(nt),this._visTimeline.range.options.zoomMax=this._transformScale(at),this._getRangeBySelectedDate(this.selectedDate,this._currentTimelineScale))},scrollTop:{save:e=>this.options.$scope._timelineScrollTop=e,load:()=>this.options.$scope._timelineScrollTop}};Ce.timeline.Core.prototype.pwOptions=d,Ce.timeline.TimeStep.prototype.pwOptions=d,Ce.timeline.components.items.Item.prototype.pwOptions=d,Ce.timeline.Range.prototype.pwOptions=d,Ce.timeline.components.TimeAxis.prototype.pwOptions=d,Ce.timeline.components.Group.prototype.pwOptions=d,Ce.timeline.components.ItemSet.prototype.pwOptions=d,l.initialWidth=`${d.resourceLabelWidth+6}px`,l.onResize=e=>{d.resourceLabelWidth=e-6,this._collectionSettings.local.settings.resourcePanelWidth>ke.J4!=e>ke.J4&&this._telemetrySrv.logSessionEvent(be.cN.CalendarEvents.TimelineResourcePanelResized,{resourcePanelWidth:e}),this._collectionSettings.local.settings.resourcePanelWidth=e,this._collectionSettings.local.save(),this._visTimeline.dom.pwLeftTop&&(this._visTimeline.dom.pwLeftTop.style.minWidth=`${e}px`),this._visTimeline.redraw()};const c=kendo.template(ze,{useWithBlock:!1});let h,u=new(N());switch(this._groupsResourceName){case be.y.NoResources:h="<div></div>";break;case be.y.Members:case be.y.GitHubAssignees:h=Ge;break;case be.y.Calendars:h=je;break;case be.y.Lists:h=Ve;break;case be.y.GitHubStatuses:h=Ke;break;case be.y.Labels:case be.y.GitHubLabels:h=Ye}const p=kendo.template(h,{useWithBlock:!1});this._workWeek=this.options.showWorkDays?{start:this.options.workWeekStart,end:this.options.workWeekEnd}:null;let m=kendo.culture();if(this._timelineOptions=_objectSpread(_objectSpread({},Mt),{},{locale:m.name,format:{minorLabels:(e,t)=>({html:timeLabelFormat(e,t,m),tooltip:t===be.Uh.Day?kendo.toString(e.toDate(),"D"):null}),majorLabels:(e,t)=>{if(t.scale!==be.Uh.Day){let i=getMajorScale(t.scale);return i?timeLabelFormat(e,i,m):""}let i=null,r=null;return t.pwIsFloatingLabel?r=kendo.toString(e.toDate(),"MMMM"):(this.options.showWeekNumbers&&t.pwNewWeek&&(i=kendo.date.weekInYear(e.toDate(),m.calendar.firstDay)),t.pwNewMonth&&(r=kendo.toString(e.toDate(),"MMMM"))),Vt({weekNumber:i,month:r,monthClass:this.options.showWeekNumbers?"timeline-label-text__month--high":""})}},groupTemplate:e=>{if(!e)return;let t=e[this._groupsResource.dataValueField],i=t===ke.iF&&this._groupsResourceName!==be.y.NoResources,r=i?c:p,n=ve()(r(e)),hoverHandler=()=>{n.on("click",".pw-js-remove-resource",(()=>{let t={};i?t.isMilestones=!0:t.resource=e,this.options.$scope.$broadcast(be.FK.TimelineResourceRemoveRequested,t)}));let r=pe()(n).call(n,".pw-timeline-resource__hide-btn");r.removeAttr("style");let a=u.get(t);a&&a.$destroy(),a=this._htmlHelperSrv.compileElement(n,this.options.$scope,!0),a.$evalAsync(),u.set(t,a),e.$scope=a,q()((()=>{r.is(":hover")&&r.trigger("mouseenter")}))};return i||e.id===ke.$d?hoverHandler():n.one("mouseenter",hoverHandler),n[0]},template:(e,t,i)=>{if(i)return"background"===i.type?"":i.id===ot?Xt(i):(0,Te.$R)(i)},editable:{updateTime:!0,updateGroup:!0},onMoving:(e,t)=>{!(0,we.VH)(e.providerType).canStartMoveInScheduler(e)||e.start>e.end?t(null):t(e)},onMove:(e,t)=>{e.className="",t(e)},maxMinorChars:10}),this.options.showWorkDays){let e=(0,Me.E4)((0,Me.sD)(new Date,this.options.workWeekEnd),1),t=(0,Me.tE)(e,this.options.workWeekStart);(0,Me.rs)(e,t)||(this._timelineOptions.hiddenDates={start:e,end:(0,Me.E4)(t,7),repeat:"weekly"})}this._initTimelineDataSource(),this._initTimeline(),this.content=pe()(e).call(e,".timeline-content"),this._isDetailedView&&pe()(e).call(e,".timeline-timeline").addClass("timeline-timeline--detailed-card-view"),this._visTimeline.dom.root.appendChild(o),this._rangeHighlight={id:lt,type:"background",ignoreCollision:!0,className:"pw-scheduler-range-highlight",style:"pointer-events: none;",clone(){return _objectSpread({},this)}},this._cleanListeners=()=>{for(let e of de()(u).call(u))e.$destroy();l.$destroy()}}get _$translate(){return this._$translateLazy||(this._$translateLazy=De.K.$injector.get("$translate")),this._$translateLazy}get _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=De.K.$injector.get("appCommonSrv")),this._appCommonSrvLazy}get _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=De.K.$injector.get("collectionSrv")),this._collectionSrvLazy}get _htmlHelperSrv(){return this._htmlHelperSrvLazy||(this._htmlHelperSrvLazy=De.K.$injector.get("htmlHelperSrv")),this._htmlHelperSrvLazy}get _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=De.K.$injector.get("licenseSrv")),this._licenseSrvLazy}get _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=De.K.$injector.get("settingsSrv")),this._settingsSrvLazy}get _telemetrySrv(){return this._telemetrySrvLazy||(this._telemetrySrvLazy=De.K.$injector.get("telemetrySrv")),this._telemetrySrvLazy}get _calendarCardsSrv(){return this._calendarCardsSrvLazy||(this._calendarCardsSrvLazy=De.K.$injector.get("calendarCardsSrv")),this._calendarCardsSrvLazy}get isTimeAvailable(){return!1}get isScaleAvailable(){return!0}get isHideWeekendsAvailable(){return!0}get selectedDate(){if(!this._selectedDate){var e;let t=null===(e=this._schedulerWidget)||void 0===e?void 0:e.date();t=!t||(0,Me.KC)(t,new Date)?new Date:(0,Me.nT)(t),this.selectedDate=this.currentScaleUnit===be.Uh.Hour?(0,Me.dH)(t):(0,Me.$Y)(t)}return this._selectedDate}set selectedDate(e){this._selectedDate&&(0,Me.rs)(this._selectedDate,e)||(this.options.$scope.$emit(be.FK.ScrollSchedulerViewRequested,{scrollToDate:e,navigationMode:be.vt.Internal}),this._selectedDate=e,this.options.$scope.$evalAsync((()=>{this._schedulerWidget.date(e)})))}isVisibleDate(e){let{start:t,end:i}=this._visTimeline.getWindow();return(0,Me.mh)(e,t,i)}get navigationActions(){if(!this._navigationActions)switch(this.currentScaleUnit){case be.Uh.Hour:this._navigationActions={leftActions:[{type:be.Lo.PreviousHour,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.HOUR_BACKWARD"}],rightActions:[{type:be.Lo.NextHour,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.HOUR_FORWARD"}]};break;case be.Uh.Day:this._navigationActions={leftActions:[{type:be.Lo.PreviousDay,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.DAY_BACKWARD"}],rightActions:[{type:be.Lo.NextDay,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.DAY_FORWARD"}]};break;case be.Uh.Week:this._navigationActions={leftActions:[{type:be.Lo.PreviousWeek,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.WEEK_BACKWARD"}],rightActions:[{type:be.Lo.NextWeek,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.WEEK_FORWARD"}]};break;case be.Uh.Month:this._navigationActions={leftActions:[{type:be.Lo.PreviousMonth,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.MONTH_BACKWARD"}],rightActions:[{type:be.Lo.NextMonth,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.MONTH_FORWARD"}]};break;case be.Uh.Quarter:this._navigationActions={leftActions:[{type:be.Lo.PreviousQuarter,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.QUARTER_BACKWARD"}],rightActions:[{type:be.Lo.NextQuarter,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.QUARTER_FORWARD"}]};break;case be.Uh.Year:this._navigationActions={leftActions:[{type:be.Lo.PreviousYear,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.YEAR_BACKWARD"}],rightActions:[{type:be.Lo.NextYear,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.YEAR_FORWARD"}]}}return this._navigationActions}get currentScaleUnit(){return this._currentScaleUnit||timelineScaleToScaleUnit(this._currentTimelineScale*Qe)}set currentScaleUnit(e){var t;let i,r=null===(t=this._visTimeline)||void 0===t?void 0:t.range;if(!r)return;switch(e){case be.Uh.Hour:i=nt;let t=new Date;this.selectedDate=(0,Me.KC)(this.selectedDate,t)?(0,Me.dH)(t):(0,Me.nT)(this.selectedDate);break;case be.Uh.Day:i=be.F6.DayDefault/Qe;break;case be.Uh.Week:i=et;break;case be.Uh.Month:i=tt;break;case be.Uh.Quarter:i=it;break;case be.Uh.Year:i=rt;break;default:throw new Error(`Timeline scale unit ${e} is not supported`)}this._currentTimelineScale=i;let n=this._getRangeBySelectedDate(this.selectedDate,this._currentTimelineScale);r.setRange(n.start,n.end,{animation:$t,byUser:!0,byNavigation:!0,scaleMethod:"selectPredefined"}),this._saveScale()}get contentHeight(){let e=this._visTimeline.body.domProps;return e.top.height+e.center.height}get pwContentHeight(){let e=this._visTimeline.body.domProps;return e.top.height+e.bottom.height+e.pwContentHeight}getClosestVisibleSlot(e){e=(0,Me.$Y)(e);let t,{start:i,end:r}=this._visTimeline.getWindow(),n={start:this.options.workWeekStart,end:this.options.workWeekEnd};t=(0,Me.mh)(e,i,r)?!(0,Me.ET)(e.getDay(),n)&&this.options.showWorkDays?(0,Me.IG)(e,n):(0,Me.$Y)(e):r<e?(0,Me.$Y)(r):new Date(i);let a=this._getSlotByDate(t);if(!a)return{start:e,end:e};const shiftSlotInView=(e,t)=>{let n=this.currentScaleUnit===be.Uh.Hour?Me.TR:Me.E4;return i>t?this._getSlotByDate(n(e.endDate,1)):r<t?this._getSlotByDate(n(e.startDate,-1)):e};let s;switch(this.currentScaleUnit){case be.Uh.Day:return a=shiftSlotInView(a,(0,Me.nT)(a.startDate)),{start:a.startDate,end:a.startDate};case be.Uh.Hour:case be.Uh.Week:case be.Uh.Month:case be.Uh.Quarter:case be.Uh.Year:return s=a.startDate.getTime()+(a.endDate.getTime()-a.startDate.getTime())/2,a=shiftSlotInView(a,new Date(s)),{start:a.startDate,end:a.endDate};default:throw new Error(`Unsupported view scale: ${this.currentScaleUnit}`)}}setCardDragHelper(e){this._visTimeline.itemSet.pwCardDragHelper=e,this._visTimeline.itemSet.pwWorkWeek=this._workWeek}applyPreviousViewOptions(e){if((null==e?void 0:e.name)===be.rW.Timeline){this._selectedDate=e.selectedDate,this._currentScaleUnit=e.currentScaleUnit;let t=this.currentScaleUnit===be.Uh.Hour;this._visTimeline.pwOptions.isHourScale=t,this._visTimeline.currentTime.setOptions({showCurrentTime:t})}}addEventListener(e,t){this._visTimeline.on(e,(e=>t(e.event)))}startDate(){let e=this._getRangeBySelectedDate(this.selectedDate,this._currentTimelineScale),t=Math.max(400*this._currentTimelineScale,st);return new Date(e.start.getTime()-t)}endDate(){let e=this._getRangeBySelectedDate(this.selectedDate,this._currentTimelineScale),t=Math.max(400*this._currentTimelineScale,st);return new Date(e.end.getTime()+t)}getCardCreateDefaultSlots(e,t){if(!e.element.hasClass("timeline-group"))return;let i=_objectSpread({},e);return this.currentScaleUnit===be.Uh.Hour&&(i.endDate=(0,Me.mH)(e.startDate,t)),{firstSlot:i,lastSlot:i}}getNewCardSortOrder(e,t){let i=0;return e.element.children().each(((r,n)=>{var a;let s=null===(a=n["timeline-item"])||void 0===a?void 0:a.data;if(!s||s.isTempCard||(0,Me.$Y)(s.start)>t.endDate||(0,Me.$Y)(s.end)<e.startDate)return;let o=s.providerCard[this._groupsResource.cardSortOrderField]+1;i<o&&(i=o)})),i}getCardSortOrderField(){return this._groupsResource.cardSortOrderField}getResourceIdByCell(e){if(e.hasClass("timeline-group"))return e[0]["timeline-group"].groupId}updateRangeHighlight(e,t,i){var r;let n=!1,a=null===(r=this._visCardsDataSource.get(this._rangeHighlight.id))||void 0===r?void 0:r.clone();a||(a=this._rangeHighlight.clone(),n=!0),a[this._cardIdField]=a.id,a.isAllDay=e.isDaySlot,a.start=e.startDate<t.startDate?e.startDate:t.startDate,a.end=e.endDate>t.endDate?e.endDate:t.endDate,a.providerType=i.providerType,a.providerCard={[this._groupsResource.cardSortOrderField]:Number.POSITIVE_INFINITY},a.cardRole=i.cardRole,a.cardType=i.cardType;let s=(0,Me._M)(t.resources,this._groupsResource.field,this._groupsResource.defaultFieldValue),o=this._groupsResource.multiple?s[0]:s;a.group=o,(0,Me.iA)(a,this._groupsResource.field,s),adjustEventForView(a),n?(this._visCardsDataSource.add([a],"ignore"),this._removeCreateCardHint()):this._visCardsDataSource.update([a],"ignore")}removeRangeHighlight(){this._visCardsDataSource.remove(this._rangeHighlight.id)}updateCreateCardPreview(e,t,i){var r;let{accountId:n,providerType:a,calendarId:s,cardType:o,cardRole:l}=i,d=e.startDate<t.startDate?e.startDate:t.startDate,c=e.endDate>t.endDate?e.endDate:t.endDate,h=!1,u=this._createCardPreview&&(null===(r=this._visCardsDataSource.get(this._createCardPreview.id))||void 0===r?void 0:r.clone());if(u)u.start=d,u.end=c;else{let t=this.options.$ctrl.getPreviewCard({accountId:n,providerType:a,calendarId:s,cardType:o,cardRole:l,isAllDay:e.isDaySlot,start:d,end:c});u=this.options.dataSource._createNewModel(t),u.$ctrl=this.options.$ctrl,u.ignoreCollision=!0,u[this._cardIdField]=t.id,this._createCardPreview=u,h=!0}u.realStart=u.start,u.realEnd=u.end;let p=(0,Me._M)(t.resources,this._groupsResource.field,this._groupsResource.defaultFieldValue),m=this._groupsResource.multiple?p[0]:p;if(m===ke.iF)u.end=u.start,u.realEnd=u.realStart;else{var g;let e;m!==ke.xp&&(e=(0,we.VH)(u.providerType).updateProviderCardDataByTimelineResource(u,this._appCommonSrv.getTimelineResourceById(this._groupsResourceName,m))),(0,Me.iA)(u,this._groupsResource.field,null!==(g=e)&&void 0!==g?g:p)}u.providerCard[this._groupsResource.cardSortOrderField]=Number.POSITIVE_INFINITY,u.group=m,adjustEventForView(u),h?this._visCardsDataSource.add([u],"ignore"):this._visCardsDataSource.update([u],"ignore")}removeCreateCardPreview(){this._createCardPreview&&this._visCardsDataSource.remove(this._createCardPreview.id)}getSlotByEvent(e){let t=this._visTimeline.getEventProperties(e),i=this._getSlotByDate(t.time);if(i){if(this._groupsResourceName===be.y.Labels){let e=this._visGroupsDataSource.get(t.group);e.id!==ke.$d&&(i.labelName=e.resourceData.name,i.labelColor=e.resourceData.color)}return i=_objectSpread(_objectSpread({},i),{},{element:ve()(e.target),resources:{}}),(0,Me.iA)(i.resources,this._groupsResource.field,this._groupsResource.multiple?[t.group]:t.group),i}}_getSlotByDate(e){let t={isDaySlot:this.currentScaleUnit!==be.Uh.Hour},i=this._getCellRange(e);if(i){t.startDate=(0,Me.Pe)(i.start,0,this._workWeek);let e=(0,Me.Pe)(i.end,0,this._workWeek);return t.endDate=t.isDaySlot?(0,Me.Pe)(e,-864e5,this._workWeek):e,t}}adjustUpdateEventData(e,t,i){return i.isAllDay?_objectSpread(_objectSpread({},i),{},{start:(0,Me.$Y)(i.start),end:(0,Me.$Y)(i.end)}):this.currentScaleUnit!==be.Uh.Hour?_objectSpread(_objectSpread({},i),{},{start:(0,Me.q_)(i.start,t.previousStart),end:(0,Me.q_)(i.end,t.previousEnd)}):i}changeScale(e){if(this._isScaling)return;let t;switch(e){case"in":if(this._currentTimelineScale<=nt)return;t=Math.round(this._currentTimelineScale/1.5),t<nt+10&&(t=nt);break;case"out":if(this._currentTimelineScale>=at)return;t=Math.round(1.5*this._currentTimelineScale),t>at-10&&(t=at)}this._isScaling=!0,this._currentTimelineScale=t;let{start:i,end:r}=this._getRangeBySelectedDate(this.selectedDate,this._currentTimelineScale);this._visTimeline.range.setRange(i,r,{scaleMethod:"zoomByButtons",animation:$t,onNotChanged:()=>this._isScaling=!1},(()=>this._isScaling=!1)),this._saveScale()}getScale(){return this._collectionSettings.global.settings.timelineScale}redraw(e){e!==this._isDetailedView&&(this._isDetailedView=e,this._visTimeline.itemSet.pwIsItemsHeightDirty=!0);let t=this._visTimeline.itemSet.items;for(let e in t){let i=t[e].data;this._setEventTimes(i)}this._visTimeline.redraw()}getDateToNavigate(e){switch(e){case be.Lo.Today:return roundDateToScaleUnit(new Date,this.currentScaleUnit);case be.Lo.PreviousHour:let e=(0,Me.TR)(this.selectedDate,-1);for(;!(0,Me.ET)(e.getDay(),this._workWeek);)e=(0,Me.E4)(e,-1);return e;case be.Lo.NextHour:return(0,Me.TR)(this.selectedDate,1);case be.Lo.PreviousDay:let t=this.selectedDate;do{t=(0,Me.E4)(t,-1)}while(!(0,Me.ET)(t.getDay(),this._workWeek));return t;case be.Lo.NextDay:return(0,Me.E4)(this.selectedDate,1);case be.Lo.PreviousWeek:return(0,Me.E4)(roundDateToScaleUnit(this.selectedDate,be.Uh.Week),-7);case be.Lo.NextWeek:return(0,Me.E4)(roundDateToScaleUnit(this.selectedDate,be.Uh.Week),7);case be.Lo.PreviousMonth:return(0,Me.zI)(roundDateToScaleUnit(this.selectedDate,be.Uh.Month),-1);case be.Lo.NextMonth:return(0,Me.zI)(roundDateToScaleUnit(this.selectedDate,be.Uh.Month),1);case be.Lo.PreviousQuarter:return(0,Me.zI)(roundDateToScaleUnit(this.selectedDate,be.Uh.Quarter),-3);case be.Lo.NextQuarter:return(0,Me.zI)(roundDateToScaleUnit(this.selectedDate,be.Uh.Quarter),3);case be.Lo.PreviousYear:return(0,Me.Bc)(roundDateToScaleUnit(this.selectedDate,be.Uh.Year),-1);case be.Lo.NextYear:return(0,Me.Bc)(roundDateToScaleUnit(this.selectedDate,be.Uh.Year),1)}throw new Error(`Navigation action ${e} unsupported by view ${this.options.viewName}`)}resize(){this._visTimeline.redraw()}scrollTo(e){let{date:t,time:i,navigationMode:r}=e;if(i||r||(i=this.selectedDate),i&&(t=(0,Me.q_)(t,i)),t=roundDateToScaleUnit(t,this.currentScaleUnit),r===be.vt.ClosestVisible)return;if((0,Me.ET)(t.getDay(),this._workWeek)||(t=(0,Me.Pe)(t,0,this._workWeek)),(0,Me.rs)(t,this.selectedDate))return;if(this._schedulerWidget.date(t),!this._visTimeline)return;let{start:n,end:a}=this._getRangeBySelectedDate(t,this._currentTimelineScale);this._visTimeline.range.setRange(n,a,{animation:$t,byUser:!0,byNavigation:!0})}scrollToResource(e){let t=this._visTimeline.itemSet.groups[e];if(!t)return;let i=t.top;void 0!==i&&(-1*this._visTimeline._getScrollTop()>i?this._visTimeline._setScrollTop(i):this._visTimeline._setScrollTop(-i))}destroy(){this._visTimeline&&(this._cleanListeners(),this._visTimeline.destroy(),this._visTimeline=null),super.destroy()}render(e){var t;let i=this._defineEventsWithResource(e),r=new(M())(x()(i).call(i,(e=>e[this._cardIdField]))),n=this._visTimeline.itemSet;this._visTimeline.redrawCount=0;let a=H()(t=this._visCardsDataSource.getIds()).call(t,(e=>!r.has(e)&&!n.pwIsItemDragged(n.items[e])));this._visTimeline.pwOptions.isRedraw=void 0===this._visTimeline.pwOptions.isRedraw,this._visCardsDataSource.remove(a,"ignore"),this._visCardsDataSource.update(i,"ignore"),n.pwLinkPlotter.clear();for(let e of this._collectionSrv.getCurrentCollectionConnectedProviders()){var s,o;let t=H()(s=x()(o=this._visCardsDataSource.getIds()).call(o,(e=>n.items[e]))).call(s,(t=>t.data.providerType===e.type));for(let{itemFrom:i,itemTo:r}of e.getCardLinks(t))n.pwLinkPlotter.addLink(new RangeItemLinkPlotterHandle(i),new RangeItemLinkPlotterHandle(r))}this._visTimeline.pwOptions.isRedraw=!0,n.pwIsDragging()||n.pwUpdateSelection(),ve()(".k-event:hover").trigger("mouseleave").trigger("mouseenter"),this._renderedCardsRange={start:this.startDate(),end:this.visibleEndDate()},this._schedulerWidget._select()}refreshLayout(){}get _schedulerWidget(){return this._appCommonSrv.getSchedulerWidget()}get _currentTimelineScale(){return this._currentTimelineScaleRaw||0}set _currentTimelineScale(e){this._currentTimelineScaleRaw=e}_defineEventsWithResource(e){var t;let i=[];const addInstance=(e,t)=>{if(!this._visGroupsDataSource.get(t))return;let r=e.clone();this._groupsResourceName===be.y.NoResources&&(0,Me.iA)(r,this._groupsResource.field,ke.xp),t?(r[this._cardIdField]=this._groupsResource.multiple?`${r.uid}_${t}`:r.uid,r.group=t):r[this._cardIdField]=r.uid,r.uid===ke.$d&&(this._createdCardId=r[this._cardIdField]),this._setEventTimes(r),adjustEventForView(r),r.$ctrl=this.options.$ctrl,i.push(r)};if(x()(t=this._visGroupsDataSource).call(t,(e=>e)).length)for(let t of e){var r;R()(r=(0,we.VH)(t.providerType).expandTimelineResources(t,this._groupsResource)).call(r,(e=>addInstance(t,e)))}else for(let t of e)addInstance(t,null);return i}_getRangeBySelectedDate(e,t){let i=this._transformScale(t),r=(0,Me.Pe)(e,i,this._workWeek),n=this._getSelectedDateByRange({start:e,end:r}),a=-(0,Me.bt)(e,n,this._workWeek).ms;return{start:(0,Me.Pe)(e,a,this._workWeek),end:(0,Me.Pe)(r,a,this._workWeek),scale:i}}_getSelectedDateByRange(e){let{start:t,end:i}=e,r=(0,Me.Pe)(t,0*(0,Me.bt)(t,i,this._workWeek).ms,this._workWeek);return(0,Me.ET)(r,this._workWeek)||(r=(0,Me.Pe)(r,0,this._workWeek)),r}_initTimeline(){this.table=ve()(`<div class="k-scheduler-layout timeline-pw-layout timeline--scale_${this.currentScaleUnit} pw-js-kendo-sortable-outside-target"></div>`),this._visTimeline=new Ce.Timeline(this.table[0],this._visCardsDataSource,this._visGroupsDataSource,this._timelineOptions),this.element.append(this.table);let e,t,i={click:"pwClick",mouseDown:"pwMouseDown",mouseMove:"pwMouseMove",mouseLeave:"pwMouseLeave",mouseUp:"pwMouseUp"},r=!1;this._visTimeline.on("changed",(()=>{this.pwContentHeight!==e&&(this.options.$rootScope.$evalAsync(),e=this.pwContentHeight)})),this._visTimeline.on("pwCardDragStarted",(()=>{r=!0}));for(let e in i)this._visTimeline.on(e,(t=>{if(r&&"click"===e)return void t.event.stopPropagation();"mouseDown"===e&&(r=!1);let n=t.event.srcEvent||t.event,a=new MouseEvent(i[e],n);n.target.dispatchEvent(a)}));this._visTimeline.dom.root.addEventListener("pointerdown",(e=>{if(!e.target.classList.contains("timeline-item")&&!e.target.classList.contains("k-resize-handle")){let t=ve()(e.target).closest(".timeline-item")[0];if(!t)return;let i=new PointerEvent(e.type,e);e.stopPropagation(),t.dispatchEvent(i)}}),!0),this._visTimeline.dom.root.addEventListener("mousedown",(e=>e.stopPropagation())),this._visTimeline.dom.center.addEventListener("mousemove",(e=>this._updateCreateCardHintAsync(e))),this._visTimeline.dom.center.addEventListener("mouseleave",(e=>{this._visTimeline.emit("pwMouseLeave",{event:e}),this._removeCreateCardHint(),this.removeRangeHighlight()})),this._visTimeline.on("scroll",(e=>q()((()=>this._updateCreateCardHintAsync(e))))),this._visTimeline.on("rangechange",(e=>{this.selectedDate=this._getSelectedDateByRange(e),(!this._renderedCardsRange||e.start<this._renderedCardsRange.start||e.end>this._renderedCardsRange.end)&&(this._renderedCardsRange&&this.options.$scope.$evalAsync((()=>this._schedulerWidget.refresh())),this._renderedCardsRange={start:this.startDate(),end:this.visibleEndDate()})}));const n=_e()(((e,t)=>{t&&this._telemetrySrv.logSessionEvent(be.cN.CalendarEvents.TimelineScaleChanged,{timelineScale:e,scaleMethod:t})}),200);let a;this._visTimeline.on("rangechanged",(e=>{if(e.byUser&&!e.byNavigation){let t=this._visTimeline.props.centerContainer.width,i=Math.round((0,Me.bt)(e.start,e.end,this._workWeek).ms/t);i>at-10&&(i=at),i<nt+10&&(i=nt),i!==this._currentTimelineScale&&(this._currentTimelineScale=i,this._saveScale())}"zoomByWheel"===e.scaleMethod&&e.event&&q()((()=>this._updateCreateCardHintAsync(e.event))),t?n(this.currentScaleUnit,e.scaleMethod):t=this.currentScaleUnit,e.scaleMethod||this.options.$rootScope.$broadcast(be.FK.TimelineScrolled)})),this._visTimeline.on("pwScroll",(e=>{let t;switch(e.by){case"wheel":t=be.Lo.Wheel;break;case"scrollbar":t=be.Lo.Scrollbar;break;case"drag":t=be.Lo.Drag;break;default:return}this._telemetrySrv.logSessionEvent(be.cN.CalendarEvents.TimelineNavigated,{navigateAction:t})})),this._visTimeline.on("pwSelect",(e=>{this._selectedUids=e.uids})),this.options.$scope.isAdditionalElementsShown=!0,this._visTimeline.on("pwGroupDragStarted",(()=>{this.options.$scope.isAdditionalElementsShown=!1,this.options.$scope.$evalAsync((()=>{var e;a=H()(e=this._visTimeline.groupsData.getIds({order:"order"})).call(e,canDragGroup)}))})),this._visTimeline.on("pwGroupDragEnded",(()=>{this.options.$scope.isAdditionalElementsShown=!0,this.options.$scope.$evalAsync((()=>{var e;let t=H()(e=this._visTimeline.groupsData.getIds({order:"order"})).call(e,canDragGroup);ge()(t).call(t,((e,t)=>e===a[t]))||this.options.$scope.$broadcast(be.FK.TimelineResourcesReordered,{newResourcesOrder:t})}))})),this._visTimeline.on("pwUpdateScale",(e=>{if(this._currentScaleUnit!==e.scale){let t=!this._currentScaleUnit,i=this._currentScaleUnit===be.Uh.Hour,r=e.scale===be.Uh.Hour;if(this._currentScaleUnit=e.scale,this._visTimeline.pwOptions.isHourScale=r,this._navigationActions=null,this.table[0].className=`k-scheduler-layout timeline-pw-layout timeline--scale_${this.currentScaleUnit} pw-js-kendo-sortable-outside-target`,t||i!==r){this._visTimeline.currentTime.setOptions({showCurrentTime:r});let e=this._visTimeline.itemSet.items;for(let t in e)e[t].pwRefreshDuration()}}})),this._visTimeline.on("pwCreateLink",(e=>{let t=this._calendarCardsSrv.getCalendarCardById(e.accountId,e.leftCardType,e.leftCardId),i=be.z7.Blocks;(0,we.VH)(t.providerType).logCardEvent(t,be.cN.CardEvents.CardLinkAdded,{where:be.a6.Scheduler,by:be.AH.Mouse,linkType:i}),this._calendarCardsSrv.createCalendarCardLinkAsync(t,e.rightCardId,i)}))}_initTimelineDataSource(){let e,t=this._groupsResource.dataSource,i="";if(this._groupsResourceName===be.y.NoResources?(i=" pw-group-no-resources",e=[{[this._groupsResource.dataValueField]:ke.xp,className:"pw-group-fixed"+i,order:Number.POSITIVE_INFINITY,resourceData:{}}]):e=oe()(t.view()),this._collectionSettings.global.settings.isMilestonesShown&&this._licenseSrv.checkPaidFeatureAvailable(be.ZV.Milestones,!1)){var r;let t=this._appCommonSrv.getTimelineView();g()(r=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(r,(e=>{var i;return e.isMilestonesSupported()&&e.hasCurrentCollectionSelectedCalendars()&&g()(i=e.getSupportedTimelineViews()).call(i,(e=>e.value===t))}))&&e.push({[this._groupsResource.dataValueField]:ke.iF,className:"pw-group-fixed pw-milestone-group"+i,order:Number.NEGATIVE_INFINITY,name:this._$translate.instant("MISC.MILESTONES_RESOURCE"),resourceData:{}})}this._visGroupsDataSource=new Ce.DataSet(e,{fieldId:this._groupsResource.dataValueField}),te()(t).call(t,"change",(e=>{switch(e.action){case"add":case"itemchange":this._visGroupsDataSource.update(oe()(e.items));break;case"remove":this._visGroupsDataSource.remove(oe()(e.items))}})),this._cardIdField="visEventId",this._visCardsDataSource=new Ce.DataSet({fieldId:this._cardIdField}),this._visCardsDataSource.on("*",((e,t,i)=>{switch(e){case"update":if("ignore"===i)break;let e={};for(let i=0;i<t.data.length;i++){let r=t.oldData[i],n=t.data[i];if(!n||!n.resizeStart&&!n.resizeEnd)continue;if(!r)continue;r.resizeStart=null,r.resizeEnd=null;let a=n.resizeStart||n.start,s=n.resizeEnd||n.end,o=n.isAllDay,l=this._groupsResource.cardSortOrderField;n.resizeStart=null,n.resizeEnd=null,o?(a=(0,Me.$Y)(a),s=(0,Me.$Y)(s)):this.currentScaleUnit!==be.Uh.Hour&&(a=(0,Me.q_)(a,r.previousStart),s=(0,Me.q_)(s,r.previousEnd)),e[n.uid]||(e[n.uid]={event:r,updateData:{start:a,end:s,isAllDay:o,providerCard:{[l]:n.providerCard[l]}},isResize:n.isResize})}for(let t in e)this.options.update(e[t])}}))}_setEventTimes(e){if(e.id===ot)return;e.timeShortText=null,e.timeDurationText=(0,we.VH)(e.providerType).getCardTimeDurationText(e),e.timeDateText=null,e.timeText=null;let t=(0,Me.q_)(e.start,e.resizeStart||e.realStart),i=(0,Me.q_)(e.end,e.resizeEnd||e.realEnd);this._isDetailedView?e.isAllDay?e.timeDateText=(0,Me.KA)(t,i):(e.timeDateText=(0,Me.KA)(t,i,!0),e.timeText=(0,Me.Sr)(t,i)):e.isAllDay||(e.timeShortText=(0,Me.AH)(t))}_transformScale(e){return this._visTimeline&&this._visTimeline.props.centerContainer.width?Math.floor(e*this._visTimeline.props.centerContainer.width):1e3*e}_saveScale(){this._collectionSettings.global.settings.timelineScale=this._currentTimelineScale*Qe,this._debounceSaveGlobalSettings||(this._debounceSaveGlobalSettings=_e()((()=>{this._collectionSettings.global.saveAsync()}),1e3)),this._debounceSaveGlobalSettings()}async _updateCreateCardHintAsync(e){if(this._isCreateCardHintDisabled)return;let t=this.getSlotByEvent(e);if(!t)return;let i=(0,Me._M)(t.resources,this._groupsResource.field,this._groupsResource.defaultFieldValue),r=this._groupsResource.multiple?i[0]:i;if(this.getSelection().length>0||e.buttons||this._visCardsDataSource.get(lt)||this._createdCardId&&this._visCardsDataSource.get(this._createdCardId)||!e.target.classList.contains("timeline-group")||ve()("body > .md-open-menu-container.md-active")[0]||ve()(".timeline-item:hover")[0])return void this._removeCreateCardHint();let{startDate:n,endDate:a,isDaySlot:s}=t,o=this._visCardsDataSource.get(ot);if(o&&o.start&&(0,Me.rs)(n,o.start)&&o.end&&(0,Me.rs)(a,o.end)&&s===o.isAllDay&&r===o.group)return;if(!await this.options.$ctrl.getCardCreateOptionsAsync(e))return void this._removeCreateCardHint();let l=r===ke.iF,d={id:ot,[this._cardIdField]:ot,providerCard:{[this._groupsResource.cardSortOrderField]:Number.POSITIVE_INFINITY},type:"range",ignoreCollision:!1,className:"pw-create-card-hint",isReadOnly:!0,start:n,end:a,isAllDay:s,title:this._$translate.instant(l?"MISC.CREATE_MILESTONE_HINT":"MISC.CREATE_CARD_HINT"),isMilestoneCreateHint:l,cardRole:Se.D.Card,group:r};adjustEventForView(d),this._visCardsDataSource.update([d],"ignore")}_removeCreateCardHint(){this._visCardsDataSource.remove(ot)}disableCreateCardHint(){this._isCreateCardHintDisabled||(this._removeCreateCardHint(),this._isCreateCardHintDisabled=!0,this._settingsSrv.user.global.settings.isCreateCardTipPassed=!0,this._settingsSrv.user.global.saveAsync())}_resourceBySlot(){}_addResourceView(){}_createRowsLayout(){}_groups(){}_render(){}_updateCurrentTimeMarker(){}getSelection(){return this._selectedUids||[]}select(e){if(this._visTimeline.itemSet.pwSelectedUids)for(let t of e.events)this._visTimeline.itemSet.pwSelectedUids.add(t);else this._visTimeline.itemSet.pwSelectedUids=new(M())(e.events);let t=[],i=this._visTimeline.itemSet.items;for(let e in i)this._visTimeline.itemSet.pwSelectedUids.has(i[e].data.uid)&&t.push(e);this._visTimeline.itemSet.setSelection(t,!1)}clearSelection(){this._visTimeline.itemSet.pwSelectedUids=new(M()),this._visTimeline.itemSet.setSelection([],!0)}selectionByElement(){return null}_updateEventForSelection(e){return e}_getCellRange(e){let t=this._visTimeline.pwMinorTicks;if(!t)return;let i=0,r=t.length-1;if(!(e<t[i]||e>t[r])){for(;i+1!==r;){let n=Math.floor((i+r)/2);e<t[n]?r=n:i=n}return{start:t[i],end:t[r]}}}get _collectionSettings(){return this._settingsSrv.collection}}function timelineScaleToScaleUnit(e){return(e=Math.floor(e/Qe))<Je?be.Uh.Hour:e<et?be.Uh.Day:e<tt?be.Uh.Week:e<it?be.Uh.Month:e<rt?be.Uh.Quarter:be.Uh.Year}function roundDateToScaleUnit(e,t){switch(t){case be.Uh.Hour:return(0,Me.dH)(e);case be.Uh.Day:return(0,Me.$Y)(e);case be.Uh.Week:return(0,Me.tE)(e,kendo.culture().calendar.firstDay);case be.Uh.Month:return kendo.date.firstDayOfMonth(e);case be.Uh.Quarter:let t=(e=kendo.date.firstDayOfMonth(e)).getMonth();return e.setMonth(t-t%3),e;case be.Uh.Year:return e.setMonth(0,1),e}throw new Error(`Invalid timeline scale: ${t}`)}function adjustEventForView(e){switch(e.stretchedStart=e.start,e.stretchedEnd=e.end,e.cardRole){case Se.D.Card:e.isAllDay?(e.end=(0,Me.h3)(e.end),e.stretchedEnd=e.end):((0,Me.Xi)(e.end)&&!(0,Me.rs)(e.start,e.end)||(e.stretchedEnd=(0,Me.h3)(e.end)),(0,Me.CX)(e.start,e.end)<30&&(e.end=(0,Me.mH)(e.start,30)),e.stretchedStart=(0,Me.$Y)(e.start));break;case Se.D.Milestone:e.end=new Date(e.start.getTime()+1),e.stretchedEnd=e.end}}function canDragGroup(e){return e!==ke.iF}function timeLabelFormat(e,t,i){switch(t!==be.Uh.Quarter&&(e=e.toDate()),t){case be.Uh.Hour:return Gt({time:kendo.toString(e,"ts")});case be.Uh.Day:return jt({weekDay:i.calendar.days.namesShort[e.getDay()],date:e.getDate()});case be.Uh.Week:return Kt({week:"W",weekNumber:kendo.date.weekInYear(e,kendo.culture().calendar.firstDay)});case be.Uh.Month:return Yt({month:kendo.toString(e,"MMMM")});case be.Uh.Quarter:return qt({quarter:"Q",quarterNumber:e.quarter()});case be.Uh.Year:return Zt({year:kendo.toString(e,"yyyy")})}}function getMajorScale(e){switch(e){case be.Uh.Hour:return be.Uh.Day;case be.Uh.Day:return be.Uh.Week;case be.Uh.Week:return be.Uh.Month;case be.Uh.Month:return be.Uh.Quarter;case be.Uh.Quarter:return be.Uh.Year;default:return null}}function isCtrlPressed(e){return e.ctrlKey||e.metaKey}},32966:(e,t,i)=>{i.d(t,{g:()=>SchedulerTimesheetView});var r=i(86981),n=i.n(r),a=i(19755),s=i.n(a),o=i(29704),l=i(73180);class SchedulerTimesheetView extends kendo.ui.SchedulerView{constructor(e,t){super(e,t),this.name=this.options.viewName,this._initTimesheet(),this.content=n()(e).call(e,".pw-scheduler-timesheet")}scrollTo(){}render(){}dateForTitle(){}shortDateForTitle(){}mobileDateForTitle(){}startDate(){return(0,o.$Y)(new Date)}endDate(){return(0,o.E4)(this.startDate(),7)}removeRangeHighlight(){}clearSelection(){}select(){}destroy(){this._timesheetElement.remove(),this._timesheetScope.$destroy(),super.destroy()}get _htmlHelperSrv(){return this._htmlHelperSrvLazy||(this._htmlHelperSrvLazy=l.K.$injector.get("htmlHelperSrv")),this._htmlHelperSrvLazy}_initTimesheet(){this._timesheetElement=s()('<pw-scheduler-timesheet class="pw-scheduler__timesheet"></pw-scheduler-timesheet>'),this.element.append(this._timesheetElement),this._timesheetScope=this._htmlHelperSrv.compileElement(this._timesheetElement,this.options.$scope)}}},92555:(e,t,i)=>{i.d(t,{e:()=>SchedulerWeekView});var r=i(84705),n=i.n(r),a=i(86981),s=i.n(a),o=i(34300),l=i.n(o),d=i(99595),c=i.n(d),h=i(73324),u=i.n(h),p=i(98235),m=i.n(p),g=i(19755),y=i.n(g),v=i(56777),f=i(8937),_=i(73180),C=i(65067),S=i(29704);const w=n()('\n    <div class="k-scheduler-header-date-and-duration">\n        <div class="k-scheduler-header-date">\n            <div>#=kendo.toString(data.date, "ddd")#</div>\n            <div>#=kendo.toString(data.date, "dd")#</div>\n        </div>\n\n        <div\n            class="k-scheduler-header-duration"\n            data-dt="#=kendo.toString(data.date, \'u\')#"\n        ></div>\n    </div>\n').call('\n    <div class="k-scheduler-header-date-and-duration">\n        <div class="k-scheduler-header-date">\n            <div>#=kendo.toString(data.date, "ddd")#</div>\n            <div>#=kendo.toString(data.date, "dd")#</div>\n        </div>\n\n        <div\n            class="k-scheduler-header-duration"\n            data-dt="#=kendo.toString(data.date, \'u\')#"\n        ></div>\n    </div>\n'),k=n()('\n    <span>#=kendo.toString(data.date, "ts")#</span>\n').call('\n    <span>#=kendo.toString(data.date, "ts")#</span>\n'),b=16,D="pw-scheduler-range-highlight",T=30;class SchedulerWeekView extends kendo.ui.MultiDayView{constructor(e,t){var i;t.dateHeaderTemplate=kendo.template(w,{useWithBlock:!1}),t.majorTimeHeaderTemplate=kendo.template(k,{useWithBlock:!1}),t.$translate=_.K.$injector.get("$translate"),t.minorTickCount=2,t.eventHeight=C.p8,t.visibleDayCount=t.visibleDayCount||1,t.currentTimeMarker={updateInterval:6e4},super(e,t),s()(i=this.element).call(i,".k-scheduler-layout").addClass("pw-js-kendo-sortable-outside-target"),this.name=this.options.viewName,this._allDayEventHeight=this.options.eventHeight,this._allDayEventIndent=this._allDayEventHeight,this._allDayContainerHeight=0,this._workWeek=this._appCommonSrv.getSchedulerWorkWeek()}get _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=_.K.$injector.get("appCommonSrv")),this._appCommonSrvLazy}get _calendarCardsSrv(){return this._calendarCardsSrvLazy||(this._calendarCardsSrvLazy=_.K.$injector.get("calendarCardsSrv")),this._calendarCardsSrvLazy}get isTimeAvailable(){return!0}get isHideWeekendsAvailable(){return this.options.viewName===f.rW.Week}get isScaleAvailable(){return!1}get selectedDate(){var e;return(null===(e=this._schedulerWidget)||void 0===e?void 0:e.date())||this.options.date}isVisibleDate(e){return(0,S.mh)(e,this.startDate(),this.endDate())}get navigationActions(){if(!this._navigationActions)switch(this.options.viewName){case f.rW.OneDay:case f.rW.ThreeDay:this._navigationActions={leftActions:[{type:f.Lo.PreviousDay,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.DAY_BACKWARD"}],rightActions:[{type:f.Lo.NextDay,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.DAY_FORWARD"}]};break;case f.rW.Week:this._navigationActions={leftActions:[{type:f.Lo.PreviousWeek,icon:"mdi-chevron-double-left",tooltip:"TOOLTIPS.WEEK_BACKWARD",isSecondary:!0},{type:f.Lo.PreviousDay,icon:"mdi-chevron-left",tooltip:"TOOLTIPS.DAY_BACKWARD"}],rightActions:[{type:f.Lo.NextDay,icon:"mdi-chevron-right",tooltip:"TOOLTIPS.DAY_FORWARD"},{type:f.Lo.NextWeek,icon:"mdi-chevron-double-right",tooltip:"TOOLTIPS.WEEK_FORWARD",isSecondary:!0}]}}return this._navigationActions}get showWorkDays(){return this.isHideWeekendsAvailable&&this.options.showWorkDays}calculateDateRange(){var e,t;let i=[],r=this.options.viewName,n=null===(e=this._schedulerWidget)||void 0===e?void 0:e.navigationMode,a=(null===(t=this._schedulerWidget)||void 0===t?void 0:t.weekOffset)||0;if(n!==f.vt.DayScroll&&r===f.rW.Week){a=0;let e=(0,S.tE)(this.selectedDate,this.calendarInfo().firstDay);for(;!(0,S.KC)(e,this.selectedDate)&&!(0,S.Ax)(e,this.selectedDate);)this.showWorkDays&&!this._isWorkDay(e)||a++,e=this.nextDate(e);this._schedulerWidget&&(this._schedulerWidget.weekOffset=a)}this._schedulerWidget&&(this._schedulerWidget.navigationMode=null);let s=this._previousDateShifted(this.selectedDate,a);for(let e=0;e<this.options.visibleDayCount;e++)this.showWorkDays&&!this._isWorkDay(s)||i.push(s),s=kendo.date.nextDay(s);if(this._render(i),!this.showWorkDays){y()("table.k-scheduler-header-all-day > tbody > tr > td",this.element).each(((e,t)=>{this._isWorkDay(this._dates[e])||y()(t).addClass("pw-weekend")}))}}createLayout(e){this.name="week",super.createLayout(e)}render(e){var t;this._headerColumnCount=0;let i=[];for(let t of this._dates)i.push({eventCount:0,eventStart:(0,S.$Y)(t),eventEnd:(0,S.E4)((0,S.$Y)(t),1)}),this._updateHeader(t,e);let r=0;if(this._schedulerWidget.options.allDaySlot){for(let t of e){if(!t.isMultiDay())continue;let e=t.start,r=t.end;(t.isAllDay||(0,S.rs)(e,r))&&(r=(0,S.h3)(r));let n=!1;for(let t of i)if(e<t.eventEnd&&r>t.eventStart)n=!0,t.eventCount+=1;else if(n)break}let t=0;for(let e of i)t=Math.max(t,e.eventCount);let n=0===t?2*this._allDayEventIndent+C.C4:this._allDayEventIndent;r=this._allDayEventHeight*t+C.C4*(t-1)+n}this._updateAllDayHeaderHeight(r),this._groups(),this.refreshLayout(),s()(t=this.element).call(t,".k-event").detach(),this._renderEvents(e,0),y()(".k-scheduler-header-all-day-label").css({display:this._schedulerWidget.options.allDaySlot?"":"none"}),this._currentTime(!1),this.trigger("activate")}nextDate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedDate;if(this.showWorkDays){let t=kendo.date.nextDay(e);for(let e=0;e<7;e++){if(this._isWorkDay(t))return t;t=kendo.date.nextDay(t)}return t}return kendo.date.nextDay(e)}previousDate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedDate;if(this.showWorkDays){let t=kendo.date.previousDay(e);for(let e=0;e<7;e++){if(this._isWorkDay(t))return t;t=kendo.date.previousDay(t)}return t}return kendo.date.previousDay(e)}getDateToNavigate(e){switch(e){case f.Lo.Today:return new Date;case f.Lo.PreviousDay:return this.previousDate();case f.Lo.NextDay:return this.nextDate();case f.Lo.PreviousWeek:return kendo.date.addDays(this.selectedDate,-this.options.visibleDayCount);case f.Lo.NextWeek:return kendo.date.addDays(this.selectedDate,this.options.visibleDayCount)}throw new Error(`Navigation action ${e} unsupported by view ${this.options.viewName}`)}resize(e){e.widthChanged?this._schedulerWidget.resize():(this._updateAllDayHeaderHeight(this._height),this.refreshLayout())}scrollTo(e){if(!this._schedulerWidget)return;let{date:t,time:i,navigationMode:r}=e,n=y()(".k-scheduler-content",this.element).scrollTop(),a=y()("table.k-scheduler-header-all-day",this.element).height();if(this._schedulerWidget.navigationMode=r,t){if(r===f.vt.ClosestVisible&&this.isVisibleDate(t))return;(0,S.KC)(t,this.selectedDate)||this._schedulerWidget.date(t)}if(i){let e=y()(".k-scheduler-content",this.element),t=y()("table.k-scheduler-table > tbody > tr",e),r=t[0];this._scrollTo(y()("> td:first",r)[0],e[0]);let n,a=e.height()/y()(r).height(),o=i.getHours()+i.getMinutes()/60+a/3;for(let e=0;e<t.length;e++){var s;let i=null===(s=this._schedulerWidget.slotByElement(t[e]))||void 0===s?void 0:s.startDate;if(!i||i.getHours()+i.getMinutes()/60>=o)break;n=t[e]}n&&this._scrollTo(y()("> td:first",n)[0],e[0])}else{let e=y()("table.k-scheduler-header-all-day",this.element).height()-a;y()(".k-scheduler-content",this.element).scrollTop(n+e)}}getCardCreateDefaultSlots(e,t){if(!this._schedulerWidget)return;let i=y()(e.element),r=e.isDaySlot?0:Math.ceil(t/T)-1,n=i,a=i.parent(),s=a.children().index(i),o=!e.isDaySlot,l=a;for(;r>0;){if(l=l.next(),!l[0]){o=!1;break}n=l.children().eq(s),r--}let d=this._schedulerWidget.slotByElement(n);return o&&(d.endDate=(0,S.mH)(e.startDate,t)),{firstSlot:e,lastSlot:d}}getClosestVisibleSlot(e){let t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i&&(e=(0,S.$Y)(e));let r={start:this.options.workWeekStart,end:this.options.workWeekEnd};if(t=(0,S.mh)(e,this.startDate(),this.endDate())?this.showWorkDays&&!(0,S.ET)(e.getDay(),r)?(0,S.IG)(e,r):new Date(e):this.endDate()<e?new Date(this.endDate()):new Date(this.startDate()),i)return{start:t,end:new Date(t)};e.getMinutes()>T?t.setHours(e.getHours()+1,0,0,0):t.setHours(e.getHours(),T,0,0);let n=(0,S.q_)(t,this.options.workDayStart),a=(0,S.q_)(t,this.options.workDayEnd);if(this.options.showWorkHours&&!(0,S.mh)(t,n,a))if(t<n)t=(0,S.q_)(t,n);else{let e=(0,S.q_)(t,a);t=(0,S.TR)(e,-1)}return{start:t,end:(0,S.TR)(t,1)}}adjustUpdateEventData(e,t,i){if(e){if((0,S.i2)(t.start,t.end)>0){let e=(0,S.$Y)(i.start);return{start:e,end:(0,S.E4)(e,(0,S.i2)(i.start,i.end)),isAllDay:!0}}}return i}updateRangeHighlight(e,t){let i,r,n=e.isDaySlot;if(n!==t.isDaySlot)return;if(e.startDate<t.startDate?(i=e,r=t):(i=t,r=e),this._selectedRange||(this._selectedRange={}),this._selectedRange.firstSlot&&this._isSlotsEqual(i,this._selectedRange.firstSlot)&&this._selectedRange.lastSlot&&this._isSlotsEqual(r,this._selectedRange.lastSlot))return;let insertSlotsToSelection=(e,t)=>{let i=this._slotsInRange(e,t,n);for(let e of i)(!this._selectedRange.firstSlot||!this._selectedRange.lastSlot||e.isDaySlot!==this._selectedRange.firstSlot.isDaySlot||e.startDate<this._selectedRange.firstSlot.startDate||e.startDate>this._selectedRange.lastSlot.startDate)&&y()(e.element).addClass(D)},removeSlotsFromSelection=(e,t)=>{for(let i of this._slotsInRange(e,t,n))(i.isDaySlot===this._selectedRange.firstSlot.isDaySlot||i.startDate>=this._selectedRange.firstSlot.startDate||i.startDate<=this._selectedRange.lastSlot.startDate)&&y()(i.element).removeClass(D)};if(this._selectedRange.firstSlot&&this._selectedRange.firstSlot.startDate<i.startDate){let e=n?(0,S.E4)(i.startDate,-1):(0,S.mH)(i.startDate,-30);removeSlotsFromSelection(this._selectedRange.firstSlot.startDate,e)}if(this._selectedRange.lastSlot&&this._selectedRange.lastSlot.startDate>r.startDate){removeSlotsFromSelection(n?(0,S.E4)(r.startDate,1):(0,S.mH)(r.startDate,T),this._selectedRange.lastSlot.startDate)}if(this._selectedRange.firstSlot&&this._selectedRange.lastSlot){let e=this._selectedRange.firstSlot.startDate,t=this._selectedRange.lastSlot.startDate;if(i.startDate<e){let t=e<r.startDate?e:r.startDate;insertSlotsToSelection(i.startDate,t)}if(r.startDate>t){insertSlotsToSelection(t>i.startDate?t:i.startDate,r.startDate)}}else insertSlotsToSelection(i.startDate,r.startDate);this._selectedRange.firstSlot=i,this._selectedRange.lastSlot=r}removeRangeHighlight(){if(!this._selectedRange)return;let e=this._slotsInRange(this._selectedRange.firstSlot.startDate,this._selectedRange.lastSlot.startDate,this._selectedRange.firstSlot.isDaySlot);for(let t of e)y()(t.element).removeClass(D);this._selectedRange=null}updateCreateCardPreview(e,t,i){let{accountId:r,providerType:n,calendarId:a,cardType:s,cardRole:o}=i;this.removeCreateCardPreview();let l,d,c=e.isDaySlot;e.startDate<t.startDate?(l=e,d=t):(l=t,d=e);let h=l.startDate,u=c?d.startDate:d.endDate<d.startDate?(0,S.E4)(d.endDate,1):d.endDate,p=this.options.$ctrl.getPreviewCard({accountId:r,providerType:n,calendarId:a,cardType:s,cardRole:o,isAllDay:c,start:h,end:u}),m=this.options.dataSource._createNewModel(p);this._pwNewCardHint=this._insertHint(m,0)}removeCreateCardPreview(){var e;null===(e=this._pwNewCardHint)||void 0===e||e.remove()}getSlotByEvent(e){return this._schedulerWidget.slotByElement(e.dropTarget||y()(e.target))}refreshLayout(){var e;let t=this.element.innerHeight(),i=0;if(this.datesHeader&&(i=this.datesHeader.outerHeight()),this.timesHeader&&this.timesHeader.outerHeight()>i&&(i=this.timesHeader.outerHeight()),i&&(t-=i),this.datesHeader&&this.timesHeader){var r,n;let e=s()(r=this.datesHeader).call(r,"table:first tr");s()(n=this.timesHeader).call(n,"tr").height((function(t){y()(this).height(e.eq(t).height())}))}t>2*this._scrollbar?this.content.height(t):this.content.height(2*this._scrollbar+1);const a=this.content[0];this.times.height(a.clientHeight);const o=s()(e=this.times).call(e,"table");var d;o.length&&o.height(s()(d=this.content).call(d,"table")[0].clientHeight);a.offsetWidth-a.clientWidth>0?this.datesHeader.css("padding-right",this._scrollbar-l()(this.datesHeader.children().css("border-right-width"),10)):this.datesHeader.css("padding-right",""),this._schedulerWidget&&(this._schedulerWidget._size=this._schedulerWidget.getSize()),this.table.addClass("k-scrollbar-v")}get _isTimeTracking(){return this._appCommonSrv.getSchedulerMode()===f.ud.TimeTracking}get _schedulerWidget(){return this._appCommonSrv.getSchedulerWidget()}_templates(){super._templates(),this.eventTemplate=C.V5,this.allDayEventTemplate=C.$R}_layout(e){var t;let i=super._layout(e);c()(t=i.columns).call(t,((t,i)=>{this._isWorkDay(e[i])||(t.className=`${t.className||""} pw-weekend`),this.showWorkDays&&e[i].getDay()===this.options.workWeekStart&&(t.className=`${t.className||""} pw-work-week-start`)}));let r=1;return this._forTimeRange(this.startTime(),this.endTime(),((e,t)=>{if(t&&(e<this.options.workDayStart||e>=this.options.workDayEnd)){let e=i.rows[r];e&&(e.className=`${e.className||""} pw-nonwork-hour`)}r+=1})),i}_topSection(e,t,i){var r;let n=super._topSection(e,t,i);if(this.timesHeader.empty(),this.options.showWeekNumbers){let e=kendo.date.weekInYear(this.selectedDate,kendo.culture().calendar.firstDay);this.timesHeader.append(`<span>${e}</span>`)}this.timesHeader.append(`<span class="k-scheduler-header-all-day-label">${this.options.$translate.instant("MISC.ALL_DAY_SECTION")}</span>`);let a=s()(r=this.datesHeader).call(r,".k-scheduler-header-wrap > div");return a.addClass("k-scheduler-content--scrollable"),a.before('<span class="k-scheduler-content-border-top"></span>'),a.after('<span class="k-scheduler-content-border-bottom"></span>'),s()(a).call(a,".k-scheduler-table").addClass("pw-selectable-items-container"),n}_bottomSection(e,t,i){var r;let n=super._bottomSection(e,t,i);return this.content.addClass("k-scheduler-content--scrollable"),this.content.before('<span class="k-scheduler-content-border-top"></span>'),s()(r=this.content).call(r,".k-scheduler-table").addClass("pw-selectable-items-container"),n}_updateAllDayHeaderHeight(e){let t=this._schedulerWidget.options.allDaySlot?Math.max(Math.min(e,this.element.height()/2-10),this._allDayEventHeight):0;if(this._allDayContainerHeight!==t||this._height!==e){var i;this._height=e,this._allDayContainerHeight=t;let n=s()(i=this.element).call(i,".k-scheduler-header-all-day td");if(n.length>0){var r;n.parent().height(e),n.closest("div").add(s()(r=this.element).call(r,".k-scheduler-times-all-day").parent()).height(this._allDayContainerHeight);for(let e of this.groups)e.refresh()}}}_groups(){if(super._groups(),this.showWorkDays){var e;let t=s()(e=this._dates).call(e,(e=>e.getDay()===this.options.workWeekStart)),i=(0,S.q_)(t,this.options.workDayStart),r=this.groups[0].ranges(i,i,!1,!1);for(let e of r)for(let t of e.collection._slots)y()(t.element).addClass("pw-work-week-start")}else for(let e of u()(t=this._dates).call(t,(e=>!this._isWorkDay(e)))){var t;e=kendo.date.toUtcTime(e);let i=(0,S.E4)(e,1),r=this.groups[0].timeSlotRanges(e,i);for(let e of r)for(let t of e.collection._slots)y()(t.element).addClass("pw-weekend")}}_updateCurrentTimeMarker(e){let t=e,i=this.isVisibleDate((0,S.$Y)(e));i||(t=new Date(this.startDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds())),y()(".k-current-time-container",this.content).remove();let r=this.groups[0];if(!r)return;let n=kendo.date.toUtcTime(t),a=r.timeSlotRanges(n,n+1);if(!a||a.length<=0)return;if(a[0].collection.slotByStartDate(t)){let e=Math.round(a[0].innerRect(t,new Date(t.getTime()+1),!1).top),r=a[0].start.offsetLeft,n=a[0].start.clientWidth,s=y()('<div class="k-current-time-container"></div>');if(s.css({top:e}),i){let e=y()('<div class="k-current-time"></div>');e.css({left:r,width:n+2}),e.appendTo(s)}s.appendTo(this.content)}let s=e.getDay();if(void 0===this._lastDay)this._lastDay=s;else if(this._lastDay!==s){var o;this._lastDay=s,null===(o=this._schedulerWidget)||void 0===o||o.view(this.options.viewName)}}_createEventElement(e,t,i,r){e.$ctrl=this.options.$ctrl,e.timeDurationText=(0,v.VH)(e.providerType).getCardTimeDurationText(e),e.timeText=null;let n=e.tail?e.previousStart:e.start,a=e.head?e.previousEnd:e.end;return e.isAllDay||(e.timeText=(0,S.Sr)(n,a)),super._createEventElement(e,t,i,r)}_inverseEventColor(){}_addResourceView(){let e=super._addResourceView();return e.slotRanges=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.isMultiDay(),i=e.start,r=e.end,n=(0,S.mH)(i,T);r<n&&(r=n);let a=kendo.date.toUtcTime(i),s=kendo.date.toUtcTime(r);return t?this.daySlotRanges(a,s,e.isAllDay):this.timeSlotRanges(a,s)},e}_positionEvent(e,t,i){let r=e.start,n=e.end,a=(0,S.mH)(r,T);n<a&&(n=a);let o=i.startSlot(),l=i.endSlot(),d=i.outerRect(r,n,!1),c=d.bottom-d.top-2*C.wl+(o.index%2?1:0)+(l.index%2?0:2)-(0===o.index?2:1);c<0&&(c=0),t[0].style.top=d.top+C.wl-(o.index%2?1:0)+"px",t[0].style.height=`${c}px`,c>49&&t.addClass("pw-card--stretched");let h={element:t,slotIndex:o.index,start:d.top,end:d.top+c},u=kendo.ui.SchedulerView.collidingEvents(i.events(),h.start,h.end);i.addEvent(h),u.push(h);let p,m=o.clientWidth-C.jj+1,g=kendo.ui.SchedulerView.createColumns(u),y=(m-C.C4*(g.length-1))/g.length;for(let e=0;e<g.length;e++){let t,i=g[e].events;t=e===g.length-1?m-y*(g.length-1)-C.C4*(g.length-1):y;for(let r=0;r<i.length;r++)i[r].element[0].style.left=`${o.offsetLeft+C.cC+e*(y+C.C4)}px`,i[r].element[0].style.width=`${t}px`,t<C.O0&&i[r].element.addClass("pw-card--narrow")}if(c>49){let t=(0,v.VH)(e.providerType),i=this._schedulerWidget.options.showEstimatedHours&&t.hasEstimation(e)||this._schedulerWidget.options.showTrackedHours&&t.hasTrackedTime(e),r=this._schedulerWidget.options.showCalendar,n=this._schedulerWidget.options.showList;p=i||r||n?i&&(r||n)?3:2:1}else p=1;let f=Math.floor((c-8-16*p)/b)*b;var _;f>0?s()(_=t.toggleClass("pw-card--multiline",f>b)).call(_,".pw-js-card-title").css({maxHeight:f}):t.addClass("pw-card--small")}_positionAllDayEvent(e,t){let i=t.startSlot(),r=t.endSlot(),n=i.index,a=r.index,s=r.offsetLeft-i.offsetLeft+r.offsetWidth-C.hd-C.cC;e[0].style.left=`${i.offsetLeft+C.cC}px`,e[0].style.width=`${s}px`;let o={element:e,slotIndex:n,start:n,end:a},l=kendo.ui.SchedulerView.collidingEvents(t.events(),n,a);t.addEvent(o),l.push(o);let d=kendo.ui.SchedulerView.createRows(l),c=this._headerColumnCount||0;d.length&&d.length>c&&(this._headerColumnCount=d.length);for(let e=0;e<d.length;e++){let t=i.offsetTop+(this._allDayEventHeight+C.C4)*e+C.wl,r=d[e].events;for(let e=0;e<r.length;e++)r[e].element[0].style.top=`${t}px`,r[e].element[0].style.height=`${this._allDayEventHeight}px`}e.addClass("pw-card--small"),s<C.O0&&e.addClass("pw-card--narrow")}_slotByPosition(e,t){var i,r;let n=s()(i=s()(r=this.element).call(r,".k-scheduler-header-wrap:has(.k-scheduler-header-all-day)")).call(i,">div");if(n[0]&&t<=n.offset().top+this._allDayContainerHeight){let i=e+n[0].scrollLeft,r=t+n[0].scrollTop,a=n.offset();i-=a.left,r-=a.top,i=Math.ceil(i),r=Math.ceil(r);for(let e of this.groups){let t=e.daySlotByPosition(i,r,this._isGroupedByDate());if(t)return t}}else{let i=e+this.content[0].scrollLeft,r=t+this.content[0].scrollTop,n=this.content.offset();i-=n.left,r-=n.top,i=Math.ceil(i),r=Math.ceil(r);for(let e of this.groups){let t=e.timeSlotByPosition(i,r);if(t)return t}}}_slotByDate(e,t){let i=kendo.date.toUtcTime(e),r=t?this.groups[0].daySlotRanges(i,i,!0):this.groups[0].timeSlotRanges(i,i);if(0===r.length)return;let n=r[0].collection.slotByStartDate(i);return this._schedulerWidget.slotByElement(n.element)}_slotsInRange(e,t,i){let r=[],n=e;for(;n<=t;){let e=this._slotByDate(n,i);e&&r.push(e),n=i?(0,S.E4)(n,1):(0,S.mH)(n,T)}return r}_isSlotsEqual(e,t){return!(!e||!t)&&(e.isDaySlot!==t.isDaySlot||(0,S.rs)(e.startDate,t.startDate))}_updateMoveHint(e,t){if(!(0,v.VH)(e.providerType).canStartMoveInScheduler(e))return;this._removeMoveHint(e.uid);let i=this._insertHint(e,t);i&&(this._moveHint=this._moveHint.add(i))}_updateResizeHint(e,t,i,r){const correctDate=e=>{let t=new Date(e);return(0,S.mH)(t,t.getTimezoneOffset())};let n=this.options.$ctrl.getPreviewCard({accountId:e.accountId,providerType:e.providerType,cardType:e.cardType,isAllDay:e.isAllDay,start:correctDate(i),end:correctDate(r),providerCard:e.providerCard}),a=e.clone({start:n.start,end:n.end,providerCard:n.providerCard});this._removeResizeHint(),this._resizeHint=this._insertHint(a,t)}_updateEventForResize(e){if(!e.isAllDay&&e.isMultiDay()){let t=(0,S.$Y)(e.start),i=(0,S.E4)(t,(0,S.i2)(e.start,e.end));e.start=t,e.end=i,e.isAllDay=!0}}_previousDateShifted(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedDate,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(this.options.viewName){case f.rW.OneDay:case f.rW.ThreeDay:e=Math.min(0,this.options.visibleDayCount-1);break;case f.rW.Week:e=i}for(let i=0;i<e;i++)t=this.previousDate(t);return t}_selectSlots(){}_updateHeader(e,t){y()(".k-scheduler-header").css({paddingBottom:this._schedulerWidget.options.allDaySlot?"":"0"});let i=y()(`.k-scheduler-header-duration[data-dt="${kendo.toString(e,"u")}"]`);if(0===i.length)return;let r="";if(this._isTimeTracking){let i=0;for(let[r,n]of(0,S.vM)(t,"providerType"))i+=(0,v.VH)(r).getTotalCardsTimeDurationInDay(n,e);r=(0,S.QZ)(i)||"0h"}i.text(r)}_insertHint(e,t){let i=m()(t)?t[0]:t,r=e.isMultiDay(),n=this.groups[i];if(!n)return;let a=n.ranges(e.start,e.end,r,e.isAllDay);!r&&(0===kendo.date.getMilliseconds(e.end)||kendo.date.getMilliseconds(e.end)<kendo.date.getMilliseconds(this.startTime()))&&a.length>1&&a.pop();let o=y()();for(let t of a){let i=t.startSlot(),n=t.endSlot(),a={top:i.offsetTop+C.wl,left:i.offsetLeft+C.cC};if(r)a.width=n.offsetLeft-i.offsetLeft+n.offsetWidth-C.hd-C.cC,a.height=this._allDayEventHeight;else{let r=t.outerRect(e.start,e.end,!1),s=r.bottom-r.top-2*C.wl+(i.index%2?1:0)+(n.index%2?0:2)-(0===i.index?2:1);a.top=r.top+C.$G-(i.index%2?1:0),a.left=i.offsetLeft+C.hO,a.height=Math.max(s,this.options.eventHeight),a.width=i.clientWidth-C.jj+1}let d,c=this._createEventElement(e.clone({start:e.start,end:e.end}),!r);if(a.height>49){let t=(0,v.VH)(e.providerType),i=this._schedulerWidget.options.showEstimatedHours&&t.hasEstimation(e)||this._schedulerWidget.options.showTrackedHours&&t.hasTrackedTime(e),r=this._schedulerWidget.options.showCalendar,n=this._schedulerWidget.options.showList;d=i||r||n?i&&(r||n)?3:2:1}else d=1;let h=r?0:Math.floor((a.height-8-16*d)/b)*b;var l;if(h>0)s()(l=c.toggleClass("pw-card--multiline",h>b)).call(l,".pw-js-card-title").css({maxHeight:h});else c.addClass("pw-card--small");a.height>49&&c.addClass("pw-card--stretched"),a.width<C.O0&&c.addClass("pw-card--narrow"),e.isTempCard&&c.addClass("pw-card--temp"),c.addClass("k-state-selected k-event-drag-hint"),c.css(a),o=o.add(c)}let d=this.content;var c;e.isMultiDay()&&(d=s()(c=this.element).call(c,".k-scheduler-header-wrap:has(.k-scheduler-header-all-day) > div"),d.length||(d=this.content));return o.appendTo(d),o}}},29704:(e,t,i)=>{i.d(t,{$6:()=>deleteLinkParam,$U:()=>delayAsync,$Y:()=>getDayStart,$t:()=>compareGoogleReminders,A5:()=>compareStrings,AH:()=>formatCardTimesShort,Ax:()=>isAfter,Bc:()=>addYears,Bn:()=>filterKeys,C9:()=>getCorrectedLocale,CX:()=>getIntervalMinutes,D0:()=>getDateWithTime,E4:()=>addDays,EA:()=>compareTrelloTimeRecords,ET:()=>isWorkDay,FT:()=>isSameYear,Fo:()=>compareTrelloChecklists,G4:()=>compareTrelloLabels,GG:()=>roundTime,GI:()=>compareEventAttendees,GM:()=>getIntervalMs,GP:()=>minutesToIntervalUnits,H9:()=>compareTrelloLists,HE:()=>fromDateOrISOString,IG:()=>getNextWorkDay,KA:()=>formatCardDates,KC:()=>isSameDay,Kg:()=>getQuarterStart,LU:()=>formatDuration,Lj:()=>decompress,NU:()=>getDatesInInterval,OR:()=>getFirstDayOfWeek,Oo:()=>capitalizeString,Or:()=>isImage,PM:()=>mergeObjects,Pb:()=>getUtcAsTimeZoneDate,Pe:()=>addWorkMs,Pk:()=>compareTrelloComment,Q9:()=>getYearEnd,QJ:()=>saveDataUrlAs,QV:()=>roundNumber,QZ:()=>formatTimeRecordDuration,R2:()=>getLastDateOfMonth,RF:()=>fromRecurrenceExceptionDate,RT:()=>getExtension,SG:()=>ngInject,SY:()=>getCustomFieldHash,Sr:()=>formatCardTimes,T6:()=>getAbbreviation,TR:()=>addHours,Tu:()=>formatFullDate,Tw:()=>keepScrollFocus,U9:()=>toTimeString,Ux:()=>formatCardDatesLong,V1:()=>getNewTrelloPosition,W8:()=>getYearStart,WF:()=>getIntervalSeconds,Wf:()=>getTimeZoneOffset,XG:()=>getTrelloOrganizationColorHash,X_:()=>compareTrelloAttachments,Xi:()=>isDayStart,YU:()=>groupByField,Yb:()=>compareTrelloMembers,Yg:()=>fromLocalDateTimeString,Yp:()=>compareTrelloReminders,ZR:()=>fromDateTimeByTimeZone,Zo:()=>deleteCachedRequest,_M:()=>objectGet,_q:()=>applyUTCOffset,a5:()=>intervalUnitsToMinutes,b:()=>isFirstDayOfMonth,bt:()=>countWorkTime,c6:()=>getTimeZoneDateAsUtc,cO:()=>arraysEqual,dH:()=>getHourStart,fE:()=>getTrelloBoardColorHash,gG:()=>formatCardDuration,gI:()=>parseTrelloCustomField,h0:()=>objectsEqual,h2:()=>isLastDayOfMonth,h3:()=>getDayEnd,hr:()=>escapeRegExp,i$:()=>formatTimestamp,i2:()=>getIntervalDays,iA:()=>objectSet,iS:()=>formatShortDate,iT:()=>getLocalTimeZone,jf:()=>toLocalDateTimeString,jh:()=>addWeeks,kC:()=>formatCardDatesShort,ke:()=>compareTrelloCheckItems,kt:()=>mapsEqual,lX:()=>getLinkParam,lv:()=>visibleToKendo,mH:()=>addMinutes,mI:()=>getTrelloMemberAvatarColorHash,mb:()=>copyToClipboardAsync,mh:()=>isInRange,mv:()=>shallowClone,n0:()=>getFilterRegexByStartOfWords,nN:()=>compress,nT:()=>getMidday,nb:()=>setsEqual,np:()=>loadFileAsDataUrlAsync,nx:()=>deepAssign,of:()=>isDateString,ok:()=>intervalsIntersect,oy:()=>fromDateString,p6:()=>formatDate,pW:()=>getFirstDateOfMonth,q_:()=>setTime,qb:()=>isValidDate,rs:()=>datesEqual,sD:()=>getWeekEnd,sO:()=>getParentControllerByClass,tC:()=>toDateString,tE:()=>getWeekStart,uZ:()=>clamp,uz:()=>getLabelHash,v7:()=>getQuarterEnd,v8:()=>addSeconds,vM:()=>groupBy,vr:()=>getLastDayOfWeek,wD:()=>removeUTCOffset,wd:()=>toRecurrenceExceptionDate,xj:()=>isSameMonth,y9:()=>compareTrelloCustomFields,z7:()=>normalizeTimeZone,zD:()=>parseTrelloCardDescription,zE:()=>isFile,zI:()=>addMonths,zg:()=>formatRelativeDate,zi:()=>AsyncQueue});i(52020),i(88546),i(2201);var r=i(26171),n=i(57445),a=i.n(n),s=i(56626),o=i.n(s),l=i(22574),d=i.n(l),c=i(35293),h=i.n(c),u=i(76555),p=i.n(u),m=i(29898),g=i.n(m),y=i(40703),v=i.n(y),f=i(7488),_=i.n(f),C=i(61539),S=i.n(C),w=i(98235),k=i.n(w),b=i(73324),D=i.n(b),T=i(27525),E=i.n(T),A=i(45181),I=i.n(A),P=i(78490),R=i.n(P),L=i(23513),N=i.n(L),O=i(35704),M=i.n(O),$=i(19178),x=i.n($),B=i(35820),H=i.n(B),U=i(9938),F=i.n(U),W=i(57170),z=i.n(W),G=i(66924),j=i.n(G),V=i(58218),K=i.n(V),Y=i(55243),q=i.n(Y),Z=i(53706),X=i.n(Z),Q=i(81290),J=i.n(Q),ee=i(3841),te=i.n(ee),ie=i(39272),re=i.n(ie),ne=i(66775),ae=i.n(ne),se=i(88946),oe=i.n(se),le=i(54847),de=i.n(le),ce=i(99595),he=i.n(ce),ue=i(62079),pe=i.n(ue),me=i(91829),ge=i.n(me),ye=i(99560),ve=i.n(ye),fe=i(12383),_e=i(69119),Ce=i(57870),Se=i(3151),we=i(49160),ke=i(44812),be=i(60310),De=i(60792),Te=i(42699),Ee=i(24257),Ae=i(61973),Ie=i(58545),Pe=i(78343),Re=i(77349),Le=i(63500),Ne=i(11640),Oe=i(21593),Me=i(59910),$e=i(11699),xe=i(69690),Be=i(94673),He=i(96843),Ue=i(59485),Fe=i(64063),We=i.n(Fe),ze=i(19755),Ge=i.n(ze),je=i(27885),Ve=i(12846),Ke=i(9996),Ye=i.n(Ke),qe=i(44140),Ze=i.n(qe),Xe=i(71370),Qe=(i(82617),i(8937)),Je=i(20115),et=i(95877),tt=i(48764).Buffer;const it=(0,Ve.Z)();function getDateTime(e,t){if(e)return"string"==typeof e?Xe.ou.fromISO(e,{zone:t}):Xe.ou.fromJSDate(e,{zone:t})}function ngInject(e){return t=>{t.descriptor?t.descriptor.value.$inject=e:t.elements.push(a()({kind:"method",key:"$inject",placement:"static",descriptor:a()({enumerable:!1,configurable:!0,get:function(){return e}},o(),{value:"Descriptor"})},o(),{value:"Descriptor"}))}}function visibleToKendo(){return e=>{e.descriptor&&(e.descriptor.enumerable=!0)}}function getHourStart(e){if(e)return fe.Z("string"==typeof e?new Date(e):e)}function getDayStart(e){if(e)return _e.Z("string"==typeof e?new Date(e):e)}function getDayEnd(e){if(e)return Ce.Z("string"==typeof e?new Date(e):e)}function getMidday(e){if(e)return addHours(getDayStart(e),12)}function getWeekStart(e,t){if(!e)return;let i=getDayStart(e);for(let e=0;e<7;e++){if(i.getDay()===t)return i;i=addDays(i,-1)}return i}function getWeekEnd(e,t){if(!e)return;let i=getDayStart(e);for(let e=0;e<7;e++){if(i.getDay()===t)return i;i=addDays(i,1)}return i}function getFirstDateOfMonth(e){return kendo.date.firstDayOfMonth(e)}function getLastDateOfMonth(e){return kendo.date.lastDayOfMonth(e)}function getFirstDayOfWeek(){return kendo.culture().calendar.firstDay}function getLastDayOfWeek(){return(getFirstDayOfWeek()+6)%7}function getQuarterStart(e){let t=3*(Math.ceil((e.getMonth()+1)/3)-1);return new Date(e.getFullYear(),t,1)}function getQuarterEnd(e){let t=3*(Math.ceil((e.getMonth()+1)/3)-1)+2,i=new Date(e.getFullYear(),t+1,0).getDate();return new Date(e.getFullYear(),t,i)}function getYearStart(e){return new Date(e.getFullYear(),0,1)}function getYearEnd(e){return new Date(e.getFullYear(),11,31)}function isSameDay(e,t){if(e&&t)return Se.Z("string"==typeof e?new Date(e):e,"string"==typeof t?new Date(t):t)}function isSameMonth(e,t){if(e&&t)return we.Z("string"==typeof e?new Date(e):e,"string"==typeof t?new Date(t):t)}function isFirstDayOfMonth(e){if(e)return ke.Z("string"==typeof e?new Date(e):e)}function isLastDayOfMonth(e){if(e)return be.Z("string"==typeof e?new Date(e):e)}function isSameYear(e,t){if(e&&t)return De.Z("string"==typeof e?new Date(e):e,"string"==typeof t?new Date(t):t)}function isAfter(e,t){if(e&&t)return Te.Z("string"==typeof e?new Date(e):e,"string"==typeof t?new Date(t):t)}function isInRange(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[]";if(e&&t&&i)return!!Ee.Z("string"==typeof e?new Date(e):e,{start:"string"==typeof t?new Date(t):t,end:"string"==typeof i?new Date(i):i})&&(("("!==r[0]||!datesEqual(e,t))&&(")"!==r[1]||!datesEqual(e,i)))}function isWorkDay(e,t){return!t||t.start<=t.end&&e>=t.start&&e<=t.end||t.start>t.end&&(e>=t.start||e<=t.end)}function getNextWorkDay(e,t){if(!e)return;let i=e;for(let e=0;e<7;e++)if(i=addDays(i,1),isWorkDay(i.getDay(),t))return i;return e}function addSeconds(e,t){if(e)return Ae.Z("string"==typeof e?new Date(e):e,t)}function addMinutes(e,t){if(e)return Ie.Z("string"==typeof e?new Date(e):e,t)}function addHours(e,t){if(e)return Pe.Z("string"==typeof e?new Date(e):e,t)}function addDays(e,t){if(e)return Re.Z("string"==typeof e?new Date(e):e,t)}function addWeeks(e,t){if(e)return Le.Z("string"==typeof e?new Date(e):e,t)}function addMonths(e,t){if(e)return Ne.Z("string"==typeof e?new Date(e):e,t)}function addYears(e,t){if(e)return Oe.Z("string"==typeof e?new Date(e):e,t)}function addWorkMs(e,t,i){if(!e)return;if(t=d()(t),!i)return new Date(e.valueOf()+t);let r=e,n=(e=getDayStart(e)).getDay(),a=isWorkDay(n,i),s=getIntervalMs(e,r),o=e.getTime();if(t>=0)for(a&&(t+=s);;){if(n===i.start&&(a=!0),a){let i=addDaysFast(e,1);if(t<i-o&&e.setTime(o+t),t-=i-o,o=i,t<=0)return e}else o=addDaysFast(e,1);n===i.end&&(a=!1),n++,n>6&&(n=0)}else{if(a&&(t+=s)>=0)return new Date(o+t);for(;;){if(n===i.end&&(a=!0),a){if(t>=0)return e;let i=addDaysFast(e,-1);t>i-o&&e.setTime(o+t),t+=o-i,o=i}else o=addDaysFast(e,-1);n===i.start&&(a=!1),n--,n<0&&(n=6)}}}function setTime(e,t){if(!e||!t)return;if("string"==typeof t&&(t=new Date(t)),datesEqual(e,t))return t;let i=new Date(e);return i.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i}function roundTime(e,t){if(!e)return;let i=new Date(e);switch(t){case"minute":i.setMilliseconds(0),i.setSeconds(0);break;case"quarterHour":i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(15*Math.floor(i.getMinutes()/15));break;case"halfHour":i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(30*Math.floor(i.getMinutes()/30))}return i}function getDateWithTime(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!e)return;let a=new Date(e);return a.setHours(t,i,r,n),a}function getIntervalMs(e,t){if(e&&t)return Me.Z("string"==typeof t?new Date(t):t,"string"==typeof e?new Date(e):e)}function getIntervalSeconds(e,t){if(e&&t)return $e.Z("string"==typeof t?new Date(t):t,"string"==typeof e?new Date(e):e)}function getIntervalMinutes(e,t){if(e&&t)return xe.Z("string"==typeof t?new Date(t):t,"string"==typeof e?new Date(e):e)}function getIntervalDays(e,t){if(e&&t)return Be.Z("string"==typeof t?new Date(t):t,"string"==typeof e?new Date(e):e)}function getDatesInInterval(e,t){if(!e||!t)return[];if((e="string"==typeof e?new Date(e):e)>(t="string"==typeof t?new Date(t):t))return[];let i=[getDayStart(e)],r=getIntervalDays(e,t);for(;r;)i.push(addDays(e,r)),r--;return i}function minutesToIntervalUnits(e){if(0===e)return{unit:"minutes",value:0};const t=Xe.nL.fromObject({minutes:e,hours:0,days:0,weeks:0}).normalize();return t.minutes?{unit:"minutes",value:t.as("minutes")}:t.hours?{unit:"hours",value:t.as("hours")}:t.days?{unit:"days",value:t.as("days")}:{unit:"weeks",value:t.as("weeks")}}function intervalUnitsToMinutes(e,t){switch(e){case"weeks":case"days":case"hours":case"minutes":return Xe.nL.fromObject({[e]:t}).as("minutes");default:return t}}function intervalsIntersect(e,t,i,r){return!!(e&&t&&i&&r)&&(i<=t&&r>=e)}function countWorkTime(e,t,i){if(!e||!t)return;if("string"==typeof e&&(e=new Date(e)),"string"==typeof t&&(t=new Date(t)),!i)return{days:getIntervalDays(e,t),minutes:getIntervalMinutes(e,t),ms:getIntervalMs(e,t)};let r=e>t;if(r){let i=e;e=t,t=i}let n=e.getDay(),a=isWorkDay(n,i),s=getDayStart(e),o=0,l=0,d=0,c=!1;a&&(o=-getIntervalMs(s,e),l=-getIntervalMinutes(s,e));let h=s.getTime(),u=t.getTime();for(;;){n===i.start&&(a=!0),a&&(c&&d++,c=!0);let e=addDaysFast(s,1);if(e>=u)return a&&(o+=u-h,l+=getIntervalMinutes(h,t)),c&&e===u&&isWorkDay((n+1)%7,i)&&d++,r&&(o=-o,l=-l,d=-d),{ms:o,minutes:l,days:d};a&&(o+=e-h,l+=(e-h)/6e4),h=e,n===i.end&&(a=!1),n++,n>6&&(n=0)}}function isDateString(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function fromDateString(e){if(!e)return;const[,t,i,r]=/^(\d{4})-(\d{2})-(\d{2})$/.exec(e);return new Date(t,i-1,r)}function toDateString(e){let t=getDateTime(e);if(t)return t.toISODate()}function toTimeString(e){return formatDate(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:mm")}function fromDateOrISOString(e,t){if(e)return(null!=t?t:isDateString(e))?fromDateString(e):new Date(e)}function fromLocalDateTimeString(e){if(e)return Xe.ou.fromISO(e,{setZone:!0}).setZone("local",{keepLocalTime:!0}).toJSDate()}function toLocalDateTimeString(e){return formatDate(e,"yyyy-MM-dd'T'HH:mm:ss")}function fromDateTimeByTimeZone(e,t){if(e)return t?Xe.ou.fromISO(e,{zone:t}).toJSDate():fromLocalDateTimeString(e)}function normalizeTimeZone(e){var t,i;return e?null!==(t=null===(i=(0,Ue.Z)(e)[0])||void 0===i?void 0:i.iana)&&void 0!==t?t:e:""}function getLocalTimeZone(){var e;return Xe.ou.local().zoneName||(null===(e=Ze().determine())||void 0===e?void 0:e.name())}function getTimeZoneOffset(e){return Xe.ou.now().setZone(e).offset}function applyUTCOffset(e){let t=getDateTime(e);if(t)return Xe.ou.fromISO(t.toISO({includeOffset:!1}),{zone:"utc"}).toJSDate()}function removeUTCOffset(e){let t=getDateTime(e);if(t)return Xe.ou.fromISO(t.toISO({includeOffset:!1})).toJSDate()}function getTimeZoneDateAsUtc(e,t){return Xe.ou.fromJSDate(e).setZone(t).setZone("utc",{keepLocalTime:!0}).toJSDate()}function getUtcAsTimeZoneDate(e,t){return Xe.ou.fromJSDate(e).setZone("utc").setZone(t,{keepLocalTime:!0}).toJSDate()}function isDayStart(e){if(e)return datesEqual(e,getDayStart(e))}function isValidDate(e){return!!e&&!h()(e.getTime())}function datesEqual(e,t){return e&&t?He.Z("string"==typeof e?new Date(e):e,"string"==typeof t?new Date(t):t):!e==!t}function arraysEqual(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length!==t.length)return!1;var r,n;i&&(e=p()(r=[...e]).call(r),t=p()(n=[...t]).call(n));return We()(e,t)}function mapsEqual(e,t){if(e.size!==t.size)return!1;for(let i of g()(e).call(e))if(!t.has(i))return!1;for(let[i,r]of v()(e).call(e))if(!We()(r,t.get(i)))return!1;return!0}function setsEqual(e,t){if(e.size!==t.size)return!1;for(let i of g()(e).call(e))if(!t.has(i))return!1;return!0}function objectsEqual(e,t){return We()(e,t)}function toRecurrenceExceptionDate(e){var t,i,r,n,a;if(!e)return;let s="string"==typeof e?new Date(e):e,o=s.getUTCFullYear(),l=s.getUTCMonth()+1,d=s.getUTCDate(),c=s.getUTCHours(),h=s.getUTCMinutes(),u=s.getUTCSeconds();return`${o}${_()(t=String(l)).call(t,2,"0")}${_()(i=String(d)).call(i,2,"0")}T${_()(r=String(c)).call(r,2,"0")}${_()(n=String(h)).call(n,2,"0")}${_()(a=String(u)).call(a,2,"0")}Z`}function fromRecurrenceExceptionDate(e,t){return S()(e).call(e,"Z")?Xe.ou.fromFormat(e,"yyyyMMdd'T'HHmmss'Z'").setZone("utc",{keepLocalTime:!0}).toJSDate():/^[0-9]{8}T[0-9]{6}$/.test(e)?t?Xe.ou.fromFormat(e,"yyyyMMdd'T'HHmmss",{zone:t}).toJSDate():Xe.ou.fromFormat(e,"yyyyMMdd'T'HHmmss").toUTC().toJSDate():/^[0-9]{8}$/.test(e)?Xe.ou.fromFormat(e,"yyyyMMdd").toUTC().toJSDate():void 0}function mergeObjects(e,t,i){for(let a in i){var r,n;if(!We()(i[a],t[a]))if(We()(e[a],t[a]))e[a]=i[a];else if(e[a]&&t[a])if(k()(e[a]))e[a]=[...D()(r=e[a]).call(r,(e=>{var r,n;return!E()(r=t[a]).call(r,(t=>We()(t,e)))||!!E()(n=i[a]).call(n,(t=>We()(t,e)))})),...D()(n=i[a]).call(n,(i=>{var r,n;return!E()(r=t[a]).call(r,(e=>We()(e,i)))&&!E()(n=e[a]).call(n,(e=>We()(e,i)))}))];else e[a].constructor===Object&&mergeObjects(e[a],t[a],i[a])}}function capitalizeString(e){if(e)return e.charAt(0).toUpperCase()+e.substr(1)}const rt=new Intl.Collator;function compareStrings(e,t){return rt.compare(e,t)}function compareTrelloMembers(e,t,i){return i&&e.id===i.id?-1:i&&t.id===i.id?1:compareStrings(e.fullName,t.fullName)}function compareEventAttendees(e,t){return e.isSelected&&!t.isSelected?-1:t.isSelected&&!e.isSelected?1:e.memberType===Qe.wO.Google&&t.memberType===Qe.wO.Trello?-1:e.memberType===Qe.wO.Trello&&t.memberType===Qe.wO.Google?1:compareStrings(e.fullName,t.fullName)}const nt={green_light:1,green:2,green_dark:3,yellow_light:4,yellow:5,yellow_dark:6,orange_light:7,orange:8,orange_dark:9,red_light:10,red:11,red_dark:12,purple_light:13,purple:14,purple_dark:15,blue_light:16,blue:17,blue_dark:18,sky_light:19,sky:20,sky_dark:21,lime_light:22,lime:23,lime_dark:24,pink_light:25,pink:26,pink_dark:27,black_light:28,black:29,black_dark:30,null:31};function compareTrelloLabels(e,t){let i=(nt[e.color]||100)-(nt[t.color]||100);return 0===i&&(i=compareStrings(e.name,t.name)),i}function compareTrelloLists(e,t){let i=compareStrings(e.boardName,t.boardName);return 0===i&&(i=e.position-t.position),i}const at={checkbox:1,date:2,list:3,number:4,text:5};function compareTrelloCustomFields(e,t){let i=e.position-t.position;return 0===i&&(i=(at[e.type]||100)-(at[t.type]||100),0===i&&(i=compareStrings(e.name,t.name))),i}function compareTrelloReminders(e,t){let i=t.remindBefore-e.remindBefore;return 0===i&&(i=compareStrings(t.id,e.id)),i}function compareGoogleReminders(e,t){return e.remindBefore-t.remindBefore}function compareTrelloChecklists(e,t){let i=e.position-t.position;return 0===i&&(i=compareStrings(e.name,t.name)),i}function compareTrelloCheckItems(e,t){let i=e.position-t.position;return 0===i&&(i=compareStrings(e.name,t.name)),i}function compareTrelloTimeRecords(e,t){if(e.id===Je.$d)return-1;if(t.id===Je.$d)return 1;let i=t.from-e.from;return 0===i&&(i=t.to-e.to,0===i&&(i=compareStrings(t.id,e.id))),i}function compareTrelloAttachments(e,t){let i=t.position-e.position;return 0===i&&(i=t.date-e.date,0===i&&(i=compareStrings(t.id,e.id))),i}function compareTrelloComment(e,t){var i,r;if(I()(i=e.id).call(i,Je.$d)!==I()(r=t.id).call(r,Je.$d)){var n,a;if(I()(n=t.id).call(n,Je.$d))return 1;if(I()(a=e.id).call(a,Je.$d))return-1}let s=t.creationDate-e.creationDate;return 0===s&&(s=compareStrings(t.id,e.id)),s}function getLabelHash(e){let t=e.color||"null";var i;e.name&&(t=`${t}-${R()(i=e.name).call(i," ","_")}`);return t}function getCustomFieldHash(e){var t;return`${e.type}-${R()(t=e.name).call(t," ","_")}`}function getNewTrelloPosition(e,t){if(t.length<=1)return Je.LA;if(0===e)return 1===t.length?Je.LA:t[e+1].position/2;if(e<t.length-1){return(t[e-1].position+t[e+1].position)/2}return e>t.length-1&&(e=t.length-1),t[e-1].position+Je.LA}function isFile(e){return e&&e.constructor===File}const st=new(N())(["jpg","jpeg","png","bmp","gif"]);function isImage(e){let t;var i,r,n,a;e.type?t=M()(i=e.type).call(i,x()(r=e.type).call(r,"/")+1):t=M()(n=e.name).call(n,x()(a=e.name).call(a,".")+1);return st.has(t)}function loadFileAsDataUrlAsync(e){return new(H())(((t,i)=>{let r=new FileReader;r.onload=()=>{0===e.size?t(`${r.result}${e.type};base64,`):t(r.result)},r.onerror=e=>i(e),r.readAsDataURL(e)}))}function formatCardTimes(e,t){if(!e||!t)return;if("string"==typeof e&&(e=new Date(e)),"string"==typeof t&&(t=new Date(t)),datesEqual(e,t))return formatCardTimesShort(e);let i,r=0===t.getMinutes()?"ts1":"ts0",n=e.getHours(),a=t.getHours();return i=n<12&&a<12||n>=12&&a>=12?0===e.getMinutes()?"ts3":"ts2":0===e.getMinutes()?"ts1":"ts0",kendo.format(`{0:${i}} – {1:${r}}`,e,t)}function formatCardTimesShort(e){if(!e)return;"string"==typeof e&&(e=new Date(e));let t=0===e.getMinutes()?"ts1":"ts0";return kendo.format(`{0:${t}}`,e)}function formatCardDates(e,t,i){if(!e||!t)return;"string"==typeof e&&(e=new Date(e)),"string"==typeof t&&(t=new Date(t));let r=!isSameYear(e,new Date)||!isSameYear(t,new Date)?"{0:D}":"{0:Dm}";i&&(r+=" {0:ts0}");let n=kendo.format(r,e);if(i){if(datesEqual(e,t))return n;isSameDay(e,t)&&(r="{0:ts0}")}else if(isSameDay(e,t))return n;return`${n} – ${kendo.format(r,t)}`}function formatCardDatesShort(e,t){if(e&&t)return"string"==typeof e&&(e=new Date(e)),"string"==typeof t&&(t=new Date(t)),isSameDay(e,t)?kendo.toString(e,"Dm"):isSameMonth(e,t)?kendo.format("{0:Dd} – {1:Dm}",e,t):isSameYear(e,t)?kendo.format("{0:Dm} – {1:Dm}",e,t):kendo.format("{0:D} – {1:D}",e,t)}function formatCardDatesLong(e,t){if(e&&t)return"string"==typeof e&&(e=new Date(e)),"string"==typeof t&&(t=new Date(t)),isSameYear(e,t)?kendo.format("{0:dd MMMM} – {1:dd MMMM yyyy}",e,t):kendo.format("{0:dd MMMM yyyy} – {1:dd MMMM yyyy}",e,t)}function formatDate(e,t){const i=getDateTime(e);if(i)return i.toFormat(t,{locale:"en"})}function formatRelativeDate(e){let t=getDateTime(e);if(t)return Math.abs(getIntervalDays(e,new Date))<7?t.toRelative():formatFullDate(e)}function formatFullDate(e){let t=getDateTime(e);if(t)return t.toFormat("DDD t")}function formatShortDate(e,t){let i,r=getDateTime(e);if(r)return i=t?"DDD":isSameDay(e,new Date)?"t":"t, DDD",r.toFormat(i)}function formatTimestamp(e){return Xe.nL.fromMillis(e).toFormat("hh:mm:ss.SSS")}function formatCardDuration(e){return formatDuration(6e4*e,"days")}function formatTimeRecordDuration(e){let t=Xe.nL.fromObject({minutes:e}).shiftTo("hours","minutes");return t.minutes?`${t.hours}h ${t.minutes}m`:t.hours?`${t.hours}h`:`${t.minutes}m`}function formatDuration(e){let t;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"days"){case"minutes":t=["minutes"];break;case"hours":t=["minutes","hours"];break;case"days":t=["minutes","hours","days"]}let i=Xe.nL.fromMillis(e).shiftTo(...t).toObject(),r=[];return i.days&&r.push(`${i.days}d`),i.hours&&r.push(`${i.hours}h`),i.minutes&&r.push(`${i.minutes}m`),r.join(" ")}function getCorrectedLocale(e){if(e)try{if(kendo.cultures.hasOwnProperty(e))return e;let t=e.toLowerCase();if(I()(t).call(t,"en"))t="en-US";else if(I()(t).call(t,"pt"))t="pt-BR";else if("zh-hant"===t)t="zh-Hant";else if(I()(t).call(t,"zh"))t="zh-Hans";else{let e=["cs","de","es","fi","fr","hu","it","ja","nb","nl","pl","ru","sv","th","tr","uk","vi"];for(let i of e)if(I()(t).call(t,i)){t=i;break}}if(kendo.cultures.hasOwnProperty(t))return t}catch{}return"en-US"}function delayAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new(H())((t=>F()(t,e)))}function keepScrollFocus(e){if(e[0]){let t=e.parent(),i=t.scrollTop();e[0].focus({preventScroll:!0}),t.scrollTop(i)}}function addDaysFast(e,t){return e.setDate(e.getDate()+t)}function getLinkParam(e,t){return function getLinkParamFromString(e,t){return new(z())(e).get(t)}(e.location.search,t)}function getLinkParams(e){return function getLinkParamsFromString(e){return j()(new(z())(e))}(e.location.search)}function setLinkParams(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=new(z());for(let e in t){let i=t[e];void 0!==i&&r.set(e,i)}let n=`${e.location.origin}${e.location.pathname}`,a=r.toString();a&&(n+=`?${a}`),i?e.history.pushState(t,"",n):e.history.replaceState(t,"",n)}function deleteLinkParam(e,t){!function deleteLinkParams(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=getLinkParams(e);for(let e of t)delete r[e];setLinkParams(e,r,i)}(e,[t],!(arguments.length>2&&void 0!==arguments[2])||arguments[2])}function deleteCachedRequest(e){try{et.Xb.removeItem(e)}catch{}}function getExtension(e){var t;return null===(t=/\.([a-z0-9]{1,6})$/i.exec(e))||void 0===t?void 0:t[1].toLowerCase()}function copyToClipboardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body";const i=Ge()("<input />").css({position:"fixed",opacity:0}).val(e).appendTo(t);return i[0].select(),new(H())((e=>{F()((()=>{window.document.execCommand("copy"),i.remove(),e()}),0)}))}function clamp(e,t,i){return e<t?t:e>i?i:e}function roundNumber(e,t){return h()(e)?e:Math.round((e+q())*Math.pow(10,t))/Math.pow(10,t)}function getTrelloMemberAvatarColorHash(e){var t;let i=ve()(e);return X()(t=i.split("")).call(t,((e,t)=>e+t.charCodeAt(0)),0)%9}function getTrelloBoardColorHash(e){var t;let i=ve()(e);return X()(t=i.split("")).call(t,((e,t)=>e+t.charCodeAt(0)),0)%9}function getTrelloOrganizationColorHash(e){var t;return X()(t=e.split("")).call(t,((e,t)=>e+t.charCodeAt(0)),0)%5}function parseTrelloCardDescription(e){let t={description:e,data:"",match:""};function extractPlanywayData(e){let t=e.match(/\u200C?\n*-*\n*\[.+\]\(https:\/\/planyway\.com\?cardData=(.*?)\)/);return t||(t=e.match(/\n*\[]\(Planyway_Data-DO_NOT_DELETE\)\[]\((.*?)\)/)),t}if(e){let e;for(;e=extractPlanywayData(t.description);)t.data||(t.data=e[1],t.match=e[0]),t.description=t.description.replace(e[0],"")}return t}function parseTrelloCustomField(e){var t;if(e)return null===(t=e.match(/Do not edit \((.*?)\)/))||void 0===t?void 0:t[1]}function escapeRegExp(e){return e?e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function getFilterRegexByStartOfWords(e){return new RegExp(`\\b${escapeRegExp(e)}`,"i")}class AsyncQueue{constructor(){(0,r.Z)(this,"_queue",[])}add(e){return new(H())((t=>{this._queue.push({fn:e,resolve:t})}))}async resolveNext(){if(!this._queue.length)return;let{fn:e,resolve:t}=this._queue.shift();t(await e())}}function saveDataUrlAs(e,t,i){let r=document.createElement("a"),n="string"!=typeof t&&!(t instanceof String),a=n?J().createObjectURL(t):`data:${e},${encodeURIComponent(t)}`;r.setAttribute("href",a),r.setAttribute("download",i),r.setAttribute("style","display:none;"),document.body.appendChild(r),r.click(),F()((()=>{n&&a&&J().revokeObjectURL(a),document.body.removeChild(r)}))}function getParentControllerByClass(e,t){let i,r=e;for(;r=r.$parent,r;)if(r.$ctrl instanceof t){i=r.$ctrl;break}return i}function shallowClone(e){return te()(re()(e),ae()(e))}function objectGet(e,t,i){if(!e)return;let r=e,n=t.split(".");for(let e=0;e<n.length;++e)if(r=r[n[e]],null==r)return null!=i?i:r;return r}function objectSet(e,t,i){let r=e,n=t.split(".");for(let e=0;e<n.length;++e)e===n.length-1?r[n[e]]=i:(null!==r[n[e]]&&void 0!==r[n[e]]||(r[n[e]]={}),r=r[n[e]])}function getAbbreviation(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!e)return"";let n=e.split(i);return n.length<r?n[0].substring(0,r).toUpperCase():oe()(t=M()(n).call(n,0,r)).call(t,(e=>{var t,i;return(null===(t=e.match(it))||void 0===t?void 0:t[0])||(null==e||null===(i=e[0])||void 0===i?void 0:i.toUpperCase())||""})).join("")}function groupBy(e,t){return groupByField(e,(e=>e[t]))}function groupByField(e,t){let i=new(de());return e&&e.length&&he()(e).call(e,(e=>{let r=t(e);i.has(r)?i.get(r).push(e):i.set(r,[e])})),i}function filterKeys(e,t){let i={};for(let r of pe()(e))("function"==typeof t?t(r):ge()(t).call(t,r))&&(i[r]=e[r]);return i}function compress(e){let t=tt.from(K()(e)),i=je.ZP.deflate(t,{level:3});return tt.from(i).toString("base64")}function decompress(e){let t=tt.from(e,"base64"),i=je.ZP.inflate(t);return JSON.parse(tt.from(i).toString())}function deepAssign(e,t){return Ye()(e,t,{arrayMerge:(e,t)=>t||e})}},13627:(e,t,i)=>{i.d(t,{U:()=>ge});var r=i(40024),n=i.n(r),a=i(99595),s=i.n(a),o=i(57445),l=i.n(o),d=i(90143),c=i.n(d),h=i(56626),u=i.n(h),p=i(62079),m=i.n(p),g=i(52020),y=i.n(g),v=i(88546),f=i.n(v),_=i(66775),C=i.n(_),S=i(2201),w=i.n(S),k=i(26171),b=i(26881),D=i(54847),T=i.n(D),E=i(10349),A=i.n(E),I=i(89221),P=i.n(I),R=i(27525),L=i.n(R),N=i(53706),O=i.n(N),M=i(87994),$=i.n(M),x=i(73324),B=i.n(x),H=i(91829),U=i.n(H),F=i(86981),W=i.n(F),z=i(23513),G=i.n(z),j=i(88946),V=i.n(j),K=i(76555),Y=i.n(K),q=i(51791),Z=i.n(q),X=i(84705),Q=i.n(X),J=i(31082),ee=i.n(J),te=i(67552),ie=i.n(te),re=i(57647),ne=i.n(re),ae=i(83423),se=i.n(ae),oe=i(99560),le=i.n(oe),de=(i(82617),i(56777)),ce=i(70404),he=i(8937),ue=i(29704),pe=i(20115),me=i(95877);function ownKeys(e,t){var i=m()(e);if(y()){var r=y()(e);t&&(r=B()(r).call(r,(function(t){return f()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?s()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,k.Z)(e,t,n[t])})):C()?w()(e,C()(n)):s()(r=ownKeys(Object(n))).call(r,(function(t){l()(e,t,f()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}l()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),s()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==Z()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];c()(s).call(s,Z()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var h=0;h<d.length;h++)this.addElementPlacement(d[h],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,u(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return V()(t=(0,b.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:ie()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:V()(e).call(e,this.fromElementDescriptor,this)};return l()(t,u(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let ge=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=W()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(V()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,ue.SG)(["$injector","$rootScope","$window","$interval","$log","$timeout","$translate","dialogSrv","licenseSrv","notificationSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class AppCommonService{constructor(t,i,r,n,a,s,o,l,d,c,h,u,p,m){e(this),this._$injector=t,this._$rootScope=i,this._$window=r,this._$interval=n,this._$log=a,this._$timeout=s,this._$translate=o,this._dialogSrv=l,this._licenseSrv=d,this._notificationSrv=c,this._planywayIntegrationSrv=h,this._platformSrv=u,this._settingsSrv=p,this._telemetrySrv=m,this._isSchedulerButtonBusy=!0,this._isSchedulerBusy=!1,this._filtersCardSearchString="",this._watchTimeZoneChange(),this._$rootScope.$watch((()=>this.isPlanywayShown()),(e=>{e&&this._$rootScope.$broadcast(he.FK.PlanywayShown)}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"appCommonSrv"}},{kind:"field",key:"_appContext",value:void 0},{kind:"get",key:"_collectionSrv",value:function _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=this._$injector.get("collectionSrv")),this._collectionSrvLazy}},{kind:"method",key:"getAppContextAsync",value:function getAppContextAsync(){return this._appContext={},this._appContext}},{kind:"method",key:"getAppContext",value:function getAppContext(){return this._appContext}},{kind:"method",key:"getLocale",value:function getLocale(){try{let e=this._locale||me.Xb.planywayLocale;if(e)return e}catch(e){this._$log.error("Planyway get locale error:"),this._$log.error(e)}return(0,ue.C9)(se().replace("_","-"))}},{kind:"method",key:"setLocale",value:function setLocale(e){let t=this.getLocale();if(e){if(this._locale=e,me.Xb.planywayLocale=e,e!==t){(this._$translate.negotiateLocale(e)||pe.L2)!==(this._$translate.negotiateLocale(t)||pe.L2)&&this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.LOCALE_CHANGED_WARNING"),he.k$.WarningWithReload,he.Ne.LocaleChanged)}}else this._locale=t,me.Xb.planywayLocale=t;this.applyLocale()}},{kind:"method",key:"applyLocale",value:function applyLocale(){var e;let t=this.getLocale();kendo.culture(t),(0,ce.jk)(t,null!==(e=this._userSettings.global.settings.firstWeekDay)&&void 0!==e?e:kendo.culture().calendar.firstDay)}},{kind:"method",key:"getLanguage",value:function getLanguage(e){return(e||this.getLocale()).replace("-","_")}},{kind:"method",key:"isSchedulerButtonBusy",value:function isSchedulerButtonBusy(){return this._isSchedulerButtonBusy}},{kind:"method",key:"setSchedulerButtonBusy",value:function setSchedulerButtonBusy(e){this._$timeout((()=>this._isSchedulerButtonBusy=e))}},{kind:"method",key:"isSchedulerBusy",value:function isSchedulerBusy(){return this._isSchedulerBusy}},{kind:"method",key:"setSchedulerBusy",value:function setSchedulerBusy(e){void 0===this._schedulerBusyCounter&&(this._schedulerBusyCounter=0),e?(0===this._schedulerBusyCounter&&this._$timeout((()=>this._isSchedulerBusy=!0)),this._schedulerBusyCounter++):(this._schedulerBusyCounter--,0===this._schedulerBusyCounter&&this._$timeout((()=>this._isSchedulerBusy=!1)))}},{kind:"get",key:"isUiPreconditionsPassed",value:function isUiPreconditionsPassed(){return!!this._currentCollectionId&&!!(this._collectionSrv.isCurrentCollectionUnavailable||this._userSettings.global.settings.isOnboardingWelcomeSurveyPassed&&this._collectionSettings.global.settings.isViewTemplateSelected)}},{kind:"method",key:"isPlanywayShown",value:function isPlanywayShown(){return!this._collectionSrv.isCurrentCollectionUnavailable}},{kind:"method",key:"setPlanywayShown",value:function setPlanywayShown(e){}},{kind:"method",key:"getPlanywayOrientation",value:function getPlanywayOrientation(){}},{kind:"method",key:"setPlanywayOrientation",value:function setPlanywayOrientation(e){}},{kind:"method",key:"getLayoutOrientation",value:function getLayoutOrientation(){return this._collectionSettings.global.settings.layout.orientation}},{kind:"method",key:"setLayoutOrientation",value:function setLayoutOrientation(e){this._collectionSettings.global.settings.layout.orientation=e,this._collectionSettings.global.saveAsync()}},{kind:"method",key:"flipLayoutOrientation",value:function flipLayoutOrientation(){this.setLayoutOrientation(he.cs[this.getLayoutOrientation()])}},{kind:"method",key:"getExpandedLayoutPanel",value:function getExpandedLayoutPanel(){var e;let t=this.getSchedulerMode();return t===he.ud.Board?he.sF.Scheduler:null!==(e=this._collectionSettings.global.settings.layout.expandedPanels[t])&&void 0!==e?e:null}},{kind:"method",key:"setExpandedLayoutPanel",value:function setExpandedLayoutPanel(e){let t=this.getSchedulerMode();if(t===he.ud.Board);else this._collectionSettings.global.settings.layout.expandedPanels[t]=e,this._collectionSettings.global.saveAsync()}},{kind:"method",key:"flipExpandedLayoutPanel",value:function flipExpandedLayoutPanel(){switch(this.getExpandedLayoutPanel()){case he.sF.Scheduler:this.setExpandedLayoutPanel(he.sF.WorkPanel);break;case he.sF.WorkPanel:this.setExpandedLayoutPanel(he.sF.Scheduler)}}},{kind:"method",key:"isMiniLayout",value:function isMiniLayout(){return this._isMiniLayout}},{kind:"method",key:"setMiniLayout",value:function setMiniLayout(e){this._isMainSidebarShown=!e&&this._collectionSettings.local.settings.mainSidebar.isShown,void 0===this._isMiniLayout?this._isMiniLayout=e:this._$timeout((()=>this._isMiniLayout=e))}},{kind:"method",key:"getSchedulerWidget",value:function getSchedulerWidget(){return this._schedulerWidget}},{kind:"method",key:"setSchedulerWidget",value:function setSchedulerWidget(e){this._schedulerWidget=e}},{kind:"method",key:"getSchedulerMode",value:function getSchedulerMode(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this._schedulerMode)return this._schedulerMode;this._schedulerMode||this._$timeout((()=>{this._schedulerMode=null}),0,!1);let e=he.lv[this._collectionSettings.global.settings.schedulerMode];return e&&!this._licenseSrv.checkPaidFeatureAvailable(e,!1)?this._schedulerMode=he.ud.Calendar:this.isAvailableSchedulerMode(this._collectionSettings.global.settings.schedulerMode)?this._schedulerMode=this._collectionSettings.global.settings.schedulerMode:this._schedulerMode=he.ud.Calendar,this._schedulerMode}},{kind:"method",key:"getAvailableSchedulerModes",value:function getAvailableSchedulerModes(){let e=new(T());for(let t of this._collectionSrv.getCurrentCollectionConnectedProviders())for(let i of t.getSupportedSchedulerModes())e.has(i.value)||e.set(i.value,i);return A()(P()(e).call(e))}},{kind:"method",key:"isAvailableSchedulerMode",value:function isAvailableSchedulerMode(e){var t;return L()(t=this.getAvailableSchedulerModes()).call(t,(t=>t.value===e))}},{kind:"method",key:"getSchedulerView",value:function getSchedulerView(e){switch(this.getSchedulerMode(e)){case he.ud.Calendar:return this._collectionSettings.global.settings.schedulerView;case he.ud.Timeline:return he.rW.Timeline;case he.ud.TimeTracking:switch(this._collectionSettings.global.settings.timeTrackingView){case he.$5.List:return he.rW.Timesheet;case he.$5.Calendar:return he.rW.Week}break;case he.ud.Board:return he.rW.Board;case he.ud.Reports:return he.rW.Reports}}},{kind:"method",key:"getTimelineView",value:function getTimelineView(e){if(e&&this._timelineView)return this._timelineView;this._timelineView||this._$timeout((()=>{this._timelineView=null}),0,!1);let t=he.cA[this._collectionSettings.global.settings.timelineView];return t&&!this._licenseSrv.checkPaidFeatureAvailable(t,!1)?this._timelineView=he.tS.None:this.isAvailableTimelineView(this._collectionSettings.global.settings.timelineView)?this._timelineView=this._collectionSettings.global.settings.timelineView:this._timelineView=he.tS.None,this._timelineView}},{kind:"method",key:"getAvailableTimelineViews",value:function getAvailableTimelineViews(){var e,t,i;let r=O()(e=$()(t=B()(i=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(i,(e=>e.hasCurrentCollectionSelectedCalendars()))).call(t,(e=>e.getSupportedTimelineViews()))).call(e,((e,t)=>(e.has(t.value)||e.set(t.value,t),e)),new(T()));return A()(P()(r).call(r))}},{kind:"method",key:"isAvailableTimelineView",value:function isAvailableTimelineView(e){var t;return L()(t=this.getAvailableTimelineViews()).call(t,(t=>t.value===e))}},{kind:"method",key:"getTimeTrackingView",value:function getTimeTrackingView(){return this._collectionSettings.global.settings.timeTrackingView}},{kind:"method",key:"getSchedulerSelectedDate",value:function getSchedulerSelectedDate(){return this._schedulerSelectedDate||(this._schedulerSelectedDate=(0,ue.$Y)(new Date)),this._schedulerSelectedDate}},{kind:"method",key:"setSchedulerSelectedDate",value:function setSchedulerSelectedDate(e){return this._schedulerSelectedDate=e}},{kind:"method",key:"isMainSidebarShown",value:function isMainSidebarShown(){return!this._collectionSrv.isCurrentCollectionUnavailable&&(this.isMiniLayout()&&null!==(e=this._isMainSidebarShown)&&void 0!==e?e:this._collectionSettings.local.settings.mainSidebar.isShown);var e}},{kind:"method",key:"setMainSidebarShown",value:function setMainSidebarShown(e){this.isMiniLayout()?this._isMainSidebarShown=e:(this._collectionSettings.local.settings.mainSidebar.isShown=e,this._collectionSettings.local.save())}},{kind:"method",key:"getSchedulerWorkWeek",value:function getSchedulerWorkWeek(){let e=this.getSchedulerView();if(e===he.rW.Week||e===he.rW.Timeline)return this._collectionSettings.global.settings.showWorkDays?{start:this._userSettings.global.settings.workWeekStart,end:this._userSettings.global.settings.workWeekEnd}:void 0}},{kind:"method",key:"getTargetCalendarData",value:function getTargetCalendarData(){let{accountTypes:e,accountIds:t,calendarIds:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this._collectionSettings.local.settings.lastUsedCalendarData;if(r&&(!e||U()(e).call(e,r.accountType))&&(!t||U()(t).call(t,r.accountId))&&(!i||U()(i).call(i,r.calendarId))){let e=(0,de.dS)(r.accountType);if(e.isCurrentCollectionAccountReady(r.accountId)){if(e.getCurrentCollectionConnectedCalendar(r.accountId,r.calendarId).isSelected&&e.canCreateCard(r.accountId,r.calendarId))return{accountType:r.accountType,accountId:r.accountId,calendarId:r.calendarId,availableCardTypes:e.availableCardTypes,defaultCardType:e.defaultCardType,availableCardRoles:e.availableCardRoles,defaultCardRole:e.defaultCardRole}}}for(let r of this._planywayIntegrationSrv.getConnectedAccounts()){var n;if(e&&!U()(e).call(e,r.accountType))continue;if(t&&!U()(t).call(t,r.accountId))continue;let a=(0,de.dS)(r.accountType);if(!a.isCurrentCollectionAccountReady(r.accountId))continue;let s=W()(n=a.getCurrentCollectionSelectedCalendarIds(r.accountId)).call(n,(e=>(!i||U()(i).call(i,e))&&a.canCreateCard(r.accountId,e)));if(s)return{accountType:r.accountType,accountId:r.accountId,calendarId:s,availableCardTypes:a.availableCardTypes,defaultCardType:a.defaultCardType,availableCardRoles:a.availableCardRoles,defaultCardRole:a.defaultCardRole}}}},{kind:"method",key:"getTimelineResourcesType",value:function getTimelineResourcesType(e){switch(this.getTimelineView(e)){case he.tS.None:return he.y.NoResources;case he.tS.Member:return he.y.Members;case he.tS.Board:return he.y.Calendars;case he.tS.List:return he.y.Lists;case he.tS.Label:return he.y.Labels;case he.tS.GitHubAssignee:return he.y.GitHubAssignees;case he.tS.GitHubLabel:return he.y.GitHubLabels;case he.tS.GitHubStatus:return he.y.GitHubStatuses}}},{kind:"method",key:"getTimelineResources",value:function getTimelineResources(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getTimelineResourcesType();if(t===he.y.NoResources)return[];let i=[],r=B()(e=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(e,(e=>e.hasCurrentCollectionSelectedCalendars()));for(let e of r){var n,a;let r=O()(n=$()(a=e.getCurrentCollectionConnectedAccountIds()).call(a,(i=>e.getTimelineResourcesByType(i,t)))).call(n,((e,t)=>{let i=e.get(t.id);return i?(i.accountTypes=[...new(G())([...i.accountTypes,...t.accountTypes])],i.accountIds=[...new(G())([...i.accountIds,...t.accountIds])],i.calendarIds=[...new(G())([...i.calendarIds,...t.calendarIds])]):e.set(t.id,_objectSpread(_objectSpread({},t),{},{resourceData:_objectSpread({},t.resourceData)})),e}),new(T()));i.push(...P()(r).call(r))}let s=this._collectionSettings.global.settings.timelineResourcesOrder[t];if(s){let e=new(T())(V()(i).call(i,((e,t)=>{let{id:i}=e;return[i,t]})));Y()(i).call(i,((t,i)=>{let r=Z()(s).call(s,t.id),n=Z()(s).call(s,i.id);return-1!==r&&-1!==n?r-n:-1!==r?-1:-1!==n?1:e.get(t.id)-e.get(i.id)}))}return V()(i).call(i,((e,t)=>_objectSpread(_objectSpread({},e),{},{order:t})))}},{kind:"method",key:"getTimelineResourceById",value:function getTimelineResourceById(e,t){var i;return W()(i=this.getTimelineResources(e)).call(i,(e=>e.id===t))}},{kind:"method",key:"getFiltersCardSearchString",value:function getFiltersCardSearchString(){return this._filtersCardSearchString}},{kind:"method",key:"setFiltersCardSearchString",value:function setFiltersCardSearchString(e){e=e?Q()(e).call(e).toLowerCase():"",this._filtersCardSearchString!==e&&(this._filtersCardSearchString=e)}},{kind:"method",key:"isABTestEnabled",value:function isABTestEnabled(e){var t,i;return null!==(t=null===(i=this._ABTests)||void 0===i?void 0:i[e])&&void 0!==t&&t}},{kind:"method",key:"initABTests",value:function initABTests(){this._ABTests={};for(let e of ee()(he.hh))this._ABTests[e]=getRandomGroup(`${e}${this._planywayIntegrationSrv.userId}`,2)>0;this._telemetrySrv.setABTestTests(this._ABTests)}},{kind:"method",key:"selectTemplate",value:function selectTemplate(e){let t;e===he.By.Skipped?t=(0,ue.nx)(this._collectionSettings.global.settings,_objectSpread(_objectSpread({},he.mn[he.By.MonthlyCalendar]),{},{isViewTemplateSelected:!0})):(this._userSettings.global.settings.defaultTemplate=e,t=(0,ue.nx)(this._collectionSettings.global.settings,_objectSpread(_objectSpread({},he.mn[e]),{},{isViewTemplateSelected:!0,viewTemplate:e}))),ie()(this._collectionSettings.global.settings,t),this._$rootScope.$broadcast(he.FK.ChangeSchedulerViewRequested),this._userSettings.global.saveAsync(),this._collectionSettings.global.saveAsync()}},{kind:"method",key:"getCancellationToken",value:function getCancellationToken(e){this._cancellationTokens||(this._cancellationTokens={});let t=ne()(),i={_timestamp:t,isCanceled:()=>this._cancellationTokens[e]._timestamp!==t};return this._cancellationTokens[e]=i,i}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"method",key:"_watchTimeZoneChange",value:function _watchTimeZoneChange(){this._lastTimeZone=(0,ue.iT)(),this._$interval((()=>{let e=(0,ue.iT)();e!==this._lastTimeZone&&((0,ue.Wf)(e)!==(0,ue.Wf)(this._lastTimeZone)&&(this._telemetrySrv.logSingleEvent(he.cN.GeneralEvents.TimeZoneChanged,{previousTimeZone:this._lastTimeZone}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.TIME_ZONE_CHANGED"),he.k$.WarningWithReload)),this._lastTimeZone=e)}),5e3,0,!1)}}]}}));function getRandomGroup(e,t){var i;let r=le()(e);return O()(i=r.split("")).call(i,((e,t)=>e+t.charCodeAt(0)),0)%t}},88076:(e,t,i)=>{i.d(t,{j:()=>X});var r=i(40024),n=i.n(r),a=i(57445),s=i.n(a),o=i(51791),l=i.n(o),d=i(90143),c=i.n(d),h=i(56626),u=i.n(h),p=i(67552),m=i.n(p),g=i(86981),y=i.n(g),v=i(62079),f=i.n(v),_=i(52020),C=i.n(_),S=i(88546),w=i.n(S),k=i(66775),b=i.n(k),D=i(2201),T=i.n(D),E=i(26171),A=i(26881),I=i(88946),P=i.n(I),R=i(10349),L=i.n(R),N=i(89221),O=i.n(N),M=i(99595),$=i.n(M),x=i(23513),B=i.n(x),H=i(53706),U=i.n(H),F=i(35820),W=i.n(F),z=i(39290),G=i.n(z),j=i(87994),V=i.n(j),K=i(73324),Y=i.n(K),q=i(82617),Z=(i(46930),i(8937));function ownKeys(e,t){var i=f()(e);if(C()){var r=C()(e);t&&(r=Y()(r).call(r,(function(t){return w()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?$()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,E.Z)(e,t,n[t])})):b()?T()(e,b()(n)):$()(r=ownKeys(Object(n))).call(r,(function(t){s()(e,t,w()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;$()(i=["method","field"]).call(i,(function(i){$()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;$()(i=["method","field"]).call(i,(function(i){$()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}s()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if($()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),$()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==l()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];c()(s).call(s,l()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),d=this.toElementFinisherExtras((0,n[a])(o)||o);e=d.element,this.addElementPlacement(e,t),d.finisher&&r.push(d.finisher);var h=d.extras;if(h){for(var u=0;u<h.length;u++)this.addElementPlacement(h[u],t);i.push.apply(i,h)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return s()(t,u(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return P()(t=(0,A.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:m()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:P()(e).call(e,this.fromElementDescriptor,this)};return s()(t,u(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let X=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=y()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(P()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,i(29704).SG)(["$injector","$rootScope","$log","$interval","$translate","appCommonSrv","collectionSrv","iCalCardsSrv","googleCardsSrv","notificationSrv","outlookCardsSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class CalendarCardsService{constructor(t,i,r,n,a,s,o,l,d,c,h,u,p){var m=this;e(this),this._$injector=t,this._$rootScope=i,this._$log=r,this._$interval=n,this._$translate=a,this._appCommonSrv=s,this._collectionSrv=o,this._iCalCardsSrv=l,this._googleCardsSrv=d,this._notificationSrv=c,this._outlookCardsSrv=h,this._settingsSrv=u,this._telemetrySrv=p,this._cardsServicesByCardType={[q.eT.GoogleEvent]:this._googleCardsSrv,[q.eT.ICalEvent]:this._iCalCardsSrv,[q.eT.OutlookEvent]:this._outlookCardsSrv};{const e=this._$injector.get("trelloCardsSrv");this._cardsServicesByCardType[q.eT.TrelloCard]=e,this._cardsServicesByCardType[q.eT.TrelloCheckItem]=e,this._cardsServicesByCardType[q.eT.TrelloCustomField]=e,this._cardsServicesByCardType[q.eT.TrelloTimeRecord]=e}const updateCardServices=()=>{var e;this._cardsServices=P()(e=this._collectionSrv.getCurrentCollectionConnectedProviders()).call(e,(e=>e.cardsService));for(const{event:e,cardsService:i,callback:r}of L()(O()(t=this._addedCalendarCardsListeners).call(t))){var t;i.removeCalendarCardEventListener(e,r)}this._addedCalendarCardsListeners.clear();for(const e in this._calendarCardsListeners)for(let t of this._cardsServices){let callback=function(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return $()(t=m._calendarCardsListeners[e]).call(t,(e=>e(...r)))};this._addedCalendarCardsListeners.add({cardsService:t,event:e,callback}),t.addCalendarCardEventListener(e,callback)}};updateCardServices();for(const e of[Z.FK.CollectionChanged,Z.FK.AccountAdded,Z.FK.AccountDeleted])this._$rootScope.$on(e,updateCardServices)}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"calendarCardsSrv"}},{kind:"field",key:"_cardsServices",value:void 0},{kind:"field",key:"_cardsServicesByCardType",value:void 0},{kind:"field",key:"_calendarCardsListeners",value:()=>({added:new(B()),updated:new(B()),deleted:new(B()),cleared:new(B())})},{kind:"field",key:"_addedCalendarCardsListeners",value:()=>new(B())},{kind:"method",key:"needReloadCalendarCards",value:function needReloadCalendarCards(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let t of this._cardsServices)t.needReloadCalendarCards(e)}},{kind:"method",key:"getCalendarCardsAsync",value:async function getCalendarCardsAsync(){var e,t,i;let r=U()(e=this._cardsServices).call(e,((e,t)=>{if(t.isCurrentCollectionInitialized)for(let i of t.provider.getCurrentCollectionConnectedAccountIds())e[i]=t;return e}),{});return await W().all(P()(t=G()(r)).call(t,(e=>{let[t,i]=e;return i.loadCalendarCardsAsync(t)}))),V()(i=G()(r)).call(i,(e=>{let[t,i]=e;return i.getCalendarCards(t)}))}},{kind:"method",key:"getCalendarCardByIdAsync",value:function getCalendarCardByIdAsync(e,t,i){let r=this._cardsServicesByCardType[t];if(null==r||!r.getCalendarCardByIdAsync)throw new Error(`Unsupported method for card type: ${t}`);return r.getCalendarCardByIdAsync(e,i,{cardType:t})}},{kind:"method",key:"getCalendarCardById",value:function getCalendarCardById(e,t,i){let r=this._cardsServicesByCardType[t];if(null==r||!r.getCalendarCardById)throw new Error(`Unsupported method for card type: ${t}`);return r.getCalendarCardById(e,i,{cardType:t})}},{kind:"method",key:"waitCalendarCardAsync",value:function waitCalendarCardAsync(e,t,i,r){if(!this._cardsServicesByCardType[i])throw new Error(`Unsupported method for card type: ${i}`);let n=this.getCalendarCardById(e,i,r);return n||new(W())((n=>{const a=this._$rootScope.$on(Z.FK.CollectionCalendarReady,((s,o)=>{o.accountId===e&&o.calendarId===t&&(a(),n(this.getCalendarCardById(e,i,r)))}))}))}},{kind:"method",key:"createCalendarCardAsync",value:function createCalendarCardAsync(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.createCalendarCardAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.createCalendarCardAsync(e)}},{kind:"method",key:"createTempCalendarCard",value:function createTempCalendarCard(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=this._cardsServicesByCardType[t];if(null==n||!n.createTempCalendarCard)throw new Error(`Unsupported method for card type: ${t}`);return n.createTempCalendarCard(e,i,_objectSpread(_objectSpread({},r),{},{cardType:t}))}},{kind:"method",key:"changeCalendarCardType",value:function changeCalendarCardType(e,t,i){const r=e.cardType;if(r===t)return;const n=e.accountId;for(let s of this._cardsServices){var a;null===(a=s.changeCalendarCardType)||void 0===a||a.call(s,e,r,t,n,i)}}},{kind:"method",key:"getIsSendUpdatesRequiredAsync",value:function getIsSendUpdatesRequiredAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.getIsSendUpdatesRequiredAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.getIsSendUpdatesRequiredAsync(e,t)}},{kind:"method",key:"updateCalendarCardAsync",value:function updateCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.updateCalendarCardAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.updateCalendarCardAsync(e,t)}},{kind:"method",key:"updateCalendarCardPropertiesAsync",value:function updateCalendarCardPropertiesAsync(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.updateCalendarCardPropertiesAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.updateCalendarCardPropertiesAsync(e,t,i)}},{kind:"method",key:"removeCalendarCardAsync",value:function removeCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.removeCalendarCardAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.removeCalendarCardAsync(e,t)}},{kind:"method",key:"deleteCalendarCardAsync",value:function deleteCalendarCardAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.deleteCalendarCardAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.deleteCalendarCardAsync(e,t)}},{kind:"method",key:"createRecurrenceExceptionAsync",value:async function createRecurrenceExceptionAsync(e,t,i){let r={title:i.title,description:i.description,isAllDay:i.isAllDay,start:i.start,end:i.end,recurrenceRule:i.recurrenceRule,recurrenceId:i.recurrenceId,originalStart:i.originalStart};switch(t){case q.eT.TrelloCard:r.providerCard={sourceCardId:i.providerCard.sourceCardId,boardId:i.providerCard.boardId,listId:i.providerCard.listId,position:i.providerCard.position,isArchived:i.providerCard.isArchived,isCompleted:i.providerCard.isCompleted,isSubscribed:i.providerCard.isSubscribed,labelIds:i.providerCard.labelIds,memberIds:i.providerCard.memberIds,estimationHours:i.providerCard.estimationHours,priority:i.providerCard.priority,notifications:i.providerCard.notifications,links:i.providerCard.links};break;case q.eT.GoogleEvent:r.providerCard={googleCalendarId:i.providerCard.googleCalendarId,isCompleted:i.providerCard.isCompleted,googleShowAsFree:i.providerCard.googleShowAsFree,googleAttendees:i.providerCard.googleAttendees,googleReminders:i.providerCard.googleReminders};break;case q.eT.OutlookEvent:r.providerCard={outlookCalendarId:i.providerCard.outlookCalendarId,isCompleted:i.providerCard.isCompleted,outlookShowAs:i.providerCard.outlookShowAs,outlookInviteStatus:i.providerCard.outlookInviteStatus,outlookAttendees:i.providerCard.outlookAttendees}}let n=this.createTempCalendarCard(e,t,r);try{return this._appCommonSrv.setSchedulerBusy(!0),await this.createCalendarCardAsync(n)}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"createRecurrenceGapAsync",value:async function createRecurrenceGapAsync(e,t,i){let r=this._cardsServicesByCardType[t];if(null==r||!r.createRecurrenceGapAsync)throw new Error(`Unsupported method for card type: ${t}`);try{this._appCommonSrv.setSchedulerBusy(!0),await r.createRecurrenceGapAsync(e,i,{cardType:t})}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"addExceptionToRecurrentAsync",value:async function addExceptionToRecurrentAsync(e,t,i){let r=this._cardsServicesByCardType[t];if(null==r||!r.addExceptionToRecurrentAsync)throw new Error(`Unsupported method for card type: ${t}`);try{this._appCommonSrv.setSchedulerBusy(!0),await r.addExceptionToRecurrentAsync(e,i,{cardType:t})}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"removeExceptionsFromRecurrentAsync",value:async function removeExceptionsFromRecurrentAsync(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=this._cardsServicesByCardType[t];if(null==n||!n.removeExceptionsFromRecurrentAsync)throw new Error(`Unsupported method for card type: ${t}`);try{this._appCommonSrv.setSchedulerBusy(!0),await n.removeExceptionsFromRecurrentAsync(e,i,_objectSpread(_objectSpread({},r),{},{cardType:t}))}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"deleteRecurrenceExceptionsAsync",value:async function deleteRecurrenceExceptionsAsync(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._cardsServicesByCardType[e];if(null==r||!r.deleteRecurrenceExceptionsAsync)throw new Error(`Unsupported method for card type: ${e}`);try{this._appCommonSrv.setSchedulerBusy(!0),await r.deleteRecurrenceExceptionsAsync(t,_objectSpread(_objectSpread({},i),{},{cardType:e}))}finally{this._appCommonSrv.setSchedulerBusy(!1)}}},{kind:"method",key:"getCalendarCardCustomFieldValues",value:function getCalendarCardCustomFieldValues(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardCustomFieldValues)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardCustomFieldValues(e)}},{kind:"method",key:"getCalendarCardChecklists",value:function getCalendarCardChecklists(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardChecklists)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardChecklists(e)}},{kind:"method",key:"createCalendarCardChecklistAsync",value:function createCalendarCardChecklistAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.createCalendarCardChecklistAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.createCalendarCardChecklistAsync(e,t)}},{kind:"method",key:"updateCalendarCardChecklistAsync",value:function updateCalendarCardChecklistAsync(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=this._cardsServicesByCardType[e.cardType];if(null==n||!n.updateCalendarCardChecklistAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return n.updateCalendarCardChecklistAsync(e,t,i,r)}},{kind:"method",key:"deleteCalendarCardChecklistAsync",value:function deleteCalendarCardChecklistAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.deleteCalendarCardChecklistAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.deleteCalendarCardChecklistAsync(e,t)}},{kind:"method",key:"createCalendarCardCheckItemAsync",value:function createCalendarCardCheckItemAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.createCalendarCardCheckItemAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.createCalendarCardCheckItemAsync(e,t,i)}},{kind:"method",key:"updateCalendarCardCheckItemAsync",value:function updateCalendarCardCheckItemAsync(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=this._cardsServicesByCardType[e.cardType];if(null==a||!a.updateCalendarCardCheckItemAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return a.updateCalendarCardCheckItemAsync(e,t,i,r,n)}},{kind:"method",key:"convertCalendarCardCheckItemAsync",value:function convertCalendarCardCheckItemAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.convertCalendarCardCheckItemAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.convertCalendarCardCheckItemAsync(e,t,i)}},{kind:"method",key:"deleteCalendarCardCheckItemAsync",value:function deleteCalendarCardCheckItemAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.deleteCalendarCardCheckItemAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.deleteCalendarCardCheckItemAsync(e,t,i)}},{kind:"method",key:"getCalendarCardTimeRecords",value:function getCalendarCardTimeRecords(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardTimeRecords)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardTimeRecords(e)}},{kind:"method",key:"getTimeRecords",value:function getTimeRecords(){var e,t;return Y()(e=V()(t=this._cardsServices).call(t,(e=>{var t;return null===(t=e.getTimeRecords)||void 0===t?void 0:t.call(e)}))).call(e,(e=>e))}},{kind:"method",key:"createCalendarCardTimeRecordAsync",value:function createCalendarCardTimeRecordAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.createCalendarCardTimeRecordAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.createCalendarCardTimeRecordAsync(e,t)}},{kind:"method",key:"updateCalendarCardTimeRecordAsync",value:function updateCalendarCardTimeRecordAsync(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=this._cardsServicesByCardType[e.cardType];if(null==n||!n.updateCalendarCardTimeRecordAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return n.updateCalendarCardTimeRecordAsync(e,t,i,r)}},{kind:"method",key:"moveCalendarCardTimeRecordAsync",value:function moveCalendarCardTimeRecordAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.moveCalendarCardTimeRecordAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.moveCalendarCardTimeRecordAsync(e,t,i)}},{kind:"method",key:"deleteCalendarCardTimeRecordAsync",value:function deleteCalendarCardTimeRecordAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.deleteCalendarCardTimeRecordAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.deleteCalendarCardTimeRecordAsync(e,t)}},{kind:"method",key:"getCalendarCardAttachments",value:function getCalendarCardAttachments(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardAttachments)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardAttachments(e)}},{kind:"method",key:"createCalendarCardAttachmentAsync",value:function createCalendarCardAttachmentAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.createCalendarCardAttachmentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.createCalendarCardAttachmentAsync(e,t,i)}},{kind:"method",key:"updateCalendarCardAttachmentAsync",value:function updateCalendarCardAttachmentAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.updateCalendarCardAttachmentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.updateCalendarCardAttachmentAsync(e,t,i)}},{kind:"method",key:"deleteCalendarCardAttachmentAsync",value:function deleteCalendarCardAttachmentAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.deleteCalendarCardAttachmentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.deleteCalendarCardAttachmentAsync(e,t)}},{kind:"method",key:"getCalendarCardComments",value:function getCalendarCardComments(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardComments)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardComments(e)}},{kind:"method",key:"reloadCalendarCardCommentsAsync",value:function reloadCalendarCardCommentsAsync(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.reloadCalendarCardCommentsAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.reloadCalendarCardCommentsAsync(e)}},{kind:"method",key:"createCalendarCardCommentAsync",value:function createCalendarCardCommentAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.createCalendarCardCommentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.createCalendarCardCommentAsync(e,t)}},{kind:"method",key:"updateCalendarCardCommentAsync",value:function updateCalendarCardCommentAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.updateCalendarCardCommentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.updateCalendarCardCommentAsync(e,t,i)}},{kind:"method",key:"deleteCalendarCardCommentAsync",value:function deleteCalendarCardCommentAsync(e,t){let i=this._cardsServicesByCardType[e.cardType];if(null==i||!i.deleteCalendarCardCommentAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return i.deleteCalendarCardCommentAsync(e,t)}},{kind:"method",key:"getCalendarCardLinks",value:function getCalendarCardLinks(e){let t=this._cardsServicesByCardType[e.cardType];if(null==t||!t.getCalendarCardLinks)throw new Error(`Unsupported method for card type: ${e.cardType}`);return t.getCalendarCardLinks(e)}},{kind:"method",key:"createCalendarCardLinkAsync",value:function createCalendarCardLinkAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.createCalendarCardLinkAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.createCalendarCardLinkAsync(e,t,i)}},{kind:"method",key:"updateCalendarCardLinkAsync",value:function updateCalendarCardLinkAsync(e,t,i,r){let n=this._cardsServicesByCardType[e.cardType];if(null==n||!n.removeCalendarCardLinkAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return n.updateCalendarCardLinkAsync(e,t,i,r)}},{kind:"method",key:"updateCalendarCardLinkedCardAsync",value:function updateCalendarCardLinkedCardAsync(e,t,i,r){let n=this._cardsServicesByCardType[e.cardType];if(null==n||!n.updateCalendarCardLinkedCardAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return n.updateCalendarCardLinkedCardAsync(e,t,i,r)}},{kind:"method",key:"removeCalendarCardLinkAsync",value:function removeCalendarCardLinkAsync(e,t,i){let r=this._cardsServicesByCardType[e.cardType];if(null==r||!r.removeCalendarCardLinkAsync)throw new Error(`Unsupported method for card type: ${e.cardType}`);return r.removeCalendarCardLinkAsync(e,t,i)}},{kind:"method",key:"addCalendarCardEventListener",value:function addCalendarCardEventListener(e,t){let i=this._calendarCardsListeners[e];if(!i)throw new Error(`Unsupported event type: ${e}`);i.add(t)}},{kind:"method",key:"removeCalendarCardEventListener",value:function removeCalendarCardEventListener(e,t){let i=this._calendarCardsListeners[e];if(!i)throw new Error(`Unsupported event type: ${e}`);i.delete(t)}},{kind:"method",key:"isCalendarCardLoaded",value:function isCalendarCardLoaded(e){let t=this._cardsServicesByCardType[e.cardType];return null==t||!t.isCalendarCardLoaded||t.isCalendarCardLoaded(e)}},{kind:"method",key:"isCalendarCardVisible",value:function isCalendarCardVisible(e,t){let i=this._cardsServicesByCardType[e.cardType];return null==i||!i.isCalendarCardVisible||i.isCalendarCardVisible(e,t)}}]}}))},57207:(e,t,i)=>{i.d(t,{a:()=>O});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(67552),f=i.n(v),_=i(86981),C=i.n(_),S=i(26881),w=i(59863),k=i.n(w),b=i(35820),D=i.n(b),T=i(58218),E=i.n(T),A=i(19755),I=i.n(A),P=i(20115),R=i(8937),L=i(29704),N=i(82617);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,S.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let O=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=C()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,L.SG)(["$log","$rootScope","$window","htmlHelperSrv","licenseSrv","platformSrv","settingsSrv","telemetrySrv","planywayIntegrationSrv"])],(function(e){return{F:class ChatService{constructor(t,i,r,n,a,s,o,l,d){e(this),this._$log=t,this._$rootScope=i,this._$window=r,this._htmlHelperSrv=n,this._licenseSrv=a,this._platformSrv=s,this._settingsSrv=o,this._telemetrySrv=l,this._planywayIntegrationSrv=d,this._chatInitialized=!1,this._chatShown=!1}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"chatSrv"}},{kind:"field",key:"_isInitialized",value:()=>!1},{kind:"get",key:"chatAvailable",value:function chatAvailable(){return k()(this._settingsSrv).chat}},{kind:"method",key:"initializeChatAsync",value:async function initializeChatAsync(){this.chatAvailable&&(this._isInitialized||(this._isInitialized=!0,await this._initializeIframeAsync()))}},{kind:"get",key:"chatInitialized",value:function chatInitialized(){return this._chatInitialized}},{kind:"method",key:"showChat",value:function showChat(){this.chatAvailable&&this.chatInitialized&&(this.chatShown||I()(".pw-js-intercom-iframe")[0].contentWindow.postMessage({type:R.Nx.ShowIntercomChat},"*"))}},{kind:"get",key:"chatShown",value:function chatShown(){return this._chatShown}},{kind:"method",key:"updateUserData",value:function updateUserData(e){this.chatAvailable&&this.chatInitialized&&I()(".pw-js-intercom-iframe")[0].contentWindow.postMessage({type:R.Nx.UpdateIntercomUser,options:e},"*")}},{kind:"method",key:"_initializeIframeAsync",value:async function _initializeIframeAsync(){let e=I()('<iframe class="pw-js-intercom-iframe pw-intercom-frame"></iframe>');this._$window.document.body.appendChild(e[0]);const minimizeChat=()=>{e.css({width:72,height:72})};let t=new(D())((t=>{this._$window.addEventListener("message",(i=>{let{data:r}=i;if(r)switch(r.type){case R.Nx.IntercomChatInitialized:t();break;case R.Nx.IntercomChatShown:e.css({width:400,height:700}),this._chatShown=!0;break;case R.Nx.IntercomChatHidden:minimizeChat(),this._chatShown=!1;break;case R.Nx.IntercomPreviewShown:e.css({width:360,height:400});break;case R.Nx.IntercomPreviewHidden:this.chatShown||minimizeChat()}}),!1)}));try{await this._platformSrv.exchangeSiteDataAsync(R.jj.InjectIntercomScript,E()({userId:this._planywayIntegrationSrv.userId,userName:this._planywayIntegrationSrv.userName,userEmail:this._planywayIntegrationSrv.userEmail,userCreatedAt:Math.floor(this._planywayIntegrationSrv.userCreationDate.getTime()/1e3),licenseType:this._licenseSrv.getLicenseType(),appPlatform:N.Yl[this._platformSrv.getAppPlatform()],appType:N.i7[this._platformSrv.getAppType()],appVersion:this._platformSrv.getAppVersion()}),".pw-js-intercom-iframe"),await t,minimizeChat(),this._chatInitialized=!0}catch(e){this._$log.error("Intercom iframe initialization error:"),this._$log.error(e),this._telemetrySrv.logError("Intercom iframe initialization error",e,{class:this.constructor.name,method:this._initializeIframeAsync.name})}}},{kind:"method",key:"_initializeIntercomAsync",value:async function _initializeIntercomAsync(){let e=new(D())((e=>{this._htmlHelperSrv.injectScript(P.j3,{api_base:P.nq,app_id:P.Ch,email:this._planywayIntegrationSrv.userEmail,name:this._planywayIntegrationSrv.userName,user_id:this._planywayIntegrationSrv.userId,created_at:Math.floor(this._planywayIntegrationSrv.userCreationDate.getTime()/1e3),"Planyway user ID":this._planywayIntegrationSrv.userId,"License type":this._licenseSrv.getLicenseType(),"App platform":N.Yl[this._platformSrv.getAppPlatform()],"App type":N.i7[this._platformSrv.getAppType()],"App version":this._platformSrv.getAppVersion()}),this._$window.Intercom("onShow",(()=>{this._chatShown=!0})),this._$window.Intercom("onHide",(()=>{this._chatShown=!1})),this._$window.Intercom("onUnreadCountChange",(()=>{this._chatInitialized=!0,e()}))}));try{await D().race([(0,L.$U)(5e3),e])}catch(e){this._$log.error("Intercom chat initialization error:"),this._$log.error(e),this._telemetrySrv.logError("Intercom chat initialization error",e,{class:this.constructor.name,method:this._initializeIntercomAsync.name})}}}]}}))},25660:(e,t,i)=>{i.d(t,{a:()=>ue});var r=i(40024),n=i.n(r),a=i(99595),s=i.n(a),o=i(57445),l=i.n(o),d=i(51791),c=i.n(d),h=i(90143),u=i.n(h),p=i(56626),m=i.n(p),g=i(67552),y=i.n(g),v=i(86981),f=i.n(v),_=i(52020),C=i.n(_),S=i(88546),w=i.n(S),k=i(66775),b=i.n(k),D=i(2201),T=i.n(D),E=i(26171),A=i(26881),I=i(89221),P=i.n(I),R=i(31082),L=i.n(R),N=i(39290),O=i.n(N),M=i(91829),$=i.n(M),x=i(62079),B=i.n(x),H=i(35820),U=i.n(H),F=i(88946),W=i.n(F),z=i(27525),G=i.n(z),j=i(73324),V=i.n(j),K=i(23513),Y=i.n(K),q=i(59863),Z=i.n(q),X=i(76555),Q=i.n(X),J=i(10349),ee=i.n(J),te=i(8244),ie=i.n(te),re=i(90869),ne=i.n(re),ae=i(82617),se=i(56777),oe=i(8937),le=i(20115),de=i(54840),ce=i(29704);function ownKeys(e,t){var i=B()(e);if(C()){var r=C()(e);t&&(r=V()(r).call(r,(function(t){return w()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?s()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,E.Z)(e,t,n[t])})):b()?T()(e,b()(n)):s()(r=ownKeys(Object(n))).call(r,(function(t){l()(e,t,w()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}l()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),s()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==c()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];u()(s).call(s,c()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var h=0;h<d.length;h++)this.addElementPlacement(d[h],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,m(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return W()(t=(0,A.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:y()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:W()(e).call(e,this.fromElementDescriptor,this)};return l()(t,m(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const he=256;let ue=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=f()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(W()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,ce.SG)(["$injector","$rootScope","$log","$window","$timeout","$translate","dialogSrv","notificationSrv","planywayIntegrationSrv","platformSrv","telemetrySrv"])],(function(e){return{F:class CollectionService{constructor(t,i,r,n,a,s,o,l,d,c,h){e(this),this._$injector=t,this._$rootScope=i,this._$log=r,this._$window=n,this._$timeout=a,this._$translate=s,this._dialogSrv=o,this._notificationSrv=l,this._planywayIntegrationSrv=d,this._platformSrv=c,this._telemetrySrv=h,this._$window.addEventListener("popstate",(()=>this._onHistoryNavigate()))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"collectionSrv"}},{kind:"field",key:"_collectionsMap",value:()=>new de.v("id")},{kind:"get",key:"_appCommonSrv",value:function _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}},{kind:"get",key:"_onboardingSrv",value:function _onboardingSrv(){return this._onboardingSrvLazy||(this._onboardingSrvLazy=this._$injector.get("onboardingSrv")),this._onboardingSrvLazy}},{kind:"get",key:"_settingsSrv",value:function _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=this._$injector.get("settingsSrv")),this._settingsSrvLazy}},{kind:"method",key:"loadCollectionsAsync",value:async function loadCollectionsAsync(){let e=await this._getUserCollectionsFromBackendAsync();this._collectionsMap.clear();for(let t of e)this._collectionsMap.add(t)}},{kind:"method",key:"getCollections",value:function getCollections(){var e;return P()(e=this._collectionsMap).call(e)}},{kind:"method",key:"getCollectionById",value:function getCollectionById(e){return this._collectionsMap.get(e)}},{kind:"method",key:"getCollectionIdByConnectedCalendarId",value:function getCollectionIdByConnectedCalendarId(e){let t,i;for(let n of this.getCollections()){var r;let a=this._userSettings.global.settings.collection[n.id];a&&a.settings&&(null!==(r=a.settings.calendar[e])&&void 0!==r&&r.isConnected&&(!t||a.lastOpenDate>t)&&(t=a.lastOpenDate,i=n.id))}return i}},{kind:"method",key:"getAccountIdByConnectedCalendarId",value:function getAccountIdByConnectedCalendarId(e){for(let{account:t}of L()(this._userSettings.global.settings.collection))if(t)for(let[i,r]of O()(t))if($()(r).call(r,e))return i}},{kind:"method",key:"createCollectionAsync",value:async function createCollectionAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=_objectSpread({},e),e.name?e.name=ne()(e.name,he):e.name=this._$translate.instant("MISC.PERSONAL_COLLECTION_NAME"),e.color||(e.color=oe.Fx.Blue);let t=await this._createCollectionOnBackendAsync(e);return this._platformSrv.setCurrentCollectionId(t.id),this._collectionsMap.add(t),await this._settingsSrv.createCollectionSettingsAsync(),t}},{kind:"method",key:"updateCollectionAsync",value:async function updateCollectionAsync(e,t){(t=_objectSpread({},t)).name&&(t.name=ne()(t.name,he));let i=await this._updateCollectionOnBackendAsync(e,t);this.currentCollection.name=i.name,this.currentCollection.color=i.color,this.currentCollection.users=i.users,this._$rootScope.$broadcast(oe.FK.CollectionUpdated),this._platformSrv.setAppTitleAsync({collectionName:this.currentCollection.name})}},{kind:"method",key:"reloadCollectionAsync",value:async function reloadCollectionAsync(e){let t=await this._getCollectionFromBackendAsync(e);this._collectionsMap.has(e)?this._collectionsMap.update(t):this._collectionsMap.add(t),this._$rootScope.$broadcast(oe.FK.CollectionUpdated),this._platformSrv.setAppTitleAsync({collectionName:this.currentCollection.name})}},{kind:"method",key:"duplicateCollectionAsync",value:function duplicateCollectionAsync(e,t){if(t)t=ne()(t,he);else{let i=this._collectionsMap.get(e).name,r=` ${this._$translate.instant("MISC.COPY")}`;t=ne()(i,he-r.length)+r}return this._duplicateCollectionOnBackendAsync(e,t)}},{kind:"method",key:"deleteCollectionAsync",value:async function deleteCollectionAsync(e){await this._deleteCollectionFromBackendAsync(e),delete this._userSettings.global.settings.collection[this.currentCollectionId],await this._userSettings.global.saveAsync(),(0,ce.$6)(this._$window,ae.pJ,!1),this._collectionsMap.delete(e),await this._platformSrv.openOrCreateCollectionAsync(),await this.initCurrentCollectionAsync(this._appCommonSrv.getCancellationToken("init-current-collection"))}},{kind:"method",key:"leaveCollectionAsync",value:async function leaveCollectionAsync(e){await this._leaveCollectionFromBackendAsync(e),delete this._userSettings.global.settings.collection[this.currentCollectionId],await this._userSettings.global.saveAsync(),(0,ce.$6)(this._$window,ae.pJ,!1),this._collectionsMap.delete(e),await this._platformSrv.openOrCreateCollectionAsync(),await this.initCurrentCollectionAsync(this._appCommonSrv.getCancellationToken("init-current-collection"))}},{kind:"method",key:"initCurrentCollectionAsync",value:async function initCurrentCollectionAsync(e){try{var t,i;if(this.currentCollectionId&&!this._collectionsMap.has(this.currentCollectionId))try{let e=await this._getCollectionFromBackendAsync(this.currentCollectionId);e&&this._collectionsMap.add(e)}catch(e){this._$log.error("Planyway get collection error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get collection error",e,{class:this.constructor.name,method:this.initCurrentCollectionAsync.name})}if(!this.currentCollection)return this._platformSrv.setAppTitleAsync({collectionName:null}),await this._platformSrv.openOrCreateCollectionAsync(),this.initCurrentCollectionAsync(e);if(this._platformSrv.setAppTitleAsync({collectionName:this.currentCollection.name}),this.isCurrentCollectionUnavailable)return;let r=this._userSettings.global.settings.collection[this.currentCollectionId];null!==(t=r)&&void 0!==t&&t.settings?this._collectionSettings.global.override(r.settings):(await this._settingsSrv.loadCollectionSettingsAsync(),r=this._userSettings.global.settings.collection[this.currentCollectionId]);for(let e of B()(this._userSettings.global.settings.collection))this._collectionsMap.has(e)||delete this._userSettings.global.settings.collection[e];if(this._collectionSettings.local.settings.lastOpenDate=new Date,this._collectionSettings.local.save(),this._userSettings.global.settings.collection[this.currentCollectionId]=_objectSpread(_objectSpread({},r),{},{lastOpenDate:new Date}),this._userSettings.global.saveAsync(),e.isCanceled())return;if(this._$rootScope.$broadcast(oe.FK.CollectionChanging),await U().all(W()(i=this.getCurrentCollectionConnectedProviders()).call(i,(t=>t.initializeAsync(e)))),e.isCanceled())return;(async()=>{await U().all([(async()=>{this._appCommonSrv.isPlanywayShown()||await this._$rootScope.$onceAsync(oe.FK.PlanywayShown)})(),this._onboardingSrv.showOnboardingAsync()]);let e=this.getCurrentCollectionConnectedAccounts();if(e.length>0){G()(e).call(e,(e=>{let{accountId:t,accountType:i}=e;return(0,se.dS)(i).getCurrentCollectionConnectedCalendarIds(t).length>0}))||this._showManageAccountCalendarsDialogAsync(e[0])}await this.waitCurrentCollectionConnectedAccountsReadyAsync()&&this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionOpened),this._telemetrySrv.logSessionEvent(oe.cN.CalendarEvents.Opened)})()}catch(e){throw this._$log.error("Planyway collection initialization error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway collection initialization error",e,{class:this.constructor.name,method:this.initCurrentCollectionAsync.name}),e}this._$rootScope.$broadcast(oe.FK.CollectionChanged)}},{kind:"method",key:"changeCurrentCollectionAsync",value:async function changeCurrentCollectionAsync(e,t){if(t=t||this._appCommonSrv.getCancellationToken("init-current-collection"),this._platformSrv.setCurrentCollectionId(e),e&&(this._collectionsMap.has(e)||await this.loadCollectionsAsync()),this.isCurrentCollectionUnavailable)return this._platformSrv.reloadAppAsync();this._platformSrv.setAppTitleAsync({collectionName:null}),this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionChanged),this.initCurrentCollectionAsync(t)}},{kind:"get",key:"currentCollectionId",value:function currentCollectionId(){return this._platformSrv.getCurrentCollectionId()}},{kind:"get",key:"currentCollection",value:function currentCollection(){return this.getCollectionById(this.currentCollectionId)}},{kind:"get",key:"isCurrentCollectionAdmin",value:function isCurrentCollectionAdmin(){var e;return!!this.currentCollection&&G()(e=this.currentCollection.users).call(e,(e=>e.userId===this._userId&&e.type===ae.GV.Admin))}},{kind:"get",key:"isCurrentCollectionSingleAdmin",value:function isCurrentCollectionSingleAdmin(){if(this.currentCollection){var e;let t=V()(e=this.currentCollection.users).call(e,(e=>e.type===ae.GV.Admin));return 1===t.length&&t[0].userId===this._userId}return!1}},{kind:"get",key:"isCurrentCollectionRequester",value:function isCurrentCollectionRequester(){var e;return!!this.currentCollection&&G()(e=this.currentCollection.users).call(e,(e=>e.userId===this._userId&&e.type===ae.GV.Requester))}},{kind:"get",key:"isCurrentCollectionUserCanShare",value:function isCurrentCollectionUserCanShare(){var e;return!!this.currentCollection&&G()(e=this.currentCollection.users).call(e,(e=>e.userId===this._userId&&(e.type===ae.GV.Admin||e.type===ae.GV.User)))}},{kind:"get",key:"isCurrentCollectionReadOnly",value:function isCurrentCollectionReadOnly(){return!1}},{kind:"get",key:"isCurrentCollectionUnavailable",value:function isCurrentCollectionUnavailable(){var e;return!!this.currentCollection&&!G()(e=this.currentCollection.users).call(e,(e=>e.userId===this._userId&&e.type!==ae.GV.Requester))}},{kind:"method",key:"getCurrentCollectionConnectedProviders",value:function getCurrentCollectionConnectedProviders(){var e,t,i;let r=new(Y())(W()(e=V()(t=this.getCurrentCollectionConnectedAccounts()).call(t,(e=>{let{isPrimary:t}=e;return!!Z()(this._settingsSrv).connect||t}))).call(e,(e=>{let{accountType:t}=e;return(0,se.dS)(t)})));return Q()(i=ee()(r)).call(i,((e,t)=>oe.Tr[e.type]-oe.Tr[t.type]))}},{kind:"method",key:"isCurrentCollectionProviderConnected",value:function isCurrentCollectionProviderConnected(e){var t;return G()(t=this.getCurrentCollectionConnectedAccounts()).call(t,(t=>{let{accountType:i}=t;return(0,se.fL)(i)===e}))}},{kind:"method",key:"getCurrentCollectionConnectedAccounts",value:function getCurrentCollectionConnectedAccounts(){var e;let t=this._userSettings.global.settings.collection[this.currentCollectionId];return t?V()(e=this._planywayIntegrationSrv.getConnectedAccounts()).call(e,(e=>{let{accountId:i}=e;return t.account[i]})):[]}},{kind:"method",key:"waitCurrentCollectionConnectedAccountsReadyAsync",value:function waitCurrentCollectionConnectedAccountsReadyAsync(){if(0===this.getCurrentCollectionConnectedAccounts().length)return!1;const isConnectedAccountsReady=()=>{var e;return ie()(e=this.getCurrentCollectionConnectedAccounts()).call(e,(e=>{let{accountType:t,accountId:i}=e;return(0,se.dS)(t).isCurrentCollectionAccountReady(i)}))};return!!isConnectedAccountsReady()||new(U())((e=>{const t=this._$rootScope.$on(oe.FK.CollectionAccountReady,(()=>{isConnectedAccountsReady()&&(t(),e(!0))}))}))}},{kind:"method",key:"addUserToCurrentCollectionAsync",value:async function addUserToCurrentCollectionAsync(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae.GV.User,r=[...V()(t=this.currentCollection.users).call(t,(t=>t.userId!==e)),{userId:e,type:i}],n=await this._updateCollectionUsersOnBackendAsync(this.currentCollectionId,r);this.currentCollection.name=n.name,this.currentCollection.color=n.color,this.currentCollection.users=n.users}},{kind:"method",key:"addUsersToCurrentCollectionAsync",value:async function addUsersToCurrentCollectionAsync(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae.GV.User,r=[...V()(t=this.currentCollection.users).call(t,(t=>!$()(e).call(e,t.userId))),...W()(e).call(e,(e=>({userId:e,type:i})))],n=await this._updateCollectionUsersOnBackendAsync(this.currentCollectionId,r);this.currentCollection.name=n.name,this.currentCollection.color=n.color,this.currentCollection.users=n.users}},{kind:"method",key:"updateUserTypeInCurrentCollectionAsync",value:async function updateUserTypeInCurrentCollectionAsync(e,t){var i;let r=[...V()(i=this.currentCollection.users).call(i,(t=>t.userId!==e)),{userId:e,type:t}],n=await this._updateCollectionUsersOnBackendAsync(this.currentCollectionId,r);this.currentCollection.name=n.name,this.currentCollection.color=n.color,this.currentCollection.users=n.users}},{kind:"method",key:"deleteUserFromCurrentCollectionAsync",value:async function deleteUserFromCurrentCollectionAsync(e){var t;let i=V()(t=this.currentCollection.users).call(t,(t=>t.userId!==e)),r=await this._updateCollectionUsersOnBackendAsync(this.currentCollectionId,i);this.currentCollection.name=r.name,this.currentCollection.color=r.color,this.currentCollection.users=r.users}},{kind:"method",key:"createCurrentCollectionInviteTokenAsync",value:async function createCurrentCollectionInviteTokenAsync(){let e=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Create invite token",{body:{action:"createInvite",data:{collectionId:this.currentCollectionId}}});if(!e.success){let t=new Error(e.message);throw t.code=e.code,t.details=e.details,t}return e.data.inviteToken}},{kind:"method",key:"deleteCurrentCollectionInviteTokenAsync",value:async function deleteCurrentCollectionInviteTokenAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Delete invite token",{body:{action:"deleteInvite",data:{inviteToken:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}}},{kind:"method",key:"addUserToCurrentCollectionByInviteAsync",value:async function addUserToCurrentCollectionByInviteAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Add user by invite token",{body:{action:"addUserByInvite",data:{inviteToken:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}}},{kind:"method",key:"addUserToCurrentCollectionAsRequesterAsync",value:async function addUserToCurrentCollectionAsRequesterAsync(){let e=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Add user as a requester",{body:{action:"addUserAsRequester",data:{collectionId:this.currentCollectionId}}});if(!e.success){let t=new Error(e.message);throw t.code=e.code,t.details=e.details,t}}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_userId",value:function _userId(){return this._planywayIntegrationSrv.userId}},{kind:"method",key:"_onHistoryNavigate",value:function _onHistoryNavigate(){}},{kind:"method",key:"_showManageAccountCalendarsDialogAsync",value:async function _showManageAccountCalendarsDialogAsync(e){this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionAddCalendarDialogShown,{accountType:e.accountType});let t=await this._dialogSrv.showManageAccountCalendarsDialogAsync(e);t?(this._$rootScope.$broadcast(oe.FK.CalendarsChanging,e),t.connectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionCalendarAdded,{accountType:e.accountType,count:t.connectedCalendarIds.length}),t.disconnectedCalendarIds.length>0&&this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionCalendarRemoved,{accountType:e.accountType,count:t.disconnectedCalendarIds.length})):this._telemetrySrv.logSessionEvent(oe.cN.CollectionEvents.CollectionAddCalendarDialogClosed,{accountType:e.accountType})}},{kind:"method",key:"_createCollectionOnBackendAsync",value:async function _createCollectionOnBackendAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Create collection",{body:{action:"create",data:e}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return{id:t.data.id,name:t.data.name,color:t.data.color,users:t.data.users}}},{kind:"method",key:"_updateCollectionOnBackendAsync",value:async function _updateCollectionOnBackendAsync(e,t){let i=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Update collection",{body:{action:"update",data:_objectSpread({collectionId:e},t)}});if(!i.success){let e=new Error(i.message);throw e.code=i.code,e.details=i.details,e}return{id:i.data.id,name:i.data.name,color:i.data.color,users:i.data.users}}},{kind:"method",key:"_updateCollectionUsersOnBackendAsync",value:async function _updateCollectionUsersOnBackendAsync(e,t){let i=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Update collection users",{body:{action:"updateUsers",data:{collectionId:e,users:t}}});if(!i.success){let e=new Error(i.message);throw e.code=i.code,e.details=i.details,e}return{id:i.data.id,name:i.data.name,color:i.data.color,users:i.data.users}}},{kind:"method",key:"_leaveCollectionFromBackendAsync",value:async function _leaveCollectionFromBackendAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Leave collection",{body:{action:"leave",data:{collectionId:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}}},{kind:"method",key:"_deleteCollectionFromBackendAsync",value:async function _deleteCollectionFromBackendAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Delete collection",{body:{action:"delete",data:{collectionId:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}}},{kind:"method",key:"_duplicateCollectionOnBackendAsync",value:async function _duplicateCollectionOnBackendAsync(e,t){let i=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Duplicate collection",{body:{action:"duplicate",data:{collectionId:e,name:t}}});if(!i.success){let e=new Error(i.message);throw e.code=i.code,e.details=i.details,e}return{id:i.data.id,name:i.data.name,color:i.data.color,users:i.data.users}}},{kind:"method",key:"_getUserCollectionsFromBackendAsync",value:async function _getUserCollectionsFromBackendAsync(){var e;let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Get user collections",{body:{action:"getUserCollections"}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return W()(e=t.data).call(e,(e=>({id:e.id,name:e.name,color:e.color,users:e.users})))}},{kind:"method",key:"_getCollectionFromBackendAsync",value:async function _getCollectionFromBackendAsync(e){let t=await this._restAsync(oe.Tu.Post,`${le.yx}/planyway/${this._userId}/collection`,"Get collection",{body:{action:"get",data:{collectionId:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return{id:t.data.id,name:t.data.name,color:t.data.color,users:t.data.users}}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(i,e,t,_objectSpread(_objectSpread({},n.query),n.body),n.telemetrySkipOnSuccess),s=200;try{return await this._platformSrv.restAsync(e,t,_objectSpread(_objectSpread({},n),{},{usePlanywayAuth:!0}))}catch(e){throw s=e.status,r=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,s,r)}}}]}}))},28211:(e,t,i)=>{i.d(t,{x:()=>lt});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(62079),f=i.n(v),_=i(52020),C=i.n(_),S=i(88546),w=i.n(S),k=i(66775),b=i.n(k),D=i(2201),T=i.n(D),E=i(26171),A=i(26881),I=i(35820),P=i.n(I),R=i(86981),L=i.n(R),N=i(67552),O=i.n(N),M=i(73324),$=i.n(M),x=i(19755),B=i.n(x),H=i(85079),U=(i(67294),i(82617)),F=i(20115),W=i(8937),z=i(29704),G=i(91775),j=i(92211),V=i(48901),K=i(2824),Y=i(36030),q=i(34683),Z=i(81790),X=i(84571),Q=i(19861),J=i(30379),ee=i(70598),te=i(31502),ie=i(75904),re=i(57893),ne=i(46809),ae=i(41099),se=i(7257),oe=i(49834),le=i(10774),de=i(62525),ce=i(72325),he=i(25302),ue=i(25672),pe=i(16357),me=i(87419),ge=i(77151),ye=i(96449),ve=i(85918),fe=i(39965),_e=i(74951),Ce=i(77979),Se=i(76224),we=i(16785),ke=i(76029),be=i(41092),De=i(42940),Te=i(79319),Ee=i(27582),Ae=i(46579),Ie=i(88093),Pe=i(77159),Re=i(81948),Le=i(68368),Ne=i(73213),Oe=i.n(Ne),Me=i(57420),$e=i.n(Me),xe=i(87296),Be=i.n(xe),He=i(86067),Ue=i.n(He),Fe=i(32424),We=i.n(Fe),ze=i(8190),Ge=i.n(ze),je=i(26985),Ve=i.n(je),Ke=i(11565),Ye=i.n(Ke),qe=i(73481),Ze=i.n(qe),Xe=i(49375),Qe=i.n(Xe),Je=i(76562),et=i.n(Je),tt=i(89655),it=i.n(tt),rt=i(8710),nt=i.n(rt),at=i(7955),st=i.n(at);function ownKeys(e,t){var i=f()(e);if(C()){var r=C()(e);t&&(r=$()(r).call(r,(function(t){return w()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?l()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,E.Z)(e,t,n[t])})):b()?T()(e,b()(n)):l()(r=ownKeys(Object(n))).call(r,(function(t){c()(e,t,w()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,A.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:O()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const ot=[Ce.L,Se.m,ke.B,be.Z,De.G,Ae.M,Ie.A,Pe.P,Re.p];let lt=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=L()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,z.SG)(["$injector","$rootScope","$log","$window","$timeout","$translate","$mdDialog","$mdMenu","$mdPanel","htmlHelperSrv"])],(function(e){return{F:class DialogService{constructor(t,i,r,n,a,s,o,l,d,c){e(this),this._$injector=t,this._$rootScope=i,this._$log=r,this._$window=n,this._$timeout=a,this._$translate=s,this._$mdDialog=o,this._$mdMenu=l,this._$mdPanel=d,this._htmlHelperSrv=c;for(let e of ot)this._$mdPanel.newPanelGroup(e.controllerName,{maxOpen:1});this._$mdPanel.newPanelPosition().constructor.viewportMargin=0,this._$rootScope.$on(W.FK.CloseDialogsRequested,(()=>{for(let e of this._openedReactDialogs)e.onClose()}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"dialogSrv"}},{kind:"field",key:"_openedReactDialogs",value:()=>[]},{kind:"field",key:"_lastReactDialogId",value:()=>0},{kind:"get",key:"_onboardingSrv",value:function _onboardingSrv(){return this._onboardingSrvLazy||(this._onboardingSrvLazy=this._$injector.get("onboardingSrv")),this._onboardingSrvLazy}},{kind:"get",key:"_settingsSrv",value:function _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=this._$injector.get("settingsSrv")),this._settingsSrvLazy}},{kind:"method",key:"showAddAccountDialogAsync",value:async function showAddAccountDialogAsync(){let e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this._$mdPanel.newPanelPosition().absolute().centerHorizontally().centerVertically(),n=new(P())((t=>{e=t}));const a=["pw-dialog","pw-dialog-add-account"],s=["pw-dialog-backdrop"];try{let o=this._createPanelConfig({getPanelRef:()=>t,templateUrl:Oe(),enableScroll:!0,disableParentScroll:!0,propagateContainerEvents:!1,controller:_e.B.controllerName,locals:{account:i.account,accountType:i.accountType},zIndex:1998,position:r,panelClass:a.join(" "),onDomAdded:()=>{var e;return null===(e=t)||void 0===e?void 0:e.panelContainer.addClass(s.join(" "))},onCloseSuccess:(t,i)=>{"escapeToClose"===i?e():e(i)}});return t=this._$mdPanel.create(o),await t.open(),await n}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show add account settings dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showEditLabelsDialogAsync",value:async function showEditLabelsDialogAsync(e){const{boardId:t,accountId:i,calendarCard:r}=e;let n,a,s=this._$mdPanel.newPanelPosition().absolute().centerHorizontally().centerVertically(),o=new(P())((e=>{n=e}));const l=["pw-dialog","pw-dialog-edit-labels"],d=["pw-dialog-backdrop"];try{let e=this._createPanelConfig({getPanelRef:()=>a,templateUrl:Ve(),disableParentScroll:!1,controller:De.G.controllerName,locals:{accountId:i,boardId:t,calendarCard:r},position:s,panelClass:l.join(" "),onDomAdded:()=>{var e;return null===(e=a)||void 0===e?void 0:e.panelContainer.addClass(d.join(" "))},onCloseSuccess:()=>n()});return a=this._$mdPanel.create(e),await a.open(),await o}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show edit labels dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showGoogleSyncStartDialogAsync",value:function showGoogleSyncStartDialogAsync(e,t){return new(P())((async i=>{try{await this._$mdDialog.show(this._createDialogConfig({templateUrl:Ze(),controller:Ee.l.controllerName,locals:{accountId:e,boardId:t,onSyncStarted:i}}))}catch(e){if(e){if(e.message===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show start Google sync dialog error:"),this._$log.error(e)}i()}}))}},{kind:"method",key:"showManageAccountCalendarsDialogAsync",value:async function showManageAccountCalendarsDialogAsync(e,t){let i,r,n=this._$mdPanel.newPanelPosition().absolute().centerHorizontally().centerVertically(),a=new(P())((e=>{i=e}));const s=["pw-dialog"],o=["pw-dialog-backdrop"];try{let l=this._createPanelConfig({getPanelRef:()=>r,templateUrl:et(),targetEvent:t,enableScroll:!0,disableParentScroll:!0,propagateContainerEvents:!1,controller:Ie.A.controllerName,locals:{account:e},zIndex:1998,position:n,panelClass:s.join(" "),onDomAdded:()=>{var e;return null===(e=r)||void 0===e?void 0:e.panelContainer.addClass(o.join(" "))},onCloseSuccess:(e,t)=>{"escapeToClose"===t?i():i(t)}});return r=this._$mdPanel.create(l),await r.open(),await a}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show manage account calendars dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showNotificationCenterDialogAsync",value:async function showNotificationCenterDialogAsync(e){this._currentNotificationCenterDialog&&this._currentNotificationCenterDialog.close();let t,i,r=this._$mdPanel.newPanelPosition().relativeTo(B()("pw-trello-main-toolbar-right")[0]||".pw-body-wrapper").addPanelPosition(this._$mdPanel.xPosition.ALIGN_END,this._$mdPanel.yPosition.ALIGN_TOPS).withOffsetY("35px").withOffsetX("-12px"),n=this._$mdPanel.newPanelAnimation().withAnimation(this._$mdPanel.animation.FADE).duration({open:250,close:250}),a=new(P())((e=>{t=e}));try{let s=this._createPanelConfig({getPanelRef:()=>i,templateUrl:it(),disableParentScroll:!1,propagateContainerEvents:!1,focusOnOpen:!1,hasBackdrop:!1,controller:Pe.P.controllerName,locals:{mode:e},zIndex:999,animation:n,panelClass:"pw-dialog pw-dialog-notification-center",onDomAdded:()=>{i.addClass("pw-dialog-notification-center__outer-wrapper",!1),i.updatePosition(r)},onComplete:()=>{this._currentNotificationCenterDialog=i},onCloseSuccess:()=>{this._currentNotificationCenterDialog=null,t()}});i=this._$mdPanel.create(s),await i.open(),await a}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show notification center error:"),this._$log.error(e)}}},{kind:"method",key:"showRecurringEditorAsync",value:async function showRecurringEditorAsync(e){const{rule:t,start:i,isAllDay:r,relativeTo:n}=e;this._currentRecurringEditor&&await this._currentRecurringEditor.close();let a,s,o=this._$mdPanel.newPanelPosition().relativeTo(n).withOffsetY("3px").addPanelPosition(this._$mdPanel.xPosition.ALIGN_START,this._$mdPanel.yPosition.BELOW),l=new(P())((e=>{a=e}));const d=B()("pw-recurrent-select > md-menu.md-open").scope();try{let e=this._createPanelConfig({getPanelRef:()=>s,templateUrl:nt(),controller:Re.p.controllerName,locals:{rule:t,start:i,isAllDay:r},position:o,panelClass:"pw-dialog pw-dialog--popup pw-dialog-recurrent-editor",zIndex:2e3,onDomAdded:()=>{null==d||d.$evalAsync((()=>d.isRecurringEditorOpen=!0))},onComplete:()=>{this._currentRecurringEditor=s},onCloseSuccess:(e,i)=>{this._currentRecurringEditor=null,null==d||d.$evalAsync((()=>d.isRecurringEditorOpen=!1)),a(e&&"success"===i?e.$ctrl.recurrenceRule:t)}});return s=this._$mdPanel.create(e),await s.open(),await l}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show recurring editor error:"),this._$log.error(e)}}},{kind:"method",key:"showBoardDialogAsync",value:async function showBoardDialogAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._$mdDialog.show(this._createDialogConfig({templateUrl:Ue(),controller:we.Z.controllerName,targetEvent:e,locals:{account:t.account,board:t.board}}))}catch(e){if(e){if(e.message===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show board dialog error:"),this._$log.error(e)}}}},{kind:"method",key:"showGitHubProjectDialogAsync",value:async function showGitHubProjectDialogAsync(e,t){try{return await this._$mdDialog.show(this._createDialogConfig({templateUrl:Ye(),controller:Te.s.controllerName,targetEvent:e,locals:{account:t.account,project:t.project}}))}catch(e){if(e){if(e.message===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show GitHub project dialog error:"),this._$log.error(e)}}}},{kind:"method",key:"showSettingsDialogAsync",value:async function showSettingsDialogAsync(e){try{await this._$mdDialog.show(this._createDialogConfig({templateUrl:st(),controller:Le.E.controllerName,targetEvent:e}))}catch(e){if(e){if(e.message===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show settings dialog error:"),this._$log.error(e)}}}},{kind:"method",key:"showEditCardDialogAsync",value:async function showEditCardDialogAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!t.noAnimation&&this._currentEditCardDialog&&await this._currentEditCardDialog.close();let i=t.openerContext;i||(this._editCardDialogOpenerContext||(this._editCardDialogOpenerContext={setupCompactDialogPosition:e=>{e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_END,this._$mdPanel.yPosition.CENTER),e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_START,this._$mdPanel.yPosition.CENTER),e.addPanelPosition(this._$mdPanel.xPosition.CENTER,this._$mdPanel.yPosition.ABOVE),e.addPanelPosition(this._$mdPanel.xPosition.CENTER,this._$mdPanel.yPosition.BELOW),e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_END,this._$mdPanel.yPosition.ALIGN_TOPS),e.addPanelPosition(this._$mdPanel.xPosition.OFFSET_START,this._$mdPanel.yPosition.ALIGN_BOTTOMS)}}),i=this._editCardDialogOpenerContext);const r=B()("body");let n,a,s=new(P())((e=>{n=e}));const onDocumentMouseDown=t=>{if(!a)return;if(t.offsetX>t.target.clientWidth||t.offsetY>t.target.clientHeight)return;let i=B()(t.target);i.closest(`.k-event[data-uid="${e.id}"]`)[0]||i.hasClass("timeline-item")&&i.children(`.k-event[data-uid="${e.id}"]`)[0]||i.closest(`.pw-tasks-card[data-id="${e.id}"]`)[0]||i.closest(".md-dialog-container, .md-panel-outer-wrapper")[0]||L()(r).call(r,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0]||i.closest(".k-notification")[0]||a.close()};try{var o,l,d;let r=t.forceDetailedMode||!e.isTempCard||e.cardType===U.eT.TrelloTimeRecord,c=this._createPanelConfig({getPanelRef:()=>a,propagateContainerEvents:!1,templateUrl:Ge(),enableScroll:!0,disableParentScroll:!0,controller:be.Z.controllerName,locals:{calendarCard:e,cardElement:t.cardElement,cardTypes:t.cardTypes,isDetailed:r,forceDetailedMode:t.forceDetailedMode,hasChanges:t.hasChanges,openerContext:i,scrollToCommentId:t.scrollToCommentId},panelClass:"pw-dialog pw-dialog-edit-card",onDomAdded:()=>{if(a&&(a.panelContainer.addClass("pw-dialog-container"),t.noAnimation&&a.panelContainer.addClass("pw-dialog-backdrop--no-animation")),r&&(a&&a.panelContainer.addClass("pw-dialog-backdrop"),t.noAnimation&&this._currentEditCardDialog)){let e=this._currentEditCardDialog;e.panelContainer.addClass("pw-dialog-backdrop--hiding"),this._$timeout((()=>e.close()),250,!1)}},onComplete:()=>{this._currentEditCardDialog=a,this._$window.document.addEventListener("mousedown",onDocumentMouseDown,!0),this._$window.document.addEventListener("pwMouseDown",onDocumentMouseDown,!0)},onSubmit:()=>a.close(),onRemoving:()=>{this._currentRecurringEditor&&this._currentRecurringEditor.close()},onCloseSuccess:t=>{this._currentEditCardDialog===a&&(this._currentEditCardDialog=null),this._$window.document.removeEventListener("mousedown",onDocumentMouseDown,!0),this._$window.document.removeEventListener("pwMouseDown",onDocumentMouseDown,!0);let i=null==t?void 0:t.$ctrl.dialogResult;e.isTempCard?n(i===W.Xs.CardCreated):n(i===W.Xs.CardEdited)}});return this._editCardDialogOpenCount=(this._editCardDialogOpenCount||0)+1,null===(o=(l=i).onOpen)||void 0===o||o.call(l,null!==(d=t.cardElement)&&void 0!==d&&d[0]?[t.cardElement.data("uid")]:null),a=this._$mdPanel.create(c),await a.open(),await s}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;throw e}finally{var c,h;if(this._editCardDialogOpenCount-=1,0===this._editCardDialogOpenCount)null===(c=(h=i).onClose)||void 0===c||c.call(h)}}},{kind:"method",key:"showEditAttachmentDialogAsync",value:async function showEditAttachmentDialogAsync(e){const{attachment:t,relativeTo:i}=e;this._currentEditAttachmentDialog&&await this._currentEditAttachmentDialog.close();let r,n,a=this._$mdPanel.newPanelPosition().relativeTo(i).withOffsetX("30px").addPanelPosition(this._$mdPanel.xPosition.ALIGN_START,this._$mdPanel.yPosition.ALIGN_TOPS),s=new(P())((e=>{r=e}));try{let e=this._createPanelConfig({getPanelRef:()=>n,templateUrl:We(),controller:ke.B.controllerName,position:a,panelClass:"pw-dialog pw-dialog--popup pw-dialog-edit-attachment",zIndex:2e3,locals:{attachment:t},onComplete:()=>{this._currentEditAttachmentDialog=n},onCloseSuccess:(e,t)=>{this._currentEditAttachmentDialog=null,e&&"success"===t?r({name:e.$ctrl.name,url:e.$ctrl.url}):r()}});return n=this._$mdPanel.create(e),await n.open(),await s}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show edit attachment dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showAddDependencyDialogAsync",value:async function showAddDependencyDialogAsync(e){const{isEditingMode:t,linkedCardFilter:i,linkType:r,linkedCard:n,relativeTo:a}=e;this._currentAddDependencyDialog&&await this._currentAddDependencyDialog.close();let s,o,l=this._$mdPanel.newPanelPosition().relativeTo(a).withOffsetY("3px").addPanelPosition(this._$mdPanel.xPosition.ALIGN_START,this._$mdPanel.yPosition.BELOW),d=new(P())((e=>{s=e}));try{let e=this._createPanelConfig({getPanelRef:()=>o,templateUrl:Be(),controller:Se.m.controllerName,position:l,panelClass:"pw-dialog pw-dialog--popup pw-dialog-add-dependency",zIndex:2e3,locals:{isEditingMode:t,linkedCardFilter:i,linkType:r,linkedCard:n},ensureScreenBound:!0,onComplete:()=>{this._currentAddDependencyDialog=o},onCloseSuccess:(e,t)=>{if(this._currentAddDependencyDialog=null,"success"===t)s({linkType:e.$ctrl.linkType,linkedCard:e.$ctrl.linkedCard});else s()}});return o=this._$mdPanel.create(e),await o.open(),await d}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show add dependency dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showAddCustomReminderDialogAsync",value:async function showAddCustomReminderDialogAsync(e){const{isEditingMode:t,isAllDay:i,isNegativeReminderAvailable:r,type:n,remindBefore:a,relativeTo:s}=e;this._currentAddCustomReminderDialog&&await this._currentAddCustomReminderDialog.close();let o,l,d=this._$mdPanel.newPanelPosition().relativeTo(s).withOffsetY("3px").addPanelPosition(this._$mdPanel.xPosition.ALIGN_START,this._$mdPanel.yPosition.ALIGN_TOPS),c=this._$mdPanel.newPanelAnimation().withAnimation(this._$mdPanel.animation.FADE).duration({open:250,close:250}),h=new(P())((e=>{o=e}));try{let e=this._createPanelConfig({getPanelRef:()=>l,templateUrl:$e(),controller:Ce.L.controllerName,position:d,animation:c,panelClass:"pw-dialog pw-dialog--popup pw-dialog-add-custom-reminder",zIndex:2e3,locals:{isEditingMode:t,isAllDay:i,isNegativeReminderAvailable:r,type:n,remindBefore:a},ensureScreenBound:!0,onComplete:()=>{this._currentAddCustomReminderDialog=l},onCloseSuccess:(e,t)=>{if(this._currentAddCustomReminderDialog=null,"success"===t)o({type:e.$ctrl.type,remindBefore:e.$ctrl.remindBefore});else o()}});return l=this._$mdPanel.create(e),await l.open(),await h}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show add custom reminder dialog error:"),this._$log.error(e)}}},{kind:"method",key:"showOnboardingTipAsync",value:async function showOnboardingTipAsync(e){let t=B()(e.target);if(!t[0]&&(await(0,z.$U)(1e3),t=B()(e.target),!t[0]))return null;let i=t.scope();if(!i)return null;const r=B()("body");let n,a;const hide=()=>{a&&(a.destroy(),B()(n).remove())};let s=i.$new();return O()(s,{arrowPosition:e.position.arrowPosition,text:e.text}),n=this._htmlHelperSrv.compileHtml("<pw-onboarding-tip></pw-onboarding-tip>",s,!1),r.append(n),a=await this._$timeout((()=>{let i=new H.Z({element:n,target:t[0],offset:e.offset||"0 0",targetOffset:e.targetOffset||"0 0",attachment:e.position.attachment,targetAttachment:e.position.targetAttachment,constraints:[{to:"scrollParent"}]});return t[0].parentNode?(i.position(),i):(i.destroy(),n.parentNode.removeChild(n),null)}),0,!1),a&&(a.hide=hide),a}},{kind:"method",key:"showLoginDialogAsync",value:async function showLoginDialogAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canClose:t=!0}=e;let i,r,n=this._$mdPanel.newPanelPosition().absolute().centerHorizontally().centerVertically(),a=new(P())((e=>{i=e}));const s=["pw-dialog","pw-dialog--full-size","pw-dialog-login"],o=["pw-dialog-backdrop","pw-dialog-backdrop--full-size"];try{let e=this._createPanelConfig({getPanelRef:()=>r,templateUrl:Qe(),enableScroll:!0,disableParentScroll:!0,propagateContainerEvents:!1,preventClose:!t,clickOutsideToClose:t,controller:Ae.M.controllerName,locals:{canClose:t},zIndex:1998,position:n,panelClass:s.join(" "),onDomAdded:()=>{var e;return null===(e=r)||void 0===e?void 0:e.panelContainer.addClass(o.join(" "))},onCloseSuccess:(e,t)=>i("success"===t)});return r=this._$mdPanel.create(e),await r.open(),await a}catch(e){if((null==e?void 0:e.message)===W.FK.CloseDialogsRequested)return;this._$log.error("Planyway show login dialog error:"),this._$log.error(e)}}},{kind:"get",key:"openedReactDialogs",value:function openedReactDialogs(){return this._openedReactDialogs}},{kind:"method",key:"showAboutDialogAsync",value:async function showAboutDialogAsync(){await this._showReactDialogAsync(q.f)}},{kind:"method",key:"showAttachmentPopupAsync",value:async function showAttachmentPopupAsync(e,t){return this._showReactDialogAsync(Z.G,{attachments:e,currentAttachmentIndex:t})}},{kind:"method",key:"showBoardsGoogleSyncDialogAsync",value:function showBoardsGoogleSyncDialogAsync(){return this._showReactDialogAsync(V.Z)}},{kind:"method",key:"showBoardSettingsMigratorDialogAsync",value:function showBoardSettingsMigratorDialogAsync(e){return this._showReactDialogAsync(X.Y,e)}},{kind:"method",key:"showSatisfactionSurveyDialogAsync",value:async function showSatisfactionSurveyDialogAsync(e){this._currentSatisfactionSurveyDialogPromise&&this._currentSatisfactionSurveyDialogPromise.closeDialog();const t={nodeType:Node.ELEMENT_NODE,getBoundingClientRect:()=>DOMRect.fromRect({x:window.innerWidth/2,y:window.innerHeight-20,width:0,height:0})};return this._currentSatisfactionSurveyDialogPromise=this._showReactDialogAsync(ue.b,_objectSpread(_objectSpread({},e),{},{anchorEl:t})),this._currentSatisfactionSurveyDialogPromise}},{kind:"method",key:"showBoardShareDialogAsync",value:function showBoardShareDialogAsync(e){return this._showReactDialogAsync(j.Z,{locals:e})}},{kind:"method",key:"showCollectionDialogAsync",value:function showCollectionDialogAsync(e){return this._showReactDialogAsync(Q.g,{collection:e})}},{kind:"method",key:"showCollectionShareDialogAsync",value:function showCollectionShareDialogAsync(){return this._showReactDialogAsync(K.Z)}},{kind:"method",key:"showConfirmAsync",value:async function showConfirmAsync(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.buttons||[{text:this._$translate.instant("BUTTONS.YES"),isPrimary:!0,dialogResult:!0}];if(i.dontAskType&&this._userSettings.global.settings.dontAskConfirmDialogs[i.dontAskType]&&r.length>0){let e=L()(r).call(r,(e=>e.isPrimary));if(e)return e.dialogResult}let n={title:e,message:t,showDontAskCheckbox:!!i.dontAskType,buttons:r},{dontAskChecked:a,dialogResult:s}=await this._showReactDialogAsync(J.T,n)||{};if(i.dontAskType&&a){let e=L()(r).call(r,(e=>e.isPrimary));e&&e.dialogResult===s&&(this._userSettings.global.settings.dontAskConfirmDialogs[i.dontAskType]=!0,this._userSettings.global.saveAsync())}return s}},{kind:"method",key:"showCustomFiltersDialogAsync",value:function showCustomFiltersDialogAsync(){return this._showReactDialogAsync(ee.U)}},{kind:"method",key:"showEditRecurringConfirmDialogAsync",value:function showEditRecurringConfirmDialogAsync(e,t,i){let r={cardType:e,showThisAndFollowing:t,modifyCardType:i};return this._showReactDialogAsync(te.F,r)}},{kind:"method",key:"showExportDialogAsync",value:function showExportDialogAsync(e){return this._showReactDialogAsync(ie.W,{board:e})}},{kind:"method",key:"showFatalErrorDialogAsync",value:function showFatalErrorDialogAsync(e){let{canClose:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._showReactDialogAsync(re.G,{message:e,canClose:t})}},{kind:"method",key:"showFeedbackDialogAsync",value:function showFeedbackDialogAsync(){return this._showReactDialogAsync(ne.F)}},{kind:"method",key:"showGitHubLicenseRequestDialogAsync",value:function showGitHubLicenseRequestDialogAsync(){return this._showReactDialogAsync(ae.u)}},{kind:"method",key:"showICalEditDialogAsync",value:function showICalEditDialogAsync(e){return this._showReactDialogAsync(se.u,{calendar:e})}},{kind:"method",key:"showICalImportDialogAsync",value:function showICalImportDialogAsync(){return this._showReactDialogAsync(oe.u)}},{kind:"method",key:"showNewsDialogAsync",value:function showNewsDialogAsync(){return this._showReactDialogAsync(le.x)}},{kind:"method",key:"showPaidFeatureOfferDialogAsync",value:function showPaidFeatureOfferDialogAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._showReactDialogAsync(de.Y,{paidFeature:e,options:t})}},{kind:"method",key:"showPaymentFailedDialogAsync",value:function showPaymentFailedDialogAsync(e){return this._showReactDialogAsync(ce.e,{changePaymentMethodUrl:e.changePaymentMethodUrl})}},{kind:"method",key:"showProductTourAsync",value:function showProductTourAsync(){return this._showReactDialogAsync(Y.Z)}},{kind:"method",key:"showReportDialogAsync",value:async function showReportDialogAsync(e){return this._showReactDialogAsync(he.$,e)}},{kind:"method",key:"showSendEventUpdatesDialogAsync",value:async function showSendEventUpdatesDialogAsync(e,t){if(this._sendEventUpdatesDialogQueue||(this._sendEventUpdatesDialogQueue=new z.zi),this._hasPendingSendEventUpdatesDialogPromise)return this._sendEventUpdatesDialogQueue.add((()=>this.showSendEventUpdatesDialogAsync(e,t)));this._hasPendingSendEventUpdatesDialogPromise=!0;const i=await this._showReactDialogAsync(pe.b,{eventTitle:e,eventUpdateType:t});return this._hasPendingSendEventUpdatesDialogPromise=!1,this._sendEventUpdatesDialogQueue.resolveNext(),i}},{kind:"method",key:"showShortcutsDialogAsync",value:function showShortcutsDialogAsync(){return this._showReactDialogAsync(me.i)}},{kind:"method",key:"showTrialExpiredDialogAsync",value:function showTrialExpiredDialogAsync(){return this._showReactDialogAsync(ge.e)}},{kind:"method",key:"showVideoPlayerDialogAsync",value:function showVideoPlayerDialogAsync(e){return this._showReactDialogAsync(ye.x,{videoId:e})}},{kind:"method",key:"showWelcomeSurveyDialogAsync",value:function showWelcomeSurveyDialogAsync(){return this._showReactDialogAsync(ve.d)}},{kind:"method",key:"showWelcomeToAppDialogAsync",value:function showWelcomeToAppDialogAsync(){return this._showReactDialogAsync(fe.O)}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"method",key:"_createDialogConfig",value:function _createDialogConfig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=B()("body");let i,r;return _objectSpread(_objectSpread({parent:t,clickOutsideToClose:!0,escapeToClose:!0,disableParentScroll:!0,zIndex:9999,controllerAs:"$ctrl"},e),{},{onComplete:(n,a)=>{var s;if(i=n,r=a,null===(s=e.onComplete)||void 0===s||s.call(e,i,r),i.$on(W.FK.CloseDialogsRequested,(()=>this._$mdDialog.cancel())),r){let i=!0;r.on("mousedown pwMouseDown",(e=>{i=!B()(e.target).is("input, textarea")&&!L()(t).call(t,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0]})),r.on("mouseup pwMouseUp",(r=>{if(!B()(r.target).closest("md-dialog")[0]&&!L()(t).call(t,".pw-dialog.pw-dialog--opaque")[0])return L()(t).call(t,"> .md-open-menu-container.md-active")[0]?(this._$mdMenu.hide(),void r.stopPropagation()):void(i?e.clickOutsideToClose&&this._$mdDialog.cancel():r.stopPropagation())})),r.on("click",(e=>{let t=B()(e.target);t.closest("a")[0]||t.is("input[type=file]")||(e.preventDefault(),e.stopPropagation())})),L()(r).call(r,"> md-dialog").on("keydown",(e=>{if(e.which===W.VD.Escape){if(L()(t).call(t,".pw-dialog.pw-dialog--opaque")[0])return void e.stopPropagation();L()(t).call(t,"> .md-open-menu-container.md-active")[0]&&(this._$mdMenu.hide(),e.stopPropagation()),r.trigger("focus")}})),r.on("keydown",(e=>e.stopPropagation())),r.on("keypress",(t=>{if(t.stopPropagation(),t.which===W.VD.Enter||t.which===W.VD.Enter2){if(e.disableSubmit)return;let i=B()(t.target);if(i.is("input:focus, textarea:focus")){if(i.hasClass("pw-js-multiline-textarea"))return void((t.ctrlKey||t.shiftKey)&&r.trigger("focus"));if(i.hasClass("pw-js-dialog-prevent-submit"))return void(t.ctrlKey||t.shiftKey||r.trigger("focus"));r.trigger("focus")}t.preventDefault(),e.onSubmit?e.onSubmit():L()(r).call(r,".pw-js-dialog-primary-btn:not([disabled])").click()}}))}},onRemoving:()=>{var n,a,s;null===(n=e.onRemoving)||void 0===n||n.call(e,i,r),null===(a=r)||void 0===a||a.detach(),null===(s=i)||void 0===s||s.$destroy(),(0,z.Tw)(L()(t).call(t,".md-panel"))}})}},{kind:"method",key:"_createPanelConfig",value:function _createPanelConfig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=B()("body");let i,r,n,a=this._$mdPanel.newPanelAnimation();e.targetEvent?a.openFrom(e.targetEvent).withAnimation(this._$mdPanel.animation.SCALE):a.withAnimation(this._$mdPanel.animation.FADE).duration({open:50,close:0});let s=!1;const o=this._$rootScope.$on(W.FK.CloseDialogsRequested,(()=>{s=!0,o()}));let l;return _objectSpread(_objectSpread({attachTo:t,disableParentScroll:!0,propagateContainerEvents:!1,animation:a,zIndex:1e3,controllerAs:"$ctrl",bindToController:!1,groupName:e.controller,mouseUpOutsideToClose:!0},e),{},{escapeToClose:!e.preventClose,clickOutsideToClose:!1,onDomAdded:()=>{var t,a;if(e.getPanelRef&&(i=e.getPanelRef(),n=i.panelContainer,r=i.config.scope),null===(t=e.onDomAdded)||void 0===t||t.call(e,r,n),s)throw null===(a=r)||void 0===a||a.$destroy(),new Error(W.FK.CloseDialogsRequested);if(e.ensureScreenBound){var o;let e=null===(o=i.panelEl)||void 0===o?void 0:o[0];if(!e)return;l=r.$watch((()=>e.scrollHeight),(()=>{let t=e.getBoundingClientRect().bottom-window.innerHeight+8;e.style.top=t>0?-t+"px":"0px"}))}},onOpenComplete:()=>{var a,l,d;(null===(a=e.onComplete)||void 0===a||a.call(e,r,n),e.enableScroll)&&(null===(l=i)||void 0===l||null===(d=l._restoreScroll)||void 0===d||d.call(l));if(r){if(s)return void i.close();o();let n=!0;r.$on(W.FK.CloseDialogsRequested,(function(t){let{force:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=!1,!r&&e.preventClose||i.close()})),i.registerInterceptor(this._$mdPanel.interceptorTypes.CLOSE,(async()=>{if(L()(t).call(t,".MuiDialog-root, .MuiPopover-root")[0])return P().reject(F.v8);if(r.$ctrl.confirmCloseAsync&&n){if(!await r.$ctrl.confirmCloseAsync())return P().reject(F.v8)}return P().resolve()}))}if(n){let a=!0;n.on("mousedown pwMouseDown",(i=>{if(e.propagateContainerEvents)return;if(i.offsetX>i.target.clientWidth||i.offsetY>i.target.clientHeight)return void(a=!1);let r=B()(i.target);a=!r.is("input, textarea")&&!L()(t).call(t,"> .md-open-menu-container.md-active, > .k-animation-container > .k-list-container.k-state-border-up")[0]&&(!r.closest(".md-panel")[0]&&!B()(this._$window.document.activeElement).hasClass("pw-js-multiline-textarea"))})),n.on("mouseup pwMouseUp",(r=>{var n;if(!B()(r.target).closest(".md-panel")[0]&&!L()(t).call(t,".pw-dialog.pw-dialog--opaque")[0])return L()(t).call(t,"> .md-open-menu-container.md-active")[0]&&!L()(t).call(t,".pw-dialog--opaque")[0]?(this._$mdMenu.hide(),void r.stopPropagation()):void(a&&!e.preventClose?null===(n=i)||void 0===n||n.close():r.stopPropagation())})),n.on("click",(e=>{let t=B()(e.target);t.closest("a")[0]||t.is("input[type=file]")||(e.preventDefault(),e.stopPropagation())})),e.preventClose||n.addClass("md-panel-closable");const s=L()(n).call(n,".md-panel");s.on("keydown",(e=>{if(e.which===W.VD.Escape){if(L()(t).call(t,".pw-dialog.pw-dialog--opaque")[0])return void e.stopPropagation();let i=B()(e.target);if((r.$ctrl.preventEscape||i.is("input, textarea"))&&e.stopPropagation(),L()(t).call(t,"> .md-open-menu-container.md-active")[0]&&(this._$mdMenu.hide(),e.stopPropagation()),L()(t).call(t,"> .k-animation-container > .k-list-container.k-state-border-up")[0]&&e.stopPropagation(),i.hasClass("pw-js-cancellable-input")){let t=i.scope();t&&(t.value=""),e.stopPropagation()}(0,z.Tw)(s)}})),n.on("keydown",(t=>{e.propagateContainerEvents||t.stopPropagation()})).on("keypress",(t=>{if(t.stopPropagation(),t.which===W.VD.Enter||t.which===W.VD.Enter2){if(e.disableSubmit)return;let i=B()(t.target);if(i.is("input:focus, textarea:focus")){if(i.hasClass("pw-js-multiline-textarea"))return void((t.ctrlKey||t.shiftKey)&&(0,z.Tw)(s));if(i.hasClass("pw-js-dialog-prevent-submit"))return void(t.ctrlKey||t.shiftKey||(0,z.Tw)(s));(0,z.Tw)(s)}t.preventDefault(),e.onSubmit?e.onSubmit():L()(s).call(s,".pw-js-dialog-primary-btn:not([disabled])").click()}}))}},onRemoving:()=>{var i,a,s,o;null===(i=e.onRemoving)||void 0===i||i.call(e,r,n),null===(a=n)||void 0===a||a.detach(),null===(s=r)||void 0===s||s.$destroy(),(0,z.Tw)(L()(t).call(t,".md-panel")),null===(o=l)||void 0===o||o()},onCloseSuccess:(t,i)=>{var n;null===(n=e.onCloseSuccess)||void 0===n||n.call(e,r,i)}})}},{kind:"method",key:"_showReactDialogAsync",value:function _showReactDialogAsync(e,t){let i,r=new(P())((r=>{let n=this._lastReactDialogId;this._lastReactDialogId++;let a={};for(let e of G.Z.componentInjections)a[e]=this._$injector.get(e);if(e.injections)for(let t of e.injections)a[t]=this._$injector.get(t);i=e=>this._$rootScope.$evalAsync((()=>{var t;this._openedReactDialogs=$()(t=this._openedReactDialogs).call(t,(e=>e.id!==n)),r(e)}));let s=_objectSpread(_objectSpread(_objectSpread({id:n,component:e,injections:a},t),a),{},{onClose:i});this._$rootScope.$evalAsync((()=>{this._openedReactDialogs=[...this._openedReactDialogs,s]}))}));return r.closeDialog=i,r}}]}}))},20946:(e,t,i)=>{i.d(t,{E:()=>V});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(67552),f=i.n(v),_=i(86981),C=i.n(_),S=i(62079),w=i.n(S),k=i(52020),b=i.n(k),D=i(73324),T=i.n(D),E=i(88546),A=i.n(E),I=i(66775),P=i.n(I),R=i(2201),L=i.n(R),N=i(26171),O=i(26881),M=i(73672),$=i.n(M),x=i(27525),B=i.n(x),H=i(31082),U=i.n(H),F=(i(88106),i(82617)),W=i(8937),z=i(29704),G=i(20115);i(95877);function ownKeys(e,t){var i=w()(e);if(b()){var r=b()(e);t&&(r=T()(r).call(r,(function(t){return A()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?l()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,N.Z)(e,t,n[t])})):P()?L()(e,P()(n)):l()(r=ownKeys(Object(n))).call(r,(function(t){c()(e,t,A()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,O.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const j={[F.T.TrialNoRemainingTrials]:"NOTIFICATIONS.PLANYWAY_ACTIVATE_TRIAL_ERROR_NO_REMAINING_TRIALS",[F.T.TrialPaidAlreadyActive]:"NOTIFICATIONS.PLANYWAY_ACTIVATE_TRIAL_ERROR_PAID_ALREADY_ACTIVE"};let V=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=C()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,z.SG)(["$injector","$rootScope","$log","$window","$translate","dialogSrv","notificationSrv","planywayIntegrationSrv","platformSrv","telemetrySrv"])],(function(e){return{F:class LicenseService{constructor(t,i,r,n,a,s,o,l,d,c){e(this),this._$injector=t,this._$rootScope=i,this._$log=r,this._$window=n,this._$translate=a,this._dialogSrv=s,this._notificationSrv=o,this._planywayIntegrationSrv=l,this._platformSrv=d,this._telemetrySrv=c}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"licenseSrv"}},{kind:"field",key:"_userLicense",value:void 0},{kind:"field",key:"_userSubscription",value:void 0},{kind:"get",key:"_appCommonSrv",value:function _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}},{kind:"method",key:"loadLicenseAsync",value:async function loadLicenseAsync(){if(!this.isLicenseLoaded()){this._loadLicensePromise||(this._loadLicensePromise=(async()=>{let e;try{e=await this._planywayIntegrationSrv.restAsync(W.Tu.Get,`${G.yx}/planyway/${this._userId}/license`,"Get user license"),(0,z.Zo)(G.X6)}catch(e){return this._$log.error("Planyway get user license error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get user license error",e,{class:this.constructor.name,method:this.loadLicenseAsync().name}),void this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_USER_LICENSE_LOAD_ERROR"),W.k$.ErrorWithReload)}e.success?(this._userLicense=_objectSpread(_objectSpread({},e.data),{},{expirationDate:e.data.expirationDate&&new Date(e.data.expirationDate),subscriptionStartDate:e.data.subscriptionStartDate&&new Date(e.data.subscriptionStartDate)}),this._applyLicense()):this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_USER_LICENSE_LOAD_ERROR_WITH_MESSAGE",{message:e.message}),W.k$.ErrorWithReload)})());try{return await this._loadLicensePromise}finally{this._loadLicensePromise=null}}}},{kind:"method",key:"loadLicensesAsync",value:async function loadLicensesAsync(e){let t;try{t=await this._planywayIntegrationSrv.restAsync(W.Tu.Post,`${G.yx}/planyway/${this._userId}/license`,"Get user licenses",{body:{action:"getLicenses",data:{userIds:e}}})}catch(e){this._$log.error("Planyway get user licenses error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway get user licenses error",e,{class:this.constructor.name,method:this.loadLicensesAsync.name})}if(t.success)return t.data}},{kind:"method",key:"activateTrialLicenseAsync",value:async function activateTrialLicenseAsync(){const e=this._appCommonSrv.getCancellationToken("activateTrialLicense");let t;try{t=await this._planywayIntegrationSrv.restAsync(W.Tu.Post,`${G.yx}/planyway/${this._userId}/license`,"Activate trial license",{body:{action:"activateTrial"}}),(0,z.Zo)(G.X6)}catch(e){return this._$log.error("Planyway activate trial license error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway activate trial license error",e,{class:this.constructor.name,method:this.activateTrialLicenseAsync.name}),void this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_ACTIVATE_TRIAL_ERROR"),W.k$.Error)}if(!t.success)return void this._notificationSrv.showNotification(j[t.code]?this._$translate.instant(j[t.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_ACTIVATE_TRIAL_ERROR_WITH_MESSAGE",{message:t.message}),W.k$.Error);let i=_objectSpread(_objectSpread({},t.data),{},{expirationDate:t.data.expirationDate&&new Date(t.data.expirationDate)});e.isCanceled()||i&&(this._userLicense=i,this._applyLicense(),this.isLicenseActive()&&this._$rootScope.$broadcast(W.FK.TrialLicenseActivated))}},{kind:"method",key:"isLicenseLoaded",value:function isLicenseLoaded(){return!!this._userLicense}},{kind:"method",key:"getLicenseType",value:function getLicenseType(){if(this.isLicenseLoaded())return this._userLicense.licenseType}},{kind:"method",key:"isLicenseActive",value:function isLicenseActive(){return!!this.isLicenseLoaded()&&(this._userLicense.isLicenseActive&&this._userLicense.expirationDate>new Date)}},{kind:"method",key:"getLicenseExpirationDate",value:function getLicenseExpirationDate(){if(this.isLicenseLoaded())return this._userLicense.expirationDate}},{kind:"method",key:"isTrialAvailable",value:function isTrialAvailable(){return!!this.isLicenseLoaded()&&(!this.isLicenseActive()&&this._userLicense.isTrialAvailable)}},{kind:"method",key:"isTrialActive",value:function isTrialActive(){return!!this.isLicenseLoaded()&&(this.getLicenseType()===F.oj.Trial&&this.isLicenseActive())}},{kind:"method",key:"getTrialDaysLeft",value:function getTrialDaysLeft(){if(!this.isTrialActive())return 0;let e=(0,z.i2)(new Date,this.getLicenseExpirationDate());return(!e||e<0)&&(e=0),e}},{kind:"method",key:"isSubscriptionAvailable",value:function isSubscriptionAvailable(){return!!this.isLicenseLoaded()&&(this.getLicenseType()===F.oj.Trial||!this.isLicenseActive())}},{kind:"method",key:"isSubscriptionAdmin",value:function isSubscriptionAdmin(){var e;return!!this.isLicenseLoaded()&&(null!==(e=this._userLicense.isSubscriptionAdmin)&&void 0!==e&&e)}},{kind:"method",key:"getSubscriptionStartDate",value:function getSubscriptionStartDate(){if(this.isLicenseLoaded())return this._userLicense.subscriptionStartDate}},{kind:"method",key:"getSubscriptionStatus",value:function getSubscriptionStatus(){if(this.isLicenseLoaded())return this._userLicense.subscriptionStatus}},{kind:"method",key:"getQuantity",value:function getQuantity(){if(this.isLicenseLoaded())return this._userLicense.quantity}},{kind:"method",key:"getPaymentCount",value:function getPaymentCount(){if(this.isLicenseLoaded())return this._userLicense.paymentCount}},{kind:"method",key:"getAddedUserCount",value:function getAddedUserCount(){if(this.isLicenseLoaded())return this._userLicense.addedUserCount}},{kind:"method",key:"getMaxMemberLanes",value:function getMaxMemberLanes(){var e;return null!==(e=this._userLicense.maxTeamLanes)&&void 0!==e?e:$()}},{kind:"method",key:"checkPaidFeatureAvailable",value:function checkPaidFeatureAvailable(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isLicenseLoaded())return t&&this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_USER_LICENSE_LOAD_ERROR"),W.k$.ErrorWithReload),!1;switch(e){case W.ZV.TimelineMember:if(this._availablePaidFeatures.has(e)&&(void 0===i.paidLanesCount||i.paidLanesCount<=this.getMaxMemberLanes()))return!0;break;case W.ZV.MultiBoard:if(this._availablePaidFeatures.has(e))return!0;if(i.paidCalendarsCount<=1)return!0;break;default:if(this._availablePaidFeatures.has(e))return!0}return t&&this._dialogSrv.showPaidFeatureOfferDialogAsync(e,i),!1}},{kind:"method",key:"getSubscriptionAsync",value:async function getSubscriptionAsync(){if(!this._userSubscription){let e;try{e=await this._planywayIntegrationSrv.restAsync(W.Tu.Get,`${G.yx}/planyway/${this._userId}/subscription`,"Get user subscription")}catch(e){return this._$log.error("Planyway get user subscription error:"),this._$log.error(e),void this._telemetrySrv.logError("Planyway get user subscription error",e,{class:this.constructor.name,method:this.getSubscriptionAsync.name})}if(!e.success)return void this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_USER_SUBSCRIPTION_LOAD_ERROR_WITH_MESSAGE",{message:e.message}),W.k$.Error);this._userSubscription=_objectSpread(_objectSpread({},e.data),{},{expirationDate:e.data.expirationDate&&new Date(e.data.expirationDate),firstPaymentDate:e.data.firstPaymentDate&&new Date(e.data.firstPaymentDate)})}return this._userSubscription}},{kind:"method",key:"getPricingAsync",value:async function getPricingAsync(){let e;try{e=await this._planywayIntegrationSrv.restAsync(W.Tu.Get,`${G.yx}/payment/pd/prices`,"Get pricing")}catch(e){return this._$log.error("Planyway get pricing error:"),this._$log.error(e),void this._telemetrySrv.logError("Planyway get pricing error",e,{class:this.constructor.name,method:this.getPricingAsync.name})}if(e.success)return e.data;this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PLANYWAY_PRICING_LOAD_ERROR_WITH_MESSAGE",{message:e.message}),W.k$.Error)}},{kind:"method",key:"isSaleActive",value:function isSaleActive(){var e;return!(W.wi<new Date)&&(!!B()(e=U()(F.R9)).call(e,(e=>W.Vc[e]))&&(this._paymentPlatform||this._getPaymentPlatformPromise?this._paymentPlatform===F.YT.Paddle:(this._getPaymentPlatformPromise=(async()=>{try{let e=await this.getPricingAsync();if(e)if(e[F.oj.Team][F.R9.Month].currency===F.F.RUB)this._paymentPlatform=F.YT.CloudPayments;else this._paymentPlatform=F.YT.Paddle}finally{this._getPaymentPlatformPromise=null}})(),!1)))}},{kind:"get",key:"_userId",value:function _userId(){return this._planywayIntegrationSrv.userId}},{kind:"method",key:"_applyLicense",value:function _applyLicense(){let e=this.isLicenseActive()?this.getLicenseType():F.oj.Free;this._availablePaidFeatures=W.gJ[e]}}]}}))},47304:(e,t,i)=>{i.d(t,{g:()=>T});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(57445),l=i.n(o),d=i(51791),c=i.n(d),h=i(90143),u=i.n(h),p=i(56626),m=i.n(p),g=i(67552),y=i.n(g),v=i(86981),f=i.n(v),_=i(26881),C=i(23513),S=i.n(C),w=i(99595),k=i.n(w),b=i(29704),D=i(8937);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;k()(i=["method","field"]).call(i,(function(i){k()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;k()(i=["method","field"]).call(i,(function(i){k()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}l()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(k()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),k()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==c()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];u()(s).call(s,c()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var h=0;h<d.length;h++)this.addElementPlacement(d[h],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,m(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,_.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:y()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return l()(t,m(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let T=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=f()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,b.SG)(["telemetrySrv"])],(function(e){return{F:class NotificationService{constructor(t){e(this),this._telemetrySrv=t,this._notificationListeners=new(S()),this._notificationQueue=[]}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"notificationSrv"}},{kind:"method",key:"addEventListener",value:function addEventListener(e){this._notificationListeners.add(e)}},{kind:"method",key:"removeEventListener",value:function removeEventListener(e){this._notificationListeners.delete(e)}},{kind:"method",key:"showNotification",value:function showNotification(e,t,i){var r;this._notificationQueue.push({message:e,type:t,group:i}),k()(r=this._notificationListeners).call(r,(r=>r(e,t,i))),this._telemetrySrv.logSingleEvent(D.cN.GeneralEvents.SystemMessageShown,{message:e,type:t})}},{kind:"method",key:"getNotificationQueue",value:function getNotificationQueue(){return this._notificationQueue}},{kind:"method",key:"clearNotificationQueue",value:function clearNotificationQueue(){this._notificationQueue=[]}}]}}))},90566:(e,t,i)=>{i.d(t,{D:()=>B});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(67552),f=i.n(v),_=i(26881),C=i(62079),S=i.n(C),w=i(86981),k=i.n(w),b=i(59863),D=i.n(b),T=i(53706),E=i.n(T),A=i(35820),I=i.n(A),P=i(65240),R=i(82617),L=i(8937),N=i(20115),O=i(29704),M=i(56777),$=i(95877);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,_.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const x={actionCount:0,releaseDate:new Date,actions:[L.Us.BoardCreate,L.Us.BoardEdit,L.Us.CalendarCreate,L.Us.CalendarEdit,L.Us.TimelineCreate,L.Us.TimelineEdit,L.Us.TimeTrackingCreate,L.Us.TimeTrackingEdit]};let B=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=k()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,O.SG)(["$injector","$rootScope","$sce","$log","$timeout","$translate","appCommonSrv","chatSrv","collectionSrv","dialogSrv","htmlHelperSrv","licenseSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class OnboardingService{constructor(t,i,r,n,a,s,o,l,d,c,h,u,p,m,g,y){e(this),this._$injector=t,this._$rootScope=i,this._$sce=r,this._$log=n,this._$timeout=a,this._$translate=s,this._appCommonSrv=o,this._charSrv=l,this._collectionSrv=d,this._dialogSrv=c,this._htmlHelperSrv=h,this._licenseSrv=u,this._planywayIntegrationSrv=p,this._platformSrv=m,this._settingsSrv=g,this._telemetrySrv=y}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"onboardingSrv"}},{kind:"field",key:"_isProductTourShown",value:()=>!1},{kind:"method",key:"showOnboardingAsync",value:async function showOnboardingAsync(){await this.showWelcomeSurveyDialogAsync(),this._collectionSettings.global.settings.isViewTemplateSelected||this._appCommonSrv.selectTemplate(this._userSettings.global.settings.defaultTemplate),(async()=>{if(await this._showTrialExpiredDialogAsync(),await this._showPaymentFailedDialogAsync(),this._injectProfitWellRetainScript(),await this._showSatisfactionSurveyDialogAsync(),await this._showNewsDialogAsync(),this._userSettings.global.settings.isOnboardingDemoInvitePassed||(this._userSettings.global.settings.isOnboardingDemoInvitePassed=!0,this._userSettings.global.saveAsync(),(0,O.i2)(this._planywayIntegrationSrv.userCreationDate,new Date)<7&&this._planywayIntegrationSrv.sendDemoInviteAsync()),this._charSrv.chatAvailable)if(await this._charSrv.initializeChatAsync(),(0,O.i2)(this._planywayIntegrationSrv.userCreationDate,new Date)>0)this._charSrv.updateUserData({"Action card created or edited":!0});else{let e=this._userSettings.global.settings.actionCounters;S()(e).length>0?this._charSrv.updateUserData({"Action card created or edited":!0}):this._charSrv.updateUserData({"Action card created or edited":!1})}await this.showProductTourAsync()})()}},{kind:"method",key:"showWelcomeSurveyDialogAsync",value:async function showWelcomeSurveyDialogAsync(){this._showWelcomeSurveyDialogPromise||(this._showWelcomeSurveyDialogPromise=(async()=>{this._userSettings.global.settings.isOnboardingWelcomeSurveyPassed||(await this._dialogSrv.showWelcomeSurveyDialogAsync({fullSize:!0}),this._userSettings.global.settings.isOnboardingWelcomeSurveyPassed=!0,this._$rootScope.$evalAsync((()=>{this._userSettings.global.saveAsync()})))})());try{return await this._showWelcomeSurveyDialogPromise}finally{this._showWelcomeSurveyDialogPromise=null}}},{kind:"get",key:"lastNewsDate",value:function lastNewsDate(){return this._lastNewsDate}},{kind:"get",key:"isProductTourOpen",value:function isProductTourOpen(){return this._isProductTourShown&&!this._userSettings.global.settings.isOnboardingProductTourMinimized}},{kind:"method",key:"showProductTourAsync",value:async function showProductTourAsync(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).force)this._userSettings.global.settings.isOnboardingProductTourClosed=!1,this._userSettings.global.settings.isOnboardingProductTourMinimized=!1,this._userSettings.global.saveAsync();else if(!this._isProductTourShown&&this._userSettings.global.settings.isOnboardingProductTourClosed)return;this._showProductTourPromise||(this._showProductTourPromise=(async()=>{let e,t=!1;const toggleProductTourShownAsync=async i=>{if(this._appCommonSrv.isUiPreconditionsPassed&&(this._isProductTourShown||!this._userSettings.global.settings.isOnboardingProductTourClosed))if(i){if(!this._collectionSrv.isCurrentCollectionProviderConnected(L.lP.Trello))return;if(!(0,M.VH)(L.lP.Trello).hasCurrentCollectionSelectedCalendars())return;if(t)return;t=!0;try{this._isProductTourShown=!0;let t=this._dialogSrv.showProductTourAsync();e=t.closeDialog,await t}finally{this._isProductTourShown=!1,e=null}}else{var r;if(!t)return;t=!1,null===(r=e)||void 0===r||r()}};if(!this._productTourInitialized){this._productTourInitialized=!0,this._$rootScope.$watch((()=>this._appCommonSrv.isPlanywayShown()),(e=>toggleProductTourShownAsync(e)));for(let e of[L.FK.CollectionChanged,L.FK.CalendarsChanged,L.FK.ChangeSchedulerViewRequested,L.FK.TrelloBoardSelectionChanged])this._$rootScope.$on(e,(()=>{if(!this._appCommonSrv.isPlanywayShown())return;if(!this._collectionSrv.isCurrentCollectionProviderConnected(L.lP.Trello))return;let e=!0;(0,M.VH)(L.lP.Trello).hasCurrentCollectionSelectedCalendars()||(e=!1),toggleProductTourShownAsync(e)}))}this._appCommonSrv.isPlanywayShown()&&await toggleProductTourShownAsync(!0)})());try{return await this._showProductTourPromise}finally{this._showProductTourPromise=null}}},{kind:"method",key:"incrementActionCounter",value:function incrementActionCounter(e){let t=this._userSettings.global.settings.actionCounters;0===S()(t).length&&this._charSrv.updateUserData({"Action card created or edited":!0}),void 0===t[e]?t[e]=1:t[e]+=1,this._userSettings.global.saveAsync(),this._showSatisfactionSurveyDialogAsync()}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"method",key:"_checkNewsAvailableAsync",value:async function _checkNewsAvailableAsync(){if(!this._planywayIntegrationSrv.isProviderConnected(L.lP.Trello))return!1;try{var e;let t=await this._platformSrv.restAsync(L.Tu.Get,N.D2,{maxRetryCount:3,headers:{"cache-control":"no-cache"}});this._lastNewsDate=null===(e=k()(t).call(t,(e=>{let t=!0,i=!0;return e.minVersion&&(t=(0,P.q)(this._platformSrv.getAppVersionShort(),e.minVersion,">=")),e.maxVersion&&(i=(0,P.q)(this._platformSrv.getAppVersionShort(),e.maxVersion,"<=")),t&&i})))||void 0===e?void 0:e.date}catch(e){return this._$log.error("Planyway load app changelog error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load app changelog error",e,{class:this.constructor.name,method:this._checkNewsAvailableAsync.name}),!1}if(!this.lastNewsDate||new Date(this.lastNewsDate)<(0,O.E4)(new Date,-30)||this._planywayIntegrationSrv.userCreationDate>(0,O.E4)(new Date,-1))return!1;let t=this._userSettings.global.settings.news;return!t.lastNewsDate||new Date(t.lastNewsDate)<new Date(this.lastNewsDate)?(t.lastNewsDate=this.lastNewsDate,t.newsHidden=!1,t.showUntilDate=(0,O.tC)((0,O.E4)(new Date,30)),this._userSettings.global.saveAsync(),!0):!t.newsHidden&&new Date(t.showUntilDate)>new Date}},{kind:"method",key:"_showNewsDialogAsync",value:async function _showNewsDialogAsync(){this._showNewsDialogPromise||(this._showNewsDialogPromise=(async()=>{await this._checkNewsAvailableAsync()&&(await(0,O.$U)(1e3),this._telemetrySrv.logSingleEvent(L.cN.GeneralEvents.NewsShown,{newsDate:this.lastNewsDate}),await this._dialogSrv.showNewsDialogAsync(),this._telemetrySrv.logSingleEvent(L.cN.GeneralEvents.NewsHidden,{newsDate:this.lastNewsDate}),this._userSettings.global.settings.news.newsHidden=!0,this._userSettings.global.saveAsync())})());try{return await this._showNewsDialogPromise}finally{this._showNewsDialogPromise=null}}},{kind:"method",key:"_showTrialExpiredDialogAsync",value:async function _showTrialExpiredDialogAsync(){this._showTrialExpiredDialogPromise||(this._showTrialExpiredDialogPromise=(async()=>{if(this._licenseSrv.isLicenseActive())try{$.Xb.removeItem("planywayTrialExpirationNotified")}catch{}else if(this._licenseSrv.getLicenseType()===R.oj.Trial&&!$.Xb.planywayTrialExpirationNotified){await(0,O.$U)(1e3),this._telemetrySrv.logSessionEvent(L.cN.GeneralEvents.TrialExpiredShown),await this._dialogSrv.showTrialExpiredDialogAsync();try{$.Xb.planywayTrialExpirationNotified=!0}catch{}}})());try{return await this._showTrialExpiredDialogPromise}finally{this._showTrialExpiredDialogPromise=null}}},{kind:"method",key:"_showPaymentFailedDialogAsync",value:async function _showPaymentFailedDialogAsync(){this._showPaymentFailedDialogPromise||(this._showPaymentFailedDialogPromise=(async()=>{switch(this._licenseSrv.getSubscriptionStatus()){case R.yh.PastDue:if(this._userSettings.global.settings.isPaymentFailedDialogShown)break;let e=await this._licenseSrv.getSubscriptionAsync();if(!e||!e.changePaymentMethodUrl)return;this._telemetrySrv.logSingleEvent(L.cN.GeneralEvents.PaymentFailedDialogShown),await this._dialogSrv.showPaymentFailedDialogAsync(e)||this._telemetrySrv.logSingleEvent(L.cN.GeneralEvents.PaymentFailedDialogClosed),this._userSettings.global.settings.isPaymentFailedDialogShown=!0,this._userSettings.global.saveAsync();break;case R.yh.Active:this._userSettings.global.settings.isPaymentFailedDialogShown&&(this._userSettings.global.settings.isPaymentFailedDialogShown=!1,this._userSettings.global.saveAsync())}})());try{return await this._showPaymentFailedDialogPromise}finally{this._showPaymentFailedDialogPromise=null}}},{kind:"method",key:"_showInstallGitHubFromMarketplaceDialog",value:async function _showInstallGitHubFromMarketplaceDialog(){}},{kind:"method",key:"_injectProfitWellRetainScript",value:function _injectProfitWellRetainScript(){if(!this._platformSrv.isProfitWellRetainEnabled()||!D()(this._settingsSrv).telemetry)return;if(!this._planywayIntegrationSrv.userEmail)return;const e=N.Tc.replace("USER_EMAIL_HERE",this._planywayIntegrationSrv.userEmail),t=[{key:"id",value:"profitwell-js"},{key:"type",value:"text/javascript"},{key:"data-pw-auth",value:N.T}];this._htmlHelperSrv.injectExternalScript(e,t)}},{kind:"method",key:"_showSatisfactionSurveyDialogAsync",value:async function _showSatisfactionSurveyDialogAsync(){var e;if(!this._planywayIntegrationSrv.isProviderConnected(L.lP.Trello))return!1;let t=this._userSettings.global.settings.productSatisfactionSurvey;const i=new Date;if((0,O.i2)(this._planywayIntegrationSrv.userCreationDate,i)<7)return;if(t.lastShownDate){let e=(0,O.i2)(t.lastShownDate,i);if(e<75)return;if(e<90)return void(t.isActionCountersReset||(this._userSettings.global.settings.actionCounters={},t.isActionCountersReset=!0))}if(E()(e=x.actions).call(e,((e,t)=>(void 0!==this._userSettings.global.settings.actionCounters[t]&&(e+=this._userSettings.global.settings.actionCounters[t]),e)),0)<x.actionCount)return;this._telemetrySrv.logSessionEvent(L.cN.FeedbackEvents.ProductSatisfactionShown);let r=await new(I())((e=>{this._dialogSrv.showSatisfactionSurveyDialogAsync({onSurveyDone:e})}));r&&(r.isSkipped&&this._telemetrySrv.logSessionEvent(L.cN.FeedbackEvents.ProductSatisfactionClosed),r.isSent&&(this._telemetrySrv.logSessionEvent(L.cN.FeedbackEvents.ProductSatisfactionSent,{npsLevel:r.npsLevel,npsFeedback:r.npsFeedback}),this._planywayIntegrationSrv.sendSatisfactionAsync({npsLevel:r.npsLevel,npsFeedback:r.npsFeedback})),t.lastShownDate=i,t.isActionCountersReset=!1,this._userSettings.global.saveAsync())}}]}}))},38044:(t,i,r)=>{r.d(i,{V:()=>oe});var n=r(40024),a=r.n(n),s=r(99595),o=r.n(s),l=r(57445),d=r.n(l),c=r(51791),h=r.n(c),u=r(56626),p=r.n(u),m=r(67552),g=r.n(m),y=r(62079),v=r.n(y),f=r(52020),_=r.n(f),C=r(88546),S=r.n(C),w=r(66775),k=r.n(w),b=r(2201),D=r.n(b),T=r(26171),E=r(26881),A=r(54847),I=r.n(A),P=r(35820),R=r.n(P),L=r(39290),N=r.n(L),O=r(27525),M=r.n(O),$=r(86981),x=r.n($),B=r(73324),H=r.n(B),U=r(10349),F=r.n(U),W=r(89221),z=r.n(W),G=r(88946),j=r.n(G),V=r(58218),K=r.n(V),Y=r(90143),q=r.n(Y),Z=r(51206),X=r.n(Z),Q=r(83423),J=r.n(Q),ee=r(82617),te=r(20115),ie=r(8937),re=r(29704),ne=r(56777),ae=r(95877);function ownKeys(e,t){var i=v()(e);if(_()){var r=_()(e);t&&(r=H()(r).call(r,(function(t){return S()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?o()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,T.Z)(e,t,n[t])})):k()?D()(e,k()(n)):o()(r=ownKeys(Object(n))).call(r,(function(t){d()(e,t,S()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;o()(i=["method","field"]).call(i,(function(i){o()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;o()(i=["method","field"]).call(i,(function(i){o()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}d()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(o()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),o()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==h()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];q()(s).call(s,h()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return d()(t,p(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return j()(t=(0,E.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:g()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:j()(e).call(e,this.fromElementDescriptor,this)};return d()(t,p(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[a()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const se={[ee.T.AuthGitHubNotAuthorized]:"NOTIFICATIONS.PLANYWAY_SIGN_IN_GITHUB_NOT_AUTHORIZED",[ee.T.AuthTrelloNotAuthorized]:"NOTIFICATIONS.PLANYWAY_SIGN_IN_TRELLO_NOT_AUTHORIZED",[ee.T.ConnectGoogleNotAuthorized]:"NOTIFICATIONS.PLANYWAY_CONNECT_GOOGLE_NOT_AUTHORIZED",[ee.T.ConnectGoogleGSuiteError]:"NOTIFICATIONS.PLANYWAY_CONNECT_GOOGLE_G_SUITE_ERROR",[ee.T.ConnectGoogleRefreshNotConnected]:"NOTIFICATIONS.PLANYWAY_CONNECT_GOOGLE_REFRESH_NOT_CONNECTED",[ee.T.ConnectOutlookNotAuthorized]:"NOTIFICATIONS.PLANYWAY_CONNECT_OUTLOOK_NOT_AUTHORIZED",[ee.T.ConnectOutlookRefreshNotConnected]:"NOTIFICATIONS.PLANYWAY_CONNECT_OUTLOOK_REFRESH_NOT_CONNECTED",[ee.T.ConnectCannotDisconnectPrimary]:"NOTIFICATIONS.PLANYWAY_DISCONNECT_CANNOT_DISCONNECT_PRIMARY"};let oe=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=x()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(j()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,re.SG)(["$injector","$rootScope","$log","$window","$translate","dialogSrv","notificationSrv","platformSrv","telemetrySrv"])],(function(t){return{F:class PlanywayIntegrationService{constructor(e,i,r,n,a,s,o,l,d){t(this),this._$injector=e,this._$rootScope=i,this._$log=r,this._$window=n,this._$translate=a,this._dialogSrv=s,this._notificationSrv=o,this._platformSrv=l,this._telemetrySrv=d;try{this._browser=X().getParser(this._$window.navigator.userAgent)}catch{}ae.Xb.addStorageEventListener((e=>{"planywayUserId"===e.key&&null!==e.newValue&&e.newValue!==this.userId&&this._platformSrv.reloadAppAsync()}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"planywayIntegrationSrv"}},{kind:"field",key:"_isAuthorized",value:()=>!1},{kind:"field",key:"_user",value:void 0},{kind:"field",key:"_connectedAccounts",value:()=>new(I())},{kind:"method",key:"isAppInitialized",value:function isAppInitialized(){return this._isAppInitialized}},{kind:"get",key:"fatalErrorMessage",value:function fatalErrorMessage(){return this._fatalErrorMessage}},{kind:"get",key:"userId",value:function userId(){return this._userId}},{kind:"get",key:"userCreationDate",value:function userCreationDate(){return!this._userCreationDate&&this.userId&&(this._userCreationDate=(0,ee.BX)(this.userId)),this._userCreationDate}},{kind:"get",key:"userName",value:function userName(){var e;return null===(e=this._user)||void 0===e?void 0:e.userName}},{kind:"get",key:"userEmail",value:function userEmail(){var e;return null===(e=this._user)||void 0===e?void 0:e.userEmail}},{kind:"get",key:"userAvatar",value:function userAvatar(){var e;return null===(e=this._user)||void 0===e?void 0:e.userAvatar}},{kind:"get",key:"user",value:function user(){return this._user&&_objectSpread({},this._user)}},{kind:"method",key:"isSignedIn",value:function isSignedIn(){return!!this._userId}},{kind:"method",key:"checkSignedInAsync",value:async function checkSignedInAsync(){if(this.isSignedIn())return!0;let e;try{e=await this.restAsync(ie.Tu.Get,`${te.yx}/planyway/auth`,"Check signed in")}catch(e){return this._$log.error("Planyway check signed in error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway check signed in error",e,{class:this.constructor.name,method:this.checkSignedInAsync.name}),!1}let t=await this._platformSrv.getAppStorageDataAsync();if(e.success){var i;this._userId=null===(i=e.data)||void 0===i?void 0:i.userId,t.isSignedIn=!0,ae.Xb.planywayUserId=this.userId}else{switch(e.code){case ee.T.AuthUnauthorized:case ee.T.AuthInvalidToken:case ee.T.AuthUserNotFound:break;default:this._notificationSrv.showNotification(se[e.code]?this._$translate.instant(se[e.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_SIGN_IN_ERROR_WITH_MESSAGE",{message:e.message}),ie.k$.Error)}t.isSignedIn=!1,ae.Xb.planywayUserId="",this._clearCachedRequests()}return this._platformSrv.setAppStorageDataAsync(t),e.success}},{kind:"method",key:"signInAsync",value:async function signInAsync(e){let t;try{t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/auth`,"Sign in",{body:{action:"signIn",data:e}})}catch(e){return this._$log.error("Planyway sign in error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway sign in error",e,{class:this.constructor.name,method:this.signInAsync.name}),!1}if(t.success){var i;this._$rootScope.$broadcast(ie.FK.UserAuthorized),this._userId=null===(i=t.data)||void 0===i?void 0:i.userId;let e=await this._platformSrv.getAppStorageDataAsync();e.isSignedIn=!0,this._platformSrv.setAppStorageDataAsync(e),ae.Xb.planywayUserId=this.userId,this._clearCachedRequests()}else this._notificationSrv.showNotification(se[t.code]?this._$translate.instant(se[t.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_SIGN_IN_ERROR_WITH_MESSAGE",{message:t.message}),ie.k$.Error);return t.success}},{kind:"method",key:"signOutAsync",value:async function signOutAsync(){let e;try{e=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/auth`,"Sign out",{body:{action:"signOut"}})}catch(e){return this._$log.error("Planyway sign out error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway sign out error",e,{class:this.constructor.name,method:this.signOutAsync.name}),!1}if(e.success){let e=await this._platformSrv.getAppStorageDataAsync();e.isSignedIn=!1,this._platformSrv.setAppStorageDataAsync(e),ae.Xb.planywayUserId="",this._clearCachedRequests(),await this._platformSrv.reloadAppAsync()}else this._notificationSrv.showNotification(se[e.code]?this._$translate.instant(se[e.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_SIGN_OUT_ERROR_WITH_MESSAGE",{message:e.message}),ie.k$.Error);return e.success}},{kind:"method",key:"initializeAppAsync",value:async function initializeAppAsync(e){let t;try{this._appCommonSrv.setSchedulerButtonBusy(!0),t=await this.checkSignedInAsync()}finally{e.isCanceled()||this._appCommonSrv.setSchedulerButtonBusy(!1)}if(!e.isCanceled()){if(!t)return await this._$rootScope.$onceAsync(ie.FK.UserAuthorized),this.initializeAppAsync(e);try{if(this._appCommonSrv.setSchedulerBusy(!0),this._appCommonSrv.setSchedulerButtonBusy(!0),this._isAppInitialized){if(await this._platformSrv.openOrCreateCollectionAsync(),e.isCanceled())return;await this._collectionSrv.initCurrentCollectionAsync(e)}else{if(await this._platformSrv.initializePlatformAsync(),await R().all([this._collectionSrv.loadCollectionsAsync(),this._loadUserAsync(),this._loadConnectedAccountsAsync(),this._settingsSrv.loadUserSettingsAsync(),this._licenseSrv.loadLicenseAsync()]),e.isCanceled())return;this._appCommonSrv.setLocale(this._userSettings.global.settings.locale);for(let[e,t]of N()(this._userSettings.global.settings.account))t.accountType===ee.Qm.ICal&&this.setConnectedAccount(_objectSpread(_objectSpread({},t),{},{accountId:e,accountName:t.name}));if(this._sendLaunchAsync(),this._appCommonSrv.initABTests(),this._telemetrySrv.initUserAsync(),this._userSettings.local.settings.lastOpenDate=new Date,this._userSettings.local.save(),!this._licenseSrv.isLicenseActive()&&this._licenseSrv.isTrialAvailable()){let e=this._licenseSrv.getLicenseType()===ee.oj.Free?ie.SG.Onboarding:ie.SG.Reset;await this._licenseSrv.activateTrialLicenseAsync(),this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.TrialStarted,{trialSource:e})}const{invite:t,link:i,card:r,action:n}=await this._appCommonSrv.getAppContextAsync();if(t)try{await this._collectionSrv.addUserToCurrentCollectionByInviteAsync(t),await this._collectionSrv.loadCollectionsAsync()}catch(e){this._$log.error("Planyway handle invite to collection error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway handle invite to collection error",e,{class:this.constructor.name,method:this.initializeAppAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.HANDLE_INVITE_TO_COLLECTION_ERROR"),ie.k$.Error)}if(i)switch(i.type){case ie.Un.AllowAccessBanner:case ie.Un.BrowserButton:case ie.Un.InviteEmail:case ie.Un.RequestEmail:case ie.Un.ShareCard:case ie.Un.ShareCollection:case ie.Un.PlanOnTimeline:case ie.Un.ViewOnTimeline:case ie.Un.PushNotificationMemberAssigned:case ie.Un.PushNotificationMemberMentioned:case ie.Un.PushNotificationRemindStart:case ie.Un.OverdueEmail:case ie.Un.NewsletterEmail:case ie.Un.OnboardingEmail:this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.OpenedByLink,{linkType:i.type,linkSubtype:i.subtype});break;case ie.Un.Maximized:this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.WindowMaximized);break;case ie.Un.Minimized:this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.WindowMinimized);break;case ie.Un.Fullscreen:this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.StandaloneOpenedByLink,{where:i.source}),this._userSettings.global.settings.isOnboardingWelcomeToAppPassed||(async()=>{await this._dialogSrv.showWelcomeToAppDialogAsync(),this._userSettings.global.settings.isOnboardingWelcomeToAppPassed=!0,this._userSettings.global.saveAsync()})()}if(await this._collectionSrv.initCurrentCollectionAsync(e),r){(0,ne.dS)(r.accountType).tryOpenCardAsync(r)}if(n)switch(n){case ie.NQ.ShowNotificationCenter:if(!this._licenseSrv.checkPaidFeatureAvailable(ie.ZV.Notifications,!0))return;let e;switch(i.type){case ie.Un.BrowserButton:e=ie.Yd.BrowserButton;break;case ie.Un.OverdueEmail:e=ie.Yd.OverdueEmail}this._telemetrySrv.logSingleEvent(ie.cN.NotificationEvents.CenterOpened,{by:e}),this._dialogSrv.showNotificationCenterDialogAsync("content");break;case ie.NQ.ShowNotificationSettings:if(!this._licenseSrv.checkPaidFeatureAvailable(ie.ZV.Notifications,!0))return;this._telemetrySrv.logSingleEvent(ie.cN.NotificationEvents.CenterOpened,{by:ie.Yd.OverdueEmail}),this._dialogSrv.showNotificationCenterDialogAsync("settings");break;case ie.NQ.ShowShareCollection:this._telemetrySrv.logSingleEvent(ie.cN.CollectionEvents.CollectionShareDialogOpened,{by:ie.qF.RequestEmail}),this._dialogSrv.showCollectionShareDialogAsync();break;case ie.NQ.ShowReports:this._telemetrySrv.logSingleEvent(ie.cN.GeneralEvents.OpenedByLink,{linkType:ie.Un.Reports});let t=ie.lv[ie.ud.Reports];if(t&&!this._licenseSrv.checkPaidFeatureAvailable(t,!0))break;this._collectionSettings.global.settings.schedulerMode=ie.ud.Reports,this._collectionSettings.global.saveAsync()}this._$rootScope.$broadcast(ie.FK.AppInitialized),this._isAppInitialized=!0}return!0}catch(e){return this._$log.error("Planyway app initialization error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway app initialization error",e,{class:this.constructor.name,method:this.initializeAppAsync.name}),this._fatalErrorMessage=this._$translate.instant("MISC.PLANYWAY_INITIALIZATION_ERROR"),!1}finally{this._appCommonSrv.setSchedulerBusy(!1),this._appCommonSrv.setSchedulerButtonBusy(!1)}}}},{kind:"method",key:"clearUserDataAsync",value:async function clearUserDataAsync(){}},{kind:"method",key:"isProviderConnected",value:function isProviderConnected(e){var t;return M()(t=this._connectedAccounts).call(t,(t=>{let{accountType:i}=t;return(0,ne.fL)(i)===e}))}},{kind:"method",key:"getPrimaryAccount",value:function getPrimaryAccount(){var e;return x()(e=this._connectedAccounts).call(e,(e=>e.isPrimary))}},{kind:"method",key:"getConnectedAccounts",value:function getConnectedAccounts(e){var t,i,r;return e?H()(i=F()(z()(r=this._connectedAccounts).call(r))).call(i,(t=>t.accountType===e)):F()(z()(t=this._connectedAccounts).call(t))}},{kind:"method",key:"getConnectedAccountById",value:function getConnectedAccountById(e){return this._connectedAccounts.get(e)}},{kind:"method",key:"connectAccountAsync",value:async function connectAccountAsync(e){let t;try{t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/connect`,"Connect account",{body:{action:"connect",data:e}}),(0,re.Zo)(te.ow)}catch(e){return this._$log.error("Planyway connect account error:"),this._$log.error(e),void this._telemetrySrv.logError("Planyway connect account error",e,{class:this.constructor.name,method:this.connectAccountAsync.name})}if(!t.success)return void this._notificationSrv.showNotification(se[t.code]?this._$translate.instant(se[t.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_CONNECT_ACCOUNT_ERROR_WITH_MESSAGE",{message:t.message}),ie.k$.Error);let i=t.data;return this.setConnectedAccount(i),i}},{kind:"method",key:"refreshAccountAsync",value:async function refreshAccountAsync(e){let t;try{t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/connect`,"Refresh account",{body:{action:"refresh",data:e}}),(0,re.Zo)(te.ow)}catch(e){return e.status||this._platformSrv.switchToOffline(),this._$log.error("Planyway refresh account error:"),this._$log.error(e),void this._telemetrySrv.logError("Planyway refresh account error",e,{class:this.constructor.name,method:this.refreshAccountAsync.name})}if(!t.success)return void this._notificationSrv.showNotification(se[t.code]?this._$translate.instant(se[t.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_CONNECT_ACCOUNT_ERROR_WITH_MESSAGE",{message:t.message}),ie.k$.Error);let i=t.data;return this.setConnectedAccount(i),i}},{kind:"method",key:"disconnectAccountAsync",value:async function disconnectAccountAsync(e){let t;try{t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/connect`,"Disconnect account",{body:{action:"disconnect",data:{accountType:e.accountType,accountId:e.accountId}}}),(0,re.Zo)(te.ow)}catch(e){return this._$log.error("Planyway disconnect account error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway disconnect account error",e,{class:this.constructor.name,method:this.disconnectAccountAsync.name}),!1}return t.success?(this.deleteConnectedAccount(e),!0):(this._notificationSrv.showNotification(se[t.code]?this._$translate.instant(se[t.code]):this._$translate.instant("NOTIFICATIONS.PLANYWAY_CONNECT_ACCOUNT_ERROR_WITH_MESSAGE",{message:t.message}),ie.k$.Error),!1)}},{kind:"method",key:"setConnectedAccount",value:function setConnectedAccount(e){this._connectedAccounts.set(e.accountId,e)}},{kind:"method",key:"deleteConnectedAccount",value:function deleteConnectedAccount(e){this._connectedAccounts.delete(e.accountId)}},{kind:"method",key:"sendSurveyAsync",value:async function sendSurveyAsync(t){try{await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/acquisition`,"Send survey",{body:{action:"survey",data:t}})}catch{this._$log.error("Planyway send survey error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway send survey error",e,{class:this.constructor.name,method:this.sendSurveyAsync.name})}}},{kind:"method",key:"sendSatisfactionAsync",value:async function sendSatisfactionAsync(t){try{await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/acquisition`,"Send satisfaction",{body:{action:"satisfaction",data:t}})}catch{this._$log.error("Planyway send satisfaction error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway send satisfaction error:",e,{class:this.constructor.name,method:this.sendSatisfactionAsync.name})}}},{kind:"method",key:"sendDemoInviteAsync",value:async function sendDemoInviteAsync(){const e=this._platformSrv.getAppPlatform(),t=this._platformSrv.getAppType();try{await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/acquisition`,"Send Demo Invite",{body:{action:"demoInvite",data:{appPlatform:e,appType:t,timeZone:(0,re.iT)()}}})}catch(e){this._$log.error("Planyway send demo invite error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway send demo invite error",e,{class:this.constructor.name,method:this.sendDemoInviteAsync.name})}}},{kind:"method",key:"sendFeedbackAsync",value:async function sendFeedbackAsync(e){try{var t,i;let n,a=this.restAsync(ie.Tu.Get,`${te.yx}/feedback/link`,"Get feedback upload link");var r;if(e.files)n=R().all(j()(r=e.files).call(r,(async e=>{let t=await(0,re.np)(e);return{name:e.name,content:t}})));let[s,o]=await R().all([a,n]);if(!s.success)throw new Error(`Failed to get feedback upload link! Response:\n${K()(s,null,4)}`);return await this.restAsync(ie.Tu.Put,s.data,"Send feedback",{headers:{"x-ms-blob-type":"BlockBlob"},body:{userId:e.userId,userName:e.userName,userEmail:e.userEmail,appPlatform:this._platformSrv.getAppPlatform(),appType:this._platformSrv.getAppType(),appVersion:this._platformSrv.getAppVersion(),browserName:null===(t=this._browser)||void 0===t?void 0:t.getBrowserName(),browserVersion:null===(i=this._browser)||void 0===i?void 0:i.getBrowserVersion(),browserLocale:J(),timeZone:(0,re.iT)(),isEnterpriseContactUs:e.isEnterpriseContactUs,message:e.message,attachments:o}}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.SEND_FEEDBACK_SUCCESS"),ie.k$.Success),!0}catch(e){return this._$log.error("Planyway send feedback error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway send feedback error",e,{class:this.constructor.name,method:this.sendFeedbackAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.SEND_FEEDBACK_ERROR"),ie.k$.Error),!1}}},{kind:"method",key:"lookupUserAsync",value:async function lookupUserAsync(e){let t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/user`,"Lookup user",{body:{action:"lookupUser",data:e}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return t.data}},{kind:"method",key:"createUserAsync",value:async function createUserAsync(e){let t=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/user`,"Create temp user",{body:{action:"createUser",data:e}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return t.data}},{kind:"method",key:"getUsersAsync",value:async function getUsersAsync(e){if(!e||!e.length)return[];let t=[],i=[...e];for(;i.length>0;){let e=await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/user`,"Get users",{body:{action:"getUsers",data:{userIds:q()(i).call(i,0,100)}}});if(!e.success){let t=new Error(e.message);throw t.code=e.code,t.details=e.details,t}t.push(...e.data)}return t}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"method",key:"_clearCachedRequests",value:function _clearCachedRequests(){const e=[te.f7,te.ow,te.X6,te.U0];for(const t of e)(0,re.Zo)(t)}},{kind:"method",key:"restAsync",value:async function restAsync(e,t,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(i,e,t,_objectSpread(_objectSpread({},n.query),n.body)),s=200;try{return await this._platformSrv.restAsync(e,t,_objectSpread(_objectSpread({},n),{},{usePlanywayAuth:!0}))}catch(e){throw s=e.status,r=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,s,r)}}},{kind:"method",key:"_loadUserAsync",value:async function _loadUserAsync(){if(!this.userId)return;let e=await this.restAsync(ie.Tu.Get,`${te.yx}/planyway/${this.userId}/user`,"Get user");if(!e.success){let t=new Error(e.message);throw t.code=e.code,t.details=e.details,t}this._user=e.data}},{kind:"method",key:"_sendLaunchAsync",value:async function _sendLaunchAsync(){const e=this._platformSrv.getAppPlatform(),t=this._platformSrv.getAppType();try{await this.restAsync(ie.Tu.Post,`${te.yx}/planyway/${this.userId}/acquisition`,"Send launch",{body:{action:"launch",data:{appPlatform:e,appType:t,installType:this._platformSrv.getInstallType(),unauthorizedId:this._telemetrySrv.unauthorizedId}},throttle:{tag:`Launch ${e} ${t}`,delay:60}})}catch(e){this._$log.error("Planyway send acquisition error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway send acquisition error",e,{class:this.constructor.name,method:this._sendLaunchAsync.name})}}},{kind:"method",key:"_loadConnectedAccountsAsync",value:async function _loadConnectedAccountsAsync(){var e,t;if(!this.userId)return;let i=await this.restAsync(ie.Tu.Get,`${te.yx}/planyway/${this.userId}/connect`,"Get connected accounts");if((0,re.Zo)(te.ow),!i.success){let e=new Error(i.message);throw e.code=i.code,e.details=i.details,e}this._connectedAccounts=new(I())(j()(e=H()(t=i.data).call(t,(e=>(0,ne.fL)(e.accountType)))).call(e,(e=>[e.accountId,e])))}},{kind:"get",key:"_appCommonSrv",value:function _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}},{kind:"get",key:"_licenseSrv",value:function _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=this._$injector.get("licenseSrv")),this._licenseSrvLazy}},{kind:"get",key:"_settingsSrv",value:function _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=this._$injector.get("settingsSrv")),this._settingsSrvLazy}},{kind:"get",key:"_collectionSrv",value:function _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=this._$injector.get("collectionSrv")),this._collectionSrvLazy}}]}}))},5875:(e,t,i)=>{i.d(t,{i:()=>he});var r=i(40024),n=i.n(r),a=i(57445),s=i.n(a),o=i(51791),l=i.n(o),d=i(90143),c=i.n(d),h=i(56626),u=i.n(h),p=i(67552),m=i.n(p),g=i(86981),y=i.n(g),v=i(62079),f=i.n(v),_=i(52020),C=i.n(_),S=i(88546),w=i.n(S),k=i(66775),b=i.n(k),D=i(2201),T=i.n(D),E=i(26171),A=i(26881),I=i(54847),P=i.n(I),R=i(53706),L=i.n(R),N=i(10349),O=i.n(N),M=i(40703),$=i.n(M),x=i(73324),B=i.n(x),H=i(89221),U=i.n(H),F=i(31082),W=i.n(F),z=i(88946),G=i.n(z),j=i(91829),V=i.n(j),K=i(35820),Y=i.n(K),q=i(99595),Z=i.n(q),X=i(76555),Q=i.n(X),J=i(96807),ee=i.n(J),te=i(77738),ie=i.n(te),re=i(82617),ne=i(56777),ae=(i(43611),i(8937)),se=i(20115),oe=i(29704);function ownKeys(e,t){var i=f()(e);if(C()){var r=C()(e);t&&(r=B()(r).call(r,(function(t){return w()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?Z()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,E.Z)(e,t,n[t])})):b()?T()(e,b()(n)):Z()(r=ownKeys(Object(n))).call(r,(function(t){s()(e,t,w()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;Z()(i=["method","field"]).call(i,(function(i){Z()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;Z()(i=["method","field"]).call(i,(function(i){Z()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}s()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(Z()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),Z()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==l()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];c()(s).call(s,l()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),d=this.toElementFinisherExtras((0,n[a])(o)||o);e=d.element,this.addElementPlacement(e,t),d.finisher&&r.push(d.finisher);var h=d.extras;if(h){for(var u=0;u<h.length;u++)this.addElementPlacement(h[u],t);i.push.apply(i,h)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return s()(t,u(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return G()(t=(0,A.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:m()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:G()(e).call(e,this.fromElementDescriptor,this)};return s()(t,u(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const le=new(ee())(se.Rv),de=(0,oe.$Y)(new Date("2021-09-03")),ce=(0,oe.TR)(de,9);let he=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=y()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(G()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,oe.SG)(["$log","$rootScope","$timeout","$translate","appCommonSrv","dialogSrv","licenseSrv","notificationSrv","onboardingSrv","planywayIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class PlanywayNotificationsService{constructor(t,i,r,n,a,s,o,l,d,c,h,u,p){e(this),this._$log=t,this._$rootScope=i,this._$timeout=r,this._$translate=n,this._appCommonSrv=a,this._dialogSrv=s,this._licenseSrv=o,this._notificationSrv=l,this._onboardingSrv=d,this._planywayIntegrationSrv=c,this._platformSrv=h,this._settingsSrv=u,this._telemetrySrv=p,this._provider=(0,ne.VH)(ae.lP.Trello),(async()=>{try{await this._registerServiceWorkerAsync()}catch{}})(),this._$rootScope.$on(ae.FK.TrialLicenseActivated,(()=>this.initializeAsync())),this._$rootScope.$on(ae.FK.NotificationsRead,(()=>{for(let e of this._provider.getCurrentCollectionConnectedAccountIds())this._lastReadDate[e]=this.getLastSentDate(e)||new Date,this._setNotificationsLastReadDateAsync(e,this.getLastReadDate(e)),this._unreadNotificationsCount=null,this._platformSrv.setAppUnreadNotificationsCountAsync(0)}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"planywayNotificationsSrv"}},{kind:"field",key:"_webNotificationStatus",value:()=>({})},{kind:"field",key:"_pushNotificationStatus",value:()=>({})},{kind:"field",key:"_notificationsSettings",value:()=>({})},{kind:"field",key:"_overdueEmailSettings",value:()=>({})},{kind:"field",key:"_lastSentDate",value:()=>({})},{kind:"field",key:"_lastReadDate",value:()=>({})},{kind:"field",key:"_notificationsMap",value:()=>new(P())},{kind:"field",key:"_unreadNotificationsCount",value:()=>null},{kind:"field",key:"_isPushNotificationsBannerShown",value:()=>!1},{kind:"method",key:"getLastSentDate",value:function getLastSentDate(e){return this._lastSentDate[e]}},{kind:"method",key:"getLastReadDate",value:function getLastReadDate(e){return this._lastReadDate[e]}},{kind:"get",key:"unreadNotificationsCount",value:function unreadNotificationsCount(){if(null===this._unreadNotificationsCount){var e;let t=(0,oe.vM)(this.notifications,"accountId");this._unreadNotificationsCount=L()(e=O()($()(t).call(t))).call(e,((e,t)=>{let[i,r]=t,n=this.getNotificationsSettings(i);return e+B()(r).call(r,(e=>{if(n[re.MY.Web][e.type]){let t=this.getLastReadDate(i);return!t||e.sentDate>t}return!1})).length}),0)}return this._unreadNotificationsCount}},{kind:"get",key:"notifications",value:function notifications(){var e;return O()(U()(e=this._notificationsMap).call(e))}},{kind:"method",key:"getNotificationsSettings",value:function getNotificationsSettings(e){return this._provider?this._notificationsSettings[e]||this._defaultNotificationSettings[e]:{}}},{kind:"get",key:"isNotificationsBusy",value:function isNotificationsBusy(){return this._isNotificationsBusy}},{kind:"method",key:"initializeAsync",value:async function initializeAsync(){if(this._provider&&!this._isInitialized&&!this._isInitializing&&0!==this._provider.getCurrentCollectionConnectedAccountIds().length&&this._licenseSrv.checkPaidFeatureAvailable(ae.ZV.Notifications,!1)){this._isInitializing=!0;try{this._setNotificationsBusy(!0);let e=!1;const t=await this._platformSrv.getPushNotificationsSubscriptionAsync();for(let i of this._provider.getCurrentCollectionConnectedAccountIds())await this._loadNotificationSettingsAsync(i,t),this.isWebNotificationsEnabled(i)?await this._loadLastNotificationsAsync(i):await this._subscribeNotificationsAsync(i,t),await this._subscribeSignalRNotificationsAsync(i),this.isPushNotificationsEnabled(i)||(t&&await this._platformSrv.setPushNotificationsSubscriptionAsync(null),this.isPushNotificationsBannerShown||this.showPushNotificationsBannerAsync()),this._telemetrySrv.logSingleEvent(ae.cN.NotificationEvents.Initialized,{accountId:i}),e=!0;e&&this._startAppNotificationsPollingAsync(),this._isInitialized=!0}catch(e){this._$log.error("Planyway initialize notifications error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway initialize notifications error",e,{class:this.constructor.name,method:this.initializeAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.NOTIFICATIONS_INITIALIZATION_ERROR"),ae.k$.Error)}finally{this._isInitializing=!1,this._setNotificationsBusy(!1)}}}},{kind:"method",key:"changeNotificationsLocaleAsync",value:async function changeNotificationsLocaleAsync(e){if(this.isWebNotificationsEnabled(e))try{this._setNotificationsBusy(!0),await this._setNotificationsLocaleAsync(e,this._appCommonSrv.getLocale())}catch(e){this._$log.error("Planyway save notifications locale error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway save notifications locale error",e,{class:this.constructor.name,method:this.changeNotificationsLocaleAsync.name})}finally{this._setNotificationsBusy(!1)}}},{kind:"method",key:"saveNotificationsSettingsAsync",value:async function saveNotificationsSettingsAsync(e,t){if(this.isWebNotificationsEnabled)try{this._setNotificationsBusy(!0);for(let i in t)for(let r in t[i])this._notificationsSettings[e][i][r]=t[i][r];this._notificationsSettings[e]=await this._setNotificationsSettingsAsync(e,t)}catch(e){this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_NOTIFICATIONS_SETTINGS_ERROR"),ae.k$.Error),this._$log.error("Planyway save notifications settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway save notifications settings error",e,{class:this.constructor.name,method:this.saveNotificationsSettingsAsync.name})}finally{this._setNotificationsBusy(!1)}}},{kind:"method",key:"getWebNotificationStatus",value:function getWebNotificationStatus(e){return this._webNotificationStatus[e]}},{kind:"method",key:"isWebNotificationsEnabled",value:function isWebNotificationsEnabled(e){return this.getWebNotificationStatus(e)===ae.Ez.Enabled}},{kind:"method",key:"getPushNotificationStatus",value:function getPushNotificationStatus(e){return this._pushNotificationStatus[e]}},{kind:"method",key:"isPushNotificationsEnabled",value:function isPushNotificationsEnabled(e){return this.getPushNotificationStatus(e)===ae.Ez.Enabled}},{kind:"get",key:"isPushNotificationsSupported",value:function isPushNotificationsSupported(){return this._platformSrv.isPushNotificationsSupported()}},{kind:"get",key:"isPushNotificationsBannerShown",value:function isPushNotificationsBannerShown(){return!!this._provider&&(!(!this._isInitialized||0===this._provider.getCurrentCollectionConnectedAccountIds().length)&&this._isPushNotificationsBannerShown)}},{kind:"method",key:"showPushNotificationsBannerAsync",value:async function showPushNotificationsBannerAsync(){if(this._platformSrv.isPushNotificationsSupported()){let{doNotShowPushNotificationsBanner:e}=await this._platformSrv.getAppStorageDataAsync();e||(this._isPushNotificationsBannerShown=!0)}}},{kind:"method",key:"hidePushNotificationsBannerAsync",value:async function hidePushNotificationsBannerAsync(){this._isPushNotificationsBannerShown=!1;let e=await this._platformSrv.getAppStorageDataAsync();e.doNotShowPushNotificationsBanner||(e.doNotShowPushNotificationsBanner=!0,this._platformSrv.setAppStorageDataAsync(e))}},{kind:"method",key:"enablePushNotificationsAsync",value:async function enablePushNotificationsAsync(e){if(this._licenseSrv.checkPaidFeatureAvailable(ae.ZV.Notifications,!1))try{this._setNotificationsBusy(!0);let t,i=this.getPushNotificationStatus(e);if(i===ae.Ez.Enabled||i===ae.Ez.Enabling)return!0;if(this._telemetrySrv.logSingleEvent(ae.cN.NotificationEvents.EnableRequested),this._platformSrv.isPushNotificationsServiceWorkerSupported())await this._registerServiceWorkerAsync(),t=await this._serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:se.Hz});else{let e=await this._platformSrv.exchangeSiteDataAsync(ae.jj.SubscribeNotifications,this._appCommonSrv.getLocale());t=null==e?void 0:e.subscription}if(!t)return this._telemetrySrv.logSingleEvent(ae.cN.NotificationEvents.EnableRejected),!1;this._telemetrySrv.logSingleEvent(ae.cN.NotificationEvents.EnableConfirmed);let r=le.encrypt(t,"base64");await this._platformSrv.setPushNotificationsSubscriptionAsync(r),await this._subscribeNotificationsAsync(e,r);let n=this.getNotificationsSettings(e);for(let e of W()(re.k$))n[re.MY.Desktop][e]=!0;return await this.saveNotificationsSettingsAsync(e,n),this._isPushNotificationsBannerShown=!1,!0}catch(t){if(this._pushNotificationStatus[e]=ae.Ez.Disabled,await this._platformSrv.setPushNotificationsSubscriptionAsync(null),"NotAllowedError"===t.name)this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PUSH_NOTIFICATIONS_BLOCKED_WARNING"),ae.k$.Warning,ae.Ne.Notifications),this._telemetrySrv.logSingleEvent(ae.cN.NotificationEvents.EnableDenied);else this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.PUSH_NOTIFICATIONS_ENABLE_ERROR"),ae.k$.Error,ae.Ne.Notifications),this._$log.error("Planyway turn push notifications on error:"),this._$log.error(t),this._telemetrySrv.logError("Planyway turn push notifications on error",t,{class:this.constructor.name,method:this.enablePushNotificationsAsync.name});return!1}finally{this._setNotificationsBusy(!1)}}},{kind:"get",key:"maxRemindersPerCard",value:function maxRemindersPerCard(){return 5}},{kind:"get",key:"remindTimeDayStart",value:function remindTimeDayStart(){return de}},{kind:"method",key:"getDefaultReminders",value:function getDefaultReminders(e){let t=e?this._userSettings.global.settings.defaultRemindBeforeAllDay:this._userSettings.global.settings.defaultRemindBefore;return G()(t).call(t,(e=>({id:ie()(),type:re.k$.RemindStart,remindBefore:e})))}},{kind:"method",key:"getOverdueEmailSettings",value:function getOverdueEmailSettings(e){return this._overdueEmailSettings[e]||this._defaultOverdueEmailSettings}},{kind:"method",key:"saveOverdueEmailSettingsAsync",value:async function saveOverdueEmailSettingsAsync(e,t){if(this.isWebNotificationsEnabled(e))try{this._setNotificationsBusy(!0),this._overdueEmailSettings[e]=_objectSpread({},t),this._overdueEmailSettings[e]=await this._setNotificationsOverdueEmailSettingsAsync(e,t)}catch(e){this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.UPDATE_NOTIFICATIONS_SETTINGS_ERROR"),ae.k$.Error),this._$log.error("Planyway save notifications overdue email settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway save notifications overdue email settings error",e,{class:this.constructor.name,method:this.saveOverdueEmailSettingsAsync.name})}finally{this._setNotificationsBusy(!1)}}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_defaultNotificationSettings",value:function _defaultNotificationSettings(){if(!this._defaultNotificationSettingsInternal){this._defaultNotificationSettingsInternal={};for(let e of this._provider.getCurrentCollectionConnectedAccountIds()){this._defaultNotificationSettingsInternal[e]={};for(let t of W()(re.MY)){this._defaultNotificationSettingsInternal[e][t]={};for(let i of W()(re.k$))this._defaultNotificationSettingsInternal[e][t][i]=!1}}}return this._defaultNotificationSettingsInternal}},{kind:"get",key:"_defaultOverdueEmailSettings",value:function _defaultOverdueEmailSettings(){return this._defaultOverdueEmailSettingsinternal||(this._defaultOverdueEmailSettingsinternal={isEnabled:!0,sendDate:ce,sendRule:"FREQ=DAILY"}),this._defaultOverdueEmailSettingsinternal}},{kind:"method",key:"_subscribeNotificationsAsync",value:async function _subscribeNotificationsAsync(e,t){let i=[ae.Ez.Enabled,ae.Ez.Enabling];if(!V()(i).call(i,this._webNotificationStatus[e])||!V()(i).call(i,this._pushNotificationStatus[e])){this._webNotificationStatus[e]=ae.Ez.Enabling,t&&(this._pushNotificationStatus[e]=ae.Ez.Enabling);try{await this._subscribeNotificationsOnBackendAsync(e,(0,oe.iT)(),this._appCommonSrv.getLocale(),t);let i=(async()=>{let i=0;for(;i<5;){await(0,oe.$U)(1e3*(0===i?10:5)),i+=1;let r=await this._getNotificationSettingsAsync(e,t);if(r[re.MY.Web]&&(!t||r[re.MY.Desktop]))return this._webNotificationStatus[e]=ae.Ez.Enabled,t&&(this._pushNotificationStatus[e]=ae.Ez.Enabled),this._notificationsSettings[e]=r.settings,this._overdueEmailSettings[e]=r.overdueEmailSettings,void(this._lastReadDate[e]=r.lastReadDate)}this._webNotificationStatus[e]=ae.Ez.Disabled,t&&(this._pushNotificationStatus[e]=ae.Ez.Disabled),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.NOTIFICATIONS_REGISTER_LONGER_THAN_USUAL"),ae.k$.Warning,ae.Ne.Notifications)})();await i}catch(i){this._webNotificationStatus[e]=ae.Ez.Disabled,t&&(this._pushNotificationStatus[e]=ae.Ez.Disabled),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.NOTIFICATIONS_ENABLE_ERROR"),ae.k$.Error,ae.Ne.Notifications),this._$log.error("Planyway enable notifications error:"),this._$log.error(i),this._telemetrySrv.logError("Planyway enable notifications error",i,{class:this.constructor.name,method:this._subscribeNotificationsAsync.name})}}}},{kind:"method",key:"_setNotificationsBusy",value:function _setNotificationsBusy(e){this._$timeout((()=>this._isNotificationsBusy=e))}},{kind:"method",key:"_subscribeSignalRNotificationsAsync",value:async function _subscribeSignalRNotificationsAsync(e){const t=this._planywayIntegrationSrv.getConnectedAccountById(e),{url:i,token:r}=this._provider.getSignalRConnectionParams(t),errorCallback=e=>{this._$log.error("Planyway notification SignalR error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway notification SignalR error",e,{class:this.constructor.name,method:this._subscribeSignalRNotificationsAsync.name})},n=this._platformSrv.buildSignalRPollingController((async()=>{this._provider.invalidAccountIds.has(e)||await this._loadNotificationSettingsAsync(e)}),6e4),a=this._platformSrv.buildSignalRPollingController((async()=>{this._provider.invalidAccountIds.has(e)||await this._loadLastNotificationsAsync(e)}),6e4);await Y().all([this._platformSrv.subscribeSignalRAsync(i,{token:r,messageType:re.Wy.NotificationsSettingsChanged,messageCallback:t=>{this._notificationsSettings[e]=t.settings},errorCallback,pollingController:n}),this._platformSrv.subscribeSignalRAsync(i,{token:r,messageType:re.Wy.NotificationsOverdueEmailSettingsChanged,messageCallback:t=>{this._overdueEmailSettings[e]=t.overdueEmailSettings},errorCallback,pollingController:n}),this._platformSrv.subscribeSignalRAsync(i,{token:r,messageType:re.Wy.NotificationsLastReadDateChanged,messageCallback:t=>{this._lastReadDate[e]=t.lastReadDate,this._resetUnreadNotificationsCount()},errorCallback,pollingController:n}),this._platformSrv.subscribeSignalRAsync(i,{token:r,messageType:re.Wy.NotificationsSent,messageCallback:t=>{this._processNewNotifications(e,[t],t.sentDate)},errorCallback,pollingController:a})])}},{kind:"method",key:"_resetUnreadNotificationsCount",value:function _resetUnreadNotificationsCount(){this._$timeout((()=>{this._unreadNotificationsCount=null,this._platformSrv.setAppUnreadNotificationsCountAsync(this.unreadNotificationsCount)}))}},{kind:"method",key:"_loadNotificationSettingsAsync",value:async function _loadNotificationSettingsAsync(e,t){try{let i=await this._getNotificationSettingsAsync(e,t);this._webNotificationStatus[e]=i[re.MY.Web]?ae.Ez.Enabled:ae.Ez.Disabled,t&&(this._pushNotificationStatus[e]=i[re.MY.Desktop]?ae.Ez.Enabled:ae.Ez.Disabled),this._notificationsSettings[e]=i.settings||this._defaultNotificationSettings[e],this._overdueEmailSettings[e]=i.overdueEmailSettings||{},this._lastReadDate[e]=i.lastReadDate||this._lastReadDate[e]}catch(e){this._$log.error("Planyway load notification settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load notification settings error",e,{class:this.constructor.name,method:this._loadNotificationSettingsAsync.name})}}},{kind:"method",key:"_loadLastNotificationsAsync",value:async function _loadLastNotificationsAsync(e){try{let{notifications:t,lastSentDate:i}=await this._getLastNotificationsAsync(e,this.getLastSentDate(e));this._processNewNotifications(e,t,i)}catch(e){this._$log.error("Planyway load last notifications error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load last notifications error",e,{class:this.constructor.name,method:this._loadLastNotificationsAsync.name})}}},{kind:"method",key:"_processNewNotifications",value:function _processNewNotifications(e,t,i){t=B()(t).call(t,(e=>e.type!==re.k$.RemindStart)),Z()(t).call(t,(t=>this._notificationsMap.set(t.id,_objectSpread({accountId:e},t))));let r=this._notificationsMap.size-50;if(r>0){var n;let e=Q()(n=this.notifications).call(n,((e,t)=>e.sentDate-t.sentDate));for(let t=0;t<r;++t)this._notificationsMap.delete(e[t].id)}(t.length>0||r>0)&&this._$rootScope.$broadcast(ae.FK.NotificationsChanged),i&&(this._lastSentDate[e]=i),this._resetUnreadNotificationsCount()}},{kind:"method",key:"_startAppNotificationsPollingAsync",value:function _startAppNotificationsPollingAsync(){var e;let t=G()(e=this._provider.getCurrentCollectionConnectedAccountIds()).call(e,(e=>{const{trelloMemberId:t,trelloToken:i}=this._planywayIntegrationSrv.getConnectedAccountById(e);return{trelloMemberId:t,trelloToken:i}}));this._platformSrv.startAppNotificationsPollingAsync({data:t})}},{kind:"method",key:"_getNotificationSettingsAsync",value:async function _getNotificationSettingsAsync(e,t){const{trelloMemberId:i,trelloToken:r}=this._planywayIntegrationSrv.getConnectedAccountById(e);let n=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${i}/control`,"Check Notifications Status",{token:r,body:{action:"check",data:{subscription:t}},telemetrySkipOnSuccess:!0});if(!n.success){let e=new Error(n.message);throw e.code=n.code,e.details=n.details,e}let a=n.data;return _objectSpread(_objectSpread({},a),{},{overdueEmailSettings:a.overdueEmailSettings&&_objectSpread(_objectSpread({},a.overdueEmailSettings),{},{sendDate:a.overdueEmailSettings.sendDate&&new Date(a.overdueEmailSettings.sendDate)}),lastReadDate:a.lastReadDate&&new Date(a.lastReadDate)})}},{kind:"method",key:"_subscribeNotificationsOnBackendAsync",value:async function _subscribeNotificationsOnBackendAsync(e,t,i,r){const{trelloMemberId:n,trelloToken:a}=this._planywayIntegrationSrv.getConnectedAccountById(e);let s=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${n}/control`,"Subscribe Notifications",{token:a,body:{action:"subscribe",data:{timeZone:t,locale:i,subscription:r}}});if(!s.success){let e=new Error(s.message);throw e.code=s.code,e.details=s.details,e}}},{kind:"method",key:"_setNotificationsSettingsAsync",value:async function _setNotificationsSettingsAsync(e,t){const{trelloMemberId:i,trelloToken:r}=this._planywayIntegrationSrv.getConnectedAccountById(e);let n=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${i}/control`,"Set Notifications Settings",{token:r,body:{action:"setSettings",data:{settings:t}}});if(!n.success){let e=new Error(n.message);throw e.code=n.code,e.details=n.details,e}return n.data.settings}},{kind:"method",key:"_setNotificationsLastReadDateAsync",value:async function _setNotificationsLastReadDateAsync(e,t){const{trelloMemberId:i,trelloToken:r}=this._planywayIntegrationSrv.getConnectedAccountById(e);let n=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${i}/control`,"Set Notifications Last Read Date",{token:r,body:{action:"setLastReadDate",data:{lastReadDate:t}}});if(!n.success){let e=new Error(n.message);throw e.code=n.code,e.details=n.details,e}}},{kind:"method",key:"_getLastNotificationsAsync",value:async function _getLastNotificationsAsync(e,t){var i;const{trelloMemberId:r,trelloToken:n}=this._planywayIntegrationSrv.getConnectedAccountById(e);let a=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${r}/control`,"Get Last Notifications",{token:n,body:{action:"getLastNotifications",data:{lastSentDate:t}},telemetrySkipOnSuccess:!0});if(!a.success){let e=new Error(a.message);throw e.code=a.code,e.details=a.details,e}let s=a.data;return{lastSentDate:s.lastSentDate&&new Date(s.lastSentDate),notifications:G()(i=s.notifications).call(i,(e=>_objectSpread(_objectSpread({},e),{},{sentDate:new Date(e.sentDate)})))}}},{kind:"method",key:"_setNotificationsLocaleAsync",value:async function _setNotificationsLocaleAsync(e,t){const{trelloMemberId:i,trelloToken:r}=this._planywayIntegrationSrv.getConnectedAccountById(e);let n=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${i}/control`,"Set Notifications Locale",{token:r,body:{action:"setLocale",data:{locale:t}}});if(!n.success){let e=new Error(n.message);throw e.code=n.code,e.details=n.details,e}}},{kind:"method",key:"_setNotificationsOverdueEmailSettingsAsync",value:async function _setNotificationsOverdueEmailSettingsAsync(e,t){const{trelloMemberId:i,trelloToken:r}=this._planywayIntegrationSrv.getConnectedAccountById(e);let n=await this._restAsync(ae.Tu.Post,`${se.jI}/trello/${i}/control`,"Set Notifications Overdue Email Settings",{token:r,body:{action:"setOverdueEmailSettings",data:{overdueEmailSettings:t}}});if(!n.success){let e=new Error(n.message);throw e.code=n.code,e.details=n.details,e}let a=n.data;return _objectSpread(_objectSpread({},a.overdueEmailSettings),{},{sendDate:a.overdueEmailSettings.sendDate&&new Date(a.overdueEmailSettings.sendDate)})}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(i,e,t,_objectSpread(_objectSpread({},n.query),n.body),n.telemetrySkipOnSuccess),s=200;n.usePlanywayAuth||(n.useTrelloAuth=!0);try{return await this._platformSrv.restAsync(e,t,n)}catch(e){throw s=e.status,r=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,s,r)}}},{kind:"method",key:"_registerServiceWorkerAsync",value:async function _registerServiceWorkerAsync(){if(this._platformSrv.isPushNotificationsServiceWorkerSupported()&&this._platformSrv.isPushNotificationsSupported()&&!this._serviceWorkerRegistration){this._registerServiceWorkerPromise||(this._registerServiceWorkerPromise=(async()=>{this._serviceWorkerRegistration=await navigator.serviceWorker.register("https://planyway.com/common/push-notifications-sw.js")})());try{await this._registerServiceWorkerPromise}finally{this._registerServiceWorkerPromise=null}}}}]}}))},87217:(e,t,i)=>{i.d(t,{r:()=>$e});var r=i(40024),n=i.n(r),a=i(57445),s=i.n(a),o=i(51791),l=i.n(o),d=i(90143),c=i.n(d),h=i(56626),u=i.n(h),p=i(67552),m=i.n(p),g=i(52020),y=i.n(g),v=i(88546),f=i.n(v),_=i(66775),C=i.n(_),S=i(2201),w=i.n(S),k=i(41266),b=i(26171),D=i(26881),T=i(54847),E=i.n(T),A=i(23513),I=i.n(A),P=i(35820),R=i.n(P),L=i(10349),N=i.n(L),O=i(29898),M=i.n(O),$=i(8244),x=i.n($),B=i(91829),H=i.n(B),U=i(88946),F=i.n(U),W=i(73324),z=i.n(W),G=i(53706),j=i.n(G),V=i(86981),K=i.n(V),Y=i(31082),q=i.n(Y),Z=i(76555),X=i.n(Z),Q=i(66924),J=i.n(Q),ee=i(99595),te=i.n(ee),ie=i(62079),re=i.n(ie),ne=i(45181),ae=i.n(ne),se=i(39290),oe=i.n(se),le=i(98235),de=i.n(le),ce=i(59580),he=i.n(ce),ue=i(35704),pe=i.n(ue),me=i(19755),ge=i.n(me),ye=i(82303),ve=i(84105),fe=i(93162),_e=i(10183),Ce=i(36727),Se=i.n(Ce),we=i(82617),ke=i(14587),be=i(8937),De=i(20115),Te=i(29704),Ee=i(47436);const Ae=["date"],Ie=["date"];function ownKeys(e,t){var i=re()(e);if(y()){var r=y()(e);t&&(r=z()(r).call(r,(function(t){return f()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?te()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,b.Z)(e,t,n[t])})):C()?w()(e,C()(n)):te()(r=ownKeys(Object(n))).call(r,(function(t){s()(e,t,f()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;te()(i=["method","field"]).call(i,(function(i){te()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;te()(i=["method","field"]).call(i,(function(i){te()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}s()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(te()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),te()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==l()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];c()(s).call(s,l()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),d=this.toElementFinisherExtras((0,n[a])(o)||o);e=d.element,this.addElementPlacement(e,t),d.finisher&&r.push(d.finisher);var h=d.extras;if(h){for(var u=0;u<h.length;u++)this.addElementPlacement(h[u],t);i.push.apply(i,h)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return s()(t,u(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return F()(t=(0,D.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:m()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:F()(e).call(e,this.fromElementDescriptor,this)};return s()(t,u(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}Se().fonts={"NotoSans.ttf":{normal:"https://files.planyway.com/common/fonts/Regular-NotoSans.ttf",bold:"https://files.planyway.com/common/fonts/Bold-NotoSans.ttf"}};const Pe="custom_field__",Re="Archived",Le="Completed",Ne="Incomplete";let Oe;Oe=[["type","Type"],["board","Board/Calendar"],["list","List"],["parent","ParentCard"],["title","Title"],["members","Members"],["labels","Labels"],["status","Status"],["startDate","StartDate"],["startTime","StartTime"],["endDate","EndDate"],["endTime","EndTime"],["durationHours","DurationHours"],["estimatedTimeHours","EstimatedTimeHours"],["trackedTimeHours","TrackedTimeHours"],["description","Description"]];const Me=["durationHours","estimatedTimeHours","trackedTimeHours"];let $e=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=K()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(F()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,Te.SG)(["$injector","$log","$translate","appCommonSrv","calendarCardsSrv","googleIntegrationSrv","iCalIntegrationSrv","notificationSrv","outlookIntegrationSrv","platformSrv","settingsSrv","telemetrySrv"])],(function(e){return{F:class ReportService{constructor(t,i,r,n,a,s,o,l,d,c,h,u){e(this),this._$injector=t,this._$log=i,this._$translate=r,this._appCommonSrv=n,this._calendarCardsSrv=a,this._googleIntegrationSrv=s,this._iCalIntegrationSrv=o,this._notificationSrv=l,this._outlookIntegrationSrv=d,this._platformSrv=c,this._settingsSrv=h,this._telemetrySrv=u}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"reportSrv"}},{kind:"field",key:"_accountMembersCache",value:()=>new(E())},{kind:"field",key:"_fonts",value:()=>new(I())(["NotoSans.ttf"])},{kind:"get",key:"_githubIntegrationSrv",value:function _githubIntegrationSrv(){return this._githubIntegrationSrvLazy||(this._githubIntegrationSrvLazy=this._$injector.get("githubIntegrationSrv")),this._githubIntegrationSrvLazy}},{kind:"get",key:"_trelloIntegrationSrv",value:function _trelloIntegrationSrv(){return this._trelloIntegrationSrvLazy||(this._trelloIntegrationSrvLazy=this._$injector.get("trelloIntegrationSrv")),this._trelloIntegrationSrvLazy}},{kind:"get",key:"availableReports",value:function availableReports(){return this._availableReports||(this._availableReports=[{type:be.C2.TimeRecords,parameters:{title:this._$translate.instant("DIALOGS.REPORTS_EXPORT_TIME_RECORDS"),isValid:e=>this._isTimeRecordsReportParametersValid(e)},getActionText:e=>this._getActionText(be.C2.TimeRecords,e),buildAsync:(e,t)=>this._buildTimeRecordsReportAsync(e,t)},{type:be.C2.AllCards,parameters:{title:this._$translate.instant("DIALOGS.REPORTS_EXPORT_ALL_CARDS"),isValid:e=>this._isAllCardsReportParametersValid(e)},getActionText:e=>this._getActionText(be.C2.AllCards,e),buildAsync:(e,t)=>this._buildAllCardsReportAsync(e,t)},{type:be.C2.BoardCards,buildAsync:(e,t)=>this._buildBoardCardsReportAsync(e,t)},{type:be.C2.Scheduler,buildAsync:()=>this._buildSchedulerReportAsync()}]),this._availableReports}},{kind:"get",key:"isCancelled",value:function isCancelled(){return this._isCancelled}},{kind:"set",key:"isCancelled",value:function isCancelled(e){this._isCancelled=e}},{kind:"method",key:"getDefaultParameters",value:function getDefaultParameters(e){let{view:t,unit:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case be.C2.TimeRecords:return{startDate:(0,Te.$Y)(t.startDate()),endDate:(0,Te.h3)(t.endDate())};case be.C2.AllCards:switch(this._appCommonSrv.getSchedulerMode()){case be.ud.Calendar:switch(this._appCommonSrv.getSchedulerView()){case be.rW.OneDay:case be.rW.ThreeDay:case be.rW.Week:return{startDate:(0,Te.$Y)(t.startDate()),endDate:(0,Te.h3)(t.endDate())};case be.rW.Month:return{startDate:(0,Te.$Y)((0,Te.pW)(t.selectedDate)),endDate:(0,Te.h3)((0,Te.R2)(t.selectedDate))}}break;case be.ud.Timeline:switch(i){case be.Uh.Hour:return{startDate:(0,Te.$Y)(t.selectedDate),endDate:(0,Te.h3)(t.selectedDate)};case be.Uh.Day:let e=(0,Te.OR)(),i=(0,Te.vr)();return{startDate:(0,Te.$Y)((0,Te.tE)(t.selectedDate,e)),endDate:(0,Te.h3)((0,Te.sD)(t.selectedDate,i))};case be.Uh.Week:return{startDate:(0,Te.$Y)((0,Te.pW)(t.selectedDate)),endDate:(0,Te.h3)((0,Te.R2)(t.selectedDate))};case be.Uh.Month:return{startDate:(0,Te.$Y)((0,Te.Kg)(t.selectedDate)),endDate:(0,Te.h3)((0,Te.v7)(t.selectedDate))};case be.Uh.Quarter:case be.Uh.Year:return{startDate:(0,Te.$Y)((0,Te.W8)(t.selectedDate)),endDate:(0,Te.h3)((0,Te.Q9)(t.selectedDate))}}}}return{}}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"method",key:"_getActionText",value:function _getActionText(e,t){switch(e){case be.C2.AllCards:case be.C2.TimeRecords:switch(t){case be.qK.Csv:return this._$translate.instant("BUTTONS.EXPORT_TO_CSV");case be.qK.Excel:return this._$translate.instant("BUTTONS.EXPORT_TO_EXCEL")}}}},{kind:"method",key:"_generateCsvReportAsync",value:function _generateCsvReportAsync(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\t";return new(R())(((r,n)=>{(0,ye.Pz)(e,{columns:t,delimiter:i,header:!0,quoted_match:i},((e,t)=>{e?n(e):r(t)}))}))}},{kind:"method",key:"_generateExcelReport",value:function _generateExcelReport(e,t){let i=ve.P6.book_new(),r=N()(M()(t).call(t));if(0===e.length){let t={};for(let e=0;e<r.length;++e)t[r[e]]="";e.push(t)}let n=ve.P6.json_to_sheet(e,{headers:r,cellDates:!0});for(let e=0;e<r.length;++e){let i=`${ve.P6.encode_col(e)}1`;n[i]&&(n[i].v=t.get(r[e]))}return ve.P6.book_append_sheet(i,n,"Report Data"),ve.cW(i,{bookType:"xlsx",type:"array",cellDates:!0})}},{kind:"method",key:"_isCardInHiddenTimelineResource",value:function _isCardInHiddenTimelineResource(e){var t,i;if(this._appCommonSrv.getSchedulerMode()!==be.ud.Timeline)return!1;if(e.cardRole===we.D.Milestone)return!1;let r=this._appCommonSrv.getTimelineResourcesType(),n=this._collectionSettings.global.settings.timelineHiddenResources[r]||[];switch(e.providerType){case be.lP.Trello:switch(r){case be.y.Members:if(x()(t=N()(e.providerCard.memberIds)).call(t,(e=>H()(n).call(n,e))))return!0;break;case be.y.Calendars:return H()(n).call(n,e.providerCard.boardId);case be.y.Lists:if(H()(n).call(n,e.providerCard.listId))return!0;break;case be.y.Labels:if(x()(i=N()(e.providerCard.labelIds)).call(i,(e=>H()(n).call(n,e))))return!0}break;case be.lP.Google:if(r===be.y.Calendars)return H()(n).call(n,e.providerCard.googleCalendarId);break;case be.lP.Outlook:if(r===be.y.Calendars)return H()(n).call(n,e.providerCard.outlookCalendarId);break;case be.lP.ICal:if(r===be.y.Calendars)return H()(n).call(n,e.providerCard.iCalCalendarId)}return!1}},{kind:"method",key:"_getCardLabels",value:function _getCardLabels(e){var t,i;return F()(t=z()(i=e.providerCard.labelIds).call(i,(e=>e!==De.$d))).call(t,(t=>{let i=this._trelloIntegrationSrv.getTrelloLabelById(e.accountId,t);return(null==i?void 0:i.name)||(null==i?void 0:i.color)||De.$d}))}},{kind:"method",key:"_getCardMembers",value:function _getCardMembers(e){var t,i;return F()(t=z()(i=N()(e.providerCard.memberIds)).call(i,(e=>e!==De.$d))).call(t,(t=>this._trelloIntegrationSrv.getTrelloMemberById(e.accountId,t).fullName))}},{kind:"method",key:"_getCardDurationHours",value:function _getCardDurationHours(e){if(e.hasDates)return e.isAllDay?(0,Te.KC)(e.start,e.end)?24:24*((0,Te.i2)(e.start,e.end)+1):(0,Te.CX)(e.start,e.end)/60}},{kind:"method",key:"_getCardCustomFields",value:function _getCardCustomFields(e,t){var i,r;let n=this._calendarCardsSrv.getCalendarCardCustomFieldValues(e)||{};return j()(i=z()(r=t.customFields).call(r,(e=>e.id!==t.cardDataCustomFieldId))).call(i,((e,t)=>{var i,r;let a,s=n[t.id];if(void 0!==s)switch(t.type){case we.vK.Checkbox:a=s.toString();break;case we.vK.Date:a=(0,Te.jf)(s);break;case we.vK.Number:a=kendo.toString(s,"n");break;case we.vK.List:a=null===(i=K()(r=t.options).call(r,(e=>e.id===s)))||void 0===i?void 0:i.name;break;case we.vK.Text:a=s}return e.set(`${Pe}${t.name}`,a),e}),new(E()))}},{kind:"method",key:"_getGitHubCardCustomFields",value:function _getGitHubCardCustomFields(e,t){var i,r;const n=new(I())(q()(Ee.p9));return j()(i=z()(r=t.customFields).call(r,(e=>n.has(e.type)))).call(i,((t,i)=>{var r,n;let a,s=e.providerCard.customFields[i.id];if(void 0!==s)switch(i.type){case Ee.p9.Date:a=(0,Te.tC)(s);break;case Ee.p9.Number:a=kendo.toString(s,"n");break;case Ee.p9.List:a=null===(r=K()(n=i.options).call(n,(e=>e.id===s)))||void 0===r?void 0:r.name;break;case Ee.p9.Text:a=s}return t.set(`${Pe}${i.name}`,a),t}),new(E()))}},{kind:"method",key:"_getCardRecurrences",value:function _getCardRecurrences(e,t,i){var r,n;let a=(0,Te.GM)(e.start,e.end),s=(0,Te._q)(new Date(t.getTime()-a)),o=(0,Te._q)(new Date(i.getTime()+a)),l=(0,Te._q)(e.start),d=new ke.Ci(_objectSpread(_objectSpread({},ke.Ci.parseString(e.recurrenceRule)),{},{dtstart:l})),c=new ke.pF;c.rrule(d);for(let t of e.exceptionDates)c.exdate((0,Te._q)(t));return z()(r=F()(n=c.between(s,o,!0)).call(n,(t=>{let i=(0,Te.i2)(l,t);return{start:(0,Te.E4)(e.start,i),end:(0,Te.E4)(e.end,i)}}))).call(r,(e=>(0,Te.ok)(t,i,e.start,e.end)))}},{kind:"method",key:"_saveAs",value:function _saveAs(e,t,i){if(this._platformSrv.isInsideElectron())switch(e){case be.qK.Csv:(0,Te.QJ)("text/csv",`${String.fromCharCode(65279)}${t}`,i);break;case be.qK.Excel:(0,Te.QJ)("application/octet-stream",new Blob([t],{type:"application/octet-stream"}),i)}else{let r;switch(e){case be.qK.Csv:r=new Blob([String.fromCharCode(65279),t],{type:"text/csv;charset=utf-8"});break;case be.qK.Excel:r=new Blob([t],{type:"application/octet-stream"})}(0,fe.saveAs)(r,i)}}},{kind:"method",key:"_isTimeRecordsReportParametersValid",value:function _isTimeRecordsReportParametersValid(e){return!!e&&((0,Te.qb)(e.startDate)&&(0,Te.qb)(e.endDate))}},{kind:"method",key:"_buildTimeRecordsReportAsync",value:async function _buildTimeRecordsReportAsync(e,t){const{startDate:i,endDate:r}=t;try{var n,a;let t=await this._calendarCardsSrv.getCalendarCardsAsync();if(this.isCancelled)return;let s,o,l=j()(n=X()(a=z()(t).call(t,(e=>e.cardType===we.eT.TrelloTimeRecord&&(!!(0,Te.ok)(i,r,e.start,e.end)&&this._calendarCardsSrv.isCalendarCardVisible(e,{isForceOnlyMeShown:this._collectionSettings.global.settings.timeTrackingOnlyMe,isForceArchivedShown:!0}))))).call(a,((e,t)=>e.start-t.start))).call(n,((e,t)=>(e.push(...this._timeRecordToTimeRecordsReportRows(t)),e)),[]),d=new(E())([["board","Board"],["list","List"],["card","Card"],["comment","Note"],["member","Member"],["labels","Labels"],["date","Date"],["startTime","StartTime"],["endTime","EndTime"],["durationHours","DurationHours"],["description","Description"]]);switch(e){case be.qK.Csv:s=await this._generateCsvReportAsync(l,J()(d)),o="csv";break;case be.qK.Excel:te()(l).call(l,(e=>{e.date=(0,Te.oy)(e.date),e.durationHours=kendo.parseFloat(e.durationHours)})),s=this._generateExcelReport(l,d),o="xlsx"}let c=`Planyway-time-report-${(0,Te.tC)(i)}-${(0,Te.tC)(r)}.${o}`;this._saveAs(e,s,c)}catch(e){this._$log.error("Planyway time records report error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway time records report error",e,{class:this.constructor.name,method:this._buildTimeRecordsReportAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.REPORT_ERROR"),be.k$.Error)}}},{kind:"method",key:"_timeRecordToTimeRecordsReportRows",value:function _timeRecordToTimeRecordsReportRows(e){var t,i,r;let n=this._calendarCardsSrv.getCalendarCardById(e.accountId,we.eT.TrelloCard,e.providerCard.parentId),a={board:this._trelloIntegrationSrv.getTrelloBoardById(n.accountId,n.providerCard.boardId).name,list:null!==(t=null===(i=this._trelloIntegrationSrv.getTrelloListById(n.accountId,n.providerCard.listId))||void 0===i?void 0:i.name)&&void 0!==t?t:this._$translate.instant("MISC.UNKNOWN_LIST"),card:n.title,comment:e.title,member:null===(r=this._trelloIntegrationSrv.getTrelloMemberById(e.accountId,N()(e.providerCard.memberIds)[0]))||void 0===r?void 0:r.fullName,description:n.description,labels:this._getCardLabels(n).join()},getReportRow=(e,t,i,r)=>({board:a.board,list:a.list,card:a.card,comment:a.comment,member:a.member,labels:a.labels,date:(0,Te.tC)(e),startTime:i?void 0:(0,Te.U9)(e),endTime:i?void 0:(0,Te.U9)(t),durationHours:kendo.toString(r/60,"n2"),description:a.description});if((0,Te.KC)(e.start,e.end)||(0,Te.rs)(e.end,(0,Te.$Y)(e.end)))return[getReportRow(e.start,e.end,e.isAllDay,e.providerCard.durationMinutes)];{let t=(0,Te.$Y)(e.end);return[getReportRow(e.start,t,e.isAllDay,(0,Te.CX)(e.start,t)),getReportRow(t,e.end,e.isAllDay,(0,Te.CX)(t,e.end))]}}},{kind:"method",key:"_isAllCardsReportParametersValid",value:function _isAllCardsReportParametersValid(e){return!!e&&((0,Te.qb)(e.startDate)&&(0,Te.qb)(e.endDate))}},{kind:"method",key:"_buildAllCardsReportAsync",value:async function _buildAllCardsReportAsync(e,t){const{startDate:i,endDate:r}=t;try{var n,a,s;let t=await this._calendarCardsSrv.getCalendarCardsAsync();if(this.isCancelled)return;let o=F()(n=X()(a=j()(s=z()(t).call(t,(e=>e.cardType!==we.eT.TrelloCustomField&&(!(!(0,Te.ok)(i,r,e.start,e.end)&&!e.recurrenceRule)&&(!this._isCardInHiddenTimelineResource(e)&&this._calendarCardsSrv.isCalendarCardVisible(e)))))).call(s,((e,t)=>(e.push(...this._cardToAllCardsTrelloReportRows(t,i,r)),e)),[])).call(a,((e,t)=>e.date-t.date))).call(n,(e=>{let{date:t}=e;return(0,k.Z)(e,Ae)})),l=[this._$translate.instant("DIALOGS.CARD_ROLE_CARD"),this._$translate.instant("DIALOGS.CARD_ROLE_MILESTONE"),this._$translate.instant("DIALOGS.CARD_ROLE_CHECK_ITEM"),this._$translate.instant("DIALOGS.CARD_ROLE_TIME_RECORD"),this._$translate.instant("DIALOGS.CARD_ROLE_ISSUE")],d={};for(let e of o)if(H()(l).call(l,e.type))for(let t of re()(e))ae()(t).call(t,Pe)&&!(t in d)&&(d[t]=t.replace(Pe,""));let c,h,u=new(E())([...Oe,...oe()(d)]);switch(e){case be.qK.Csv:c=await this._generateCsvReportAsync(o,J()(u)),h="csv";break;case be.qK.Excel:te()(o).call(o,(e=>{for(let t of re()(e))(0,Te.of)(e[t])&&(e[t]=(0,Te.oy)(e[t]));for(let t in Me)e.hasOwnProperty(t)&&(e[t]=kendo.parseFloat(e[t]))})),c=this._generateExcelReport(o,u),h="xlsx"}let p=`Planyway-report-${(0,Te.tC)(i)}-${(0,Te.tC)(r)}.${h}`;this._saveAs(e,c,p)}catch(e){this._$log.error("Planyway all cards report error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway all cards report error",e,{class:this.constructor.name,method:this._buildAllCardsReportAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.REPORT_ERROR"),be.k$.Error)}}},{kind:"method",key:"_cardToAllCardsTrelloReportRows",value:function _cardToAllCardsTrelloReportRows(e,t,i){var r,n,a;let s,o,l,d,c,h,u,p,m,g,y,v,f,_=!1;switch(e.cardType){case we.eT.GoogleEvent:s=this._$translate.instant("DIALOGS.CARD_ROLE_GOOGLE_EVENT"),d=this._googleIntegrationSrv.getGoogleCalendarById(e.accountId,e.providerCard.googleCalendarId),m=this._getCardDurationHours(e),e.recurrenceRule&&(f=this._getCardRecurrences(e,t,i));break;case we.eT.OutlookEvent:s=this._$translate.instant("DIALOGS.CARD_ROLE_OUTLOOK_EVENT"),d=this._outlookIntegrationSrv.getOutlookCalendarById(e.accountId,e.providerCard.outlookCalendarId),m=this._getCardDurationHours(e),e.recurrenceRule&&(f=this._getCardRecurrences(e,t,i));break;case we.eT.ICalEvent:s=this._$translate.instant("DIALOGS.CARD_ROLE_ICAL_EVENT"),d=this._iCalIntegrationSrv.getICalCalendarById(e.accountId,e.providerCard.iCalCalendarId),m=this._getCardDurationHours(e),e.recurrenceRule&&(f=this._getCardRecurrences(e,t,i));break;case we.eT.TrelloCard:switch(e.cardRole){case we.D.Card:s=this._$translate.instant("DIALOGS.CARD_ROLE_CARD");break;case we.D.Milestone:s=this._$translate.instant("DIALOGS.CARD_ROLE_MILESTONE"),_=!0}d=this._trelloIntegrationSrv.getTrelloBoardById(e.accountId,e.providerCard.boardId),c=null!==(r=this._trelloIntegrationSrv.getTrelloListById(e.accountId,e.providerCard.listId))&&void 0!==r?r:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(e).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:e.providerCard.isCompleted?Le:Ne,m=this._getCardDurationHours(e),g=e.providerCard.estimationHours,y=e.providerCard.totalTimeRecordDurationHours,v=this._getCardCustomFields(e,d),e.recurrenceRule&&(f=this._getCardRecurrences(e,t,i));break;case we.eT.TrelloCheckItem:s=this._$translate.instant("DIALOGS.CARD_ROLE_CHECK_ITEM"),o=this._calendarCardsSrv.getCalendarCardById(e.accountId,we.eT.TrelloCard,e.providerCard.parentId),l=o.title,d=this._trelloIntegrationSrv.getTrelloBoardById(o.accountId,o.providerCard.boardId),c=null!==(n=this._trelloIntegrationSrv.getTrelloListById(o.accountId,o.providerCard.listId))&&void 0!==n?n:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(o).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:e.providerCard.isCompleted?Le:Ne,m=this._getCardDurationHours(e),v=this._getCardCustomFields(e,d);break;case we.eT.TrelloTimeRecord:s=this._$translate.instant("DIALOGS.CARD_ROLE_TIME_RECORD"),o=this._calendarCardsSrv.getCalendarCardById(e.accountId,we.eT.TrelloCard,e.providerCard.parentId),l=o.title,d=this._trelloIntegrationSrv.getTrelloBoardById(o.accountId,o.providerCard.boardId),c=null!==(a=this._trelloIntegrationSrv.getTrelloListById(o.accountId,o.providerCard.listId))&&void 0!==a?a:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(o).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:void 0,m=e.providerCard.durationMinutes/60,v=this._getCardCustomFields(e,d)}v=v&&v.size?J()(v):{};let getReportRow=(t,i)=>{var r,n;return _objectSpread({date:t,type:s,board:d.name,list:null===(r=c)||void 0===r?void 0:r.name,parent:l,title:e.title,members:h,labels:u,status:p,startDate:(0,Te.tC)(t),startTime:e.isAllDay?void 0:(0,Te.U9)(t),endDate:_?void 0:(0,Te.tC)(i),endTime:e.isAllDay||_?void 0:(0,Te.U9)(i),durationHours:kendo.toString(m,"n2"),estimatedTimeHours:void 0===g?void 0:kendo.toString(g,"n2"),trackedTimeHours:y?kendo.toString(y,"n2"):void 0,description:(null===(n=o)||void 0===n?void 0:n.description)||e.description},v)};return f?F()(f).call(f,(e=>getReportRow(e.start,e.end))):[getReportRow(e.start,e.end)]}},{kind:"method",key:"_cardToAllCardsGitHubReportRows",value:function _cardToAllCardsGitHubReportRows(e,t,i){var r,n,a,s;let o,l,d,c,h,u,p;switch(e.cardType){case we.eT.GoogleEvent:o=this._$translate.instant("DIALOGS.CARD_ROLE_GOOGLE_EVENT"),l=this._googleIntegrationSrv.getGoogleCalendarById(e.accountId,e.providerCard.googleCalendarId),h=this._getCardDurationHours(e),e.recurrenceRule&&(p=this._getCardRecurrences(e,t,i));break;case we.eT.OutlookEvent:o=this._$translate.instant("DIALOGS.CARD_ROLE_OUTLOOK_EVENT"),l=this._outlookIntegrationSrv.getOutlookCalendarById(e.accountId,e.providerCard.outlookCalendarId),h=this._getCardDurationHours(e),e.recurrenceRule&&(p=this._getCardRecurrences(e,t,i));break;case we.eT.ICalEvent:o=this._$translate.instant("DIALOGS.CARD_ROLE_ICAL_EVENT"),l=this._iCalIntegrationSrv.getICalCalendarById(e.accountId,e.providerCard.iCalCalendarId),h=this._getCardDurationHours(e),e.recurrenceRule&&(p=this._getCardRecurrences(e,t,i));break;case we.eT.GitHubCard:o=this._$translate.instant("DIALOGS.CARD_ROLE_ISSUE"),l=this._githubIntegrationSrv.getGitHubProjectById(e.accountId,e.providerCard.projectId),c=F()(r=z()(n=e.providerCard.labelIds).call(n,(e=>e!==De.$d))).call(r,(t=>this._githubIntegrationSrv.getGitHubLabelById(e.accountId,t).name)).join(),d=F()(a=z()(s=N()(e.providerCard.memberIds)).call(s,(e=>e!==De.$d))).call(a,(t=>this._githubIntegrationSrv.getGitHubMemberById(e.accountId,t).fullName)).join(),h=this._getCardDurationHours(e),u=this._getGitHubCardCustomFields(e,l)}u=u&&u.size?J()(u):{};let getReportRow=(t,i)=>_objectSpread({date:t,type:o,board:l.name,title:e.title,members:d,labels:c,state:e.providerCard.isCompleted?Le:Ne,startDate:(0,Te.tC)(t),startTime:e.isAllDay?void 0:(0,Te.U9)(t),endDate:(0,Te.tC)(i),endTime:e.isAllDay?void 0:(0,Te.U9)(i),durationHours:kendo.toString(h,"n2"),description:e.description},u);return p?F()(p).call(p,(e=>getReportRow(e.start,e.end))):[getReportRow(e.start,e.end)]}},{kind:"method",key:"_buildBoardCardsReportAsync",value:async function _buildBoardCardsReportAsync(e,t){const{calendarId:i,isOnlyUnscheduledShown:r}=t;try{var n,a,s;let t=await this._calendarCardsSrv.getCalendarCardsAsync();if(this.isCancelled)return;let o=F()(n=X()(a=j()(s=z()(t).call(t,(e=>(!r||!e.hasDates)&&(e.cardType!==we.eT.TrelloCustomField&&(e.calendarId===i&&this._calendarCardsSrv.isCalendarCardVisible(e)))))).call(s,((e,t)=>(e.push(...this._cardToBoardCardsTrelloReportRows(t)),e)),[])).call(a,((e,t)=>e.date-t.date))).call(n,(e=>{let{date:t}=e;return(0,k.Z)(e,Ie)})),l=[this._$translate.instant("DIALOGS.CARD_ROLE_CARD"),this._$translate.instant("DIALOGS.CARD_ROLE_MILESTONE"),this._$translate.instant("DIALOGS.CARD_ROLE_CHECK_ITEM"),this._$translate.instant("DIALOGS.CARD_ROLE_TIME_RECORD"),this._$translate.instant("DIALOGS.CARD_ROLE_ISSUE")],d={};for(let e of o)if(H()(l).call(l,e.type))for(let t of re()(e))ae()(t).call(t,Pe)&&!(t in d)&&(d[t]=t.replace(Pe,""));let c,h,u=new(E())([...Oe,...oe()(d)]);switch(e){case be.qK.Csv:c=await this._generateCsvReportAsync(o,J()(u)),h="csv";break;case be.qK.Excel:te()(o).call(o,(e=>{for(let t of re()(e))(0,Te.of)(e[t])&&(e[t]=(0,Te.oy)(e[t]));for(let t in Me)e.hasOwnProperty(t)&&(e[t]=kendo.parseFloat(e[t]))})),c=this._generateExcelReport(o,u),h="xlsx"}let p=`Planyway-board-cards-report.${h}`;this._saveAs(e,c,p)}catch(e){this._$log.error("Planyway board cards report error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway board cards report error",e,{class:this.constructor.name,method:this._buildBoardCardsReportAsync.name}),this._notificationSrv.showNotification(this._$translate.instant("NOTIFICATIONS.REPORT_ERROR"),be.k$.Error)}}},{kind:"method",key:"_cardToBoardCardsTrelloReportRows",value:function _cardToBoardCardsTrelloReportRows(e){var t,i,r,n,a;let s,o,l,d,c,h,u,p,m,g,y,v,f=!1;switch(e.cardType){case we.eT.TrelloCard:switch(e.cardRole){case we.D.Card:s=this._$translate.instant("DIALOGS.CARD_ROLE_CARD");break;case we.D.Milestone:s=this._$translate.instant("DIALOGS.CARD_ROLE_MILESTONE"),f=!0}d=this._trelloIntegrationSrv.getTrelloBoardById(e.accountId,e.providerCard.boardId),c=null!==(t=this._trelloIntegrationSrv.getTrelloListById(e.accountId,e.providerCard.listId))&&void 0!==t?t:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(e).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:e.providerCard.isCompleted?Le:Ne,m=this._getCardDurationHours(e),g=e.providerCard.estimationHours,y=e.providerCard.totalTimeRecordDurationHours,v=this._getCardCustomFields(e,d);break;case we.eT.TrelloCheckItem:s=this._$translate.instant("DIALOGS.CARD_ROLE_CHECK_ITEM"),o=this._calendarCardsSrv.getCalendarCardById(e.accountId,we.eT.TrelloCard,e.providerCard.parentId),l=o.title,d=this._trelloIntegrationSrv.getTrelloBoardById(o.accountId,o.providerCard.boardId),c=null!==(i=this._trelloIntegrationSrv.getTrelloListById(o.accountId,o.providerCard.listId))&&void 0!==i?i:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(o).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:e.providerCard.isCompleted?Le:Ne,m=this._getCardDurationHours(e),v=this._getCardCustomFields(e,d);break;case we.eT.TrelloTimeRecord:s=this._$translate.instant("DIALOGS.CARD_ROLE_TIME_RECORD"),o=this._calendarCardsSrv.getCalendarCardById(e.accountId,we.eT.TrelloCard,e.providerCard.parentId),l=o.title,d=this._trelloIntegrationSrv.getTrelloBoardById(o.accountId,o.providerCard.boardId),c=null!==(r=this._trelloIntegrationSrv.getTrelloListById(o.accountId,o.providerCard.listId))&&void 0!==r?r:{name:this._$translate.instant("MISC.UNKNOWN_LIST")},u=this._getCardLabels(o).join(),h=this._getCardMembers(e).join(),p=e.providerCard.isArchived?Re:void 0,m=e.providerCard.durationMinutes/60,v=this._getCardCustomFields(e,d)}return v=v&&v.size?J()(v):{},[_objectSpread({date:e.start,type:s,board:d.name,list:null===(n=c)||void 0===n?void 0:n.name,parent:l,title:e.title,members:h,labels:u,status:p,startDate:(0,Te.tC)(e.start),startTime:e.isAllDay?void 0:(0,Te.U9)(e.start),endDate:f?void 0:(0,Te.tC)(e.end),endTime:e.isAllDay||f?void 0:(0,Te.U9)(e.end),durationHours:kendo.toString(m,"n2"),estimatedTimeHours:void 0===g?void 0:kendo.toString(g,"n2"),trackedTimeHours:y?kendo.toString(y,"n2"):void 0,description:(null===(a=o)||void 0===a?void 0:a.description)||e.description},v)]}},{kind:"method",key:"_cardToBoardCardsGitHubReportRows",value:function _cardToBoardCardsGitHubReportRows(e){var t,i,r,n;let a,s,o,l,d,c;if(e.cardType===we.eT.GitHubCard)a=this._$translate.instant("DIALOGS.CARD_ROLE_ISSUE"),s=this._githubIntegrationSrv.getGitHubProjectById(e.accountId,e.providerCard.projectId),l=F()(t=z()(i=e.providerCard.labelIds).call(i,(e=>e!==De.$d))).call(t,(t=>this._githubIntegrationSrv.getGitHubLabelById(e.accountId,t).name)).join(),o=F()(r=z()(n=N()(e.providerCard.memberIds)).call(n,(e=>e!==De.$d))).call(r,(t=>{var i;return null===(i=this._githubIntegrationSrv.getGitHubMemberById(e.accountId,t))||void 0===i?void 0:i.fullName})).join(),d=this._getCardDurationHours(e),c=this._getGitHubCardCustomFields(e,s);return c=c&&c.size?J()(c):{},[_objectSpread({date:e.start,type:a,project:s.name,title:e.title,members:o,labels:l,state:e.providerCard.isCompleted?Le:Ne,startDate:(0,Te.tC)(e.start),startTime:e.isAllDay?void 0:(0,Te.U9)(e.start),endDate:(0,Te.tC)(e.end),endTime:e.isAllDay?void 0:(0,Te.U9)(e.end),durationHours:kendo.toString(d,"n2"),description:e.description},c)]}},{kind:"method",key:"_buildSchedulerReportAsync",value:async function _buildSchedulerReportAsync(){const e=await this._getImagePropsAsync(ge()(".pw-js-scheduler")),t=await this._getPdfDefinitionAsync(e);(0,Te.QJ)("application/octet-stream",new Blob([t],{type:"application/octet-stream"}),`Planyway-report-${(0,Te.tC)(new Date)}.pdf`)}},{kind:"method",key:"_getImagePropsAsync",value:async function _getImagePropsAsync(e){const t=e.prev();try{e.addClass("pw-scheduler__scheduler--export");const t=e[0],i=t.scrollWidth,r=t.scrollHeight,n={filter:e=>"pw-member-avatar__image"!==e.className&&"pw-calendar-icon__image"!==e.className&&"timeline-panel timeline-bottom"!==e.className&&"timeline-panel timeline-right timeline-vertical-scroll"!==e.className&&"k-resize-handle k-resize-w"!==e.className&&"k-resize-handle k-resize-e"!==e.className&&"k-icon k-i-arrow-n"!==e.className&&"k-icon k-i-arrow-s"!==e.className&&"pw-card__edit-button mdi mdi-dots-horizontal pw-js-card-edit-button"!==e.className,backgroundColor:"white",width:i,height:r,pixelRatio:2};e.detach(),ge()("head > style").clone().prependTo(e);return{image:await(0,_e.YM)(t,n),width:i,height:r}}finally{K()(e).call(e,"> style").remove(),e.insertAfter(t),e.removeClass("pw-scheduler__scheduler--export")}}},{kind:"method",key:"_loadSvgContentAsync",value:async function _loadSvgContentAsync(e){try{return await this._platformSrv.restAsync(be.Tu.Get,e)}catch(e){this._$log.error("Planyway load svg content error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load svg content error",e,{class:this.constructor.name,method:this._loadSvgContentAsync.name})}}},{kind:"method",key:"_getPdfDefinitionAsync",value:async function _getPdfDefinitionAsync(e){const t=e.width&&e.height?{width:e.width+80,height:e.height+140}:"A4",i=await this._loadSvgContentAsync("https://files.planyway.com/common/planyway-logo-full.svg"),r=this._$translate.instant("MISC.REPORTS_COPYRIGHT");let n;this._fonts=new(I());const a=await this._getJsonContentAsync("https://files.planyway.com/common/fonts/table.json");a&&(n=this._buildMatches(a));const s=this._buildTextNode({text:(0,Te.iS)(new Date,!0),matches:n}),o={pageSize:t,defaultStyle:{font:"NotoSans.ttf"},pageMargins:[40,70],content:[e],styles:{footer:{marginTop:40,fontSize:8,color:"#666666"}},header:()=>({columns:[{fontSize:9,color:"#212121",text:s,marginTop:34,marginBottom:8,marginLeft:40},{svg:i||"",fit:[80,18],marginTop:32,marginRight:20,alignment:"right"}]}),footer:()=>({text:r,style:"footer",marginLeft:40})};return new(R())((e=>{Se().createPdf(o,void 0,this._getFontsList()).getBuffer((t=>e(t)))}))}},{kind:"method",key:"_getJsonContentAsync",value:async function _getJsonContentAsync(e){let t;try{const i=await fetch(e);t=await i.json()}catch(e){}return t}},{kind:"method",key:"_buildMatches",value:function _buildMatches(e){return F()(e).call(e,(e=>{const t={font:e.font,chars:new(I())};for(const i of e.chars)if(de()(i))for(let e=i[0];e<=i[1];e++)t.chars.add(e);else t.chars.add(i);return t}))}},{kind:"method",key:"_buildTextNode",value:function _buildTextNode(e){let{text:t,matches:i,isBold:r}=e;if(!i)return _objectSpread({text:t},r&&{bold:!0});const n=this._splitText(t,i);return{text:F()(n).call(n,(e=>{let{font:t,text:i}=e;return t?(this._fonts.add(t),_objectSpread({font:t,text:i},r&&{bold:!0})):_objectSpread({text:i},r&&{bold:!0})}))}}},{kind:"method",key:"_splitText",value:function _splitText(e,t){const i=[];let r,n={start:0,end:0},a=0;for(const l of e){var s;const e=he()(l).call(l,0)||0,d=e<65536?1:2;var o;if(null!==(s=r)&&void 0!==s&&s.chars.has(e))n.end=a+d;else if(r=K()(t).call(t,(t=>t.chars.has(e))),r||!n||n.font)n={font:null===(o=r)||void 0===o?void 0:o.font,start:a,end:a+d},i.push(n);else n.end=a+d;a+=d}return F()(i).call(i,(t=>({font:t.font,text:pe()(e).call(e,t.start,t.end)})))}},{kind:"method",key:"_getFontsList",value:function _getFontsList(){const e={};for(const t of this._fonts)e[t]={normal:`https://files.planyway.com/common/fonts/Regular-${t}`,bold:`https://files.planyway.com/common/fonts/Bold-${t}`};return e}}]}}))},97808:(e,t,i)=>{i.d(t,{g:()=>Q});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(57445),l=i.n(o),d=i(51791),c=i.n(d),h=i(90143),u=i.n(h),p=i(56626),m=i.n(p),g=i(67552),y=i.n(g),v=i(86981),f=i.n(v),_=i(52020),C=i.n(_),S=i(73324),w=i.n(S),k=i(88546),b=i.n(k),D=i(66775),T=i.n(D),E=i(2201),A=i.n(E),I=i(26171),P=i(26881),R=i(59863),L=i.n(R),N=i(99595),O=i.n(N),M=i(39290),$=i.n(M),x=i(62079),B=i.n(x),H=i(82617),U=i(53706),F=i.n(U),W=i(58218),z=i.n(W),G=i(68949),j=i(56777),V=i(8937),K=i(29704);function ownKeys(e,t){var i=B()(e);if(C()){var r=C()(e);t&&(r=w()(r).call(r,(function(t){return b()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?O()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,I.Z)(e,t,n[t])})):T()?A()(e,T()(n)):O()(r=ownKeys(Object(n))).call(r,(function(t){l()(e,t,b()(n,t))}))}return e}function getDefaultLocalSettings(){return{provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.getDefaultUserLocalProviderSettings(),e}),{})}}function getDefaultGlobalSettings(){return{account:{},actionCounters:{},defaultRemindBefore:[10],defaultRemindBeforeAllDay:[-540],dontAskConfirmDialogs:{},firstWeekDay:null,isCreateCardTipPassed:!1,isOnboardingButtonPassed:!1,isOnboardingDemoInvitePassed:!1,isOnboardingProductTourClosed:!1,isOnboardingProductTourCompleted:!1,isOnboardingProductTourMinimized:!1,isOnboardingVideoTourPreviewClosed:!1,isOnboardingWelcomeSurveyPassed:!1,isOnboardingWelcomeToAppPassed:!1,isPaymentFailedDialogShown:!1,locale:null,news:{},productSatisfactionSurvey:{},provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.getDefaultUserGlobalProviderSettings(),e}),{}),workDayEnd:(0,K.jf)(new Date(1980,1,1,18,0,0)),workDayStart:(0,K.jf)(new Date(1980,1,1,9,0,0)),collection:{},workWeekEnd:5,workWeekStart:1}}class UserSettingsStorage{constructor(e,t,i,r,n){this._$log=e,this._$window=t,this._telemetrySrv=i,this._localSettings="string"==typeof r?this._deserializeLocalSettings(r):(0,K.nx)(getDefaultLocalSettings(),r||{}),this._globalSettings="string"==typeof n?this._deserializeGlobalSettings(n):(0,K.nx)(getDefaultGlobalSettings(),n||{}),this._baseGlobalSettings=this.cloneGlobalSettings(),(0,G.ky)(this)}get local(){return this._localSettings}get global(){return this._globalSettings}updateLocalSettings(e){this._localSettings=(0,K.nx)(getDefaultLocalSettings(),e||{})}minimizeLocalSettings(){return{lastOpenDate:this.local.lastOpenDate,provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceUserLocalProviderSettings(this.local.provider[t]),e}),{})}}cloneGlobalSettings(){return this.global.provider=F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceUserGlobalProviderSettings(this.global.provider[t]),e}),{}),JSON.parse(z()(this.global))}serializeGlobalSettings(){return this.global.provider=F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceUserGlobalProviderSettings(this.global.provider[t]),e}),{}),(0,K.nN)(this.global)}rebaseGlobalSettings(){this._baseGlobalSettings=this.cloneGlobalSettings()}mergeGlobalSettings(e){let t=this._deserializeGlobalSettings(e);(0,K.PM)(this.global,this._baseGlobalSettings,t)}_deserializeLocalSettings(e){if(!e)return getDefaultLocalSettings();try{let t=(0,K.Lj)(e),i=(0,K.nx)(getDefaultLocalSettings(),t||{});return i.lastOpenDate&&(i.lastOpenDate=new Date(i.lastOpenDate)),i}catch(t){return t.localSettingsString=e,this._$log.error("Planyway deserialize user local settings error:"),this._$log.error(t),this._telemetrySrv.logError("Planyway deserialize user local settings error",t,{class:this.constructor.name,method:this._deserializeLocalSettings.name}),getDefaultLocalSettings()}}_deserializeGlobalSettings(e){if(!e)return getDefaultGlobalSettings();try{let t=(0,K.Lj)(e),i=(0,K.nx)(getDefaultGlobalSettings(),t||{});if(t){let e=(0,K.q_)((0,K.Yg)(getDefaultGlobalSettings().workDayStart),(0,K.Yg)(t.workDayStart)),r=(0,K.q_)((0,K.Yg)(getDefaultGlobalSettings().workDayEnd),(0,K.Yg)(t.workDayEnd)),n=(0,K.CX)(e,r);n>=30&&n<=1440&&(i.workDayStart=(0,K.jf)((0,K.dH)(e)),i.workDayEnd=(0,K.jf)(r)),void 0===t.isCreateCardTipPassed&&(i.isCreateCardTipPassed=!0),void 0===t.isOnboardingProductTourClosed&&(i.isOnboardingProductTourClosed=!0),void 0===t.isOnboardingProductTourClosed&&(i.isOnboardingProductTourClosed=!0),void 0===t.isOnboardingVideoTourPreviewClosed&&(i.isOnboardingVideoTourPreviewClosed=!0),void 0===t.isOnboardingWelcomeSurveyPassed&&(i.isOnboardingWelcomeSurveyPassed=!0),void 0===t.isOnboardingWelcomeToAppPassed&&(i.isOnboardingWelcomeToAppPassed=!0);for(let[e,r]of $()(t.collection))i.collection[e]=_objectSpread(_objectSpread({account:{}},r),{},{lastOpenDate:r.lastOpenDate&&new Date(r.lastOpenDate)})}return i}catch(t){return t.globalSettingsString=e,this._$log.error("Planyway deserialize user global settings error:"),this._$log.error(t),this._telemetrySrv.logError("Planyway deserialize user global settings error",t,{class:this.constructor.name,method:this._deserializeGlobalSettings.name}),getDefaultGlobalSettings()}}}function CollectionSettingsStorage_ownKeys(e,t){var i=B()(e);if(C()){var r=C()(e);t&&(r=w()(r).call(r,(function(t){return b()(e,t).enumerable}))),i.push.apply(i,r)}return i}function CollectionSettingsStorage_objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?O()(i=CollectionSettingsStorage_ownKeys(Object(n),!0)).call(i,(function(t){(0,I.Z)(e,t,n[t])})):T()?A()(e,T()(n)):O()(r=CollectionSettingsStorage_ownKeys(Object(n))).call(r,(function(t){l()(e,t,b()(n,t))}))}return e}function CollectionSettingsStorage_getDefaultLocalSettings(){return CollectionSettingsStorage_objectSpread({calendarSelectMenu:{collapsed:[]},filters:{collapsed:[]},layout:{schedulerHeight:75,schedulerWidth:60,workPanelHeight:25,workPanelWidth:40},mainSidebar:{collapsed:[],isShown:!0},provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.getDefaultCollectionLocalProviderSettings(),e}),{}),resourcePanelWidth:90},F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return CollectionSettingsStorage_objectSpread(CollectionSettingsStorage_objectSpread({},e),i.getDefaultCollectionLocalExtendedSettings())}),{}))}function CollectionSettingsStorage_getDefaultGlobalSettings(){return CollectionSettingsStorage_objectSpread({calendar:{},filters:{cardsVisibility:V.Vh.All},highlightToday:!1,isArchivedCardsShown:!1,isCheckItemCardsShown:!0,isMilestonesShown:!0,isTimeRecordCardsShown:!1,isViewTemplateSelected:!1,layout:{expandedPanels:{[V.ud.Reports]:V.sF.Scheduler},orientation:V.BF.VerticalReverse},provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.getDefaultCollectionGlobalProviderSettings(),e}),{}),schedulerMode:V.ud.Timeline,schedulerModesSettings:{},schedulerView:V.rW.Month,showCalendar:!0,showCardNumber:!1,showCheckItems:!1,showDates:!1,showEstimatedHours:!1,showList:!1,showTrackedHours:!1,showWeekNumbers:!0,showWorkDays:!1,showWorkHours:!1,timelineHiddenResources:{[V.y.Calendars]:[],[V.y.Labels]:[],[V.y.Lists]:[],[V.y.Members]:[],[V.y.GitHubAssignees]:[],[V.y.GitHubLabels]:[],[V.y.GitHubStatuses]:[]},timelineResourcesOrder:{[V.y.Calendars]:null,[V.y.Lists]:null,[V.y.Labels]:null,[V.y.Members]:null,[V.y.GitHubAssignees]:null,[V.y.GitHubLabels]:null,[V.y.GitHubStatuses]:null},timelineScale:V.F6.Default,timeTrackingOnlyMe:!0,timeTrackingView:V.$5.Calendar,timeTrackingToolbarMode:V.nv.Manual,viewTemplate:null},F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return CollectionSettingsStorage_objectSpread(CollectionSettingsStorage_objectSpread({},e),i.getDefaultCollectionGlobalExtendedSettings())}),{}))}class CollectionSettingsStorage{constructor(e,t,i,r,n){this._$log=e,this._$window=t,this._telemetrySrv=i,this._localSettings="string"==typeof r?this._deserializeLocalSettings(r):(0,K.nx)(CollectionSettingsStorage_getDefaultLocalSettings(),r||{}),this._globalSettings="string"==typeof n?this._deserializeGlobalSettings(n):(0,K.nx)(CollectionSettingsStorage_getDefaultGlobalSettings(),n||{}),this._baseGlobalSettings=this.cloneGlobalSettings(),(0,G.ky)(this)}get local(){return this._localSettings}get global(){return this._globalSettings}updateLocalSettings(e){this._localSettings=(0,K.nx)(CollectionSettingsStorage_getDefaultLocalSettings(),e||{})}minimizeLocalSettings(){return{calendarSelectMenu:this.local.calendarSelectMenu,filters:this.local.filters,lastOpenDate:this.local.lastOpenDate,lastUsedCalendarData:this.local.lastUsedCalendarData,layout:this.local.layout,mainSidebar:this.local.mainSidebar,provider:F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceCollectionLocalProviderSettings(this.local.provider[t]),e}),{}),resourcePanelWidth:this.local.resourcePanelWidth}}cloneGlobalSettings(){return this.global.provider=F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceCollectionGlobalProviderSettings(this.global.provider[t]),e}),{}),JSON.parse(z()(this.global))}serializeGlobalSettings(){return this.global.provider=F()(j.yI).call(j.yI,((e,t)=>{let i=(0,j.VH)(t);return e[t]=i.reduceCollectionGlobalProviderSettings(this.global.provider[t]),e}),{}),(0,K.nN)(this.global)}rebaseGlobalSettings(){this._baseGlobalSettings=this.cloneGlobalSettings()}mergeGlobalSettings(e){let t=this._deserializeGlobalSettings(e);(0,K.PM)(this.global,this._baseGlobalSettings,t)}_deserializeLocalSettings(e){if(!e)return CollectionSettingsStorage_getDefaultLocalSettings();try{let t=(0,K.Lj)(e);return(0,K.nx)(CollectionSettingsStorage_getDefaultLocalSettings(),t||{})}catch(t){return t.localSettingsString=e,this._$log.error("Planyway deserialize collection local settings error:"),this._$log.error(t),this._telemetrySrv.logError("Planyway deserialize collection local settings error",t,{class:this.constructor.name,method:this._deserializeLocalSettings.name}),CollectionSettingsStorage_getDefaultLocalSettings()}}_deserializeGlobalSettings(e){if(!e)return CollectionSettingsStorage_getDefaultGlobalSettings();try{let t=(0,K.Lj)(e),i=(0,K.nx)(CollectionSettingsStorage_getDefaultGlobalSettings(),t||{});return i.lastOpenDate&&(i.lastOpenDate=new Date(i.lastOpenDate)),i}catch(t){return t.globalSettingsString=e,this._$log.error("Planyway deserialize collection global settings error:"),this._$log.error(t),this._telemetrySrv.logError("Planyway deserialize collection global settings error",t,{class:this.constructor.name,method:this._deserializeGlobalSettings.name}),CollectionSettingsStorage_getDefaultGlobalSettings()}}}var Y=i(20115),q=i(95877);function SettingsService_ownKeys(e,t){var i=B()(e);if(C()){var r=C()(e);t&&(r=w()(r).call(r,(function(t){return b()(e,t).enumerable}))),i.push.apply(i,r)}return i}function SettingsService_objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?O()(i=SettingsService_ownKeys(Object(n),!0)).call(i,(function(t){(0,I.Z)(e,t,n[t])})):T()?A()(e,T()(n)):O()(r=SettingsService_ownKeys(Object(n))).call(r,(function(t){l()(e,t,b()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;O()(i=["method","field"]).call(i,(function(i){O()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;O()(i=["method","field"]).call(i,(function(i){O()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}l()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(O()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),O()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==c()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];u()(s).call(s,c()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var h=0;h<d.length;h++)this.addElementPlacement(d[h],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,m(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,P.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:y()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return l()(t,m(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Z='"00000000-0000-0000-0000-000000000000"',X={chat:!1,connect:!1,telemetry:!1,trelloAttachmentsProxy:!0,trelloBoardSettingsMigrator:!0};let Q=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=f()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,K.SG)(["$injector","$log","$window","$translate","planywayIntegrationSrv","platformSrv","telemetrySrv"])],(function(e){return{F:class SettingsService{constructor(t,i,r,n,a,s,o){e(this),this._$injector=t,this._$log=i,this._$window=r,this._$translate=n,this._planywayIntegrationSrv=a,this._platformSrv=s,this._telemetrySrv=o,this._userSettings=new UserSettingsStorage(this._$log,this._$window,this._telemetrySrv,this._getUserLocalSettings()),this._collectionSettings=new CollectionSettingsStorage(this._$log,this._$window,this._telemetrySrv,this._getCollectionLocalSettings()),(async()=>{let e=await this._platformSrv.getAppStorageDataAsync();this._localFlags=L()(e)})(),q.Xb.addStorageEventListener((e=>{switch(e.key){case"planywayUserLocalSettings":this._userSettings.updateLocalSettings(this._getUserLocalSettings());break;case"planywayCollectionLocalSettings":this._collectionSettings.updateLocalSettings(this._getCollectionLocalSettings())}}))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"settingsSrv"}},{kind:"field",key:"_collectionSettingsETag",value:()=>({})},{kind:"get",key:"_appCommonSrv",value:function _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}},{kind:"get",key:"_collectionSrv",value:function _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=this._$injector.get("collectionSrv")),this._collectionSrvLazy}},{kind:"get",key:"flags",value:function flags(){return SettingsService_objectSpread(SettingsService_objectSpread(SettingsService_objectSpread({},X),this._localFlags),this._globalFlags)}},{kind:"get",key:"user",value:function user(){return{local:{settings:this._userSettings.local,save:()=>this._saveUserLocalSettings()},global:{settings:this._userSettings.global,saveAsync:()=>this._saveUserGlobalSettingsAsync()}}}},{kind:"get",key:"collection",value:function collection(){return{local:{settings:this._collectionSettings.local,save:()=>this._saveCollectionLocalSettings()},global:{settings:this._collectionSettings.global,saveAsync:()=>this._saveCollectionGlobalSettingsAsync(),override:e=>this._overrideCollectionGlobalSettings(e)}}}},{kind:"method",key:"loadUserSettingsAsync",value:async function loadUserSettingsAsync(){this._loadSettingsPromise||(this._loadSettingsPromise=(async()=>{this._globalFlags=null;try{const{compressed:e,flags:t}=await this._getUserSettingsFromBackendAsync();this._userSettings=new UserSettingsStorage(this._$log,this._$window,this._telemetrySrv,this._getUserLocalSettings(),e),this._globalFlags=t;let i=await this._platformSrv.getAppStorageDataAsync();i.flags=t,this._platformSrv.setAppStorageDataAsync(i)}catch(e){this._$log.error("Planyway load global user settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load global user settings error",e,{class:this.constructor.name,method:this.loadUserSettingsAsync.name})}})());try{return await this._loadSettingsPromise}finally{this._loadSettingsPromise=null}}},{kind:"method",key:"createCollectionSettingsAsync",value:async function createCollectionSettingsAsync(){this._collectionSettings=new CollectionSettingsStorage(this._$log,this._$window,this._telemetrySrv),await this.collection.global.saveAsync()}},{kind:"method",key:"duplicateCurrentCollectionSettingsAsync",value:async function duplicateCurrentCollectionSettingsAsync(e){try{this._collectionSettings=new CollectionSettingsStorage(this._$log,this._$window,this._telemetrySrv,this.collection.local.settings,this.collection.global.settings),await this._saveCollectionSettingsToBackendAsync(e.id,this._collectionSettings.serializeGlobalSettings(),!1);let t=this.user.global.settings.collection[this._currentCollectionId];t||(t={account:{}}),this.user.global.settings.collection[e.id]=SettingsService_objectSpread(SettingsService_objectSpread({},t),{},{settings:this._collectionSettings.cloneGlobalSettings()}),this.user.global.saveAsync()}catch(e){this._$log.error("Planyway duplicate collection settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway duplicate collection settings error",e,{class:this.constructor.name,method:this.duplicateCurrentCollectionSettingsAsync.name})}}},{kind:"method",key:"loadCollectionSettingsAsync",value:async function loadCollectionSettingsAsync(){this._loadCollectionSettingsPromise||(this._loadCollectionSettingsPromise=(async()=>{try{let{compressed:t}=await this._getCollectionSettingsFromBackendAsync(this._currentCollectionId);this._collectionSettings=new CollectionSettingsStorage(this._$log,this._$window,this._telemetrySrv,this._getCollectionLocalSettings(),t);let i=this.user.global.settings.collection[this._currentCollectionId];var e;if(!i)if(i={account:{}},O()(e=$()(this._collectionSettings.global.calendar)).call(e,(e=>{let[t]=e,r=this._collectionSrv.getAccountIdByConnectedCalendarId(t);r&&(i.account[r]||=[]).push(t)})),B()(this._collectionSettings.global.calendar).length>0&&0===B()(i.account).length){let e=this._planywayIntegrationSrv.getPrimaryAccount();i.account[e.accountId]=[]}this.user.global.settings.collection[this._currentCollectionId]=SettingsService_objectSpread(SettingsService_objectSpread({},i),{},{settings:this._collectionSettings.cloneGlobalSettings()}),this.user.global.saveAsync()}catch(e){this._$log.error("Planyway load global collection settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway load global collection settings error",e,{class:this.constructor.name,method:this.loadCollectionSettingsAsync.name})}})());try{return await this._loadCollectionSettingsPromise}finally{this._loadCollectionSettingsPromise=null}}},{kind:"get",key:"_userId",value:function _userId(){return this._planywayIntegrationSrv.userId}},{kind:"get",key:"_currentCollectionId",value:function _currentCollectionId(){return this._collectionSrv.currentCollectionId}},{kind:"method",key:"_getUserLocalSettings",value:function _getUserLocalSettings(){try{if(!q.Xb.planywayUserLocalSettings)return;return q.Xb.planywayUserLocalSettings}catch(e){this._$log.error("Planyway user local settings cache getting error:"),this._$log.error(e)}}},{kind:"method",key:"_saveUserLocalSettings",value:function _saveUserLocalSettings(){try{let e=this._userSettings.minimizeLocalSettings();q.Xb.planywayUserLocalSettings=(0,K.nN)(e)}catch(e){this._$log.error("Planyway user local settings caching error:"),this._$log.error(e)}}},{kind:"method",key:"_saveUserGlobalSettingsAsync",value:async function _saveUserGlobalSettingsAsync(){this._processSaveUserGlobalPromise?this._needProcessSaveUserGlobal=!0:this._processSaveUserGlobalPromise=this._processSaveUserGlobalAsync();try{return await this._processSaveUserGlobalPromise}finally{this._processSaveUserGlobalPromise=null}}},{kind:"method",key:"_processSaveUserGlobalAsync",value:async function _processSaveUserGlobalAsync(){this._needProcessSaveUserGlobal=!1;try{let e=this._userSettings.serializeGlobalSettings();await this._saveUserSettingsToBackendAsync(e),this._userSettings.rebaseGlobalSettings()}catch(e){if(e.code===H.T.UpdateSettingsConflict)try{let{compressed:e,flags:t}=await this._getUserSettingsFromBackendAsync();this._userSettings.mergeGlobalSettings(e),this._needProcessSaveUserGlobal=!0,this._globalFlags=t;let i=await this._platformSrv.getAppStorageDataAsync();i.flags=t,this._platformSrv.setAppStorageDataAsync(i)}catch(e){this._$log.error("Planyway actualize user global settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway actualize user global settings error",e,{class:this.constructor.name,method:this._processSaveUserGlobalAsync.name})}else this._$log.error("Planyway save user global settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway save user global settings error",e,{class:this.constructor.name,method:this._processSaveUserGlobalAsync.name})}if(this._needProcessSaveUserGlobal)return this._processSaveUserGlobalAsync()}},{kind:"method",key:"_getCollectionLocalSettings",value:function _getCollectionLocalSettings(){try{if(!q.Xb.planywayCollectionLocalSettings)return;return(0,K.Lj)(q.Xb.planywayCollectionLocalSettings)[this._currentCollectionId]}catch(e){this._$log.error("Planyway collection local settings getting error:"),this._$log.error(e)}}},{kind:"method",key:"_saveCollectionLocalSettings",value:function _saveCollectionLocalSettings(){try{let e=q.Xb.planywayCollectionLocalSettings?(0,K.Lj)(q.Xb.planywayCollectionLocalSettings):{};e[this._currentCollectionId]=this._collectionSettings.minimizeLocalSettings(),q.Xb.planywayCollectionLocalSettings=(0,K.nN)(e)}catch(e){this._$log.error("Planyway collection local settings setting error:"),this._$log.error(e)}}},{kind:"method",key:"_saveCollectionGlobalSettingsAsync",value:async function _saveCollectionGlobalSettingsAsync(){this._processSaveCollectionGlobalPromise?this._needProcessSaveCollectionGlobal=!0:this._processSaveCollectionGlobalPromise=this._processSaveCollectionGlobalAsync();try{return await this._processSaveCollectionGlobalPromise}finally{this._processSaveCollectionGlobalPromise=null}}},{kind:"method",key:"_processSaveCollectionGlobalAsync",value:async function _processSaveCollectionGlobalAsync(){this._needProcessSaveCollectionGlobal=!1;try{if(this._collectionSrv.isCurrentCollectionAdmin){let e=this._collectionSettings.serializeGlobalSettings();await this._saveCollectionSettingsToBackendAsync(this._currentCollectionId,e),this._collectionSettings.rebaseGlobalSettings()}this.user.global.settings.collection[this._currentCollectionId]||(this.user.global.settings.collection[this._currentCollectionId]={account:{}}),this.user.global.settings.collection[this._currentCollectionId].settings=this._collectionSettings.cloneGlobalSettings(),this.user.global.saveAsync()}catch(e){if(e.code===H.T.UpdateSettingsConflict)try{const{compressed:e}=await this._getCollectionSettingsFromBackendAsync(this._currentCollectionId);this._collectionSettings.mergeGlobalSettings(e),this._needProcessSaveCollectionGlobal=!0}catch(e){this._$log.error("Planyway actualize collection global settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway actualize collection global settings error",e,{class:this.constructor.name,method:this._processSaveCollectionGlobalAsync.name})}else this._$log.error("Planyway save collection global settings error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway save collection global settings error",e,{class:this.constructor.name,method:this._processSaveCollectionGlobalAsync.name})}if(this._needProcessSaveCollectionGlobal)return this._processSaveCollectionGlobalAsync()}},{kind:"method",key:"_overrideCollectionGlobalSettings",value:function _overrideCollectionGlobalSettings(e){e&&(this._collectionSettings=new CollectionSettingsStorage(this._$log,this._$window,this._telemetrySrv,this._getCollectionLocalSettings(),e))}},{kind:"method",key:"_getUserSettingsFromBackendAsync",value:async function _getUserSettingsFromBackendAsync(){let e=await this._restAsync(V.Tu.Post,`${Y.yx}/planyway/${this._userId}/userSettings`,"Get user settings",{body:{action:"get"}});if((0,K.Zo)(Y.U0),!e.success){let t=new Error(e.message);throw t.code=e.code,t.details=e.details,t}return this._userSettingsETag=e.data.etag,{compressed:e.data.compressed,raw:e.data.raw,flags:L()(e.data)}}},{kind:"method",key:"_saveUserSettingsToBackendAsync",value:async function _saveUserSettingsToBackendAsync(e){let t=await this._restAsync(V.Tu.Post,`${Y.yx}/planyway/${this._userId}/userSettings`,"Set user settings",{body:{action:"set",data:{compressed:e,etag:this._userSettingsETag||Z}}});if((0,K.Zo)(Y.U0),!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}this._userSettingsETag=t.data.etag}},{kind:"method",key:"_getCollectionSettingsFromBackendAsync",value:async function _getCollectionSettingsFromBackendAsync(e){let t=await this._restAsync(V.Tu.Post,`${Y.yx}/planyway/${this._userId}/collectionSettings`,"Get collection settings",{body:{action:"get",data:{collectionId:e}}});if(!t.success){let e=new Error(t.message);throw e.code=t.code,e.details=t.details,e}return this._collectionSettingsETag[e]=t.data.etag,{compressed:t.data.compressed,raw:t.data.raw}}},{kind:"method",key:"_saveCollectionSettingsToBackendAsync",value:async function _saveCollectionSettingsToBackendAsync(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=await this._restAsync(V.Tu.Post,`${Y.yx}/planyway/${this._userId}/collectionSettings`,"Set collection settings",{body:{action:"set",data:{collectionId:e,compressed:t,etag:i?this._collectionSettingsETag[e]||Z:void 0}}});if(!r.success){let e=new Error(r.message);throw e.code=r.code,e.details=r.details,e}this._collectionSettingsETag[e]=r.data.etag}},{kind:"method",key:"_restAsync",value:async function _restAsync(e,t,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=this._telemetrySrv.logRequest(i,e,t,SettingsService_objectSpread(SettingsService_objectSpread({},n.query),n.body),n.telemetrySkipOnSuccess),s=200;try{return await this._platformSrv.restAsync(e,t,SettingsService_objectSpread(SettingsService_objectSpread({},n),{},{usePlanywayAuth:!0}))}catch(e){throw s=e.status,r=e.response,e}finally{this._telemetrySrv.logRequestEnd(a,s,r)}}}]}}))},97175:(e,t,i)=>{i.d(t,{y:()=>Ht});var r=i(40024),n=i.n(r),a=i(99595),s=i.n(a),o=i(57445),l=i.n(o),d=i(51791),c=i.n(d),h=i(90143),u=i.n(h),p=i(56626),m=i.n(p),g=i(86981),y=i.n(g),v=i(52020),f=i.n(v),_=i(88546),C=i.n(_),S=i(66775),w=i.n(S),k=i(2201),b=i.n(k),D=i(26171),T=i(26881),E=i(35820),A=i.n(E),I=i(54847),P=i.n(I),R=i(67552),L=i.n(R),N=i(40703),O=i.n(N),M=i(73324),$=i.n(M),x=i(27525),B=i.n(x),H=i(10349),U=i.n(H),F=i(87994),W=i.n(F),z=i(23513),G=i.n(z),j=i(91829),V=i.n(j),K=i(57647),Y=i.n(K),q=i(88106),Z=i.n(q),X=i(58218),Q=i.n(X),J=i(59863),ee=i.n(J),te=i(62079),ie=i.n(te),re=i(45181),ne=i.n(re),ae=i(88946),se=i.n(ae),oe=i(39290),le=i.n(oe),de=i(53706),ce=i.n(de),he=i(55641),ue=i.n(he),pe=i(81290),me=i.n(pe),ge=i(77738),ye=i.n(ge),ve=i(42689),fe=i(99560),_e=i.n(fe),Ce=i(51206),Se=i.n(Ce),we=i(83423),ke=i.n(we),be=i(82617),De=i(14587),Te=i(8937),Ee=i(20115),Ae=i(29704),Ie=i(56777),Pe=i(89095),Re=i(95877);i(43611),i(21695),i(3884),i(32513),i(43603);function ownKeys(e,t){var i=ie()(e);if(f()){var r=f()(e);t&&(r=$()(r).call(r,(function(t){return C()(e,t).enumerable}))),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?s()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,D.Z)(e,t,n[t])})):w()?b()(e,w()(n)):s()(r=ownKeys(Object(n))).call(r,(function(t){l()(e,t,C()(n,t))}))}return e}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;s()(i=["method","field"]).call(i,(function(i){s()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}l()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(s()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),s()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==c()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];u()(s).call(s,c()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var h=0;h<d.length;h++)this.addElementPlacement(d[h],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return l()(t,m(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return se()(t=(0,T.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:L()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:se()(e).call(e,this.fromElementDescriptor,this)};return l()(t,m(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const Le=1799995,Ne="planywaySession",Oe=`https://cdn.mouseflow.com/projects/${Ee.FX}.js`,Me="planywayIsMouseflowEnabled_2022_11_08",$e={},xe={[Te.Un.AllowAccessBanner]:"Allow Access Banner",[Te.Un.BrowserButton]:"Browser Button",[Te.Un.InviteEmail]:"Collection Invite Email",[Te.Un.RequestEmail]:"Collection Request Email",[Te.Un.ShareCard]:"Share Card Link",[Te.Un.ShareCollection]:"Share Collection Link",[Te.Un.PlanOnTimeline]:"Plan On Timeline Button",[Te.Un.ViewOnTimeline]:"View On Timeline Button",[Te.Un.Reports]:"Reports Button",[Te.Un.PushNotificationMemberAssigned]:"Member Assigned Notification",[Te.Un.PushNotificationMemberMentioned]:"Member Mentioned Notification",[Te.Un.PushNotificationRemindStart]:"Start Date Reminder",[Te.Un.OverdueEmail]:"Overdue Email",[Te.Un.NewsletterEmail]:"Newsletter Email",[Te.Un.OnboardingEmail]:"Onboarding Email"},Be={[Te.ZV.AdvancedChecklists]:"Advanced Checklists",[Te.ZV.BoardView]:"Kanban",[Te.ZV.Dependencies]:"Dependencies",[Te.ZV.ExportToFile]:"Export To File",[Te.ZV.GoogleConnect]:"Google Connect",[Te.ZV.GoogleSync]:"Google Sync",[Te.ZV.Milestones]:"Milestones",[Te.ZV.MultiBoard]:"MultiBoard",[Te.ZV.Notifications]:"Notification Center",[Te.ZV.OutlookConnect]:"Outlook Connect",[Te.ZV.RecurringCards]:"Recurring Cards",[Te.ZV.Reminders]:"Notifications",[Te.ZV.Reports]:"Reports",[Te.ZV.Timeline]:"Timeline",[Te.ZV.TaskEstimation]:"Task Estimation",[Te.ZV.TimelineMember]:"Member Timeline",[Te.ZV.TimeTracking]:"Time Entries"},He={[Te.k$.Info]:"Info",[Te.k$.Success]:"Success",[Te.k$.Warning]:"Warning",[Te.k$.WarningWithReload]:"Warning",[Te.k$.Error]:"Error",[Te.k$.ErrorWithReload]:"Error",[Te.k$.Progress]:"Progress"},Ue={[Te.U1.Top]:"Top",[Te.U1.Left]:"Left",[Te.U1.Right]:"Right",[Te.U1.Bottom]:"Bottom"},Fe=(Te.BF.Horizontal,Te.BF.VerticalReverse,Te.BF.Vertical,Te.BF.HorizontalReverse,{[Te.sF.Scheduler]:"Scheduler",[Te.sF.WorkPanel]:"Work Panel"}),We={[Te.ud.Calendar]:"Calendar",[Te.ud.Timeline]:"Timeline",[Te.ud.TimeTracking]:"Time Tracking",[Te.ud.Board]:"Board",[Te.ud.Reports]:"Reports"},ze={[Te.rW.OneDay]:"Day",[Te.rW.ThreeDay]:"3-day",[Te.rW.Week]:"Week",[Te.rW.Month]:"Month"},Ge={[Te.tS.None]:"No Lanes",[Te.tS.Member]:"Member Lanes",[Te.tS.Board]:"Board Lanes",[Te.tS.List]:"List Lanes",[Te.tS.Label]:"Label Lanes"},je={[Te.$5.List]:"List",[Te.$5.Calendar]:"Calendar"},Ve={[Te.nv.Manual]:"Manual",[Te.nv.Timer]:"Timer"},Ke={[Te.cT.List]:"List",[Te.cT.Kanban]:"Kanban"},Ye={[Te.e_.None]:"No Lanes",[Te.e_.Member]:"Member Lanes",[Te.e_.Label]:"Label Lanes",[Te.e_.List]:"List Lanes"},qe={[Pe.Hm.TrackedTime]:"Tracked Time",[Pe.Hm.TrackedVsEstimated]:"Tracked Vs Estimated"},Ze={[Pe.I4.Member]:"Member",[Pe.I4.Board]:"Board",[Pe.I4.List]:"List",[Pe.I4.Task]:"Task",[Pe.I4.None]:"None"},Xe={[Te.Lo.Today]:"Today",[Te.Lo.DateSelect]:"Select Date",[Te.Lo.PreviousHour]:"Previous Hour",[Te.Lo.NextHour]:"Next Hour",[Te.Lo.PreviousDay]:"Previous Day",[Te.Lo.NextDay]:"Next Day",[Te.Lo.PreviousWeek]:"Previous Week",[Te.Lo.NextWeek]:"Next Week",[Te.Lo.PreviousMonth]:"Previous Month",[Te.Lo.NextMonth]:"Next Month",[Te.Lo.PreviousQuarter]:"Previous Quarter",[Te.Lo.NextQuarter]:"Next Quarter",[Te.Lo.PreviousYear]:"Previous Year",[Te.Lo.NextYear]:"Next Year",[Te.Lo.Wheel]:"Mouse Wheel",[Te.Lo.Scrollbar]:"Scrollbar",[Te.Lo.Drag]:"Dragging"},Qe={[Te.Uh.Hour]:"Hour",[Te.Uh.Day]:"Day",[Te.Uh.Week]:"Week",[Te.Uh.Month]:"Month",[Te.Uh.Quarter]:"Quarter",[Te.Uh.Year]:"Year"},Je={selectPredefined:"Scale Menu",zoomByButtons:"Scale Button",zoomByWheel:"Mouse Wheel"},et=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tt={[Te.uS.DateCreatedNewest]:"Date Created Newest First",[Te.uS.DateCreatedOldest]:"Date Created Oldest First",[Te.uS.CardName]:"Card Name",[Te.uS.StartDate]:"Start Date",[Te.uS.EndDate]:"End Date"},it={[Te.go.CustomField]:"Custom Field"},rt={[be.vK.Checkbox]:"Checkbox",[be.vK.Date]:"Date",[be.vK.List]:"Dropdown",[be.vK.Number]:"Number",[be.vK.Text]:"Text"},nt={[Te.lP.GitHub]:"GitHub",[Te.lP.Google]:"Google",[Te.lP.ICal]:"iCal",[Te.lP.Outlook]:"Outlook",[Te.lP.Trello]:"Trello"},at={[be.Qm.GitHub]:"GitHub",[be.Qm.Google]:"Google",[be.Qm.ICal]:"iCal",[be.Qm.Outlook]:"Outlook",[be.Qm.Trello]:"Trello"},st={[be.GV.Admin]:"Admin",[be.GV.User]:"User"},ot={[Te.IM.Admin]:"Admin",[Te.IM.Normal]:"Member",[Te.IM.Observer]:"Observer"},lt={[be.eT.TrelloCard]:"Card",[be.eT.TrelloCustomField]:"Custom Field",[be.eT.TrelloCheckItem]:"Check Item",[be.eT.TrelloTimeRecord]:"Time Entry",[be.eT.GoogleEvent]:"Event",[be.eT.OutlookEvent]:"Event",[be.eT.ICalEvent]:"Event",[be.eT.GitHubCard]:"Item"},dt={[be.D.Card]:"Card",[be.D.Milestone]:"Milestone"},ct={[Te.dr.FirstLabel]:"First Label Color",[Te.dr.Board]:"Board Color",[Te.dr.NoColor]:"No Color"},ht={[be.nV.Due]:"Due Only",[be.nV.StartAndDue]:"Start And Due"},ut={[be.PL.DueStart]:"Start",[be.PL.DueEnd]:"End",[be.PL.NotLinked]:"Not Linked"},pt={[Te.f.AllSeries]:"All Series",[Te.f.ThisAndFollowing]:"This And Following",[Te.f.OnlyOccurrence]:"Only Occurrence"},mt={[Te.xj.Transparent]:"Free",[Te.xj.Opaque]:"Busy"},gt={[Te.X3.Free]:"Free",[Te.X3.Tentative]:"Tentative",[Te.X3.Busy]:"Busy",[Te.X3.Oof]:"Out Of Office",[Te.X3.WorkingElsewhere]:"Working Elsewhere",[Te.X3.Unknown]:"Unknown"},yt={[Te.XO.Yes]:"Yes",[Te.XO.No]:"No",[Te.XO.MayBe]:"Maybe",[Te.XO.Undefined]:"Not answered"},vt={[Te.XO.Yes]:"Yes",[Te.XO.No]:"No",[Te.XO.MayBe]:"Maybe",[Te.XO.Undefined]:"Not answered"},ft={[be.k$.MemberAssigned]:"Member Assigned Notification",[be.k$.MemberMentioned]:"Member Mentioned Notification",[be.k$.RemindStart]:"Start Date Reminder"},_t={[be.MY.Desktop]:"Desktop",[be.MY.Mobile]:"Mobile",[be.MY.Web]:"In-App"},Ct={[be.k$.RemindStart]:"Start Date"},St={[Te.n_.Email]:"Email",[Te.n_.Popup]:"Notification"},wt={[Te.sf.File]:"File",[Te.sf.Link]:"Link"},kt=["No priority","Low","Medium","High"],bt={[be.XL.Top]:"Top",[be.XL.Bottom]:"Bottom"},Dt={[Te.z7.Blocks]:"Blocking",[Te.z7.IsBlockedBy]:"Waiting On"},Tt={[Te.Vh.All]:"All Cards",[Te.Vh.Completed]:"Completed Cards",[Te.Vh.Incompleted]:"Incompleted Cards"},Et={[Te.C2.AllCards]:"All Cards",[Te.C2.BoardCards]:"Board Cards",[Te.C2.Scheduler]:"Scheduler",[Te.C2.TimeRecords]:"Time Entries",[Te.C2.TrackedTime]:"Tracked Time",[Te.C2.TrackedVsEstimated]:"Tracked Vs Estimated"},At={[Te.qK.Csv]:"CSV",[Te.qK.Excel]:"Excel",[Te.qK.Pdf]:"PDF"},It="Chrome.google.com",Pt="Trello.com",Rt="Teams.microsoft.com",Lt="Share Card Link",Nt="Share Collection Link",Ot="Collection Invite Email",Mt="Direct",$t="Referral",xt="Invite",Bt="Direct";let Ht=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var s=0;s<r.length;s++)a=r[s](a);var o=t((function initialize(e){a.initializeInstanceElements(e,l.elements)}),i),l=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=y()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(se()(n=o.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(o.F,l.elements),a.runClassFinishers(o.F,l.finishers)}([(0,Ae.SG)(["$injector","$log","$interval","$timeout","$window","htmlHelperSrv","appModuleName"])],(function(e){return{F:class TelemetryService{constructor(t,i,r,n,a,s,o){e(this),this._$injector=t,this._$log=i,this._$interval=r,this._$timeout=n,this._$window=a,this._htmlHelperSrv=s,this._appModuleName=o,this._provider=(0,Ie.VH)(Te.lP.Trello);try{this._browser=Se().getParser(this._$window.navigator.userAgent)}catch{}this._initTelemetryPromise=this._$timeout((()=>this._initTelemetryAsync()),0,!1),this._initUserPromise=new(A())((e=>this._onUserInitialized=e))}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"telemetrySrv"}},{kind:"field",key:"_acquisitionDate",value:void 0},{kind:"field",key:"_baseUserProperties",value:void 0},{kind:"field",key:"_baseEventProperties",value:void 0},{kind:"field",key:"_debouncingEvents",value:()=>new(P())},{kind:"field",key:"_appInsightsOperationId",value:()=>(0,ve.Z)()},{kind:"field",key:"_amplitudeSequenceNumber",value:()=>0},{kind:"field",key:"_session",value:void 0},{kind:"field",key:"_requests",value:()=>new(P())},{kind:"field",key:"_userActivityDays",value:()=>[]},{kind:"field",key:"_googleProvider",value:()=>(0,Ie.VH)(Te.lP.Google)},{kind:"field",key:"_iCalProvider",value:()=>(0,Ie.VH)(Te.lP.ICal)},{kind:"field",key:"_outlookProvider",value:()=>(0,Ie.VH)(Te.lP.Outlook)},{kind:"get",key:"_appCommonSrv",value:function _appCommonSrv(){return this._appCommonSrvLazy||(this._appCommonSrvLazy=this._$injector.get("appCommonSrv")),this._appCommonSrvLazy}},{kind:"get",key:"_collectionSrv",value:function _collectionSrv(){return this._collectionSrvLazy||(this._collectionSrvLazy=this._$injector.get("collectionSrv")),this._collectionSrvLazy}},{kind:"get",key:"_iCalIntegrationSrv",value:function _iCalIntegrationSrv(){return this._iCalIntegrationSrvLazy||(this._iCalIntegrationSrvLazy=this._$injector.get("iCalIntegrationSrv")),this._iCalIntegrationSrvLazy}},{kind:"get",key:"_githubIntegrationSrv",value:function _githubIntegrationSrv(){return this._githubIntegrationSrvLazy||(this._githubIntegrationSrvLazy=this._$injector.get("githubIntegrationSrv")),this._githubIntegrationSrvLazy}},{kind:"get",key:"_googleIntegrationSrv",value:function _googleIntegrationSrv(){return this._googleIntegrationSrvLazy||(this._googleIntegrationSrvLazy=this._$injector.get("googleIntegrationSrv")),this._googleIntegrationSrvLazy}},{kind:"get",key:"_licenseSrv",value:function _licenseSrv(){return this._licenseSrvLazy||(this._licenseSrvLazy=this._$injector.get("licenseSrv")),this._licenseSrvLazy}},{kind:"get",key:"_outlookIntegrationSrv",value:function _outlookIntegrationSrv(){return this._outlookIntegrationSrvLazy||(this._outlookIntegrationSrvLazy=this._$injector.get("outlookIntegrationSrv")),this._outlookIntegrationSrvLazy}},{kind:"get",key:"_planywayIntegrationSrv",value:function _planywayIntegrationSrv(){return this._planywayIntegrationSrvLazy||(this._planywayIntegrationSrvLazy=this._$injector.get("planywayIntegrationSrv")),this._planywayIntegrationSrvLazy}},{kind:"get",key:"_planywayNotificationsSrv",value:function _planywayNotificationsSrv(){return this._planywayNotificationsSrvLazy||(this._planywayNotificationsSrvLazy=this._$injector.get("planywayNotificationsSrv")),this._planywayNotificationsSrvLazy}},{kind:"get",key:"_platformSrv",value:function _platformSrv(){return this._platformSrvLazy||(this._platformSrvLazy=this._$injector.get("platformSrv")),this._platformSrvLazy}},{kind:"get",key:"_settingsSrv",value:function _settingsSrv(){return this._settingsSrvLazy||(this._settingsSrvLazy=this._$injector.get("settingsSrv")),this._settingsSrvLazy}},{kind:"get",key:"_trelloIntegrationSrv",value:function _trelloIntegrationSrv(){return this._trelloIntegrationSrvLazy||(this._trelloIntegrationSrvLazy=this._$injector.get("trelloIntegrationSrv")),this._trelloIntegrationSrvLazy}},{kind:"get",key:"unauthorizedId",value:function unauthorizedId(){return this._unauthorizedId}},{kind:"method",key:"initUserAsync",value:async function initUserAsync(){try{if(this._initTelemetryPromise&&await this._initTelemetryPromise,this._isUserIninitialized)return;this._isUserIninitialized=!0;let e=this._planywayIntegrationSrv.getPrimaryAccount(),t=(0,Ie.dS)(e.accountType);this._thirdPartyUserId=t.getThirdPartyUserId(e),this._baseUserProperties=_objectSpread(_objectSpread({},this._baseUserProperties),{},{"Planyway User ID":this._planywayIntegrationSrv.userId,"Install Type":this._platformSrv.getInstallType(),"License Type":this._licenseSrv.isLicenseActive()?this._licenseSrv.getLicenseType():"FREE"}),this._baseEventProperties=_objectSpread(_objectSpread({},this._baseEventProperties),{},{"Install Type":this._platformSrv.getInstallType(),"License Type":this._licenseSrv.isLicenseActive()?this._licenseSrv.getLicenseType():"FREE"}),this._initSessionTelemetry(),this._updateUserActivity(),this._initUserPromise=null,this._onUserInitialized(),this._initMouseflowAsync()}catch(e){0}}},{kind:"method",key:"setABTestTests",value:function setABTestTests(e){(async()=>{try{this._initTelemetryPromise&&await this._initTelemetryPromise;let t={};for(let i in e){let r;r=e[i]?"Enabled":"Disabled",t[$e[i]]=r}this._baseUserProperties=_objectSpread(_objectSpread({},this._baseUserProperties),t)}catch(e){0}})()}},{kind:"method",key:"logSingleEvent",value:function logSingleEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(async()=>{try{switch(this._initTelemetryPromise&&await this._initTelemetryPromise,e){case Te.cN.CalendarEvents.Shown:this._sessionAllowed=!0;break;case Te.cN.CalendarEvents.Hidden:this._sessionAllowed=!1}let i={},r={};switch(e){case Te.cN.GeneralEvents.OpenedByLink:L()(r,{"Link Type":xe[t.linkType],"Link Subtype":t.linkSubtype});break;case Te.cN.GeneralEvents.StandaloneOpenedByLink:L()(r,{Where:be.i7[t.where]});break;case Te.cN.GeneralEvents.AuthRequested:case Te.cN.GeneralEvents.AuthRejected:case Te.cN.GeneralEvents.AuthConfirmed:L()(r,{Provider:nt[t.providerType]});break;case Te.cN.GeneralEvents.LogOutClicked:L()(r,{Where:t.where});break;case Te.cN.GeneralEvents.UpgradeOffered:case Te.cN.GeneralEvents.UpgradeOfferLearnClicked:case Te.cN.GeneralEvents.UpgradeOfferUpgradeClicked:L()(i,{"Last Offered Paid Feature":Be[t.featureName]}),L()(r,{Source:t.upgradeSource,Feature:Be[t.featureName]});break;case Te.cN.GeneralEvents.TrialStarted:this._baseUserProperties=_objectSpread(_objectSpread({},this._baseUserProperties),{},{"License Type":this._licenseSrv.isLicenseActive()?this._licenseSrv.getLicenseType():"FREE"}),this._baseEventProperties=_objectSpread(_objectSpread({},this._baseEventProperties),{},{"License Type":this._licenseSrv.isLicenseActive()?this._licenseSrv.getLicenseType():"FREE"}),L()(i,{"Trial Source":t.trialSource,"Trial Feature":Be[t.featureName]}),L()(r,{"Trial Source":t.trialSource,"Trial Feature":Be[t.featureName]});break;case Te.cN.GeneralEvents.NewsClicked:case Te.cN.GeneralEvents.NewsShown:case Te.cN.GeneralEvents.NewsHidden:case Te.cN.GeneralEvents.NewsBlogClicked:case Te.cN.GeneralEvents.NewsHelpClicked:L()(r,{"News Release Date":t.newsDate});break;case Te.cN.GeneralEvents.NewsLearnMoreClicked:L()(r,{"News Release Date":t.newsDate,"News Link":t.newsLink});break;case Te.cN.GeneralEvents.TimeZoneChanged:L()(r,{"Time Zone":(0,Ae.iT)(),"Previous Time Zone":t.previousTimeZone});break;case Te.cN.GeneralEvents.SystemMessageShown:L()(r,{Message:t.message,Type:He[t.type]});break;case Te.cN.GeneralEvents.AccountUserAdded:L()(r,{"Added User Count":t.newAddedUserCount});break;case Te.cN.CalendarEvents.Shown:case Te.cN.CalendarEvents.Hidden:L()(r,{"Is By":t.isBy});break;case Te.cN.OnboardingEvents.AllowAccessBannerClicked:L()(r,{Where:"Trello"});break;case Te.cN.OnboardingEvents.SurveyPassed:L()(r,{Industry:t.industry,"Industry Other":t.industryOther,Role:t.role,Purpose:t.purpose,"Purpose Other":t.purposeOther}),L()(i,{Industry:t.industry,"Industry Other":t.industryOther,Role:t.role,Purpose:t.purpose,"Purpose Other":t.purposeOther}),"Marketing and advertising"===t.industry&&this._initMouseflowAsync(!0);break;case Te.cN.OnboardingEvents.OnboardingVideoOpened:case Te.cN.OnboardingEvents.OnboardingVideoClosed:L()(r,{By:t.by});break;case Te.cN.FeedbackEvents.FeedbackOpened:L()(r,{Where:t.where});break;case Te.cN.NotificationEvents.Enabled:L()(r,{Where:t.where}),L()(i,{"Notifications Desktop":"Enabled"});break;case Te.cN.NotificationEvents.Initialized:const{accountId:e}=t;let n=this._planywayNotificationsSrv.getNotificationsSettings(e),a=this._planywayNotificationsSrv.getOverdueEmailSettings(e);L()(r,{"Desktop Notifications":this._planywayNotificationsSrv.isPushNotificationsEnabled(e)?"Enabled":"Disabled","Member Assigned In-App":n[be.MY.Web][be.k$.MemberAssigned]?"Enabled":"Disabled","Member Assigned Desktop":n[be.MY.Desktop][be.k$.MemberAssigned]?"Enabled":"Disabled","Member Mentioned In-App":n[be.MY.Web][be.k$.MemberMentioned]?"Enabled":"Disabled","Member Mentioned Desktop":n[be.MY.Desktop][be.k$.MemberMentioned]?"Enabled":"Disabled","Remind Start In-App":n[be.MY.Web][be.k$.RemindStart]?"Enabled":"Disabled","Remind Start Desktop":n[be.MY.Desktop][be.k$.RemindStart]?"Enabled":"Disabled","Overdue Email":a.isEnabled?"Enabled":"Disabled","Overdue Email Time":(0,Ae.U9)(a.sendDate)}),L()(i,{"Notifications Desktop":this._planywayNotificationsSrv.isPushNotificationsEnabled(e)?"Enabled":"Disabled","Notifications Email":a.isEnabled?"Enabled":"Disabled"});break;case Te.cN.NotificationEvents.SettingsChanged:L()(r,{Target:_t[t.destination],Type:ft[t.type],State:t.value?"Enabled":"Disabled"});break;case Te.cN.NotificationEvents.OverdueEmailSettingsChanged:L()(r,{State:t.isEnabled?"Enabled":"Disabled",Time:(0,Ae.U9)(t.sendDate)}),L()(i,{"Notifications Email":this._planywayNotificationsSrv.getOverdueEmailSettings(t.accountId).isEnabled?"Enabled":"Disabled"});break;case Te.cN.NotificationEvents.CenterOpened:L()(r,{By:t.by})}this._$log.debug("SINGLE EVENT:",e,i,r),this._sendAmplitudeEvent(e,i,r),this._sendAppInsightsEvent(e,r),this._totalEventsCount++}catch(e){0}})()}},{kind:"method",key:"logSessionEvent",value:function logSessionEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(async(i,r,n)=>{try{this._initTelemetryPromise&&await this._initTelemetryPromise,this._initUserPromise&&await this._initUserPromise;for(let[t,i]of O()(a=this._debouncingEvents).call(a)){var a;t!==e&&(i.resolve(),await(0,Ae.$U)())}switch(e){case Te.cN.CalendarEvents.Multiselected:case Te.cN.FiltersEvents.SearchedByCardName:if(this._debouncingEvents.has(e)){let i=this._debouncingEvents.get(e);return this._$timeout.cancel(i.timeout),i.timeout=this._$timeout((()=>i.resolve()),3e3,!1),void(i.eventData=t)}let i={timeout:this._$timeout((()=>i.resolve()),3e3,!1),eventData:t};this._debouncingEvents.set(e,i),await new(A())((e=>i.resolve=e)),t=this._debouncingEvents.get(e).eventData,this._debouncingEvents.delete(e)}switch(e){case Te.cN.CollectionEvents.CollectionAddCalendarDialogClosed:case Te.cN.CollectionEvents.CollectionAddCalendarDialogOpened:case Te.cN.CollectionEvents.CollectionAddCalendarDialogShown:case Te.cN.CollectionEvents.CollectionCalendarAdded:case Te.cN.CollectionEvents.CollectionCalendarDeselected:case Te.cN.CollectionEvents.CollectionCalendarFilterChanged:case Te.cN.CollectionEvents.CollectionCalendarRemoved:case Te.cN.CollectionEvents.CollectionCalendarSelected:case Te.cN.CollectionEvents.CollectionCalendarSelectedAll:case Te.cN.CollectionEvents.CollectionCalendarSelectedNone:case Te.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis:if(t.accountType===be.Qm.Trello){let t={[Te.cN.CollectionEvents.CollectionAddCalendarDialogClosed]:Te.cN.CollectionEvents.CollectionAddBoardDialogClosed,[Te.cN.CollectionEvents.CollectionAddCalendarDialogOpened]:Te.cN.CollectionEvents.CollectionAddBoardDialogOpened,[Te.cN.CollectionEvents.CollectionAddCalendarDialogShown]:Te.cN.CollectionEvents.CollectionAddBoardDialogShown,[Te.cN.CollectionEvents.CollectionCalendarAdded]:Te.cN.CollectionEvents.CollectionBoardAdded,[Te.cN.CollectionEvents.CollectionCalendarDeselected]:Te.cN.CollectionEvents.CollectionBoardDeselected,[Te.cN.CollectionEvents.CollectionCalendarFilterChanged]:Te.cN.CollectionEvents.CollectionBoardFilterChanged,[Te.cN.CollectionEvents.CollectionCalendarRemoved]:Te.cN.CollectionEvents.CollectionBoardRemoved,[Te.cN.CollectionEvents.CollectionCalendarSelected]:Te.cN.CollectionEvents.CollectionBoardSelected,[Te.cN.CollectionEvents.CollectionCalendarSelectedAll]:Te.cN.CollectionEvents.CollectionBoardSelectedAll,[Te.cN.CollectionEvents.CollectionCalendarSelectedNone]:Te.cN.CollectionEvents.CollectionBoardSelectedNone,[Te.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis]:Te.cN.CollectionEvents.CollectionBoardSelectedOnlyThis};t[e]&&(e=t[e])}break;case Te.cN.CalendarEvents.Opened:{this._sessionAllowed=!0;let t={[Te.ud.Calendar]:Te.cN.CalendarEvents.CalendarOpened,[Te.ud.Timeline]:Te.cN.CalendarEvents.TimelineOpened,[Te.ud.TimeTracking]:Te.cN.CalendarEvents.TimeTrackingOpened,[Te.ud.Board]:Te.cN.CalendarEvents.BoardOpened,[Te.ud.Reports]:Te.cN.CalendarEvents.ReportsOpened};t[this._appCommonSrv.getSchedulerMode()]&&(e=t[this._appCommonSrv.getSchedulerMode()]);break}case Te.cN.CardEvents.Scheduled:switch(this._sendAmplitudeIdentity({add:{"Scheduled Card Count":1}}),t.cardRole){case be.D.Card:let i={[be.eT.TrelloCheckItem]:Te.cN.CardEvents.CheckItemScheduled,[be.eT.TrelloTimeRecord]:Te.cN.CardEvents.TimeRecordScheduled,[be.eT.GoogleEvent]:Te.cN.CardEvents.EventScheduled,[be.eT.OutlookEvent]:Te.cN.CardEvents.EventScheduled};i[t.cardType]&&(e=i[t.cardType]);break;case be.D.Milestone:e=Te.cN.CardEvents.MilestoneScheduled}}this._sessionAllowed&&this._collectionSettings.global.settings.isViewTemplateSelected&&(this._session?this._session.lastActivityDate=new Date:(this._session={userId:this._thirdPartyUserId,sessionId:ye()(),sessionStartDate:new Date,lastActivityDate:new Date},this._sendSessionStartedEvent(this._session)),this._renewSession());let l,d={},c={},h=We[this._appCommonSrv.getSchedulerMode()];switch(this._appCommonSrv.getSchedulerMode()){case Te.ud.Calendar:l=ze[this._appCommonSrv.getSchedulerView()];break;case Te.ud.Timeline:l=Ge[this._appCommonSrv.getTimelineView()];break;case Te.ud.TimeTracking:l=je[this._appCommonSrv.getTimeTrackingView()];break;case Te.ud.Board:let e=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;l=Ye[e.viewSettings[e.view].mode];break;case Te.ud.Reports:let t=this._collectionSettings.global.settings.provider[this._provider.type].reports;l=qe[t.selectedMode]}switch(e){case Te.cN.GeneralEvents.AccountConnected:case Te.cN.GeneralEvents.AccountReconnected:case Te.cN.GeneralEvents.AccountDisconnected:L()(c,{"Account Type":at[t.accountType]});break;case Te.cN.GeneralEvents.UpgradeClicked:L()(c,{Where:t.where,"CTA Name":t.callToAction});break;case Te.cN.GeneralEvents.ImportICalHowToLinkClicked:L()(c,{Calendar:t.calendarName});break;case Te.cN.GeneralEvents.ReportDialogOpened:case Te.cN.GeneralEvents.ReportBuilt:let a,u,p;if(t.type===Te.C2.BoardCards){if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)a=We[Te.ud.Board];else a="Task List";let e=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;u=Ye[e.viewSettings[e.view].mode],p=Ke[e.view]}else a=h,u=l;L()(c,{Report:Et[t.type],"File Type":At[t.fileType],View:a,"View Mode":u,"Task List View Mode":p});break;case Te.cN.GeneralEvents.LogOutClicked:L()(c,{Where:t.where});break;case Te.cN.GeneralEvents.ExportUrlCopied:L()(c,{Format:t.format});break;case Te.cN.GoogleSyncEvents.SyncWithGoogleOpened:case Te.cN.GoogleSyncEvents.SyncWithGoogleEnableGoogleSyncClicked:L()(c,{Where:t.where});break;case Te.cN.GoogleSyncEvents.SyncStarted:L()(c,{"Sync Only My Cards":t.syncOnlyMemberCards,"Set Event Color By Label":t.setEventColorByLabel,"Sync Completed Cards":t.syncCompletedCards,"Sync As Free":t.syncAsFree});break;case Te.cN.CalendarEvents.ModeMenuOpened:case Te.cN.CalendarEvents.ResourcesMenuOpened:L()(c,{View:h,"View Mode":l});break;case Te.cN.CalendarEvents.CalendarOpened:L()(c,{"View Mode":l,"Expanded Layout Panel":Fe[this._appCommonSrv.getExpandedLayoutPanel()]});break;case Te.cN.CalendarEvents.BoardOpened:L()(c,{"View Mode":l,"Expanded Layout Panel":Fe[this._appCommonSrv.getExpandedLayoutPanel()],"Task List View Mode":Ke[this._collectionSettings.global.settings.provider[this._provider.type].taskLists.view],"Task List Only Unscheduled":t.taskListsOnlyUnscheduled});break;case Te.cN.CalendarEvents.TimelineOpened:{let e=this._appCommonSrv.getTimelineResources();if(L()(c,{"View Mode":l,"Expanded Layout Panel":Fe[this._appCommonSrv.getExpandedLayoutPanel()],"Show Milestones":this._collectionSettings.global.settings.isMilestonesShown?"Enabled":"Disabled",Scale:Qe[toTimelineScaleUnit(this._collectionSettings.global.settings.timelineScale)],"Milestone Lane":this._collectionSettings.global.settings.isMilestonesShown?"Enabled":"Disabled","Lane Count":$()(e).call(e,(e=>e.id!==Ee.$d&&e.isSelected)).length,"Resources Panel Size":this._collectionSettings.local.settings.resourcePanelWidth>Ee.J4?"Wide":"Compact"}),this._collectionSettings.global.settings.timelineView===Te.tS.Member)L()(c,{"Unassigned Lane":B()(e).call(e,(e=>e.id===Ee.$d&&e.isSelected))?"Enabled":"Disabled"});break}case Te.cN.CalendarEvents.TimeTrackingOpened:L()(c,{"View Mode":l,"Expanded Layout Panel":Fe[this._appCommonSrv.getExpandedLayoutPanel()],"Time Tracking Toolbar Mode":Ve[this._collectionSettings.global.settings.timeTrackingToolbarMode]});break;case Te.cN.CalendarEvents.ReportsOpened:{let e=this._collectionSettings.global.settings.provider[this._provider.type].reports;if(L()(c,{"View Mode":l,"Expanded Layout Panel":Fe[this._appCommonSrv.getExpandedLayoutPanel()]}),e.selectedMode===Pe.Hm.TrackedTime)L()(c,{"First Level Grouping":Ze[e.selectedGrouping[0]],"Second Level Grouping":Ze[e.selectedGrouping[1]]});break}case Te.cN.CalendarEvents.OrientationChanged:case Te.cN.CalendarEvents.OrientationFlipped:L()(c,{Orientation:Ue[this._appCommonSrv.getPlanywayOrientation()],By:t.by});break;case Te.cN.CalendarEvents.LayoutPanelExpanded:L()(c,{View:h,"View Mode":l,"Expanded Layout Panel":Fe[t.expandedLayoutPanel],By:t.by});break;case Te.cN.CalendarEvents.LayoutPanelCollapsed:L()(c,{"Collapsed Layout Panel":Fe[t.collapsedLayoutPanel],By:t.by});break;case Te.cN.CalendarEvents.ViewModeMenuOpened:{let e,i,r;switch(t.where){case Te.gV.SchedulerToolbar:e=h,i=l,r="Toolbar";break;case Te.gV.TaskListToolbar:if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)e=We[Te.ud.Board];else e="Task List";let t=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;i=Ye[t.viewSettings[t.view].mode],r="Toolbar"}L()(c,{View:e,"View Mode":i,Where:r});break}case Te.cN.CalendarEvents.ViewModeChanged:{let e,i,r;switch(t.where){case Te.gV.SchedulerToolbar:if(e=h,i=l,r="Toolbar",this._appCommonSrv.getSchedulerMode()===Te.ud.Timeline){let e=this._appCommonSrv.getTimelineResources();if(L()(c,{"Lane Count":$()(e).call(e,(e=>e.id!==Ee.$d&&e.isSelected)).length}),this._collectionSettings.global.settings.timelineView===Te.tS.Member)L()(c,{"Unassigned Lane":B()(e).call(e,(e=>e.id===Ee.$d&&e.isSelected))?"Enabled":"Disabled"})}break;case Te.gV.TaskListToolbar:if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)e=We[Te.ud.Board];else e="Task List";let t=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;i=Ye[t.viewSettings[t.view].mode],r="Toolbar"}L()(c,{View:e,"View Mode":i,Where:r});break}case Te.cN.CalendarEvents.CalendarNavigated:case Te.cN.CalendarEvents.TimelineNavigated:L()(c,{"Navigate Action":Xe[t.navigateAction],"View Mode":l});break;case Te.cN.CalendarEvents.TimelineResourcePanelResized:L()(c,{"Resources Panel Size":t.resourcePanelWidth>Ee.J4?"Wide":"Compact"});break;case Te.cN.CalendarEvents.TimelineScaleChanged:L()(c,{Scale:Qe[toTimelineScaleUnit(t.timelineScale)],"Scale Method":Je[t.scaleMethod]});break;case Te.cN.CalendarEvents.Multiselected:L()(c,{View:h,"View Mode":l,"Card Count":t.cardCount});break;case Te.cN.CalendarEvents.ICalColorChanged:L()(c,{"Old Color":t.oldColor,"New Color":t.newColor});break;case Te.cN.CalendarEvents.TimelineMilestoneLaneChanged:L()(c,{"Milestone Lane":t.isMilestonesShown?"Enabled":"Disabled"});break;case Te.cN.CalendarEvents.TimelineMembersChanged:case Te.cN.CalendarEvents.TimelineMembersSelectedAll:case Te.cN.CalendarEvents.TimelineMembersSelectedNone:L()(c,{"Timeline Members Count":t.timelineMembersCount});break;case Te.cN.CalendarEvents.TimelineCalendarsChanged:case Te.cN.CalendarEvents.TimelineCalendarsSelectedAll:case Te.cN.CalendarEvents.TimelineCalendarsSelectedNone:L()(c,{"Timeline Boards Count":t.timelineBoardsCount,"Timeline GitHub Projects Count":t.timelineGitHubProjectsCount,"Timeline Google Calendars Count":t.timelineGoogleCalendarsCount,"Timeline Outlook Calendars Count":t.timelineOutlookCalendarsCount,"Timeline iCals Count":t.timelineICalsCount});break;case Te.cN.CalendarEvents.TimelineListsChanged:case Te.cN.CalendarEvents.TimelineListsSelectedAll:case Te.cN.CalendarEvents.TimelineListsSelectedNone:L()(c,{"Timeline Lists Count":t.timelineListsCount});break;case Te.cN.CalendarEvents.TimelineLabelsChanged:case Te.cN.CalendarEvents.TimelineLabelsSelectedAll:case Te.cN.CalendarEvents.TimelineLabelsSelectedNone:L()(c,{"Timeline Labels Count":t.timelineLabelsCount});break;case Te.cN.CalendarEvents.TaskListsFiltersChanged:L()(c,{View:h,"Task List View Mode":Ke[this._collectionSettings.global.settings.provider[this._provider.type].taskLists.view],"Task List Only Unscheduled":t.taskListsOnlyUnscheduled});break;case Te.cN.CalendarEvents.TaskListsViewModeMenuOpened:{let e;if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)e=We[Te.ud.Board];else e="Task List";let t=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;L()(c,{View:e,"View Mode":Ye[t.viewSettings[t.view].mode],"Task List View Mode":Ke[t.view]});break}case Te.cN.CalendarEvents.TaskListsViewModeChanged:{let e;if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)e=We[Te.ud.Board];else e="Task List";let i=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;L()(c,{View:e,"View Mode":Ye[i.viewSettings[i.view].mode],"Task List View Mode":Ke[t.taskListsView]});break}case Te.cN.CalendarEvents.CreateBoardDialogOpened:case Te.cN.CalendarEvents.CreateBoardDialogClosed:case Te.cN.CalendarEvents.EditBoardDialogOpened:case Te.cN.CalendarEvents.EditBoardDialogClosed:case Te.cN.CalendarEvents.BoardRemoved:case Te.cN.CalendarEvents.CreateGitHubProjectDialogOpened:case Te.cN.CalendarEvents.CreateGitHubProjectDialogClosed:case Te.cN.CalendarEvents.EditGitHubProjectDialogOpened:case Te.cN.CalendarEvents.EditGitHubProjectDialogClosed:case Te.cN.CalendarEvents.GitHubProjectClosed:case Te.cN.CalendarEvents.GitHubProjectDeleted:L()(c,{Where:t.where});break;case Te.cN.CalendarEvents.BoardCreated:switch(t.dateSyncType){case be.nV.StartAndDue:L()(c,{"Dates Sync Type":ht[t.dateSyncType]});break;case be.nV.Due:L()(c,{"Dates Sync Type":ht[t.dateSyncType],"Due Date Linked To":ut[t.dueLinkTypeAllDay],"Due Time Linked To":ut[t.dueLinkType]})}L()(c,{Color:t.color,"Default Card Duration":t.defaultCardIsAllDay?(0,Ae.LU)(24*t.defaultCardDuration*60*60*1e3,"days"):(0,Ae.LU)(60*t.defaultCardDuration*1e3,"minutes"),"Default Card Position":bt[t.defaultCardPosition],"Default Limit Archived Cards":t.defaultLimitArchivedCards});break;case Te.cN.CalendarEvents.MembersDialogOpened:case Te.cN.CalendarEvents.MemberAdded:case Te.cN.CalendarEvents.MemberRemoved:case Te.cN.CalendarEvents.MemberLeaved:case Te.cN.CalendarEvents.MemberTypeChanged:let m;if(t.where===Te.JM.TaskLists)if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)m="Board";else m=t.where;else m=t.where;L()(c,{"Member Type":ot[t.memberType],By:t.by,Where:m});break;case Te.cN.CalendarEvents.LabelEditDialogOpened:{let e,i;switch(t.where){case Te.a6.Scheduler:e=h,i=l;break;case Te.a6.TaskLists:if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)e=We[Te.ud.Board];else e="Task List";let t=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;i=Ye[t.viewSettings[t.view].mode]}L()(c,{View:e,"View Mode":i,By:t.by});break}case Te.cN.CalendarEvents.ReportsViewModeChanged:L()(c,{"View Mode":qe[t.mode]});break;case Te.cN.CalendarEvents.ReportsGroupingChanged:L()(c,{"First Level Grouping":Ze[t.firstLevel],"Second Level Grouping":Ze[t.secondLevel]});break;case Te.cN.CalendarEvents.ReportsSelectedBoardsChanged:case Te.cN.CalendarEvents.ReportsSelectedMembersChanged:L()(c,{Count:t.count});break;case Te.cN.SettingsEvents.WorkHoursChanged:L()(c,{"Work Hours":`${(0,Ae.U9)(this._userSettings.global.settings.workDayStart)}-${(0,Ae.U9)(this._userSettings.global.settings.workDayEnd)}`});break;case Te.cN.SettingsEvents.FirstWeekDayChanged:L()(c,{"First Week Day":et[this._userSettings.global.settings.firstWeekDay]});break;case Te.cN.SettingsEvents.WorkDaysChanged:L()(c,{"Work Days":`${et[this._userSettings.global.settings.workWeekStart]}-${et[this._userSettings.global.settings.workWeekEnd]}`});break;case Te.cN.SettingsEvents.LocaleChanged:L()(c,{Locale:t.locale});break;case Te.cN.SettingsEvents.CardDatesMigrationRequested:case Te.cN.SettingsEvents.CardDatesMigrationConfirmed:case Te.cN.SettingsEvents.CardDatesMigrationRejected:L()(c,{"Old Dates Sync Type":ht[t.oldDateSyncType],"New Dates Sync Type":ht[t.newDateSyncType]});break;case Te.cN.SettingsEvents.BoardColorChanged:L()(c,{"Old Color":t.oldColor,"New Color":t.newColor});break;case Te.cN.SettingsEvents.DatesSyncTypeChanged:L()(c,{"Dates Sync Type":ht[t.dateSyncType]});break;case Te.cN.SettingsEvents.DueLinkAllDayChanged:L()(c,{"Due Date Linked To":ut[t.dueLinkTypeAllDay]});break;case Te.cN.SettingsEvents.DueLinkChanged:L()(c,{"Due Time Linked To":ut[t.dueLinkType]});break;case Te.cN.SettingsEvents.DefaultDurationChanged:L()(c,{"Default Card Duration":t.defaultCardIsAllDay?(0,Ae.LU)(24*t.defaultCardDuration*60*60*1e3,"days"):(0,Ae.LU)(60*t.defaultCardDuration*1e3,"minutes")});break;case Te.cN.SettingsEvents.DefaultCardPositionChanged:L()(c,{"Default Card Position":bt[t.defaultCardPosition]});break;case Te.cN.SettingsEvents.DefaultLimitArchivedCardsChanged:L()(c,{"Default Limit Archived Cards":t.defaultLimitArchivedCards});break;case Te.cN.SettingsEvents.ShowDatesChanged:L()(c,{State:this._collectionSettings.global.settings.showDates?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowCalendarChanged:L()(c,{State:this._collectionSettings.global.settings.showCalendar?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.CardColorByChanged:L()(c,{"Card Color By":ct[this._collectionSettings.global.settings.provider[this._provider.type].cardColorBy]});break;case Te.cN.SettingsEvents.ShowGitHubStatusChanged:case Te.cN.SettingsEvents.ShowTrelloListChanged:L()(c,{State:this._collectionSettings.global.settings.showList?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowCardNumberChanged:L()(c,{State:this._collectionSettings.global.settings.showCardNumber?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowEstimatedHoursChanged:L()(c,{State:this._collectionSettings.global.settings.showEstimatedHours?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowTrackedHoursChanged:L()(c,{State:this._collectionSettings.global.settings.showTrackedHours?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowCheckItemCountChanged:L()(c,{State:this._collectionSettings.global.settings.showCheckItems?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.CustomFieldsAsCardsChanged:L()(c,{State:this._collectionSettings.global.settings.provider[this._provider.type].customFieldsAsCards.length>0?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.HighlightTodayChanged:L()(c,{State:this._collectionSettings.global.settings.highlightToday?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowWeekNumbersChanged:L()(c,{State:this._collectionSettings.global.settings.showWeekNumbers?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowOnlyWorkDaysChanged:L()(c,{State:this._collectionSettings.global.settings.showWorkDays?"Disabled":"Enabled"});break;case Te.cN.SettingsEvents.ShowOnlyWorkHoursChanged:L()(c,{State:this._collectionSettings.global.settings.showWorkHours?"Disabled":"Enabled"});break;case Te.cN.SettingsEvents.ShowArchivedCardsChanged:L()(c,{State:this._collectionSettings.global.settings.isArchivedCardsShown?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowCheckItemCardsChanged:L()(c,{State:this._collectionSettings.global.settings.isCheckItemCardsShown?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowTimeRecordCardsChanged:L()(c,{State:this._collectionSettings.global.settings.isTimeRecordCardsShown?"Enabled":"Disabled"});break;case Te.cN.SettingsEvents.ShowMilestonesChanged:L()(c,{State:this._collectionSettings.global.settings.isMilestonesShown?"Enabled":"Disabled"});break;case Te.cN.FiltersEvents.CustomFilterAdded:case Te.cN.FiltersEvents.CustomFilterRemoved:L()(c,{"Custom Filter Type":it[t.customFilterType],"Custom Field Type":rt[t.customFieldType]});break;case Te.cN.FiltersEvents.CardsVisibilityChanged:L()(c,{State:Tt[this._collectionSettings.global.settings.filters.cardsVisibility]});break;case Te.cN.CardEvents.CreateDialogOpened:case Te.cN.CardEvents.CreateDialogClosed:case Te.cN.CardEvents.EditDialogOpened:case Te.cN.CardEvents.EditDialogClosed:case Te.cN.CardEvents.EditDialogModeChanged:case Te.cN.CardEvents.Added:case Te.cN.CardEvents.Scheduled:case Te.cN.CardEvents.CardProviderChanged:case Te.cN.CardEvents.MilestoneScheduled:case Te.cN.CardEvents.EventScheduled:case Te.cN.CardEvents.ContextMenuOpened:case Te.cN.CardEvents.MarkedCompleted:case Te.cN.CardEvents.MarkedIncompleted:case Te.cN.CardEvents.Archived:case Te.cN.CardEvents.Unarchived:case Te.cN.CardEvents.UrlCopied:case Te.cN.CardEvents.Duplicated:case Te.cN.CardEvents.Subscribed:case Te.cN.CardEvents.Unsubscribed:case Te.cN.CardEvents.Deleted:case Te.cN.CardEvents.TitleChanged:case Te.cN.CardEvents.TypeChanged:case Te.cN.CardEvents.DatesRemoved:case Te.cN.CardEvents.IsAllDaySet:case Te.cN.CardEvents.IsAllDayUnset:case Te.cN.CardEvents.StartChanged:case Te.cN.CardEvents.EndChanged:case Te.cN.CardEvents.TimeAdded:case Te.cN.CardEvents.TimeRemoved:case Te.cN.CardEvents.DurationChanged:case Te.cN.CardEvents.EstimationClicked:case Te.cN.CardEvents.EstimationAdded:case Te.cN.CardEvents.EstimationChanged:case Te.cN.CardEvents.EstimationDeleted:case Te.cN.CardEvents.Moved:case Te.cN.CardEvents.Resized:case Te.cN.CardEvents.Reordered:case Te.cN.CardEvents.LaneChanged:case Te.cN.CardEvents.RecurrenceRuleChanged:case Te.cN.CardEvents.PriorityChanged:case Te.cN.CardEvents.BoardChanged:case Te.cN.CardEvents.GitHubProjectChanged:case Te.cN.CardEvents.GoogleCalendarChanged:case Te.cN.CardEvents.OutlookCalendarChanged:case Te.cN.CardEvents.ListChanged:case Te.cN.CardEvents.RepositoryChanged:case Te.cN.CardEvents.StatusChanged:case Te.cN.CardEvents.AvailabilityChanged:case Te.cN.CardEvents.InviteSent:case Te.cN.CardEvents.InviteStatusChanged:case Te.cN.CardEvents.LocationChanged:case Te.cN.CardEvents.ParentCardChanged:case Te.cN.CardEvents.ParentCardOpened:case Te.cN.CardEvents.PositionChanged:case Te.cN.CardEvents.MemberAssigned:case Te.cN.CardEvents.MemberAssignedSelf:case Te.cN.CardEvents.MemberUnassigned:case Te.cN.CardEvents.MemberUnassignedSelf:case Te.cN.CardEvents.LabelRemoved:case Te.cN.CardEvents.LabelAdded:case Te.cN.CardEvents.DescriptionChanged:case Te.cN.CardEvents.CustomFieldChanged:case Te.cN.CardEvents.ReminderAdded:case Te.cN.CardEvents.ReminderChanged:case Te.cN.CardEvents.ReminderDeleted:case Te.cN.CardEvents.CardLinkAdded:case Te.cN.CardEvents.CardLinkTypeChanged:case Te.cN.CardEvents.CardLinkLinkedCardOpened:case Te.cN.CardEvents.CardLinkRemoved:case Te.cN.CardEvents.ChecklistAdded:case Te.cN.CardEvents.ChecklistNameChanged:case Te.cN.CardEvents.ChecklistOrderChanged:case Te.cN.CardEvents.ChecklistCollapsed:case Te.cN.CardEvents.ChecklistExpanded:case Te.cN.CardEvents.ChecklistCompletedHidden:case Te.cN.CardEvents.ChecklistCompletedShown:case Te.cN.CardEvents.ChecklistDeleted:case Te.cN.CardEvents.CheckItemAdded:case Te.cN.CardEvents.CheckItemScheduled:case Te.cN.CardEvents.CheckItemNameChanged:case Te.cN.CardEvents.CheckItemOrderChanged:case Te.cN.CardEvents.CheckItemChecklistChanged:case Te.cN.CardEvents.CheckItemMarkedCompleted:case Te.cN.CardEvents.CheckItemMarkedIncompleted:case Te.cN.CardEvents.CheckItemConverted:case Te.cN.CardEvents.CheckItemDeleted:case Te.cN.CardEvents.CheckItemDatesRemoved:case Te.cN.CardEvents.CheckItemIsAllDaySet:case Te.cN.CardEvents.CheckItemIsAllDayUnset:case Te.cN.CardEvents.CheckItemStartChanged:case Te.cN.CardEvents.CheckItemEndChanged:case Te.cN.CardEvents.CheckItemMemberAssigned:case Te.cN.CardEvents.CheckItemMemberUnassigned:case Te.cN.CardEvents.CheckItemContextMenuOpened:case Te.cN.CardEvents.TimeRecordCommentChanged:case Te.cN.CardEvents.TimeRecordDurationChanged:case Te.cN.CardEvents.TimeRecordDeleted:case Te.cN.CardEvents.TimeRecordFromChanged:case Te.cN.CardEvents.TimeRecordMemberChanged:case Te.cN.CardEvents.TimeRecordScheduled:case Te.cN.CardEvents.TimeRecordSeeMoreClicked:case Te.cN.CardEvents.TimeRecordTimeAdded:case Te.cN.CardEvents.TimeRecordTimeRemoved:case Te.cN.CardEvents.TimeRecordToChanged:case Te.cN.CardEvents.AttachmentAdded:case Te.cN.CardEvents.AttachmentClicked:case Te.cN.CardEvents.AttachmentLinkChanged:case Te.cN.CardEvents.AttachmentNameChanged:case Te.cN.CardEvents.AttachmentDeleted:case Te.cN.CardEvents.CommentAdded:case Te.cN.CardEvents.CommentEdited:case Te.cN.CardEvents.CommentDeleted:case Te.cN.CardEvents.CommentMentionAdded:case Te.cN.CardEvents.CommentReplyClicked:case Te.cN.CardEvents.CommentSourceOpened:case Te.cN.CardEvents.CardOpenClicked:case Te.cN.CardEvents.PlanOnTimelineClicked:case Te.cN.CardEvents.ViewOnTimelineClicked:{let i,r,n,a;switch(t.where){case Te.a6.Scheduler:i=h,r=l;break;case Te.a6.TaskLists:if(this._appCommonSrv.getSchedulerMode()===Te.ud.Board)i=We[Te.ud.Board];else i="Task List";let e=this._collectionSettings.global.settings.provider[this._provider.type].taskLists;r=Ye[e.viewSettings[e.view].mode],n=Ke[e.view];break;case Te.a6.Trello:i="Trello",r="Trello Popup"}switch(t.cardRole){case be.D.Card:a=lt[t.cardType];break;case be.D.Milestone:a=dt[t.cardRole]}switch(L()(c,{"All Day":t.isAllDay,"Card Type":a,"Is New Card":t.isNewCard,"Recurrence Rule":toRecurrenceRuleText(t.recurrenceRule),Priority:kt[t.priority||0],"Recurring Mode":pt[t.recurringMode],View:i,"View Mode":r,"Task List View Mode":n,By:t.by,"Is Detailed":t.isEditDialogDetailed}),t.cardType){case be.eT.TrelloCard:case be.eT.TrelloCheckItem:case be.eT.TrelloCustomField:{var s;let e=this._trelloIntegrationSrv.getTrelloBoardById(t.accountId,t.calendarId),i=t.memberIds&&$()(s=U()(t.memberIds)).call(s,(e=>e!==Ee.$d)).length;L()(c,{"Board Member Count":null==e?void 0:e.members.length,"Member Count":i,"Is Assigned To Me":t.isAssignedToMe?"Yes":"No","Is Assigned":i>0?"Yes":"No","Card Duration":getCardDuration(t)});break}case be.eT.TrelloTimeRecord:{let e=this._trelloIntegrationSrv.getTrelloBoardById(t.accountId,t.calendarId);L()(c,{"Board Member Count":null==e?void 0:e.members.length,"Member Count":1,"Is Assigned To Me":t.isAssignedToMe?"Yes":"No","Is Assigned":"Yes","Card Duration":t.isAllDay?(0,Ae.gG)(t.durationMinutes):getCardDuration(t),Mode:this._collectionSettings.global.settings.timeTrackingOnlyMe?"Only Me":"All"});break}default:L()(c,{"Card Duration":getCardDuration(t)})}switch(e){case Te.cN.CardEvents.Scheduled:case Te.cN.CardEvents.MilestoneScheduled:case Te.cN.CardEvents.EventScheduled:L()(c,{Destination:t.destination});break;case Te.cN.CardEvents.CardProviderChanged:L()(c,{Source:nt[t.providerType]});break;case Te.cN.CardEvents.AvailabilityChanged:switch(t.cardType){case be.eT.GoogleEvent:L()(c,{Availability:mt[t.transparency]});break;case be.eT.OutlookEvent:L()(c,{Availability:gt[t.showAs]})}break;case Te.cN.CardEvents.InviteSent:L()(c,{"Invitee Count":t.attendeeCount});break;case Te.cN.CardEvents.InviteStatusChanged:switch(t.cardType){case be.eT.GoogleEvent:L()(c,{Response:yt[t.status]});break;case be.eT.OutlookEvent:L()(c,{Response:vt[t.status]})}break;case Te.cN.CardEvents.EstimationAdded:case Te.cN.CardEvents.EstimationChanged:L()(c,{"Estimation Hours":t.estimationHours});break;case Te.cN.CardEvents.ReminderAdded:case Te.cN.CardEvents.ReminderChanged:case Te.cN.CardEvents.ReminderDeleted:L()(c,{"Reminder Type":Ct[t.reminderType],"Reminder Span":`${t.remindBeforeValue} ${t.remindBeforeUnit}`,"Reminder Time":t.remindTime&&(0,Ae.U9)(t.remindTime),"Reminder Delivery Type":St[t.deliveryType]});break;case Te.cN.CardEvents.CardLinkAdded:case Te.cN.CardEvents.CardLinkTypeChanged:case Te.cN.CardEvents.CardLinkLinkedCardOpened:case Te.cN.CardEvents.CardLinkRemoved:L()(c,{"Dependency Type":Dt[t.linkType]});break;case Te.cN.CardEvents.TimeRecordScheduled:case Te.cN.CardEvents.TimeRecordCommentChanged:case Te.cN.CardEvents.TimeRecordDeleted:case Te.cN.CardEvents.TimeRecordFromChanged:case Te.cN.CardEvents.TimeRecordToChanged:case Te.cN.CardEvents.TimeRecordDurationChanged:case Te.cN.CardEvents.TimeRecordTimeAdded:case Te.cN.CardEvents.TimeRecordTimeRemoved:L()(c,{Destination:t.destination,"Card Duration":getCardDuration(t),Duration:(0,Ae.gG)(t.durationMinutes),Time:t.isDuration?"No":"Yes"});break;case Te.cN.CardEvents.AttachmentAdded:case Te.cN.CardEvents.AttachmentClicked:case Te.cN.CardEvents.AttachmentNameChanged:case Te.cN.CardEvents.AttachmentLinkChanged:case Te.cN.CardEvents.AttachmentDeleted:L()(c,{"Attachment Type":wt[t.attachmentType]})}break}case Te.cN.TaskListEvents.ContextMenuOpened:case Te.cN.TaskListEvents.Created:case Te.cN.TaskListEvents.NameChanged:case Te.cN.TaskListEvents.PositionChanged:case Te.cN.TaskListEvents.Sorted:case Te.cN.TaskListEvents.Archived:if(L()(c,{View:h,"Task List View Mode":Ke[this._collectionSettings.global.settings.provider[this._provider.type].taskLists.view],By:t.by}),e===Te.cN.TaskListEvents.Sorted)L()(c,{Type:tt[t.type]});break;case Te.cN.TimeTrackingEvents.ToolbarModeChanged:L()(c,{View:h,"View Mode":l,"Time Tracking Toolbar Mode":Ve[t.mode]});break;case Te.cN.TimeTrackingEvents.TimerStartClicked:case Te.cN.TimeTrackingEvents.TimerStarted:case Te.cN.TimeTrackingEvents.TimerStopped:L()(c,{Where:t.where,View:t.where===Te.Fb.Trello?"Trello":h,"View Mode":t.where===Te.Fb.Trello?"Trello Popup":l});break;case Te.cN.TimeTrackingEvents.NoteAdded:case Te.cN.TimeTrackingEvents.NoteChanged:case Te.cN.TimeTrackingEvents.ParentCardClicked:case Te.cN.TimeTrackingEvents.ParentCardAdded:case Te.cN.TimeTrackingEvents.ParentCardChanged:case Te.cN.TimeTrackingEvents.AddManuallyClicked:L()(c,{Where:t.where,View:h,"View Mode":l});break;case Te.cN.TimeTrackingEvents.OnlyMeChanged:L()(c,{Mode:this._collectionSettings.global.settings.timeTrackingOnlyMe?"Only Me":"All"});break;case Te.cN.OnboardingEvents.TourClicked:case Te.cN.OnboardingEvents.TourMinimized:case Te.cN.OnboardingEvents.TourMaximized:case Te.cN.OnboardingEvents.TourClosed:L()(c,{View:h});break;case Te.cN.FeedbackEvents.FeedbackOpened:L()(c,{Where:t.where});break;case Te.cN.FeedbackEvents.ProductSatisfactionShown:case Te.cN.FeedbackEvents.ProductSatisfactionClosed:break;case Te.cN.FeedbackEvents.ProductSatisfactionSent:L()(d,{"NPS Level":t.npsLevel,"NPS Feedback":t.npsFeedback}),L()(c,{"NPS Level":t.npsLevel,"NPS Feedback":t.npsFeedback});break;case Te.cN.CollectionEvents.CollectionAddAccountDialogOpened:L()(c,{Where:t.where});break;case Te.cN.CollectionEvents.CollectionAccountAdded:case Te.cN.CollectionEvents.CollectionAccountRemoved:L()(c,{"Account Type":at[t.accountType]});break;case Te.cN.CollectionEvents.CollectionAddBoardDialogOpened:case Te.cN.CollectionEvents.CollectionAddBoardDialogClosed:case Te.cN.CollectionEvents.CollectionAddCalendarDialogOpened:case Te.cN.CollectionEvents.CollectionAddCalendarDialogClosed:L()(c,{"Account Type":at[t.accountType],Where:t.where});break;case Te.cN.CollectionEvents.CollectionAddBoardDialogShown:case Te.cN.CollectionEvents.CollectionAddCalendarDialogShown:L()(c,{"Account Type":at[t.accountType]});break;case Te.cN.CollectionEvents.CollectionShareDialogOpened:L()(c,{Where:t.where,By:t.by});break;case Te.cN.CollectionEvents.CollectionUserAdded:case Te.cN.CollectionEvents.CollectionUserRemoved:case Te.cN.CollectionEvents.CollectionUserTypeChanged:L()(c,{"User Type":st[t.userType],By:t.by});break;case Te.cN.CollectionEvents.CollectionBoardAdded:case Te.cN.CollectionEvents.CollectionBoardDeselected:case Te.cN.CollectionEvents.CollectionBoardRemoved:case Te.cN.CollectionEvents.CollectionBoardSelected:case Te.cN.CollectionEvents.CollectionBoardSelectedAll:case Te.cN.CollectionEvents.CollectionBoardSelectedNone:case Te.cN.CollectionEvents.CollectionBoardSelectedOnlyThis:case Te.cN.CollectionEvents.CollectionCalendarAdded:case Te.cN.CollectionEvents.CollectionCalendarDeselected:case Te.cN.CollectionEvents.CollectionCalendarRemoved:case Te.cN.CollectionEvents.CollectionCalendarSelected:case Te.cN.CollectionEvents.CollectionCalendarSelectedAll:case Te.cN.CollectionEvents.CollectionCalendarSelectedNone:case Te.cN.CollectionEvents.CollectionCalendarSelectedOnlyThis:L()(c,{"Account Type":at[t.accountType],Count:t.count});break;case Te.cN.CollectionEvents.CollectionBoardFilterChanged:L()(c,{"Only Assigned To Me":t.onlyMyCards?"Enabled":"Disabled"});break;case Te.cN.CollectionEvents.CollectionOpened:L()(d,{"Total Google Calendar Count":this._googleIntegrationSrv.getGoogleCalendars().length,"Total iCal Calendar Count":this._iCalIntegrationSrv.getICalCalendars().length,"Total Outlook Calendar Count":this._outlookIntegrationSrv.getOutlookCalendars().length});const g=W()(i=this._googleProvider.getCurrentCollectionConnectedAccountIds()).call(i,(e=>this._googleProvider.getCurrentCollectionSelectedCalendarIds(e))),y=W()(r=this._outlookProvider.getCurrentCollectionConnectedAccountIds()).call(r,(e=>this._outlookProvider.getCurrentCollectionSelectedCalendarIds(e))),v=W()(n=this._iCalProvider.getCurrentCollectionConnectedAccountIds()).call(n,(e=>this._iCalProvider.getCurrentCollectionSelectedCalendarIds(e)));L()(c,{"Cards Visibility":Tt[this._collectionSettings.global.settings.filters.cardsVisibility],"Highlight Today":this._collectionSettings.global.settings.highlightToday?"Enabled":"Disabled",Orientation:Ue[this._appCommonSrv.getPlanywayOrientation()],View:h,"View Mode":l,"Task List View Mode":Ke[this._collectionSettings.global.settings.provider[this._provider.type].taskLists.view],"Task List Only Unscheduled":this._collectionSettings.global.settings.provider[this._provider.type].taskLists.filters.onlyUnscheduled?"Enabled":"Disabled","Show Week Numbers":this._collectionSettings.global.settings.showWeekNumbers?"Enabled":"Disabled","Show Weekends":this._collectionSettings.global.settings.showWorkDays?"Disabled":"Enabled","Show Non-working Hours":this._collectionSettings.global.settings.showWorkHours?"Disabled":"Enabled","Show Dates":this._collectionSettings.global.settings.showDates?"Enabled":"Disabled",Template:Te.PA[this._collectionSettings.global.settings.viewTemplate||Te.By.Skipped],"Collection User Count":this._collectionSrv.currentCollection.users.length,"Connected Google Calendar Count":g.length,"Connected iCal Calendar Count":v.length,"Connected Outlook Calendar Count":y.length});{var o;L()(d,{"Total Board Count":this._trelloIntegrationSrv.getTrelloBoards().length});const e=(0,Ie.VH)(Te.lP.Trello),t=W()(o=e.getCurrentCollectionConnectedAccountIds()).call(o,(t=>e.getCurrentCollectionSelectedCalendarIds(t)));let i=new(G()),r=new(G()),n=new(G()),a=new(G());for(let t of e.getCurrentCollectionConnectedAccountIds())for(let s of e.getCurrentCollectionSelectedCalendarIds(t)){let e=this._trelloIntegrationSrv.getTrelloBoardById(t,s);for(let t of e.members)i.add(t.id);for(let t of e.lists)r.add(t.id);for(let t of e.labels)n.add((0,Ae.uz)(t));for(let t of e.customFields)a.add((0,Ae.SY)(t))}L()(c,{"Show Card Number":this._collectionSettings.global.settings.showCardNumber?"Enabled":"Disabled","Show Archived":this._collectionSettings.global.settings.isArchivedCardsShown?"Enabled":"Disabled","Show Check Items":this._collectionSettings.global.settings.isCheckItemCardsShown?"Enabled":"Disabled","Show Milestones":this._collectionSettings.global.settings.isMilestonesShown?"Enabled":"Disabled","Card Color By":ct[this._collectionSettings.global.settings.provider[this._provider.type].cardColorBy],"Show Trello Board":this._collectionSettings.global.settings.showCalendar?"Enabled":"Disabled","Show Trello List":this._collectionSettings.global.settings.showList?"Enabled":"Disabled","Show Estimated Hours":this._collectionSettings.global.settings.showEstimatedHours?"Enabled":"Disabled","Show Tracked Hours":this._collectionSettings.global.settings.showTrackedHours?"Enabled":"Disabled","Show Custom Fields":this._collectionSettings.global.settings.provider[this._provider.type].customFieldsAsCards.length>0?"Enabled":"Disabled","Show Check Item Count":this._collectionSettings.global.settings.showCheckItems?"Enabled":"Disabled","Connected Board Count":t.length,"Boards Member Count":i.size,"Boards List Count":r.size,"Boards Label Count":n.size,"Boards Custom Field Count":a.size})}}if(this._$log.debug("SESSION EVENT:",e,d,c),this._sendAmplitudeEvent(e,d,c),this._sendAppInsightsEvent(e,c),this._totalEventsCount++,this._session&&this._sessionAllowed){let e=this._serializeSession(this._session);Re.y7.setItem(Ne,e),Re.Xb.setItem(`${Ne}-${this._session.sessionId}`,e)}}catch(e){0}})()}},{kind:"method",key:"logError",value:function logError(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(async()=>{try{if("string"==typeof t){if(V()(t).call(t,Ee.v8))return;t=new Error(t)}this._initTelemetryPromise&&await this._initTelemetryPromise,this._sendAppInsightsError(e,t,i)}catch(e){0}})()}},{kind:"method",key:"logRequest",value:function logRequest(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{let a=(0,ve.Z)();return this._requests.set(a,{requestType:e,method:t,url:i,data:r,startTime:Y()(),skipOnSuccess:n}),a}catch(e){0}}},{kind:"method",key:"logRequestEnd",value:function logRequestEnd(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&this._requests.has(e)&&(async()=>{try{this._initTelemetryPromise&&await this._initTelemetryPromise;let n=this._requests.get(e);r||this._requests.delete(e);let a=Y()()-n.startTime;(a<0||a>3e5)&&(a=0);let s,o,l=n.method.toUpperCase();if(n.method!==Te.Tu.Get&&(s=n.data),i&&(o=_objectSpread(_objectSpread({},i),{},{error:void 0})),this._$log.debug("REQUEST:",n.requestType,l,n.url,n.data,`duration: ${a}ms, status: ${t}, error:`,o),t>=200&&t<400){if(n.skipOnSuccess)return;if(/\/calendar\/v3\/users\/me\/calendarList/.test(n.url)||/\/calendar\/v3\/calendars\/[\w%-._~=@]+\/events/.test(n.url))return;if(/\/v1\.0\/me\/calendars/.test(n.url)||/\/v1\.0\/me\/calendars\/[\w%-._~=@]+\/events/.test(n.url)||/\/v1\.0\/me\/events\/[\w%-._~=@]+\/instances/.test(n.url))return}this._sendAppInsightsRequest(e,n.requestType,l,n.url,s,n.startTime,a,t,o)}catch(e){0}})()}},{kind:"method",key:"countUserActivityDays",value:function countUserActivityDays(e){let t=this._userActivityDays;return e&&(e=getDayStart(e),t=$()(t).call(t,(t=>t>=e))),t.length}},{kind:"get",key:"_userSettings",value:function _userSettings(){return this._settingsSrv.user}},{kind:"get",key:"_collectionSettings",value:function _collectionSettings(){return this._settingsSrv.collection}},{kind:"get",key:"_totalEventsCount",value:function _totalEventsCount(){if(Re.Xb.planywayTotalEventsCount)try{return Z()(Re.Xb.planywayTotalEventsCount,10)}catch{}return 0}},{kind:"set",key:"_totalEventsCount",value:function _totalEventsCount(e){Re.Xb.planywayTotalEventsCount=e}},{kind:"method",key:"_initTelemetryAsync",value:async function _initTelemetryAsync(){var e;let t=null!==(e=this._$window.planywayLoadStartTime)&&void 0!==e?e:Y()(),i=this._$window.planywayLoadStartTime?Y()()-this._$window.planywayLoadStartTime:0;(i<0||i>3e5)&&(i=0);let r=await this._platformSrv.getTelemetryDataAsync();switch(this._unauthorizedId=r.unauthorizedId,this._acquisitionDate=new Date(ye().getTimestamp(this.unauthorizedId.replace(/^un_/,""))),this._baseUserProperties={"App Version":this._platformSrv.getAppVersion(),"Acquisition Date":this._acquisitionDate.toISOString(),"Acquisition Day":(0,Ae.tC)(this._acquisitionDate),"Acquisition Week":(0,Ae.p6)(this._acquisitionDate,"yyyy/W"),"Acquisition Month":(0,Ae.p6)(this._acquisitionDate,"yyyy-MM"),"Acquisition Year":(0,Ae.p6)(this._acquisitionDate,"yyyy"),"Planyway User ID":Re.Xb.planywayUserId},this._baseEventProperties={"App Version":this._platformSrv.getAppVersion()},this._trafficSourceUserProperties={SourceUrl:"None"},this._platformSrv.getAppType()){case be.pR.Extension:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:It,Channel:$t});break;case be.pR.Plugin:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Pt,Channel:$t});break;case be.pR.Standalone:let e=(0,Ae.lX)(this._$window,be.Ii);var n,a;if(!e)e=null===(n=this._appCommonSrv.getAppContext())||void 0===n||null===(a=n.link)||void 0===a?void 0:a.type;switch(e){case Te.Un.ShareCard:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Lt,Channel:xt});break;case Te.Un.ShareCollection:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Nt,Channel:xt});break;case Te.Un.InviteEmail:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Ot,Channel:xt});break;default:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Mt,Channel:Bt})}break;case be.pR.Teams:this._trafficSourceUserProperties=_objectSpread(_objectSpread({},this._trafficSourceUserProperties),{},{Source:Rt,Channel:$t})}const sendAmplitudeIdentity=()=>{this._sendAmplitudeIdentity({add:{"Total Events Count":this._totalEventsCount},setOnce:this._trafficSourceUserProperties}),this._totalEventsCount=0};sendAmplitudeIdentity(),this._$interval(sendAmplitudeIdentity,36e5,0,!1);try{if(Re.y7.planywayAppInsightsOperationId)this._appInsightsOperationId=Re.y7.planywayAppInsightsOperationId;else{let e={name:`${Ee.Xt}Request`,iKey:Ee.yr,time:new Date(t).toISOString(),tags:{"ai.application.ver":this._platformSrv.getAppVersion(),"ai.cloud.role":be.i7[this._platformSrv.getAppType()],"ai.cloud.roleVer":this._platformSrv.getAppVersion(),"ai.cloud.roleInstance":this._appInsightsOperationId,"ai.operation.id":this._appInsightsOperationId,"ai.operation.name":`${be.i7[this._platformSrv.getAppType()]} Load App`,"ai.user.id":this.unauthorizedId,"ai.user.authUserId":this._thirdPartyUserId,"ai.internal.sdkVersion":`planyway:${this._platformSrv.getAppVersion()}`},data:{baseType:"RequestData",baseData:{ver:2,id:this._appInsightsOperationId,name:"Time to load app",duration:(0,Ae.i$)(i),responseCode:200,properties:_objectSpread(_objectSpread(_objectSpread({},this._baseUserProperties),this._baseEventProperties),{},{Browser:this._browser&&Q()(this._browser.getResult(),null,4)})}}};this._$log.debug("OPERATION:",`${be.i7[this._platformSrv.getAppType()]} Load App`,`duration: ${i}ms`),ee()(this._settingsSrv).telemetry&&await this._platformSrv.restAsync(Te.Tu.Post,Ee.iD,{body:e}),Re.y7.planywayAppInsightsOperationId=this._appInsightsOperationId}}catch(e){0}let{isInstallSent:s}=await this._platformSrv.getTelemetryDataAsync();this._initTelemetryPromise=null,s||(this.logSingleEvent(Te.cN.GeneralEvents.Installed),this._platformSrv.setTelemetryDataAsync({isInstallSent:!0}))}},{kind:"method",key:"_initSessionTelemetry",value:function _initSessionTelemetry(){try{var e;let t=this._deserializeSession(Re.y7.getItem(Ne));t&&!this._isSessionExpired(t)&&(this._session=t,this._renewSession());let i=$()(e=ie()(Re.Xb)).call(e,(e=>ne()(e).call(e,`${Ne}-`)));for(let e of i){let t=this._deserializeSession(Re.Xb.getItem(e));t&&this._isSessionExpired(t)&&this._sendSessionClosedEvent(t)}}catch(e){0}}},{kind:"method",key:"_renewSession",value:function _renewSession(){this._sessionTimeout&&this._$timeout.cancel(this._sessionTimeout),this._sessionTimeout=this._$timeout((()=>{this._sessionTimeout&&(this._$timeout.cancel(this._sessionTimeout),this._sessionTimeout=null),this._session&&(this._sendSessionClosedEvent(this._session),Re.y7.removeItem(Ne),this._session=null)}),Le,!1)}},{kind:"method",key:"_isSessionExpired",value:function _isSessionExpired(e){let t=(0,Ae.GM)(e.lastActivityDate,new Date);return t<0&&(t=0),t>Le||e.userId!==this._thirdPartyUserId}},{kind:"method",key:"_deserializeSession",value:function _deserializeSession(e){if(e)try{let t=JSON.parse(e);return t.sessionStartDate=new Date(t.sessionStartDate),t.lastActivityDate=new Date(t.lastActivityDate),t}catch{}}},{kind:"method",key:"_serializeSession",value:function _serializeSession(e){return Q()(e)}},{kind:"method",key:"_updateUserActivity",value:function _updateUserActivity(){this._userActivityDays=[];let e=new Date((0,Ae.tC)(new Date));if(Re.Xb.planywayActivityDays)try{var t,i;this._userActivityDays=$()(t=se()(i=JSON.parse(Re.Xb.planywayActivityDays)).call(i,(e=>new Date(e)))).call(t,(t=>{let i=(0,Ae.i2)(t,e);return i>0&&i<=90}))}catch{}this._userActivityDays.push(e);try{var r;Re.Xb.planywayActivityDays=Q()(se()(r=this._userActivityDays).call(r,(e=>(0,Ae.tC)(e))))}catch{}}},{kind:"method",key:"_initMouseflowAsync",value:async function _initMouseflowAsync(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("planyway"===this._appModuleName&&(!this._isMouseFlowInitialized||e)){if(this._isMouseFlowInitialized=!0,null===Re.Xb.getItem(Me)&&e){if(!ee()(this._settingsSrv).telemetry)return;if(!this._isMouseFlowConditionsSatisfied())return;if(!await this._isMouseFlowAppEnabledAsync())return void Re.Xb.setItem(Me,"false");Re.Xb.setItem(Me,"true"),Re.Xb.planywayMouseflowInitDate=(new Date).toISOString()}if("true"===Re.Xb.getItem(Me)&&Re.Xb.planywayMouseflowInitDate&&!((0,Ae.TR)(new Date(Re.Xb.planywayMouseflowInitDate),24)<=new Date))if(await this._isMouseFlowAppEnabledAsync())try{var t;const e={"App Platform":be.i7[this._platformSrv.getAppPlatform()],"App Type":be.i7[this._platformSrv.getAppType()],"License Type":this._licenseSrv.isLicenseActive()?this._licenseSrv.getLicenseType():"FREE"};let i=se()(t=le()(e)).call(t,(e=>{let[t,i]=e;return["setVariable",t,i]}));this._htmlHelperSrv.injectScript((e=>{window._mfq||(window._mfq=[]);for(let t of e)window._mfq.push(t)}),i);let r=this._$window.document.createElement("script");r.type="text/javascript",r.async=!0,r.src=Oe,(this._$window.document.head||this._$window.document.documentElement).appendChild(r),r.parentNode.removeChild(r)}catch(e){0}else Re.Xb.setItem(Me,"false")}}},{kind:"method",key:"_isMouseFlowConditionsSatisfied",value:function _isMouseFlowConditionsSatisfied(){return!0}},{kind:"method",key:"_isMouseFlowAppEnabledAsync",value:async function _isMouseFlowAppEnabledAsync(){if(void 0===this._isMouseFlowAppEnabled)try{let e=(await this._platformSrv.restAsync(Te.Tu.Get,"https://files.planyway.com/common/mf.json"))[this._platformSrv.getAppType()];!e||!e.enabled||Math.random()>e.rate?this._isMouseFlowAppEnabled=!1:this._isMouseFlowAppEnabled=!0}catch{this._isMouseFlowAppEnabled=!1}return this._isMouseFlowAppEnabled}},{kind:"method",key:"_sendSessionStartedEvent",value:function _sendSessionStartedEvent(e){let t={},i={"Work Hours":`${(0,Ae.U9)(this._userSettings.global.settings.workDayStart)}-${(0,Ae.U9)(this._userSettings.global.settings.workDayEnd)}`,"First Week Day":et[this._userSettings.global.settings.firstWeekDay],"Work Days":`${et[this._userSettings.global.settings.workWeekStart]}-${et[this._userSettings.global.settings.workWeekEnd]}`,Locale:this._appCommonSrv.getLocale(),Sidebar:this._collectionSettings.local.settings.mainSidebar.isShown?"Shown":"Hidden"},r={"Window Width":this._$window.innerWidth,"Window Height":this._$window.innerHeight,"Browser Locale":ke(),"Time Zone":(0,Ae.iT)()};this._$log.debug("SESSION EVENT:","Session Started",t,i),this._sendAmplitudeEvent("Session Started",t,i,e,e.sessionStartDate),this._sendAppInsightsEvent("Session Started",_objectSpread(_objectSpread({},i),r),e,e.sessionStartDate),this._totalEventsCount++}},{kind:"method",key:"_sendSessionClosedEvent",value:function _sendSessionClosedEvent(e){let t={},i={};this._$log.debug("SESSION EVENT:","Session Closed",t,i),this._sendAmplitudeEvent("Session Closed",t,i,e,e.lastActivityDate),this._sendAppInsightsEvent("Session Closed",i,e,e.lastActivityDate),this._totalEventsCount++,Re.Xb.removeItem(`${Ne}-${e.sessionId}`)}},{kind:"method",key:"_sendAmplitudeIdentity",value:function _sendAmplitudeIdentity(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._sendAmplitudeEvent("$identify",{$add:t.add,$append:t.append,$setOnce:t.setOnce,$unset:t.unset&&ce()(e=t.unset).call(e,((e,t)=>(e[t]="-",e)),{})})}},{kind:"method",key:"_sendAmplitudeEvent",value:function _sendAmplitudeEvent(e,t,i){var r,n;let a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._session,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Date;if(e===Te.cN.GeneralEvents.Installed)a="Amplitude Installed Event";let l=(0,ve.Z)();this._amplitudeSequenceNumber+=1;let d=Q()([{uuid:l,insert_id:l,platform:be.i7[this._platformSrv.getAppType()],version_name:this._platformSrv.getAppVersionShort(),device_model:be.i7[this._platformSrv.getAppType()],os_name:null===(r=this._browser)||void 0===r?void 0:r.getBrowserName(),os_version:null===(n=this._browser)||void 0===n?void 0:n.getBrowserVersion(),user_agent:navigator.userAgent,api_properties:{tracking_options:{ip_address:!1}},device_id:this.unauthorizedId,user_id:this._thirdPartyUserId,user_properties:"$identify"!==e?_objectSpread(_objectSpread({},this._baseUserProperties),t):t,session_id:s?s.sessionStartDate.getTime():-1,event_id:this._amplitudeSequenceNumber,sequence_number:this._amplitudeSequenceNumber,event_type:e,event_properties:"$identify"!==e?_objectSpread(_objectSpread({},this._baseEventProperties),i):void 0,timestamp:o.getTime()}]),c=new Date,h={client:Ee.n1,e:d,v:2,upload_time:c.getTime(),checksum:_e()(2+Ee.n1+d+c.getTime())};ee()(this._settingsSrv).telemetry&&(async()=>{try{await this._platformSrv.restAsync(Te.Tu.PostForm,Ee.NA,{body:h,deduplicationTag:a})}catch(e){this._$log.debug("Planyway send Amplitude telemetry error:"),this._$log.debug(e)}})()}},{kind:"method",key:"_sendAppInsightsEvent",value:function _sendAppInsightsEvent(e,t){let i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._session,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date;if(e===Te.cN.GeneralEvents.Installed)i="App Insights Installed Event";let a={name:`${Ee.Xt}Event`,iKey:Ee.yr,time:n.toISOString(),tags:{"ai.application.ver":this._platformSrv.getAppVersion(),"ai.cloud.role":be.i7[this._platformSrv.getAppType()],"ai.cloud.roleVer":this._platformSrv.getAppVersion(),"ai.cloud.roleInstance":this._appInsightsOperationId,"ai.operation.id":this._appInsightsOperationId,"ai.operation.name":be.i7[this._platformSrv.getAppType()],"ai.session.id":null==r?void 0:r.sessionId,"ai.user.id":this.unauthorizedId,"ai.user.authUserId":this._thirdPartyUserId,"ai.internal.sdkVersion":`planyway:${this._platformSrv.getAppVersion()}`},data:{baseType:"EventData",baseData:{ver:2,name:e,properties:_objectSpread(_objectSpread(_objectSpread({},this._baseUserProperties),this._baseEventProperties),t)}}};ee()(this._settingsSrv).telemetry&&(async()=>{try{await this._platformSrv.restAsync(Te.Tu.Post,Ee.iD,{body:a,deduplicationTag:i})}catch(e){this._$log.debug("Planyway send AppInsights telemetry error:"),this._$log.debug(e)}})()}},{kind:"method",key:"_sendAppInsightsError",value:function _sendAppInsightsError(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};if(t)for(let e of ue()(t))switch(e){case"constructor":case"name":case"message":break;default:r[e]="object"==typeof t[e]?Q()(t[e],null,4):t[e]}let n={name:`${Ee.Xt}Exception`,iKey:Ee.yr,time:(new Date).toISOString(),tags:{"ai.application.ver":this._platformSrv.getAppVersion(),"ai.cloud.role":be.i7[this._platformSrv.getAppType()],"ai.cloud.roleVer":this._platformSrv.getAppVersion(),"ai.cloud.roleInstance":this._appInsightsOperationId,"ai.operation.id":this._appInsightsOperationId,"ai.operation.name":be.i7[this._platformSrv.getAppType()],"ai.session.id":this._session&&this._session.sessionId,"ai.user.id":this.unauthorizedId,"ai.user.authUserId":this._thirdPartyUserId,"ai.internal.sdkVersion":`planyway:${this._platformSrv.getAppVersion()}`},data:{baseType:"ExceptionData",baseData:{ver:2,exceptions:[{message:t&&t.name?`${t.name}: ${t.message}`:"Unknown error",typeName:e,hasFullStack:!1}],properties:_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this._baseUserProperties),this._baseEventProperties),r),{},{"In Class":i.class,"In Property":i.property,"In Method":i.method,Browser:this._browser&&Q()(this._browser.getResult(),null,4)})}}};ee()(this._settingsSrv).telemetry&&(async()=>{try{await this._platformSrv.restAsync(Te.Tu.Post,Ee.iD,{body:n})}catch(e){this._$log.debug("Planyway send AppInsights telemetry error:"),this._$log.debug(e)}})()}},{kind:"method",key:"_sendAppInsightsRequest",value:function _sendAppInsightsRequest(e,t,i,r,n,a,s,o,l){let d=new(me())(r),c=d.host,h=d.pathname.replace(/boards\/[0-9a-zA-Z]{8}(\/|$)/,"boards/{sid}").replace(/cards\/[0-9a-zA-Z]{8}(\/|$)/,"cards/{sid}").replace(/calendar\/v3\/calendars\/[\w%-._~=@]+\/events\/[\w%-._~=@]+/,"calendar/v3/calendars/{calendar_id}/events/{event_id}").replace(/calendar\/v3\/calendars\/[\w%-._~=@]+/,"calendar/v3/calendars/{calendar_id}").replace(/me\/calendars\/[\w%-._~=@]+\/events\/[\w%-._~=@]+/,"me/calendars/{calendar_id}/events/{event_id}").replace(/me\/calendars\/[\w%-._~=@]+/,"me/calendars/{calendar_id}").replace(/me\/events\/[\w%-._~=@]+/,"me/events/{event_id}").replace(/[0-9a-f]{24}/g,"{id}").replace(/[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}/g,"{guid}"),u={name:`${Ee.Xt}RemoteDependency`,iKey:Ee.yr,time:new Date(a).toISOString(),tags:{"ai.application.ver":this._platformSrv.getAppVersion(),"ai.cloud.role":be.i7[this._platformSrv.getAppType()],"ai.cloud.roleVer":this._platformSrv.getAppVersion(),"ai.cloud.roleInstance":this._appInsightsOperationId,"ai.operation.id":this._appInsightsOperationId,"ai.operation.name":be.i7[this._platformSrv.getAppType()],"ai.session.id":this._session&&this._session.sessionId,"ai.user.id":this.unauthorizedId,"ai.user.authUserId":this._thirdPartyUserId,"ai.internal.sdkVersion":`planyway:${this._platformSrv.getAppVersion()}`},data:{baseType:"RemoteDependencyData",baseData:{ver:2,id:`|${this._appInsightsOperationId}.${e}`,name:`${i} ${h}`,duration:(0,Ae.i$)(s),resultCode:o,success:o>=200&&o<400,data:t,target:c,type:"Ajax",properties:_objectSpread(_objectSpread(_objectSpread({},this._baseUserProperties),this._baseEventProperties),{},{Data:n&&Q()(n,((e,t)=>{switch(e){case"userName":case"userEmail":case"message":case"attachments":case"compressed":case"name":case"desc":case"start":case"due":case"value":case"file":case"url":case"summary":case"subject":case"description":if("string"==typeof t)return`{${e}}`;break;case"idLabels":case"idMembers":return se()(t).call(t,(()=>"{id}"))}return"string"==typeof t?t.replace(Ee.VW,"{key}").replace(/[0-9a-f]{24}/g,"{id}").replace(/[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}/g,"{guid}"):t})),Response:l&&Q()(l,null,4),Retries:null==l?void 0:l.retries})}}};ee()(this._settingsSrv).telemetry&&(async()=>{try{await this._platformSrv.restAsync(Te.Tu.Post,Ee.iD,{body:u})}catch(e){this._$log.debug("Planyway send AppInsights telemetry error:"),this._$log.debug(e)}})()}}]}}));function toTimelineScaleUnit(e){if("string"==typeof e)return e;if(e<9e7)return Te.Uh.Hour;let t=1728e6;if(e<t)return Te.Uh.Day;let i=6912e6;if(e<i)return Te.Uh.Week;let r=20736e6;if(e<r)return Te.Uh.Month;return e<82944e6?Te.Uh.Quarter:Te.Uh.Year}function getCardDuration(e){if((0,Ae.qb)(e.start)&&(0,Ae.qb)(e.end))switch(e.cardRole){case be.D.Card:return e.isAllDay?(0,Ae.LU)(24*((0,Ae.i2)(e.start,e.end)+1)*60*60*1e3)||"0":(0,Ae.LU)((0,Ae.GM)(e.start,e.end))||"0";case be.D.Milestone:return"0"}}function toRecurrenceRuleText(e){return e?(0,Ae.Oo)(De.Ci.fromString(e).toText()):"Does not repeat"}},37342:(e,t,i)=>{i.d(t,{T:()=>P});var r=i(40024),n=i.n(r),a=i(88946),s=i.n(a),o=i(99595),l=i.n(o),d=i(57445),c=i.n(d),h=i(51791),u=i.n(h),p=i(90143),m=i.n(p),g=i(56626),y=i.n(g),v=i(67552),f=i.n(v),_=i(26881),C=i(86981),S=i.n(C),w=i(35820),k=i.n(w),b=i(68949),D=i(82617),T=i(56777),E=i(8937),A=i(29704);function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){var i;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){t.kind===i&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var i,r=e.prototype;l()(i=["method","field"]).call(i,(function(i){l()(t).call(t,(function(t){var n=t.placement;if(t.kind===i&&("static"===n||"prototype"===n)){var a="static"===n?e:r;this.defineClassElement(a,t)}}),this)}),this)},defineClassElement:function(e,t){var i=t.descriptor;if("field"===t.kind){var r=t.initializer;i={enumerable:i.enumerable,writable:i.writable,configurable:i.configurable,value:void 0===r?void 0:r.call(e)}}c()(e,t.key,i)},decorateClass:function(e,t){var i=[],r=[],n={static:[],prototype:[],own:[]};if(l()(e).call(e,(function(e){this.addElementPlacement(e,n)}),this),l()(e).call(e,(function(e){if(!_hasDecorators(e))return i.push(e);var t=this.decorateElement(e,n);i.push(t.element),i.push.apply(i,t.extras),r.push.apply(r,t.finishers)}),this),!t)return{elements:i,finishers:r};var a=this.decorateConstructor(i,t);return r.push.apply(r,a.finishers),a.finishers=r,a},addElementPlacement:function(e,t,i){var r=t[e.placement];if(!i&&-1!==u()(r).call(r,e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)},decorateElement:function(e,t){for(var i=[],r=[],n=e.decorators,a=n.length-1;a>=0;a--){var s=t[e.placement];m()(s).call(s,u()(s).call(s,e.key),1);var o=this.fromElementDescriptor(e),l=this.toElementFinisherExtras((0,n[a])(o)||o);e=l.element,this.addElementPlacement(e,t),l.finisher&&r.push(l.finisher);var d=l.extras;if(d){for(var c=0;c<d.length;c++)this.addElementPlacement(d[c],t);i.push.apply(i,d)}}return{element:e,finishers:r,extras:i}},decorateConstructor:function(e,t){for(var i=[],r=t.length-1;r>=0;r--){var n=this.fromClassDescriptor(e),a=this.toClassDescriptor((0,t[r])(n)||n);if(void 0!==a.finisher&&i.push(a.finisher),void 0!==a.elements){e=a.elements;for(var s=0;s<e.length-1;s++)for(var o=s+1;o<e.length;o++)if(e[s].key===e[o].key&&e[s].placement===e[o].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:i}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return c()(t,y(),{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){var t;if(void 0!==e)return s()(t=(0,_.Z)(e)).call(t,(function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var i=_toPropertyKey(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var n=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var a={kind:t,key:i,placement:r,descriptor:f()({},n)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:s()(e).call(e,this.fromElementDescriptor,this)};return c()(t,y(),{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var i=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:i}},runClassFinishers:function(e,t){for(var i=0;i<t.length;i++){var r=(0,t[i])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e},disallowProperty:function(e,t,i){if(void 0!==e[t])throw new TypeError(i+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,i=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:i,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var i=e[t];if(void 0!==i&&"function"!=typeof i)throw new TypeError("Expected '"+t+"' to be a function");return i}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[n()];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const I={[D.T.TimerAlreadyStarted]:"NOTIFICATIONS.TIMER_ALREADY_STARTED",[D.T.TimerAlreadyStopped]:"NOTIFICATIONS.TIMER_ALREADY_STOPPED",[D.T.TimerNotFound]:"NOTIFICATIONS.TIMER_NOT_FOUND"};let P=function _decorate(e,t,i,r){var n,a=_getDecoratorsApi();if(r)for(var o=0;o<r.length;o++)a=r[o](a);var l=t((function initialize(e){a.initializeInstanceElements(e,d.elements)}),i),d=a.decorateClass(function _coalesceClassElements(e){for(var t=[],isSameElement=function(e){return"method"===e.kind&&e.key===n.key&&e.placement===n.placement},i=0;i<e.length;i++){var r,n=e[i];if("method"===n.kind&&(r=S()(t).call(t,isSameElement)))if(_isDataDescriptor(n.descriptor)||_isDataDescriptor(r.descriptor)){if(_hasDecorators(n)||_hasDecorators(r))throw new ReferenceError("Duplicated methods ("+n.key+") can't be decorated.");r.descriptor=n.descriptor}else{if(_hasDecorators(n)){if(_hasDecorators(r))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+n.key+").");r.decorators=n.decorators}_coalesceGetterSetter(n,r)}else t.push(n)}return t}(s()(n=l.d).call(n,_createElementDescriptor)),e);return a.initializeClassElements(l.F,d.elements),a.runClassFinishers(l.F,d.finishers)}([(0,A.SG)(["$rootScope","$log","$interval","$timeout","$translate","$window","calendarCardsSrv","collectionSrv","notificationSrv","planywayIntegrationSrv","platformSrv","telemetrySrv"])],(function(e){return{F:class TimeTrackingService{constructor(t,i,r,n,a,s,o,l,d,c,h,u){e(this),this._$rootScope=t,this._$log=i,this._$interval=r,this._$timeout=n,this._$translate=a,this._$window=s,this._calendarCardsSrv=o,this._collectionSrv=l,this._notificationSrv=d,this._planywayIntegrationSrv=c,this._platformSrv=h,this._telemetrySrv=u;const onChangeCards=()=>this._loadTimerParentCardPromise=null;this._$rootScope.$on(E.FK.CardsReloaded,(()=>onChangeCards())),this._calendarCardsSrv.addCalendarCardEventListener("added",onChangeCards),this._calendarCardsSrv.addCalendarCardEventListener("updated",onChangeCards),this._calendarCardsSrv.addCalendarCardEventListener("deleted",onChangeCards),this._calendarCardsSrv.addCalendarCardEventListener("cleared",onChangeCards);for(let e of[E.FK.CollectionChanged,E.FK.AccountAdded,E.FK.AccountDeleted])this._$rootScope.$on(e,(()=>this._initTimerAsync()));this._initTimerAsync(),(0,b.rC)(this,{_timerCounterDate:!0})}},d:[{kind:"get",static:!0,key:"serviceName",value:function serviceName(){return"timeTrackingSrv"}},{kind:"field",key:"_isTimerBusy",value:()=>!1},{kind:"field",key:"_timerAccount",value:()=>null},{kind:"field",key:"_currentTimer",value:()=>null},{kind:"field",key:"_timerCounterDate",value:()=>null},{kind:"get",key:"timeRecordMinDurationSeconds",value:function timeRecordMinDurationSeconds(){return 60}},{kind:"get",key:"timeRecordMaxDurationSeconds",value:function timeRecordMaxDurationSeconds(){return 86399}},{kind:"get",key:"timeRecordMaxDurationMinutes",value:function timeRecordMaxDurationMinutes(){return this.timeRecordMaxDurationSeconds/60}},{kind:"get",key:"timeRecordDefaultDurationMinutes",value:function timeRecordDefaultDurationMinutes(){return 60}},{kind:"get",key:"isTimerBusy",value:function isTimerBusy(){return this._isTimerBusy}},{kind:"get",key:"isTimerStarted",value:function isTimerStarted(){return!!this._timerCounterDate}},{kind:"get",key:"timerCounterText",value:function timerCounterText(){return this._timerCounterDate?(0,A.U9)(this._timerCounterDate,"HH:mm:ss"):null}},{kind:"get",key:"timerProviderType",value:function timerProviderType(){if(this.isTimerStarted)return this.currentTimer?this.currentTimer.providerType:void 0}},{kind:"get",key:"timerAccountId",value:function timerAccountId(){if(this.isTimerStarted)return this.currentTimer?this.currentTimer.accountId:void 0}},{kind:"get",key:"timerParentId",value:function timerParentId(){if(this.isTimerStarted)return this.currentTimer?this.currentTimer.parentId:void 0}},{kind:"get",key:"timerParentCard",value:function timerParentCard(){if(this.isTimerStarted)return this._loadTimerParentCardPromise||(this._loadTimerParentCardPromise=(async()=>{try{if(!this.timerProviderType)return;let e=(0,T.VH)(this.timerProviderType),t=await e.getTimerParentCardByIdAsync(this.timerAccountId,this.timerParentId);this._$timeout((()=>this._timerParentCard=t))}catch(e){this._$log.error("Planyway timer parent card loading error:"),this._$log.error(e)}})()),this._timerParentCard}},{kind:"get",key:"timerComment",value:function timerComment(){if(this.isTimerStarted)return this.currentTimer?this.currentTimer.comment:void 0}},{kind:"get",key:"currentTimer",value:function currentTimer(){return this._currentTimer}},{kind:"method",key:"startTimerAsync",value:async function startTimerAsync(e,t){let{providerType:i,calendarId:r,parentId:n,comment:a}=t;if(this.isTimerStarted||this.isTimerBusy||!i||!n)return!1;try{this._isTimerBusy=!0;let t=new Date;this._currentTimer={accountId:e,providerType:i,parentId:n,comment:a,startDate:t},this._applyCurrentTimer();let s=(0,T.VH)(i);return await s.callRecordsApiAsync(e,"startTimer","Planyway start card timer",{startDate:t,boardId:r,cardId:n,comment:a}),!0}catch(e){this._currentTimer=null,this._applyCurrentTimer();let t=I[e.code]||"NOTIFICATIONS.START_TIMER_ERROR";return this._notificationSrv.showNotification(this._$translate.instant(t),E.k$.Error),!1}finally{this._$rootScope.$evalAsync((()=>{this._isTimerBusy=!1}))}}},{kind:"method",key:"stopTimerAsync",value:async function stopTimerAsync(){if(!this.isTimerStarted||this.isTimerBusy)return;let e=(0,A.WF)((0,A.$Y)(this._timerCounterDate),this._timerCounterDate);e<this.timeRecordMinDurationSeconds&&(e=this.timeRecordMinDurationSeconds);let t=(0,A.GG)(this.currentTimer.startDate,"minute"),i=(0,A.GG)((0,A.v8)(t,e),"minute"),r=this.timerAccountId,n=this.timerProviderType,a=this.timerParentId,s=this.timerComment;this.currentTimer.endDate=i;let o=this.currentTimer;try{this._isTimerBusy=!0,this._currentTimer=null,this._applyCurrentTimer();let e=(0,T.VH)(n);await e.callRecordsApiAsync(o.accountId,"stopTimer","Planyway stop card timer",{startDate:o.startDate,stopDate:o.endDate})}catch(e){this._currentTimer=o,this._applyCurrentTimer();let t=I[e.code]||"NOTIFICATIONS.STOP_TIMER_ERROR";return void this._notificationSrv.showNotification(this._$translate.instant(t),E.k$.Error)}finally{this._$rootScope.$evalAsync((()=>{this._isTimerBusy=!1}))}return{accountId:r,providerType:n,parentId:a,comment:s,startDate:t,endDate:i}}},{kind:"method",key:"_applyCurrentTimer",value:function _applyCurrentTimer(){var e,t;let i=null===(e=this.currentTimer)||void 0===e?void 0:e.parentId;i!==this._lastParentId&&(this._loadTimerParentCardPromise=null,this._lastParentId=i);let r=null===(t=this.currentTimer)||void 0===t?void 0:t.startDate;if(!(0,A.rs)(r,this._lastStartDate)){if(this._lastStartDate&&(this._$interval.cancel(this._timerInstance),this._timerInstance=null),r){const updateCounter=()=>{let e=(0,A.WF)(r,new Date);e>this.timeRecordMaxDurationSeconds&&(e=this.timeRecordMaxDurationSeconds),this._timerCounterDate=(0,A.v8)((0,A.$Y)(r),e),this._platformSrv.setAppTitleAsync({timerTime:this.timerCounterText})};this._timerInstance=this._$interval(updateCounter,1e3),this._$rootScope.$evalAsync(updateCounter)}else this._$rootScope.$evalAsync((()=>{this._timerCounterDate=null,this._platformSrv.setAppTitleAsync({timerTime:null})}));this._lastStartDate=r}}},{kind:"method",key:"_loadTimerAsync",value:async function _loadTimerAsync(e){try{let t=(0,T.dS)(e.accountType),i=await t.callRecordsApiAsync(e.accountId,"getTimer","Planyway get card timer");i.startDate&&!i.stopDate&&(this._currentTimer={accountId:e.accountId,providerType:(0,T.fL)(e.accountType),parentId:i.cardId,comment:i.comment,startDate:new Date(i.startDate)})}catch{this._currentTimer=null}finally{this._applyCurrentTimer()}}},{kind:"method",key:"_initTimerAsync",value:async function _initTimerAsync(){var e;const t=S()(e=this._collectionSrv.getCurrentCollectionConnectedAccounts()).call(e,(e=>(0,T.dS)(e.accountType).timeTrackingCardType));if(t){const{url:e,token:i}=(0,T.dS)(t.accountType).getSignalRConnectionParams(t);if(this._timerAccount){if(this._timerAccount.signalRUrl===e)return;for(let e of this._timerAccount.signalRSubscriptions)e.destroy()}this._timerAccount={signalRUrl:e};const errorCallback=e=>{this._$log.error("Planyway timer SignalR error:"),this._$log.error(e),this._telemetrySrv.logError("Planyway timer SignalR error",e,{class:this.constructor.name,method:this._initTimerAsync.name})},r=this._platformSrv.buildSignalRPollingController((()=>{if(!(0,T.dS)(t.accountType).invalidAccountIds.has(t.accountId))return this._loadTimerAsync(t)}),6e4);this._timerAccount.signalRSubscriptions=await k().all([this._platformSrv.subscribeSignalRAsync(e,{token:i,messageType:D.Wy.TimerStarted,messageCallback:e=>{this._currentTimer={accountId:t.accountId,providerType:(0,T.fL)(t.accountType),parentId:e.cardId,comment:e.comment,startDate:new Date(e.startDate)},this._applyCurrentTimer()},errorCallback,pollingController:r}),this._platformSrv.subscribeSignalRAsync(e,{token:i,messageType:D.Wy.TimerStopped,messageCallback:()=>{this._currentTimer=null,this._applyCurrentTimer()},errorCallback,pollingController:r})]),await this._loadTimerAsync(t)}else{if(this._timerAccount){for(let e of this._timerAccount.signalRSubscriptions)e.destroy();this._timerAccount=null}this._currentTimer=null,this._applyCurrentTimer()}}}]}}))},52508:(e,t,i)=>{i.d(t,{M:()=>PwCircularProgress});var r,n,a=i(62079),s=i.n(a),o=i(52020),l=i.n(o),d=i(73324),c=i.n(d),h=i(88546),u=i.n(h),p=i(99595),m=i.n(p),g=i(66775),y=i.n(g),v=i(2201),f=i.n(v),_=i(57445),C=i.n(_),S=i(26171),w=i(67294),k=i(66489),b=i(2373),D=i(59766);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},_extends.apply(this,arguments)}var T=function SvgGradientLoader(e){return w.createElement("svg",_extends({width:24,height:24,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=w.createElement("defs",null,w.createElement("linearGradient",{id:"gradient-loader_svg__prefix__grad-1",y2:1,x2:0},w.createElement("stop",{offset:"5%",stopColor:"currentColor",stopOpacity:.5}),w.createElement("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:0})),w.createElement("linearGradient",{id:"gradient-loader_svg__prefix__grad-2",y2:1,x2:0},w.createElement("stop",{offset:"5%",stopColor:"currentColor",stopOpacity:0}),w.createElement("stop",{offset:"100%",stopColor:"currentColor"})),w.createElement("pattern",{id:"gradient-loader_svg__prefix__pattern",x:0,y:0,width:"100%",height:"100%",patternUnits:"userSpaceOnUse"},w.createElement("rect",{width:"100%",height:"100%",fill:"url(#gradient-loader_svg__prefix__grad-1)"}),w.createElement("rect",{x:"50%",width:"50%",height:"100%",fill:"url(#gradient-loader_svg__prefix__grad-2)"})))),n||(n=w.createElement("circle",{cx:12,cy:12,r:10,strokeWidth:4,stroke:"url(#gradient-loader_svg__prefix__pattern)"})))};i.p;var E=i(85893);function ownKeys(e,t){var i=s()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return u()(e,t).enumerable}))),i.push.apply(i,r)}return i}const PwCircularProgress=e=>{const{color:t="success",size:i=44,sx:r,variant:n}=e,a=(0,w.useMemo)((()=>(0,D.Z)({fontSize:i,animation:"rotate 1.4s linear infinite","@keyframes rotate":{to:{transform:"rotate(1turn)"}},circle:{fill:"transparent"}},r)),[i,r]);return"determinate"===n?(0,E.jsx)(k.Z,function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?m()(i=ownKeys(Object(n),!0)).call(i,(function(t){(0,S.Z)(e,t,n[t])})):y()?f()(e,y()(n)):m()(r=ownKeys(Object(n))).call(r,(function(t){C()(e,t,u()(n,t))}))}return e}({color:t,size:i,thickness:8},e)):(0,E.jsx)(b.Z,{color:t,component:T,sx:a})}},32248:(e,t,i)=>{i.d(t,{j:()=>PwColorPicker});var r=i(88946),n=i.n(r),a=i(45697),s=i.n(a),o=i(71508),l=i(67294),d=i(59708),c=i(2734),h=i(2373),u=i(15414),p=i(85893);const ColorItemBox=e=>{let{children:t}=e;return(0,p.jsx)(d.Z,{sx:{alignItems:"center",justifyContent:"center",height:"44px",width:"44px"},children:t})},HighlightCircle=e=>{let{isHighlighted:t}=e;const{transitions:i}=(0,c.Z)();return(0,p.jsx)(o.Z,{sx:{position:"absolute",borderRadius:"50%",backgroundColor:"#eeeeee",height:t?"40px":"20px",width:t?"40px":"20px",transition:i.create(["width","height"])}})},ColorCircle=e=>{let{color:t,isSelected:i,onClick:r,onMouseEnter:n,onMouseLeave:a}=e;return(0,p.jsx)(o.Z,{sx:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"1",borderRadius:"50%",height:"24px",width:"24px",margin:"auto",backgroundColor:t,color:"#ffffff",fontSize:"20px",cursor:"pointer"},onClick:r,onMouseEnter:n,onMouseLeave:a,children:i&&(0,p.jsx)(h.Z,{component:u.r,inheritViewBox:!0,sx:{width:"12px",height:"12px",fill:"transparent",path:{fill:"#ffffff"}}})})},PwColorItem=e=>{let{value:t,isSelected:i,onClick:r}=e;const[n,a]=(0,l.useState)(!1);return(0,p.jsxs)(ColorItemBox,{children:[(0,p.jsx)(HighlightCircle,{isHighlighted:n||i}),(0,p.jsx)(ColorCircle,{color:t,isSelected:i,onClick:r,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1)})]})},ColorGrid=e=>{let{children:t}=e;return(0,p.jsx)(o.Z,{sx:{alignItems:"center",display:"grid",gridAutoRows:"44px",gridTemplateColumns:"repeat(auto-fill, 44px)",justifyItems:"center"},children:t})},PwColorPicker=e=>{let{colors:t,onChange:i,selectedColor:r}=e;return(0,p.jsx)(ColorGrid,{children:n()(t).call(t,(e=>(0,p.jsx)(PwColorItem,{isSelected:e.color===r,value:e.value,onClick:()=>i(e.color)},e.value)))})};PwColorPicker.componentName="pwColorPicker",PwColorPicker.propTypes={colors:s().arrayOf(s().shape({value:s().string.isRequired,color:s().string.isRequired})).isRequired,selectedColor:s().string,onChange:s().func.isRequired}}}]);